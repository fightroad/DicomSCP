{"version":3,"file":"1436.bundle.c0e68e6f2dd9ba272134.js","mappings":"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Cf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAA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","sources":["webpack:///../../../node_modules/@cornerstonejs/calculate-suv/dist/calculate-suv.esm.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/constants/COLOR_LUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/MouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/elementCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/ImageMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGCursorDescriptor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/setCursorForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/getSvgDrawingHelper.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/draw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setAttributesIfNecessary.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setNewAttributesIfValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawCircle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipseByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipse.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandles.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHeight.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPath.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLink.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLinkedTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRectByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawArrow.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRedactionRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationCompleted.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/onLabelmapSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationDataModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/imageChangeEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationCompletedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationSelectionListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationRemovedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationRemoved.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageRenderedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraModifiedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageSpacingCalibratedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/annotationInterpolationEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraResetEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizersForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/removeEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/cancelActiveManipulations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/Synchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/createSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getAllSynchronizers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroySynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationRepresentationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/init.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/cameraSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createCameraPositionSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/presentationViewSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createPresentationViewSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/voiSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createVOISynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/zoomPanSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createZoomPanSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/imageSliceSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/areViewportsCoplanar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createImageSliceSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/slabThicknessSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createSlabThicknessSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PanTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/TrackballRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelRegionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/StackScrollTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PlanarRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ZoomTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MIPJumpToClickTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/CrosshairsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AdvancedMagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceLinesTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OverlayGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SegmentationIntersectionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceCursors.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ScaleOverlayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SculptorTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/VolumeRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LengthTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/HeightTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/DragProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/EllipticalROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CircleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ETDRSGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ArrowAnnotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/AngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CobbAngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/UltrasoundDirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/KeyImageTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AnnotationEraserTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SphereScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/PaintFillTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OrientationMarkerTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SegmentSelectTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/VideoRedactionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/FrameOfReferenceSpecificAnnotationManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationSelection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/ToolStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/helpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getFont.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/getAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/helpers/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStateManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/activeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/internalAddSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentationRepresentationsToViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/normalizeSegmentationInput.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationColor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/events/triggerSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getCurrentLabelmapImageIdForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportIdsWithSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/computeVolumeLabelmapFromStack.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/styleHelpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/clearSegmentValue.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getLabelmapImageIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/updateSurfaceData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/createAndCacheSurfacesFromRaw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertContourToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertLabelmapToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/surfaceComputationStrategies.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/canComputeRequestedRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/computeAndAddRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentationRepresentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getStackSegmentationImageIdsForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateLabelmapSegmentationImageReferences.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/ToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/createToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroyToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getAllToolGroups.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupsWithToolName.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/svgNodeCache.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/BidirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/RectangleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/AnnotationDisplayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/BaseTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Contour/contourDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Labelmap/labelmapDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Surface/surfaceDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/BrushTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/types/ContourAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getViewportsForAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec2/findClosestPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getUniqueSegmentIndices.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/invalidateBrushCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/utilities.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRenderForViewportIds.js","webpack:///../../../node_modules/@icons/material/CheckIcon.js","webpack:///../../../node_modules/@icons/material/UnfoldMoreHorizontalIcon.js","webpack:///../../../node_modules/dicomweb-client/build/dicomweb-client.es.js","webpack:///../../../node_modules/lodash.get/index.js","webpack:///../../../node_modules/lodash/_DataView.js","webpack:///../../../node_modules/lodash/_Hash.js","webpack:///../../../node_modules/lodash/_ListCache.js","webpack:///../../../node_modules/lodash/_Map.js","webpack:///../../../node_modules/lodash/_MapCache.js","webpack:///../../../node_modules/lodash/_Promise.js","webpack:///../../../node_modules/lodash/_Set.js","webpack:///../../../node_modules/lodash/_SetCache.js","webpack:///../../../node_modules/lodash/_Stack.js","webpack:///../../../node_modules/lodash/_Uint8Array.js","webpack:///../../../node_modules/lodash/_WeakMap.js","webpack:///../../../node_modules/lodash/_arrayEach.js","webpack:///../../../node_modules/lodash/_arrayFilter.js","webpack:///../../../node_modules/lodash/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash/_arrayMap.js","webpack:///../../../node_modules/lodash/_arrayPush.js","webpack:///../../../node_modules/lodash/_arraySome.js","webpack:///../../../node_modules/lodash/_assignValue.js","webpack:///../../../node_modules/lodash/_assocIndexOf.js","webpack:///../../../node_modules/lodash/_baseAssign.js","webpack:///../../../node_modules/lodash/_baseAssignIn.js","webpack:///../../../node_modules/lodash/_baseAssignValue.js","webpack:///../../../node_modules/lodash/_baseClone.js","webpack:///../../../node_modules/lodash/_baseCreate.js","webpack:///../../../node_modules/lodash/_baseEach.js","webpack:///../../../node_modules/lodash/_baseFor.js","webpack:///../../../node_modules/lodash/_baseForOwn.js","webpack:///../../../node_modules/lodash/_baseGet.js","webpack:///../../../node_modules/lodash/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash/_baseHasIn.js","webpack:///../../../node_modules/lodash/_baseIsArguments.js","webpack:///../../../node_modules/lodash/_baseIsEqual.js","webpack:///../../../node_modules/lodash/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash/_baseIsMap.js","webpack:///../../../node_modules/lodash/_baseIsMatch.js","webpack:///../../../node_modules/lodash/_baseIsNative.js","webpack:///../../../node_modules/lodash/_baseIsSet.js","webpack:///../../../node_modules/lodash/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash/_baseIteratee.js","webpack:///../../../node_modules/lodash/_baseKeys.js","webpack:///../../../node_modules/lodash/_baseKeysIn.js","webpack:///../../../node_modules/lodash/_baseMap.js","webpack:///../../../node_modules/lodash/_baseMatches.js","webpack:///../../../node_modules/lodash/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash/_baseProperty.js","webpack:///../../../node_modules/lodash/_basePropertyDeep.js","webpack:///../../../node_modules/lodash/_baseTimes.js","webpack:///../../../node_modules/lodash/_baseToString.js","webpack:///../../../node_modules/lodash/_baseUnary.js","webpack:///../../../node_modules/lodash/_cacheHas.js","webpack:///../../../node_modules/lodash/_castFunction.js","webpack:///../../../node_modules/lodash/_castPath.js","webpack:///../../../node_modules/lodash/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash/_cloneBuffer.js","webpack:///../../../node_modules/lodash/_cloneDataView.js","webpack:///../../../node_modules/lodash/_cloneRegExp.js","webpack:///../../../node_modules/lodash/_cloneSymbol.js","webpack:///../../../node_modules/lodash/_cloneTypedArray.js","webpack:///../../../node_modules/lodash/_copyArray.js","webpack:///../../../node_modules/lodash/_copyObject.js","webpack:///../../../node_modules/lodash/_copySymbols.js","webpack:///../../../node_modules/lodash/_copySymbolsIn.js","webpack:///../../../node_modules/lodash/_coreJsData.js","webpack:///../../../node_modules/lodash/_createBaseEach.js","webpack:///../../../node_modules/lodash/_createBaseFor.js","webpack:///../../../node_modules/lodash/_defineProperty.js","webpack:///../../../node_modules/lodash/_equalArrays.js","webpack:///../../../node_modules/lodash/_equalByTag.js","webpack:///../../../node_modules/lodash/_equalObjects.js","webpack:///../../../node_modules/lodash/_getAllKeys.js","webpack:///../../../node_modules/lodash/_getAllKeysIn.js","webpack:///../../../node_modules/lodash/_getMapData.js","webpack:///../../../node_modules/lodash/_getMatchData.js","webpack:///../../../node_modules/lodash/_getNative.js","webpack:///../../../node_modules/lodash/_getPrototype.js","webpack:///../../../node_modules/lodash/_getSymbols.js","webpack:///../../../node_modules/lodash/_getSymbolsIn.js","webpack:///../../../node_modules/lodash/_getTag.js","webpack:///../../../node_modules/lodash/_getValue.js","webpack:///../../../node_modules/lodash/_hasPath.js","webpack:///../../../node_modules/lodash/_hashClear.js","webpack:///../../../node_modules/lodash/_hashDelete.js","webpack:///../../../node_modules/lodash/_hashGet.js","webpack:///../../../node_modules/lodash/_hashHas.js","webpack:///../../../node_modules/lodash/_hashSet.js","webpack:///../../../node_modules/lodash/_initCloneArray.js","webpack:///../../../node_modules/lodash/_initCloneByTag.js","webpack:///../../../node_modules/lodash/_initCloneObject.js","webpack:///../../../node_modules/lodash/_isIndex.js","webpack:///../../../node_modules/lodash/_isKey.js","webpack:///../../../node_modules/lodash/_isKeyable.js","webpack:///../../../node_modules/lodash/_isMasked.js","webpack:///../../../node_modules/lodash/_isPrototype.js","webpack:///../../../node_modules/lodash/_isStrictComparable.js","webpack:///../../../node_modules/lodash/_listCacheClear.js","webpack:///../../../node_modules/lodash/_listCacheDelete.js","webpack:///../../../node_modules/lodash/_listCacheGet.js","webpack:///../../../node_modules/lodash/_listCacheHas.js","webpack:///../../../node_modules/lodash/_listCacheSet.js","webpack:///../../../node_modules/lodash/_mapCacheClear.js","webpack:///../../../node_modules/lodash/_mapCacheDelete.js","webpack:///../../../node_modules/lodash/_mapCacheGet.js","webpack:///../../../node_modules/lodash/_mapCacheHas.js","webpack:///../../../node_modules/lodash/_mapCacheSet.js","webpack:///../../../node_modules/lodash/_mapToArray.js","webpack:///../../../node_modules/lodash/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash/_memoizeCapped.js","webpack:///../../../node_modules/lodash/_nativeCreate.js","webpack:///../../../node_modules/lodash/_nativeKeys.js","webpack:///../../../node_modules/lodash/_nativeKeysIn.js","webpack:///../../../node_modules/lodash/_nodeUtil.js","webpack:///../../../node_modules/lodash/_overArg.js","webpack:///../../../node_modules/lodash/_setCacheAdd.js","webpack:///../../../node_modules/lodash/_setCacheHas.js","webpack:///../../../node_modules/lodash/_setToArray.js","webpack:///../../../node_modules/lodash/_stackClear.js","webpack:///../../../node_modules/lodash/_stackDelete.js","webpack:///../../../node_modules/lodash/_stackGet.js","webpack:///../../../node_modules/lodash/_stackHas.js","webpack:///../../../node_modules/lodash/_stackSet.js","webpack:///../../../node_modules/lodash/_stringToPath.js","webpack:///../../../node_modules/lodash/_toKey.js","webpack:///../../../node_modules/lodash/_toSource.js","webpack:///../../../node_modules/lodash/cloneDeep.js","webpack:///../../../node_modules/lodash/eq.js","webpack:///../../../node_modules/lodash/forOwn.js","webpack:///../../../node_modules/lodash/get.js","webpack:///../../../node_modules/lodash/hasIn.js","webpack:///../../../node_modules/lodash/identity.js","webpack:///../../../node_modules/lodash/isArguments.js","webpack:///../../../node_modules/lodash/isArray.js","webpack:///../../../node_modules/lodash/isArrayLike.js","webpack:///../../../node_modules/lodash/isBuffer.js","webpack:///../../../node_modules/lodash/isFunction.js","webpack:///../../../node_modules/lodash/isLength.js","webpack:///../../../node_modules/lodash/isMap.js","webpack:///../../../node_modules/lodash/isPlainObject.js","webpack:///../../../node_modules/lodash/isSet.js","webpack:///../../../node_modules/lodash/isString.js","webpack:///../../../node_modules/lodash/isTypedArray.js","webpack:///../../../node_modules/lodash/keys.js","webpack:///../../../node_modules/lodash/keysIn.js","webpack:///../../../node_modules/lodash/map.js","webpack:///../../../node_modules/lodash/memoize.js","webpack:///../../../node_modules/lodash/property.js","webpack:///../../../node_modules/lodash/stubArray.js","webpack:///../../../node_modules/lodash/stubFalse.js","webpack:///../../../node_modules/lodash/toString.js","webpack:///../../../node_modules/react-color/es/helpers/checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Alpha.js","webpack:///../../../node_modules/react-color/es/helpers/alpha.js","webpack:///../../../node_modules/react-color/es/components/common/EditableInput.js","webpack:///../../../node_modules/react-color/es/helpers/hue.js","webpack:///../../../node_modules/react-color/es/components/common/Hue.js","webpack:///../../../node_modules/lodash-es/_listCacheClear.js","webpack:///../../../node_modules/lodash-es/eq.js","webpack:///../../../node_modules/lodash-es/_assocIndexOf.js","webpack:///../../../node_modules/lodash-es/_listCacheDelete.js","webpack:///../../../node_modules/lodash-es/_listCacheGet.js","webpack:///../../../node_modules/lodash-es/_listCacheHas.js","webpack:///../../../node_modules/lodash-es/_listCacheSet.js","webpack:///../../../node_modules/lodash-es/_ListCache.js","webpack:///../../../node_modules/lodash-es/_stackClear.js","webpack:///../../../node_modules/lodash-es/_stackDelete.js","webpack:///../../../node_modules/lodash-es/_stackGet.js","webpack:///../../../node_modules/lodash-es/_stackHas.js","webpack:///../../../node_modules/lodash-es/_freeGlobal.js","webpack:///../../../node_modules/lodash-es/_root.js","webpack:///../../../node_modules/lodash-es/_Symbol.js","webpack:///../../../node_modules/lodash-es/_getRawTag.js","webpack:///../../../node_modules/lodash-es/_objectToString.js","webpack:///../../../node_modules/lodash-es/_baseGetTag.js","webpack:///../../../node_modules/lodash-es/isObject.js","webpack:///../../../node_modules/lodash-es/isFunction.js","webpack:///../../../node_modules/lodash-es/_coreJsData.js","webpack:///../../../node_modules/lodash-es/_isMasked.js","webpack:///../../../node_modules/lodash-es/_toSource.js","webpack:///../../../node_modules/lodash-es/_baseIsNative.js","webpack:///../../../node_modules/lodash-es/_getValue.js","webpack:///../../../node_modules/lodash-es/_getNative.js","webpack:///../../../node_modules/lodash-es/_Map.js","webpack:///../../../node_modules/lodash-es/_nativeCreate.js","webpack:///../../../node_modules/lodash-es/_hashClear.js","webpack:///../../../node_modules/lodash-es/_hashDelete.js","webpack:///../../../node_modules/lodash-es/_hashGet.js","webpack:///../../../node_modules/lodash-es/_hashHas.js","webpack:///../../../node_modules/lodash-es/_hashSet.js","webpack:///../../../node_modules/lodash-es/_Hash.js","webpack:///../../../node_modules/lodash-es/_mapCacheClear.js","webpack:///../../../node_modules/lodash-es/_isKeyable.js","webpack:///../../../node_modules/lodash-es/_getMapData.js","webpack:///../../../node_modules/lodash-es/_mapCacheDelete.js","webpack:///../../../node_modules/lodash-es/_mapCacheGet.js","webpack:///../../../node_modules/lodash-es/_mapCacheHas.js","webpack:///../../../node_modules/lodash-es/_mapCacheSet.js","webpack:///../../../node_modules/lodash-es/_MapCache.js","webpack:///../../../node_modules/lodash-es/_stackSet.js","webpack:///../../../node_modules/lodash-es/_Stack.js","webpack:///../../../node_modules/lodash-es/_defineProperty.js","webpack:///../../../node_modules/lodash-es/_baseAssignValue.js","webpack:///../../../node_modules/lodash-es/_assignMergeValue.js","webpack:///../../../node_modules/lodash-es/_baseFor.js","webpack:///../../../node_modules/lodash-es/_createBaseFor.js","webpack:///../../../node_modules/lodash-es/_cloneBuffer.js","webpack:///../../../node_modules/lodash-es/_Uint8Array.js","webpack:///../../../node_modules/lodash-es/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash-es/_cloneTypedArray.js","webpack:///../../../node_modules/lodash-es/_copyArray.js","webpack:///../../../node_modules/lodash-es/_baseCreate.js","webpack:///../../../node_modules/lodash-es/_overArg.js","webpack:///../../../node_modules/lodash-es/_getPrototype.js","webpack:///../../../node_modules/lodash-es/_isPrototype.js","webpack:///../../../node_modules/lodash-es/_initCloneObject.js","webpack:///../../../node_modules/lodash-es/isObjectLike.js","webpack:///../../../node_modules/lodash-es/_baseIsArguments.js","webpack:///../../../node_modules/lodash-es/isArguments.js","webpack:///../../../node_modules/lodash-es/isArray.js","webpack:///../../../node_modules/lodash-es/isLength.js","webpack:///../../../node_modules/lodash-es/isArrayLike.js","webpack:///../../../node_modules/lodash-es/isArrayLikeObject.js","webpack:///../../../node_modules/lodash-es/stubFalse.js","webpack:///../../../node_modules/lodash-es/isBuffer.js","webpack:///../../../node_modules/lodash-es/isPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash-es/_baseUnary.js","webpack:///../../../node_modules/lodash-es/_nodeUtil.js","webpack:///../../../node_modules/lodash-es/isTypedArray.js","webpack:///../../../node_modules/lodash-es/_safeGet.js","webpack:///../../../node_modules/lodash-es/_assignValue.js","webpack:///../../../node_modules/lodash-es/_copyObject.js","webpack:///../../../node_modules/lodash-es/_baseTimes.js","webpack:///../../../node_modules/lodash-es/_isIndex.js","webpack:///../../../node_modules/lodash-es/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash-es/_nativeKeysIn.js","webpack:///../../../node_modules/lodash-es/_baseKeysIn.js","webpack:///../../../node_modules/lodash-es/keysIn.js","webpack:///../../../node_modules/lodash-es/toPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseMergeDeep.js","webpack:///../../../node_modules/lodash-es/_baseMerge.js","webpack:///../../../node_modules/lodash-es/identity.js","webpack:///../../../node_modules/lodash-es/_apply.js","webpack:///../../../node_modules/lodash-es/_overRest.js","webpack:///../../../node_modules/lodash-es/constant.js","webpack:///../../../node_modules/lodash-es/_baseSetToString.js","webpack:///../../../node_modules/lodash-es/_shortOut.js","webpack:///../../../node_modules/lodash-es/_setToString.js","webpack:///../../../node_modules/lodash-es/_baseRest.js","webpack:///../../../node_modules/lodash-es/_isIterateeCall.js","webpack:///../../../node_modules/lodash-es/merge.js","webpack:///../../../node_modules/lodash-es/_createAssigner.js","webpack:///../../../node_modules/react-color/es/components/common/Raised.js","webpack:///../../../node_modules/lodash-es/now.js","webpack:///../../../node_modules/lodash-es/_trimmedEndIndex.js","webpack:///../../../node_modules/lodash-es/_baseTrim.js","webpack:///../../../node_modules/lodash-es/isSymbol.js","webpack:///../../../node_modules/lodash-es/toNumber.js","webpack:///../../../node_modules/lodash-es/debounce.js","webpack:///../../../node_modules/lodash-es/throttle.js","webpack:///../../../node_modules/react-color/es/helpers/saturation.js","webpack:///../../../node_modules/react-color/es/components/common/Saturation.js","webpack:///../../../node_modules/lodash-es/_arrayEach.js","webpack:///../../../node_modules/lodash-es/_nativeKeys.js","webpack:///../../../node_modules/lodash-es/_baseKeys.js","webpack:///../../../node_modules/lodash-es/keys.js","webpack:///../../../node_modules/lodash-es/_baseEach.js","webpack:///../../../node_modules/lodash-es/_createBaseEach.js","webpack:///../../../node_modules/lodash-es/_baseForOwn.js","webpack:///../../../node_modules/lodash-es/_castFunction.js","webpack:///../../../node_modules/lodash-es/forEach.js","webpack:///../../../node_modules/tinycolor2/esm/tinycolor.js","webpack:///../../../node_modules/react-color/es/helpers/color.js","webpack:///../../../node_modules/react-color/es/components/common/ColorWrap.js","webpack:///../../../node_modules/react-color/es/helpers/interaction.js","webpack:///../../../node_modules/react-color/es/components/common/Swatch.js","webpack:///../../../node_modules/react-color/es/components/alpha/AlphaPointer.js","webpack:///../../../node_modules/react-color/es/components/alpha/Alpha.js","webpack:///../../../node_modules/lodash-es/_arrayMap.js","webpack:///../../../node_modules/lodash-es/_setCacheAdd.js","webpack:///../../../node_modules/lodash-es/_setCacheHas.js","webpack:///../../../node_modules/lodash-es/_SetCache.js","webpack:///../../../node_modules/lodash-es/_arraySome.js","webpack:///../../../node_modules/lodash-es/_cacheHas.js","webpack:///../../../node_modules/lodash-es/_equalArrays.js","webpack:///../../../node_modules/lodash-es/_mapToArray.js","webpack:///../../../node_modules/lodash-es/_setToArray.js","webpack:///../../../node_modules/lodash-es/_equalByTag.js","webpack:///../../../node_modules/lodash-es/_arrayPush.js","webpack:///../../../node_modules/lodash-es/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash-es/_arrayFilter.js","webpack:///../../../node_modules/lodash-es/stubArray.js","webpack:///../../../node_modules/lodash-es/_getSymbols.js","webpack:///../../../node_modules/lodash-es/_getAllKeys.js","webpack:///../../../node_modules/lodash-es/_equalObjects.js","webpack:///../../../node_modules/lodash-es/_DataView.js","webpack:///../../../node_modules/lodash-es/_Promise.js","webpack:///../../../node_modules/lodash-es/_Set.js","webpack:///../../../node_modules/lodash-es/_WeakMap.js","webpack:///../../../node_modules/lodash-es/_getTag.js","webpack:///../../../node_modules/lodash-es/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash-es/_baseIsEqual.js","webpack:///../../../node_modules/lodash-es/_baseIsMatch.js","webpack:///../../../node_modules/lodash-es/_isStrictComparable.js","webpack:///../../../node_modules/lodash-es/_getMatchData.js","webpack:///../../../node_modules/lodash-es/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash-es/_baseMatches.js","webpack:///../../../node_modules/lodash-es/_isKey.js","webpack:///../../../node_modules/lodash-es/memoize.js","webpack:///../../../node_modules/lodash-es/_stringToPath.js","webpack:///../../../node_modules/lodash-es/_memoizeCapped.js","webpack:///../../../node_modules/lodash-es/_baseToString.js","webpack:///../../../node_modules/lodash-es/toString.js","webpack:///../../../node_modules/lodash-es/_castPath.js","webpack:///../../../node_modules/lodash-es/_toKey.js","webpack:///../../../node_modules/lodash-es/_baseGet.js","webpack:///../../../node_modules/lodash-es/get.js","webpack:///../../../node_modules/lodash-es/_baseHasIn.js","webpack:///../../../node_modules/lodash-es/_hasPath.js","webpack:///../../../node_modules/lodash-es/hasIn.js","webpack:///../../../node_modules/lodash-es/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash-es/_baseProperty.js","webpack:///../../../node_modules/lodash-es/_basePropertyDeep.js","webpack:///../../../node_modules/lodash-es/property.js","webpack:///../../../node_modules/lodash-es/_baseIteratee.js","webpack:///../../../node_modules/lodash-es/_baseMap.js","webpack:///../../../node_modules/lodash-es/map.js","webpack:///../../../node_modules/react-color/es/components/block/BlockSwatches.js","webpack:///../../../node_modules/react-color/es/components/block/Block.js","webpack:///../../../node_modules/material-colors/dist/colors.es2015.js","webpack:///../../../node_modules/react-color/es/components/circle/CircleSwatch.js","webpack:///../../../node_modules/react-color/es/components/circle/Circle.js","webpack:///../../../node_modules/lodash-es/isUndefined.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromeFields.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointer.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/chrome/Chrome.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactColor.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactFields.js","webpack:///../../../node_modules/react-color/es/components/compact/Compact.js","webpack:///../../../node_modules/react-color/es/components/github/GithubSwatch.js","webpack:///../../../node_modules/react-color/es/components/github/Github.js","webpack:///../../../node_modules/react-color/es/components/hue/HuePointer.js","webpack:///../../../node_modules/react-color/es/components/hue/Hue.js","webpack:///../../../node_modules/react-color/es/components/material/Material.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopFields.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointerCircle.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointer.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopButton.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPreviews.js","webpack:///../../../node_modules/react-color/es/components/photoshop/Photoshop.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchFields.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchPresetColors.js","webpack:///../../../node_modules/react-color/es/components/sketch/Sketch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatches.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderPointer.js","webpack:///../../../node_modules/react-color/es/components/slider/Slider.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesColor.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesGroup.js","webpack:///../../../node_modules/react-color/es/components/swatches/Swatches.js","webpack:///../../../node_modules/react-color/es/components/twitter/Twitter.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointer.js","webpack:///../../../node_modules/react-color/es/components/google/GoogleFields.js","webpack:///../../../node_modules/react-color/es/components/google/Google.js","webpack:///../../../node_modules/react-window/dist/index.esm.js","webpack:///../../../node_modules/reactcss/lib/autoprefix.js","webpack:///../../../node_modules/reactcss/lib/components/active.js","webpack:///../../../node_modules/reactcss/lib/components/hover.js","webpack:///../../../node_modules/reactcss/lib/flattenNames.js","webpack:///../../../node_modules/reactcss/lib/index.js","webpack:///../../../node_modules/reactcss/lib/loop.js","webpack:///../../../node_modules/reactcss/lib/mergeClasses.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","webpack:///../../../node_modules/use-sync-external-store/shim/index.js","webpack:///../../../node_modules/use-sync-external-store/shim/with-selector.js","webpack:///../node_modules/zustand/esm/vanilla.mjs","webpack:///../node_modules/zustand/esm/index.mjs","webpack:///../node_modules/zustand/esm/middleware.mjs"],"sourcesContent":["/**\r\n * Javascript object that handles dates and compute the time.\r\n *\r\n * @export\r\n * @class FullDateInterface\r\n */\nclass FullDateInterface {\n  /**\r\n   * Creates an instance of FullDateInterface.\r\n   * @param {string} date formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n   * @memberof FullDateInterface\r\n   */\n  constructor(date) {\n    this.fullDate = date;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in sec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInSec() {\n    // yyyy-mm-ddTHH:MM:SS.FFFFFFZ\n    const dateString = this.fullDate.substring(0, 10);\n    const timeString = this.fullDate.substring(11, 28); // yyyy-mm-dd\n\n    const yyyy = parseInt(dateString.substring(0, 4), 10);\n    const mm = dateString.length >= 7 ? parseInt(dateString.substring(5, 7), 10) : undefined;\n    const dd = dateString.length >= 10 ? parseInt(dateString.substring(8, 10), 10) : undefined;\n\n    if (isNaN(yyyy) || mm !== undefined && isNaN(mm) || dd !== undefined && isNaN(dd) || yyyy > 3000 || mm && (mm < 1 || mm > 12) || dd && (dd < 1 || dd > 31)) {\n      throw new Error(`invalid date '${dateString}'`);\n    }\n\n    const dateJS = new Date(`${dateString}T00:00:00.000000Z`); // HHMMSS.FFFFFF\n\n    const HH = parseInt(timeString.substring(0, 2), 10);\n    const MM = timeString.length >= 5 ? parseInt(timeString.substring(3, 5), 10) : undefined;\n    const SS = timeString.length >= 8 ? parseInt(timeString.substring(6, 8), 10) : undefined;\n    const fractionalStr = timeString.substring(9, 15);\n    const FFFFFF = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, -fractionalStr.length) : undefined;\n\n    if (isNaN(HH) || MM !== undefined && isNaN(MM) || SS !== undefined && isNaN(SS) || FFFFFF !== undefined && isNaN(FFFFFF) || HH < 0 || HH > 23 || MM && (MM < 0 || MM > 59) || SS && (SS < 0 || SS > 59) || FFFFFF && (FFFFFF < 0 || FFFFFF > 999999)) {\n      throw new Error(`invalid time '${timeString}'`);\n    }\n\n    let timeInSec = dateJS.getTime() / 1000;\n    timeInSec += HH * 3600;\n\n    if (MM !== undefined) {\n      timeInSec += MM * 60;\n    }\n\n    if (SS !== undefined) {\n      timeInSec += SS;\n    }\n\n    if (FFFFFF !== undefined) {\n      timeInSec += FFFFFF;\n    }\n\n    return timeInSec;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in microsec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInMicroSec() {\n    const timeInMicroSec = this.getTimeInSec() * 1e6;\n    return timeInMicroSec;\n  }\n\n}\n/**\r\n * Combines two javascript objects containing the date and time information\r\n *\r\n * @export\r\n * @param {DateInterface} date\r\n * @param {TimeInterface} time\r\n * @returns {FullDateInterface}\r\n */\n\nfunction combineDateTime(date, time) {\n  const hours = `${time.hours || '00'}`.padStart(2, '0');\n  const minutes = `${time.minutes || '00'}`.padStart(2, '0');\n  const seconds = `${time.seconds || '00'}`.padStart(2, '0');\n  const month = `${date.month}`.padStart(2, '0');\n  const day = `${date.day}`.padStart(2, '0');\n  const fractionalSeconds = `${time.fractionalSeconds || '000000'}`.padEnd(6, '0');\n  const dateString = `${date.year}-${month}-${day}`;\n  const timeString = `T${hours}:${minutes}:${seconds}.${fractionalSeconds}Z`;\n  const fullDateString = `${dateString}${timeString}`;\n  return new FullDateInterface(fullDateString);\n}\n\n/**\r\n * Check the number of days for a picked month and year\r\n * algorithm based on http://stackoverflow.com/questions/1433030/validate-number-of-days-in-a-given-month\r\n *\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {number} number of days\r\n */\nfunction daysInMonth(m, y) {\n  // m is 0 indexed: 0-11\n  switch (m) {\n    case 2:\n      return y % 4 === 0 && y % 100 || y % 400 === 0 ? 29 : 28;\n\n    case 9:\n    case 4:\n    case 6:\n    case 11:\n      return 30;\n\n    default:\n      return 31;\n  }\n}\n/**\r\n * Check if the date is valid\r\n *\r\n * @param {number} d\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {boolean} boolean result\r\n */\n\n\nfunction isValidDate(d, m, y) {\n  // make year is a number\n  if (isNaN(y)) {\n    return false;\n  }\n\n  return m > 0 && m <= 12 && d > 0 && d <= daysInMonth(m, y);\n}\n/**\r\n * Parses a DA formatted string into a Javascript object\r\n * @param {string} date a string in the DA VR format\r\n * @param {boolean} [validate] - true if an exception should be thrown if the date is invalid\r\n * @returns {DateInterface} Javascript object with properties year, month and day or undefined if not present or not 8 bytes long\r\n */\n\n\nfunction parseDA(date) {\n  if (date === undefined || date === null || date.length !== 8 || typeof date !== 'string') {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  const yyyy = parseInt(date.substring(0, 4), 10);\n  const mm = parseInt(date.substring(4, 6), 10);\n  const dd = parseInt(date.substring(6, 8), 10);\n\n  if (isValidDate(dd, mm, yyyy) !== true) {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  return {\n    year: yyyy,\n    month: mm,\n    day: dd\n  };\n}\n\n/**\r\n * Parses a TM formatted string into a javascript object with properties for hours, minutes, seconds and fractionalSeconds\r\n * @param {string} time - a string in the TM VR format\r\n * @returns {string} javascript object with properties for hours, minutes, seconds and fractionalSeconds or undefined if no element or data.  Missing fields are set to undefined\r\n */\nfunction parseTM(time) {\n  if (time === null || time === undefined || time.length < 2 || typeof time !== 'string') {\n    // must at least have HH\n    throw new Error(`invalid TM '${time}'`);\n  } // 0123456789\n  // HHMMSS.FFFFFF\n\n\n  const hh = parseInt(time.substring(0, 2), 10);\n  const mm = time.length >= 4 ? parseInt(time.substring(2, 4), 10) : undefined;\n  const ss = time.length >= 6 ? parseInt(time.substring(4, 6), 10) : undefined;\n  const fractionalStr = time.length >= 8 ? time.substring(7, 13) : undefined;\n  const ffffff = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, 6 - fractionalStr.length) : undefined;\n\n  if (isNaN(hh) || mm !== undefined && isNaN(mm) || ss !== undefined && isNaN(ss) || ffffff !== undefined && isNaN(ffffff) || hh < 0 || hh > 23 || mm && (mm < 0 || mm > 59) || ss && (ss < 0 || ss > 59) || ffffff && (ffffff < 0 || ffffff > 999999)) {\n    throw new Error(`invalid TM '${time}'`);\n  }\n\n  return {\n    hours: hh,\n    minutes: mm,\n    seconds: ss,\n    fractionalSeconds: ffffff\n  };\n}\n\n/**\r\n * Utility to create a FullDateInterface object given a string formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n *\r\n * @export\r\n * @param {string} dateTime\r\n * @returns {FullDateInterface}\r\n */\n\nfunction dateTimeToFullDateInterface(dateTime) {\n  if (dateTime === undefined || dateTime === null) {\n    throw new Error('dateTimeToFullDateInterface : dateTime not defined.');\n  }\n\n  const date = parseDA(dateTime.substring(0, 8));\n  const time = parseTM(dateTime.substring(8));\n  return combineDateTime(date, time);\n}\n\n/**\r\n * Calculate the scan times\r\n *\r\n * @export\r\n * @param {InstanceMetadataForScanTimes[]} instances\r\n * @returns {FullDateInterface[]}\r\n */\n\nfunction calculateScanTimes(instances) {\n  const {\n    SeriesDate,\n    SeriesTime,\n    GEPrivatePostInjectionDateTime\n  } = instances[0];\n  const results = new Array(instances.length);\n  const seriesDate = parseDA(SeriesDate);\n  const seriesTime = parseTM(SeriesTime);\n  const seriesDateTime = combineDateTime(seriesDate, seriesTime);\n  let earliestAcquisitionDateTime = new FullDateInterface(`3000-01-01T00:00:00.000000Z`);\n  let timeError = earliestAcquisitionDateTime.getTimeInSec();\n  instances.forEach(instance => {\n    const {\n      AcquisitionDate,\n      AcquisitionTime\n    } = instance;\n    const acquisitionDate = parseDA(AcquisitionDate);\n    const acquisitionTime = parseTM(AcquisitionTime);\n    const acquisitionDateTime = combineDateTime(acquisitionDate, acquisitionTime);\n\n    if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n      earliestAcquisitionDateTime = acquisitionDateTime;\n    } else {\n      earliestAcquisitionDateTime = acquisitionDateTime.getTimeInSec() < earliestAcquisitionDateTime.getTimeInSec() ? acquisitionDateTime : earliestAcquisitionDateTime;\n    }\n  });\n\n  if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n    throw new Error('Earliest acquisition time or date could not be parsed.');\n  }\n\n  if (seriesDateTime.getTimeInSec() <= earliestAcquisitionDateTime.getTimeInSec()) {\n    return results.fill(seriesDateTime);\n  } else {\n    if (GEPrivatePostInjectionDateTime) {\n      // GE Private scan\n      return results.fill(dateTimeToFullDateInterface(GEPrivatePostInjectionDateTime));\n    } else {\n      /*const hasValidFrameTimes = instances.every(instance => {\r\n        return (\r\n          instance.FrameReferenceTime &&\r\n          instance.FrameReferenceTime > 0 &&\r\n          instance.ActualFrameDuration &&\r\n          instance.ActualFrameDuration > 0\r\n        );\r\n      });*/\n      // TODO: Temporarily commented out the checks and logic below to\n      // investigate the BQML_AC_DT_lessThan_S_DT_SIEMENS-instances case\n      //if (!hasValidFrameTimes) {\n      return results.fill(earliestAcquisitionDateTime); //}\n\n      /* Siemens PETsyngo\t3.x\tmulti-injection logic\r\n      - backcompute\tfrom\tcenter\t(average\tcount\trate\t)\tof\ttime\twindow\tfor\tbed\tposition\t(frame)\tin\tseries (reliable\tin\tall\tcases)\r\n      - Acquisition\tDate\t(0x0008,0x0022)\tand\tTime\t(0x0008,0x0032) are\tthe\tstart\tof\tthe\tbed\tposition\t(frame)\r\n      - Frame\tReference\tTime\t(0x0054,0x1300) is\tthe\toffset\t(ms)\tfrom\tthe\tscan\tDate\tand\tTime we\twant\tto\tthe\taverage\tcount\trate\ttime\r\n      */\n\n      /*return instances.map(instance => {\r\n        const {\r\n          FrameReferenceTime,\r\n          ActualFrameDuration,\r\n          RadionuclideHalfLife,\r\n          AcquisitionDate,\r\n          AcquisitionTime,\r\n        } = instance;\r\n        // Some of these checks are only here because the compiler is complaining\r\n        // We could potentially use the ! operator instead\r\n        if (!FrameReferenceTime || FrameReferenceTime <= 0) {\r\n          throw new Error(\r\n            `FrameReferenceTime is invalid: ${FrameReferenceTime}`\r\n          );\r\n        }\r\n               if (!ActualFrameDuration || ActualFrameDuration <= 0) {\r\n          throw new Error(\r\n            `ActualFrameDuration is invalid: ${ActualFrameDuration}`\r\n          );\r\n        }\r\n               if (!RadionuclideHalfLife) {\r\n          throw new Error('RadionuclideHalfLife is required');\r\n        }\r\n               if (!AcquisitionDate) {\r\n          throw new Error('AcquisitionDate is required');\r\n        }\r\n               if (!AcquisitionTime) {\r\n          throw new Error('AcquisitionTime is required');\r\n        }\r\n               const acquisitionDate: DateInterface = parseDA(AcquisitionDate);\r\n        const acquisitionTime: TimeInterface = parseTM(AcquisitionTime);\r\n        const acquisitionDateTime: FullDateInterface = combineDateTime(\r\n          acquisitionDate,\r\n          acquisitionTime\r\n        );\r\n               const frameDurationInSec = ActualFrameDuration / 1000;\r\n        const decayConstant = Math.log(2) / RadionuclideHalfLife;\r\n        const decayDuringFrame = decayConstant * frameDurationInSec;\r\n        // TODO: double check this is correctly copied from QIBA pseudocode\r\n        const averageCountRateTimeWithinFrameInSec =\r\n          (1 / decayConstant) *\r\n          Math.log(decayDuringFrame / (1 - Math.exp(-decayConstant)));\r\n        const scanDateTimeAsNumber =\r\n          Number(acquisitionDateTime) -\r\n          FrameReferenceTime / 1000 +\r\n          averageCountRateTimeWithinFrameInSec;\r\n               const scanDate = new Date(scanDateTimeAsNumber);\r\n        console.log('SIEMENS PATH');\r\n        console.log(new Date(scanDateTimeAsNumber));\r\n        return scanDate;\r\n      });*/\n    }\n  }\n}\n\nfunction calculateSUVlbmScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const weightSizeFactor = Math.pow(PatientWeight / (PatientSize * 100), 2); // reference: https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n  if (PatientSex === 'F') {\n    LBM = 1.07 * PatientWeight - 148 * weightSizeFactor;\n  } else if (PatientSex === 'M') {\n    LBM = 1.1 * PatientWeight - 120 * weightSizeFactor;\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n/**\r\n * From https://link.springer.com/article/10.1007/s00259-014-2961-x\r\n * and https://link.springer.com/article/10.2165/00003088-200544100-00004\r\n * and\r\n * @param inputs\r\n * @returns\r\n */\n\n\nfunction calculateSUVlbmJanmahasatianScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const bodyMassIndex = PatientWeight / Math.pow(PatientSize, 2);\n\n  if (PatientSex === 'F') {\n    LBM = 9270 * PatientWeight / (8780 + 244 * bodyMassIndex);\n  } else if (PatientSex === 'M') {\n    LBM = 9270 * PatientWeight / (6680 + 216 * bodyMassIndex);\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n\nfunction calculateSUVbsaScalingFactor(inputs) {\n  const {\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let BSA = Math.pow(PatientWeight, 0.425) * Math.pow(PatientSize * 100, 0.725) * 71.84;\n  return BSA;\n}\n\n/**\r\n * Calculate start time\r\n *\r\n * @export\r\n * @param {{\r\n *   RadiopharmaceuticalStartDateTime?: string;\r\n *   RadiopharmaceuticalStartTime?: string;\r\n *   SeriesDate?: string;\r\n * }} input\r\n * @returns {FullDateInterface}\r\n */\n\nfunction calculateStartTime(input) {\n  const {\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = input;\n  let time;\n  let date;\n\n  if (RadiopharmaceuticalStartDateTime) {\n    return dateTimeToFullDateInterface(RadiopharmaceuticalStartDateTime);\n  } else if (RadiopharmaceuticalStartTime && SeriesDate) {\n    // start Date\tis not explicit - assume\tsame as\tSeries Date;\n    // but consider\tspanning midnight\n    // TODO: do we need some logic to check if the scan went over midnight?\n    time = parseTM(RadiopharmaceuticalStartTime);\n    date = parseDA(SeriesDate);\n    return combineDateTime(date, time);\n  }\n\n  throw new Error(`Invalid input: ${input}`);\n}\n\n/**\r\n * The injected dose used to calculate SUV is corrected for the\r\n * decay that occurs between the time of injection and the start of the scan\r\n *\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {number[]}\r\n */\n\nfunction calculateDecayCorrection(instances) {\n  const {\n    RadionuclideTotalDose,\n    RadionuclideHalfLife,\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = instances[0];\n\n  if (RadionuclideTotalDose === undefined || RadionuclideTotalDose === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideTotalDose value not found.');\n  }\n\n  if (RadionuclideHalfLife === undefined || RadionuclideHalfLife === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideHalfLife value not found.');\n  }\n\n  const scanTimes = calculateScanTimes(instances);\n  const startTime = calculateStartTime({\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  });\n  return instances.map((_, index) => {\n    const scanTime = scanTimes[index];\n    const decayTimeInSec = scanTime.getTimeInSec() - startTime.getTimeInSec();\n\n    if (decayTimeInSec < 0) {\n      throw new Error('Decay time cannot be less than zero');\n    }\n\n    const decayedDose = RadionuclideTotalDose * Math.pow(2, -decayTimeInSec / RadionuclideHalfLife);\n    return 1 / decayedDose;\n  });\n}\n/**\r\n *\r\n * @param a Simple value or array of simple values\r\n * @param b Simple value or array of simple values\r\n * @returns boolean true if the values are equal.\r\n */\n\n\nconst deepEquals = (a, b) => {\n  return a === b || Array.isArray(a) && Array.isArray(b) && a.length === b.length && a.every((val, index) => val === b[index]);\n};\n/**\r\n * Calculate the SUV factor\r\n *\r\n * Note: Rescale Slope / Intercept must still be applied. These must be applied\r\n *       on a per-Frame basis, since some scanners may have different values per Frame.\r\n *\r\n * @export\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {ScalingFactorResult[]}\r\n */\n\n\nfunction calculateSUVScalingFactors(instances) {\n  const {\n    CorrectedImage,\n    Units,\n    PhilipsPETPrivateGroup,\n    PatientWeight,\n    PatientSex,\n    PatientSize\n  } = instances[0];\n\n  if (!CorrectedImage.includes('ATTN') || !CorrectedImage.includes('DECY')) {\n    throw new Error(`CorrectedImage must contain \"ATTN\" and \"DECY\": ${CorrectedImage}`);\n  } // Sanity check that every instance provided has identical\n  // values for series-level metadata. If not, the provided\n  // data is invalid.\n\n\n  const isSingleSeries = instances.every(instance => {\n    return instance.Units === Units && deepEquals(instance.CorrectedImage, CorrectedImage) && instance.PatientWeight === PatientWeight && instance.PatientSex === PatientSex && instance.PatientSize === PatientSize && instance.RadionuclideHalfLife === instances[0].RadionuclideHalfLife && instance.RadionuclideTotalDose === instances[0].RadionuclideTotalDose && instance.DecayCorrection === instances[0].DecayCorrection && instance.SeriesDate === instances[0].SeriesDate && instance.SeriesTime === instances[0].SeriesTime;\n  });\n\n  if (!isSingleSeries) {\n    throw new Error('The set of instances does not appear to come from one Series. Every instance must have identical values for series-level metadata properties');\n  } // Treat null, undefined and zero as a missing PatientWeight.\n\n\n  if (!PatientWeight) {\n    throw new Error('PatientWeight value is missing. It is not possible to calculate the SUV factors');\n  }\n\n  let decayCorrectionArray = new Array(instances.length);\n  decayCorrectionArray = calculateDecayCorrection(instances);\n  let results = new Array(instances.length);\n  const weightInGrams = PatientWeight * 1000;\n\n  if (Units === 'BQML') {\n    results = decayCorrectionArray.map(function (value) {\n      return value * weightInGrams;\n    });\n  } else if (Units === 'CNTS') {\n    const hasValidSUVScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP, _instance$PhilipsPETP2, _instance$PhilipsPETP3;\n\n      return instance.PhilipsPETPrivateGroup && ((_instance$PhilipsPETP = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP === void 0 ? void 0 : _instance$PhilipsPETP.SUVScaleFactor) !== null && ((_instance$PhilipsPETP2 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP2 === void 0 ? void 0 : _instance$PhilipsPETP2.SUVScaleFactor) !== undefined && ((_instance$PhilipsPETP3 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP3 === void 0 ? void 0 : _instance$PhilipsPETP3.SUVScaleFactor) !== 0;\n    });\n    const hasValidActivityConcentrationScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP4, _instance$PhilipsPETP5, _instance$PhilipsPETP6;\n\n      return instance.PhilipsPETPrivateGroup && !((_instance$PhilipsPETP4 = instance.PhilipsPETPrivateGroup) !== null && _instance$PhilipsPETP4 !== void 0 && _instance$PhilipsPETP4.SUVScaleFactor) && ((_instance$PhilipsPETP5 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP5 === void 0 ? void 0 : _instance$PhilipsPETP5.ActivityConcentrationScaleFactor) !== undefined && ((_instance$PhilipsPETP6 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP6 === void 0 ? void 0 : _instance$PhilipsPETP6.ActivityConcentrationScaleFactor) !== 0;\n    }); //console.log(`hasValidSUVScaleFactor: ${hasValidSUVScaleFactor}`);\n    //console.log(`hasValidActivityConcentrationScaleFactor: ${hasValidActivityConcentrationScaleFactor}`);\n\n    if (hasValidSUVScaleFactor) {\n      results = instances.map( // Added ! to tell Typescript that this can't be undefined, since we are testing it\n      // in the .every loop above.\n      instance => instance.PhilipsPETPrivateGroup.SUVScaleFactor);\n    } else if (hasValidActivityConcentrationScaleFactor) {\n      // if (0x7053,0x1000) not present, but (0x7053,0x1009) is present, then (0x7053,0x1009) * Rescale Slope,\n      // scales pixels to Bq/ml, and proceed as if Units are BQML\n      results = instances.map((instance, index) => {\n        // Added ! to tell Typescript that this can't be undefined, since we are testing it\n        // in the .every loop above.\n        return instance.PhilipsPETPrivateGroup.ActivityConcentrationScaleFactor * decayCorrectionArray[index] * weightInGrams;\n      });\n    } else {\n      throw new Error(`Units are in CNTS, but PhilipsPETPrivateGroup has invalid values: ${JSON.stringify(PhilipsPETPrivateGroup)}`);\n    }\n  } else if (Units === 'GML') {\n    // assumes that GML indicates SUVbw instead of SUVlbm\n    results.fill(1);\n  } else {\n    throw new Error(`Units has an invalid value: ${Units}`);\n  } // get BSA\n\n\n  let suvbsaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV bsa factors');\n  } else {\n    const sulInputs = {\n      PatientWeight,\n      PatientSize\n    };\n    suvbsaFactor = calculateSUVbsaScalingFactor(sulInputs);\n  } // get LBM\n\n\n  let suvlbmFactor;\n  let suvlbmJenmaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV lbm factors');\n  } else if (PatientSex === null || PatientSex === undefined) {\n    console.warn('PatientSex value is missing. It is not possible to calculate the SUV lbm factors');\n  } else {\n    const suvlbmInputs = {\n      PatientWeight,\n      PatientSex,\n      PatientSize\n    };\n    suvlbmFactor = calculateSUVlbmScalingFactor(suvlbmInputs);\n    suvlbmJenmaFactor = calculateSUVlbmJanmahasatianScalingFactor(suvlbmInputs);\n  }\n\n  return results.map(function (result, index) {\n    const factors = {\n      suvbw: result\n    };\n\n    if (suvbsaFactor) {\n      // multiply for BSA\n      factors.suvbsa = decayCorrectionArray[index] * suvbsaFactor;\n    }\n\n    if (suvlbmFactor) {\n      // multiply for LBM\n      factors.suvlbm = decayCorrectionArray[index] * suvlbmFactor;\n    }\n\n    if (suvlbmJenmaFactor) {\n      factors.suvlbmJanma = decayCorrectionArray[index] * suvlbmJenmaFactor;\n    } // factor formulaes taken from:\n    // https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n\n    return factors;\n  });\n}\n\nexport { calculateSUVScalingFactors };\n//# sourceMappingURL=calculate-suv.esm.js.map\n","const CORNERSTONE_COLOR_LUT = [\n    [0, 0, 0, 0],\n    [221, 84, 84, 255],\n    [77, 228, 121, 255],\n    [166, 70, 235, 255],\n    [189, 180, 116, 255],\n    [109, 182, 196, 255],\n    [204, 101, 157, 255],\n    [123, 211, 94, 255],\n    [93, 87, 218, 255],\n    [225, 128, 80, 255],\n    [73, 232, 172, 255],\n    [181, 119, 186, 255],\n    [176, 193, 112, 255],\n    [105, 153, 200, 255],\n    [208, 97, 120, 255],\n    [90, 215, 101, 255],\n    [135, 83, 222, 255],\n    [229, 178, 76, 255],\n    [122, 183, 181, 255],\n    [190, 115, 171, 255],\n    [149, 197, 108, 255],\n    [100, 118, 205, 255],\n    [212, 108, 93, 255],\n    [86, 219, 141, 255],\n    [183, 79, 226, 255],\n    [233, 233, 72, 255],\n    [118, 167, 187, 255],\n    [194, 111, 146, 255],\n    [116, 201, 104, 255],\n    [115, 96, 209, 255],\n    [216, 147, 89, 255],\n    [82, 223, 188, 255],\n    [230, 75, 224, 255],\n    [163, 184, 121, 255],\n    [114, 143, 191, 255],\n    [198, 107, 114, 255],\n    [99, 206, 122, 255],\n    [153, 92, 213, 255],\n    [220, 192, 85, 255],\n    [78, 215, 227, 255],\n    [234, 71, 173, 255],\n    [141, 188, 117, 255],\n    [110, 113, 195, 255],\n    [202, 128, 103, 255],\n    [95, 210, 157, 255],\n    [195, 88, 217, 255],\n    [206, 224, 81, 255],\n    [74, 166, 231, 255],\n    [185, 120, 139, 255],\n    [113, 192, 113, 255],\n    [133, 106, 199, 255],\n    [207, 162, 98, 255],\n    [91, 214, 198, 255],\n    [221, 84, 198, 255],\n    [159, 228, 77, 255],\n    [70, 111, 235, 255],\n    [189, 119, 116, 255],\n    [109, 196, 138, 255],\n    [165, 101, 204, 255],\n    [211, 201, 94, 255],\n    [87, 191, 218, 255],\n    [225, 80, 153, 255],\n    [106, 232, 73, 255],\n    [124, 119, 186, 255],\n    [193, 142, 112, 255],\n    [105, 200, 168, 255],\n    [203, 97, 208, 255],\n    [184, 215, 90, 255],\n    [83, 147, 222, 255],\n    [229, 76, 101, 255],\n    [122, 183, 130, 255],\n    [146, 115, 190, 255],\n    [197, 171, 108, 255],\n    [100, 205, 205, 255],\n    [212, 93, 177, 255],\n    [141, 219, 86, 255],\n    [79, 97, 226, 255],\n    [233, 99, 72, 255],\n    [118, 187, 150, 255],\n    [173, 111, 194, 255],\n    [197, 201, 104, 255],\n    [96, 171, 209, 255],\n    [216, 89, 137, 255],\n    [94, 223, 82, 255],\n    [107, 75, 230, 255],\n    [184, 153, 121, 255],\n    [114, 191, 175, 255],\n    [198, 107, 191, 255],\n    [166, 206, 99, 255],\n    [92, 132, 213, 255],\n    [220, 85, 91, 255],\n    [78, 227, 115, 255],\n    [159, 71, 234, 255],\n    [188, 176, 117, 255],\n    [110, 185, 195, 255],\n    [202, 103, 161, 255],\n    [129, 210, 95, 255],\n    [88, 88, 217, 255],\n    [224, 123, 81, 255],\n    [74, 231, 166, 255],\n    [177, 120, 185, 255],\n    [179, 192, 113, 255],\n    [106, 156, 199, 255],\n    [207, 98, 125, 255],\n    [91, 214, 96, 255],\n    [130, 84, 221, 255],\n    [228, 171, 77, 255],\n    [70, 235, 221, 255],\n    [189, 116, 174, 255],\n    [153, 196, 109, 255],\n    [101, 123, 204, 255],\n    [211, 104, 94, 255],\n    [87, 218, 136, 255],\n    [177, 80, 225, 255],\n    [232, 225, 73, 255],\n    [119, 169, 186, 255],\n    [193, 112, 149, 255],\n    [121, 200, 105, 255],\n    [111, 97, 208, 255],\n    [215, 142, 90, 255],\n    [83, 222, 181, 255],\n    [229, 76, 229, 255],\n    [165, 183, 122, 255],\n    [115, 146, 190, 255],\n    [197, 108, 119, 255],\n    [100, 205, 118, 255],\n    [148, 93, 212, 255],\n    [219, 186, 86, 255],\n    [79, 220, 226, 255],\n    [233, 72, 179, 255],\n    [144, 187, 118, 255],\n    [111, 118, 194, 255],\n    [201, 124, 104, 255],\n    [96, 209, 153, 255],\n    [189, 89, 216, 255],\n    [211, 223, 82, 255],\n    [75, 172, 230, 255],\n    [184, 121, 142, 255],\n    [117, 191, 114, 255],\n    [130, 107, 198, 255],\n    [206, 157, 99, 255],\n    [92, 213, 193, 255],\n    [220, 85, 203, 255],\n    [165, 227, 78, 255],\n    [71, 118, 234, 255],\n    [188, 117, 117, 255],\n    [110, 195, 135, 255],\n    [161, 103, 202, 255],\n    [210, 195, 95, 255],\n    [88, 195, 217, 255],\n    [224, 81, 158, 255],\n    [113, 231, 74, 255],\n    [123, 120, 185, 255],\n    [192, 139, 113, 255],\n    [106, 199, 164, 255],\n    [198, 98, 207, 255],\n    [188, 214, 91, 255],\n    [84, 153, 221, 255],\n    [228, 77, 108, 255],\n    [70, 235, 84, 255],\n    [143, 116, 189, 255],\n    [196, 167, 109, 255],\n    [101, 204, 199, 255],\n    [211, 94, 182, 255],\n    [147, 218, 87, 255],\n    [80, 104, 225, 255],\n    [232, 93, 73, 255],\n    [119, 186, 147, 255],\n    [170, 112, 193, 255],\n    [200, 200, 105, 255],\n    [97, 175, 208, 255],\n    [215, 90, 142, 255],\n    [100, 222, 83, 255],\n    [101, 76, 229, 255],\n    [183, 150, 122, 255],\n    [115, 190, 171, 255],\n    [197, 108, 194, 255],\n    [170, 205, 100, 255],\n    [93, 138, 212, 255],\n    [219, 86, 97, 255],\n    [79, 226, 110, 255],\n    [153, 72, 233, 255],\n    [187, 173, 118, 255],\n    [111, 187, 194, 255],\n    [201, 104, 165, 255],\n    [134, 209, 96, 255],\n    [89, 95, 216, 255],\n    [223, 117, 82, 255],\n    [75, 230, 159, 255],\n    [174, 121, 184, 255],\n    [182, 191, 114, 255],\n    [107, 160, 198, 255],\n    [206, 99, 130, 255],\n    [92, 213, 92, 255],\n    [124, 85, 220, 255],\n    [227, 165, 78, 255],\n    [71, 234, 214, 255],\n    [188, 117, 176, 255],\n    [156, 195, 110, 255],\n    [103, 128, 202, 255],\n    [210, 100, 95, 255],\n    [88, 217, 131, 255],\n    [170, 81, 224, 255],\n    [231, 218, 74, 255],\n    [120, 172, 185, 255],\n    [192, 113, 153, 255],\n    [125, 199, 106, 255],\n    [107, 98, 207, 255],\n    [214, 137, 91, 255],\n    [84, 221, 175, 255],\n    [222, 77, 228, 255],\n    [194, 235, 70, 255],\n    [116, 149, 189, 255],\n    [196, 109, 123, 255],\n    [101, 204, 114, 255],\n    [143, 94, 211, 255],\n    [218, 180, 87, 255],\n    [80, 225, 225, 255],\n    [232, 73, 186, 255],\n    [147, 186, 119, 255],\n    [112, 122, 193, 255],\n    [200, 121, 105, 255],\n    [97, 208, 148, 255],\n    [184, 90, 215, 255],\n    [216, 222, 83, 255],\n    [76, 178, 229, 255],\n    [183, 122, 145, 255],\n    [121, 190, 115, 255],\n    [126, 108, 197, 255],\n    [205, 153, 100, 255],\n    [93, 212, 187, 255],\n    [219, 86, 208, 255],\n    [171, 226, 79, 255],\n    [72, 126, 233, 255],\n    [187, 118, 121, 255],\n    [111, 194, 132, 255],\n    [157, 104, 201, 255],\n    [209, 190, 96, 255],\n    [89, 200, 216, 255],\n    [223, 82, 164, 255],\n    [120, 230, 75, 255],\n    [121, 121, 184, 255],\n    [191, 136, 114, 255],\n    [107, 198, 160, 255],\n    [192, 99, 206, 255],\n    [193, 213, 92, 255],\n    [85, 158, 220, 255],\n    [227, 78, 115, 255],\n    [71, 234, 78, 255],\n    [141, 117, 188, 255],\n    [195, 163, 110, 255],\n    [103, 202, 194, 255],\n    [210, 95, 186, 255],\n    [153, 217, 88, 255],\n    [81, 111, 224, 255],\n];\nexport default CORNERSTONE_COLOR_LUT;\n","const DEFINED_CURSORS = Symbol('DefinedCursors');\nconst STANDARD_CURSORS = new Set([\n    'alias',\n    'all-scroll',\n    'auto',\n    'cell',\n    'col-resize',\n    'context-menu',\n    'copy',\n    'crosshair',\n    'default',\n    'e-resize',\n    'ew-resize',\n    'grab',\n    'grabbing',\n    'help',\n    'move',\n    'ne-resize',\n    'nesw-resize',\n    'no-drop',\n    'none',\n    'not-allowed',\n    'n-resize',\n    'ns-resize',\n    'nw-resize',\n    'nwse-resize',\n    'pointer',\n    'progress',\n    'row-resize',\n    'se-resize',\n    's-resize',\n    'sw-resize',\n    'text',\n    'vertical-text',\n    'wait',\n    'w-resize',\n    'zoom-in',\n    'zoom-out',\n]);\nexport default class MouseCursor {\n    constructor(name, fallback) {\n        this.name = name + '';\n        this.fallback = fallback;\n    }\n    getName() {\n        return this.name + '';\n    }\n    addFallbackStyleProperty(style) {\n        const { fallback } = this;\n        if (fallback instanceof MouseCursor) {\n            return `${style}, ${fallback.getStyleProperty()}`;\n        }\n        return style + '';\n    }\n    getStyleProperty() {\n        return this.addFallbackStyleProperty(this.name) + '';\n    }\n    static getDefinedCursor(name) {\n        const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n        let mouseCursor = definedCursors.get(name);\n        if (mouseCursor instanceof MouseCursor) {\n            return mouseCursor;\n        }\n        if (STANDARD_CURSORS.has(name)) {\n            mouseCursor = new MouseCursor(name);\n            definedCursors.set(name, mouseCursor);\n            return mouseCursor;\n        }\n    }\n    static setDefinedCursor(name, cursor) {\n        if (cursor instanceof MouseCursor) {\n            const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n            definedCursors.set(name, cursor);\n            return true;\n        }\n        return false;\n    }\n}\nfunction getDefinedCursors(context, symbol) {\n    let definedCursors = context[symbol];\n    if (!(definedCursors instanceof Map)) {\n        definedCursors = new Map();\n        Object.defineProperty(context, symbol, { value: definedCursors });\n    }\n    return definedCursors;\n}\nconst standardCursorNames = STANDARD_CURSORS.values();\nexport { standardCursorNames };\n","import MouseCursor from './MouseCursor';\nconst ELEMENT_CURSORS_MAP = Symbol('ElementCursorsMap');\nfunction initElementCursor(element, cursor) {\n    _getElementCursors(element)[0] = cursor;\n    _setElementCursor(element, cursor);\n}\nfunction _setElementCursor(element, cursor) {\n    const cursors = _getElementCursors(element);\n    cursors[1] = cursors[0];\n    cursors[0] = cursor;\n    element.style.cursor = (cursor instanceof MouseCursor\n        ? cursor\n        : MouseCursor.getDefinedCursor('auto')).getStyleProperty();\n}\nfunction resetElementCursor(element) {\n    _setElementCursor(element, _getElementCursors(element)[1]);\n}\nfunction hideElementCursor(element) {\n    _setElementCursor(element, MouseCursor.getDefinedCursor('none'));\n}\nfunction _getElementCursors(element) {\n    let map = _getElementCursors[ELEMENT_CURSORS_MAP];\n    if (!(map instanceof WeakMap)) {\n        map = new WeakMap();\n        Object.defineProperty(_getElementCursors, ELEMENT_CURSORS_MAP, {\n            value: map,\n        });\n    }\n    let cursors = map.get(element);\n    if (!cursors) {\n        cursors = [null, null];\n        map.set(element, cursors);\n    }\n    return cursors;\n}\nexport { initElementCursor, resetElementCursor, hideElementCursor, _setElementCursor as setElementCursor, };\n","import { utilities } from '@cornerstonejs/core';\nimport MouseCursor from './MouseCursor';\nconst DEFAULT_NAME = 'image-cursor';\nexport default class ImageMouseCursor extends MouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(name || ImageMouseCursor.getUniqueInstanceName(DEFAULT_NAME), fallback);\n        this.url = url;\n        this.x = Number(x) || 0;\n        this.y = Number(y) || 0;\n    }\n    getStyleProperty() {\n        const { url, x, y } = this;\n        let style = `url('${url}')`;\n        if (x >= 0 && y >= 0 && (x > 0 || y > 0)) {\n            style += ` ${x} ${y}`;\n        }\n        return this.addFallbackStyleProperty(style);\n    }\n    static getUniqueInstanceName(prefix) {\n        return `${prefix}-${utilities.getRuntimeId(ImageMouseCursor)}`;\n    }\n}\n","const BASE = {\n    iconContent: '',\n    iconSize: 16,\n    viewBox: {\n        x: 16,\n        y: 16,\n    },\n    mousePoint: {\n        x: 8,\n        y: 8,\n    },\n    mousePointerGroupString: `\n    <path stroke=\"{{color}}\" d=\"M8 16L8 0\"></path>\n    <path stroke=\"{{color}}\" d=\"M16 8L0 8\"></path>\n  `,\n};\nconst SEGMENTATION_CURSOR_BOUNDARIES = {\n    x: 127,\n    y: 60,\n};\nconst MINUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n`;\nconst PLUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n<rect fill=\"{{color}}\" x=\"95.84\" y=\"9.38\" width=\"15.85\" height=\"47.14\"/>\n`;\nconst SCISSOR_ICON = `<path fill=\"{{color}}\" d=\"M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z\" transform=\"translate(-1.17 -0.96)\"/>`;\nconst RECTANGLE_ICON = `<path fill=\"{{color}}\" d=\"M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CIRCLE_ICON = `<path fill=\"{{color}}\" d=\"M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CursorSVG = {\n    Angle: extend(BASE, {\n        name: 'Angle',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n    10l50 50q10 10 10 23z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    ArrowAnnotate: extend(BASE, {\n        name: 'ArrowAnnotate',\n        iconContent: `<g id=\"arrowAnnotate-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"arrowAnnotate-arrow\" d=\"M23,7 l-15,15 M7,17 l0,6 6,0\" stroke-width=\"2\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Bidirectional: extend(BASE, {\n        name: 'Bidirectional',\n        iconContent: `<g fill=\"{{color}}\" stroke-width=\"3\" stroke=\"{{color}}\">\n    <path d=\"M27.63 3.21L3.12 28.81\"></path>\n    <path d=\"M27.63 15.75L15.27 4.43\"></path>\n    <path d=\"M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z\" ></path>\n    <path d=\"M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z\"></path>\n    <path d=\"M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z\"></path>\n    <path d=\"M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z\"></path>\n  </g>`,\n        viewBox: {\n            x: 48,\n            y: 48,\n        },\n    }),\n    CobbAngle: extend(BASE, {\n        name: 'CobbAngle',\n        iconContent: `<g stroke=\"{{color}}\" stroke-width=\"3\">\n    <path d=\"M28.59 2.34L3.82 12.32\"></path>\n    <path d=\"M28.59 29.66L3.82 19.68\"></path>\n    <path stroke-dasharray=\"2\" fill-opacity=\"0\" d=\"M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63\">\n    </path>\n  </g>`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    CircleROI: extend(BASE, {\n        name: 'CircleROI',\n        iconContent: `<circle stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" cx=\"16\" cy=\"16\" r=\"14\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    EllipticalROI: extend(BASE, {\n        name: 'EllipticalROI',\n        iconContent: `<path stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" d=\"M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    FreehandROI: extend(BASE, {\n        name: 'FreehandROI',\n        iconContent: `<g fill=\"{{color}}\" stroke=\"{{color}}\" stroke-width=\"2\">\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_3\" cy=\"4.240343\" cx=\"14.306499\"/>\n    <line id=\"svg_4\" y2=\"3.58462\" x2=\"12.242186\" y1=\"3.997482\" x1=\"13.432202\"/>\n    <line id=\"svg_5\" y2=\"3.268901\" x2=\"10.857882\" y1=\"3.608906\" x1=\"12.387902\"/>\n    <line id=\"svg_6\" y2=\"3.147471\" x2=\"9.740724\" y1=\"3.293187\" x1=\"10.955026\"/>\n    <line id=\"svg_7\" y2=\"3.147471\" x2=\"8.089274\" y1=\"3.196043\" x1=\"9.983585\"/>\n    <line id=\"svg_8\" y2=\"3.268901\" x2=\"6.874972\" y1=\"3.123185\" x1=\"8.307848\"/>\n    <line id=\"svg_9\" y2=\"3.657478\" x2=\"5.587812\" y1=\"3.220329\" x1=\"7.020688\"/>\n    <line id=\"svg_10\" y2=\"4.046054\" x2=\"4.737801\" y1=\"3.560334\" x1=\"5.854959\"/>\n    <line id=\"svg_11\" y2=\"4.337487\" x2=\"4.300652\" y1=\"3.997482\" x1=\"4.834945\"/>\n    <line id=\"svg_12\" y2=\"4.726063\" x2=\"3.88779\" y1=\"4.191771\" x1=\"4.470655\"/>\n    <line id=\"svg_15\" y2=\"5.3575\" x2=\"3.377783\" y1=\"4.604633\" x1=\"3.960648\"/>\n    <line id=\"svg_16\" y2=\"6.183226\" x2=\"2.916348\" y1=\"5.138926\" x1=\"3.547785\"/>\n    <line id=\"svg_17\" y2=\"6.960379\" x2=\"2.770632\" y1=\"5.867507\" x1=\"3.037779\"/>\n    <line id=\"svg_18\" y2=\"7.713246\" x2=\"2.673488\" y1=\"6.741804\" x1=\"2.819204\"/>\n    <line id=\"svg_19\" y2=\"8.684687\" x2=\"2.697774\" y1=\"7.616102\" x1=\"2.673488\"/>\n    <line id=\"svg_20\" y2=\"9.753273\" x2=\"2.892062\" y1=\"8.611829\" x1=\"2.697774\"/>\n    <line id=\"svg_21\" y2=\"10.724714\" x2=\"3.134923\" y1=\"9.534698\" x1=\"2.84349\"/>\n    <line id=\"svg_23\" y2=\"11.647583\" x2=\"3.596357\" y1=\"10.578998\" x1=\"3.086351\"/>\n    <line id=\"svg_25\" y2=\"12.521881\" x2=\"4.276366\" y1=\"11.501867\" x1=\"3.499213\"/>\n    <line id=\"svg_26\" y2=\"13.930471\" x2=\"5.830673\" y1=\"12.376165\" x1=\"4.13065\"/>\n    <line id=\"svg_28\" y2=\"14.707624\" x2=\"7.263549\" y1=\"13.881899\" x1=\"5.733528\"/>\n    <line id=\"svg_29\" y2=\"15.339061\" x2=\"8.963571\" y1=\"14.61048\" x1=\"7.06926\"/>\n    <line id=\"svg_30\" y2=\"15.581921\" x2=\"10.882168\" y1=\"15.314775\" x1=\"8.817855\"/>\n    <line id=\"svg_31\" y2=\"15.460491\" x2=\"12.023612\" y1=\"15.581921\" x1=\"10.785024\"/>\n    <line id=\"svg_33\" y2=\"15.120487\" x2=\"13.092197\" y1=\"15.484777\" x1=\"11.877895\"/>\n    <line id=\"svg_34\" y2=\"14.586194\" x2=\"13.86935\" y1=\"15.217631\" x1=\"12.897909\"/>\n    <line id=\"svg_35\" y2=\"13.833327\" x2=\"14.597931\" y1=\"14.756196\" x1=\"13.699348\"/>\n    <line id=\"svg_37\" y2=\"12.716169\" x2=\"15.180796\" y1=\"13.881899\" x1=\"14.549359\"/>\n    <line id=\"svg_39\" y2=\"11.429009\" x2=\"15.520801\" y1=\"12.813313\" x1=\"15.15651\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_40\" cy=\"10.967574\" cx=\"15.520801\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    FreehandROISculptor: extend(BASE, {\n        name: 'FreehandROISculptor',\n        iconContent: `<g id=\"icon-freehand-sculpt\" fill=\"none\" stroke-width=\"1.5\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <line id=\"svg_1\" y2=\"2.559367\" x2=\"10.184807\" y1=\"4.467781\" x1=\"8.81711\"/>\n    <line id=\"svg_4\" y2=\"1.493836\" x2=\"11.727442\" y1=\"2.766112\" x1=\"10.089386\"/>\n    <line id=\"svg_7\" y2=\"1.080346\" x2=\"13.047428\" y1=\"1.748291\" x1=\"11.345759\"/>\n    <line id=\"svg_8\" y2=\"1.000829\" x2=\"14.351511\" y1=\"1.112153\" x1=\"12.77707\"/>\n    <line id=\"svg_9\" y2=\"1.350705\" x2=\"15.242104\" y1=\"0.905408\" x1=\"13.969828\"/>\n    <line id=\"svg_10\" y2=\"2.098167\" x2=\"15.862339\" y1=\"1.14396\" x1=\"14.955842\"/>\n    <line id=\"svg_11\" y2=\"3.195505\" x2=\"16.41896\" y1=\"1.939133\" x1=\"15.766918\"/>\n    <line id=\"svg_12\" y2=\"4.292843\" x2=\"16.530284\" y1=\"2.925147\" x1=\"16.387153\"/>\n    <line id=\"svg_16\" y2=\"5.644637\" x2=\"16.196311\" y1=\"3.831643\" x1=\"16.593898\"/>\n    <line id=\"svg_18\" y2=\"7.266789\" x2=\"15.623787\" y1=\"5.19934\" x1=\"16.275829\"/>\n    <line id=\"svg_19\" y2=\"10.813258\" x2=\"14.526449\" y1=\"6.726071\" x1=\"15.766918\"/>\n    <line id=\"svg_20\" y2=\"5.056209\" x2=\"8.085552\" y1=\"4.181519\" x1=\"8.976145\"/>\n    <line id=\"svg_23\" y2=\"5.326568\" x2=\"7.481221\" y1=\"4.78585\" x1=\"8.403621\"/>\n    <line id=\"svg_24\" y2=\"5.565119\" x2=\"6.749662\" y1=\"5.294761\" x1=\"7.624352\"/>\n    <line id=\"svg_25\" y2=\"5.994512\" x2=\"5.429675\" y1=\"5.533312\" x1=\"6.956407\"/>\n    <line id=\"svg_27\" y2=\"6.551133\" x2=\"4.284627\" y1=\"5.962706\" x1=\"5.572807\"/>\n    <line id=\"svg_28\" y2=\"7.584858\" x2=\"3.044158\" y1=\"6.392099\" x1=\"4.427758\"/>\n    <line id=\"svg_29\" y2=\"8.84123\" x2=\"2.185372\" y1=\"7.489437\" x1=\"3.219096\"/>\n    <line id=\"svg_31\" y2=\"10.606513\" x2=\"1.644654\" y1=\"8.602678\" x1=\"2.280792\"/>\n    <line id=\"svg_32\" y2=\"13.214679\" x2=\"1.48562\" y1=\"10.352058\" x1=\"1.724171\"/>\n    <line id=\"svg_33\" y2=\"14.375631\" x2=\"1.676461\" y1=\"12.992031\" x1=\"1.453813\"/>\n    <line id=\"svg_34\" y2=\"15.298031\" x2=\"2.264889\" y1=\"14.152983\" x1=\"1.517427\"/>\n    <line id=\"svg_35\" y2=\"16.172721\" x2=\"3.521261\" y1=\"14.948155\" x1=\"1.915013\"/>\n    <line id=\"svg_36\" y2=\"16.824762\" x2=\"5.207027\" y1=\"15.997783\" x1=\"3.28271\"/>\n    <line id=\"svg_38\" y2=\"17.063314\" x2=\"7.035924\" y1=\"16.745245\" x1=\"4.968475\"/>\n    <line id=\"svg_39\" y2=\"16.888376\" x2=\"9.278311\" y1=\"17.047411\" x1=\"6.733758\"/>\n    <line id=\"svg_40\" y2=\"16.284045\" x2=\"10.661911\" y1=\"16.983797\" x1=\"8.992048\"/>\n    <line id=\"svg_41\" y2=\"15.313934\" x2=\"11.647925\" y1=\"16.395369\" x1=\"10.455166\"/>\n    <line id=\"svg_44\" y2=\"13.898527\" x2=\"12.82478\" y1=\"15.425259\" x1=\"11.504794\"/>\n    <line id=\"svg_45\" y2=\"12.037824\" x2=\"14.144766\" y1=\"14.312017\" x1=\"12.522614\"/>\n    <line id=\"svg_47\" y2=\"10.59061\" x2=\"14.605966\" y1=\"12.228665\" x1=\"13.953925\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_48\" cy=\"3.982726\" cx=\"13.460918\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Length: extend(BASE, {\n        name: 'Length',\n        iconContent: `<g id=\"length-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"length-dashes\" d=\"m22.5,6 -16.5,16.5\" stroke-width=\"3\" stroke-dasharray=\"0.6666,5\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Height: extend(BASE, {\n        name: 'Height',\n        iconContent: `<path d=\"m 6 22 l 8.5 0 v -16 h 8\" stroke-width=\"3\" fill=\"none\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Probe: extend(BASE, {\n        name: 'Probe',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    RectangleROI: extend(BASE, {\n        name: 'RectangleROI',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    TextMarker: extend(BASE, {\n        name: 'TextMarker',\n        iconContent: `<path fill=\"{{color}}\" d=\"M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Crosshairs: extend(BASE, {\n        name: 'Crosshairs',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Eraser: extend(BASE, {\n        name: 'Eraser',\n        iconContent: `<path transform=\"translate(0,1792) scale(1,-1)\" fill=\"{{color}}\" d=\"M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n    0 69.5 20.5t47.5 54.5z\" />`,\n        viewBox: {\n            x: 2048,\n            y: 1792,\n        },\n    }),\n    Magnify: extend(BASE, {\n        name: 'Magnify',\n        iconContent: `<path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />`,\n        viewBox: {\n            x: 512,\n            y: 512,\n        },\n    }),\n    Pan: extend(BASE, {\n        name: 'Pan',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n    45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Rotate: extend(BASE, {\n        name: 'Rotate',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n    39 17 39 59z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    StackScroll: extend(BASE, {\n        name: 'StackScroll',\n        iconContent: `<path fill=\"{{color}}\" d=\"M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z\" />`,\n        viewBox: {\n            x: 24,\n            y: 28,\n        },\n    }),\n    WindowLevelRegion: extend(BASE, {\n        name: 'WindowLevelRegion',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    WindowLevel: extend(BASE, {\n        name: 'WindowLevel',\n        iconContent: `\n    <path fill=\"{{color}}\" d=\"M14.5,3.5 a1 1 0 0 1 -11,11 Z\" stroke=\"none\" opacity=\"0.8\" />\n    <circle cx=\"9\" cy=\"9\" r=\"8\" fill=\"none\" stroke-width=\"2\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Zoom: extend(BASE, {\n        name: 'Zoom',\n        iconContent: `\n  <path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />\n  <path fill=\"{{color}}\" transform=\"scale(0.22,0.22) translate(1400,0)\" d=\"M1216\n    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z\" />`,\n        viewBox: {\n            x: 640,\n            y: 512,\n        },\n    }),\n    SegmentationFreeHandEraseInside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseInside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillInside: extend(BASE, {\n        name: 'SegmentationFreeHandFillInside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandEraseOutside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseOutside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillOutside: extend(BASE, {\n        name: 'SegmentationFreeHandFillOutside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationRectangleEraseInside: extend(BASE, {\n        name: 'SegmentationRectangleEraseInside',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    RectangleScissor: extend(BASE, {\n        name: 'RectangleScissor',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    CircleScissor: extend(BASE, {\n        name: 'CircleScissor',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_INSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.ERASE_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n};\nfunction extend(base, values) {\n    return Object.assign(Object.create(base), {\n        ...values,\n        name: values.name || base.name,\n    });\n}\nfunction registerCursor(toolName, iconContent, viewBox) {\n    CursorSVG[toolName] = extend(BASE, {\n        iconContent,\n        viewBox,\n    });\n}\nfunction getDefinedSVGCursorDescriptor(name) {\n    return CursorSVG[name];\n}\nconst svgCursorNames = Object.keys(CursorSVG);\nexport { getDefinedSVGCursorDescriptor, registerCursor, svgCursorNames, CursorSVG, };\n","import { ToolModes, AnnotationStyleStates } from '../enums';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport { getDefinedSVGCursorDescriptor } from './SVGCursorDescriptor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nconst PROPERTY = 'color';\nconst STATE = AnnotationStyleStates.Highlighted;\nconst MODE = ToolModes.Active;\nexport default class SVGMouseCursor extends ImageMouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(url, x, y, name, fallback);\n    }\n    static getDefinedCursor(name, pointer = false, color) {\n        if (!color) {\n            color = getStyleProperty(PROPERTY, {}, STATE, MODE);\n        }\n        const urn = getCursorURN(name, pointer, color);\n        let cursor = super.getDefinedCursor(urn);\n        if (!cursor) {\n            const descriptor = getDefinedSVGCursorDescriptor(name);\n            if (descriptor) {\n                cursor = createSVGMouseCursor(descriptor, urn, pointer, color, super.getDefinedCursor('default'));\n                super.setDefinedCursor(urn, cursor);\n            }\n        }\n        return cursor;\n    }\n}\nfunction format(template, dictionary) {\n    const dict = Object(dictionary);\n    const defined = Object.prototype.hasOwnProperty.bind(dict);\n    return (template + '').replace(/\\{\\{(\\w+)\\}\\}/g, (match, key) => {\n        return defined(key) ? dict[key] + '' : '';\n    });\n}\nfunction getCursorURN(name, pointer, color) {\n    const type = pointer ? 'pointer' : 'cursor';\n    return `${type}:${name}/${color}`;\n}\nfunction createSVGMouseCursor(descriptor, name, pointer, color, fallback) {\n    const { x, y } = descriptor.mousePoint;\n    return new SVGMouseCursor(createSVGIconUrl(descriptor, pointer, { color }), x, y, name, fallback);\n}\nfunction createSVGIconUrl(descriptor, pointer, options) {\n    const blob = createSVGIconBlob(descriptor, pointer, options);\n    const url = URL.createObjectURL(blob);\n    const urn = `${url}#${descriptor.name || 'unknown'}-${pointer ? 'pointer' : 'cursor'}`;\n    return urn;\n}\nfunction createSVGIconBlob(descriptor, pointer, options) {\n    const svgString = (pointer ? createSVGIconWithPointer : createSVGIcon)(descriptor, options);\n    return new Blob([svgString], { type: 'image/svg+xml' });\n}\nfunction createSVGIcon(descriptor, options) {\n    const { iconContent, iconSize, viewBox } = descriptor;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${iconSize}\" height=\"${iconSize}\" viewBox=\"0 0\n      ${viewBox.x} ${viewBox.y}\">\n      ${iconContent}\n    </svg>`;\n    return format(svgString, options);\n}\nfunction createSVGIconWithPointer(descriptor, options) {\n    const { iconContent, iconSize, viewBox, mousePointerGroupString } = descriptor;\n    const scale = iconSize / Math.max(viewBox.x, viewBox.y, 1);\n    const svgSize = 16 + iconSize;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${svgSize}\" height=\"${svgSize}\" viewBox=\"0 0 ${svgSize} ${svgSize}\">\n      <g>${mousePointerGroupString}</g>\n      <g transform=\"translate(16, 16) scale(${scale})\">${iconContent}</g>\n    </svg>`;\n    return format(svgString, options);\n}\n","import { setElementCursor } from './elementCursor';\nimport MouseCursor from './MouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nfunction setCursorForElement(element, cursorName) {\n    let cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n    if (!cursor) {\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    if (!cursor) {\n        console.log(`Cursor ${cursorName} is not defined either as SVG or as a standard cursor.`);\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    setElementCursor(element, cursor);\n}\nexport default setCursorForElement;\n","import MouseCursor, { standardCursorNames } from './MouseCursor';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nimport * as elementCursor from './elementCursor';\nimport setCursorForElement from './setCursorForElement';\nimport { registerCursor, svgCursorNames, CursorSVG, } from './SVGCursorDescriptor';\nconst CursorNames = [...svgCursorNames, ...standardCursorNames];\nexport { MouseCursor, ImageMouseCursor, SVGMouseCursor, elementCursor, registerCursor, CursorNames, CursorSVG, setCursorForElement, };\n","import { state } from '../store/state';\nimport { getEnabledElement } from '@cornerstonejs/core';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction getSvgDrawingHelper(element) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const canvasHash = `${viewportId}:${renderingEngineId}`;\n    const svgLayerElement = _getSvgLayer(element);\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        state.svgNodeCache[canvasHash][cacheKey].touched = false;\n    });\n    return {\n        svgLayerElement: svgLayerElement,\n        svgNodeCacheForCanvas: state.svgNodeCache,\n        getSvgNode: getSvgNode.bind(this, canvasHash),\n        appendNode: appendNode.bind(this, svgLayerElement, canvasHash),\n        setNodeTouched: setNodeTouched.bind(this, canvasHash),\n        clearUntouched: clearUntouched.bind(this, svgLayerElement, canvasHash),\n    };\n}\nfunction _getSvgLayer(element) {\n    const viewportElement = `.${VIEWPORT_ELEMENT}`;\n    const internalDivElement = element.querySelector(viewportElement);\n    const svgLayer = internalDivElement?.querySelector(':scope > .svg-layer');\n    return svgLayer;\n}\nfunction getSvgNode(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        return state.svgNodeCache[canvasHash][cacheKey].domRef;\n    }\n}\nfunction appendNode(svgLayerElement, canvasHash, svgNode, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return null;\n    }\n    state.svgNodeCache[canvasHash][cacheKey] = {\n        touched: true,\n        domRef: svgNode,\n    };\n    svgLayerElement.appendChild(svgNode);\n}\nfunction setNodeTouched(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        state.svgNodeCache[canvasHash][cacheKey].touched = true;\n    }\n}\nfunction clearUntouched(svgLayerElement, canvasHash) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        const cacheEntry = state.svgNodeCache[canvasHash][cacheKey];\n        if (!cacheEntry.touched && cacheEntry.domRef) {\n            svgLayerElement.removeChild(cacheEntry.domRef);\n            delete state.svgNodeCache[canvasHash][cacheKey];\n        }\n    });\n}\nexport default getSvgDrawingHelper;\n","import getSvgDrawingHelper from './getSvgDrawingHelper';\nfunction draw(element, fn) {\n    const svgDrawingHelper = getSvgDrawingHelper(element);\n    fn(svgDrawingHelper);\n    svgDrawingHelper.clearUntouched();\n}\nexport default draw;\n","export function setAttributesIfNecessary(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const currentValue = svgNode.getAttribute(key);\n        const newValue = attributes[key];\n        if (newValue === undefined || newValue === '') {\n            svgNode.removeAttribute(key);\n        }\n        else if (currentValue !== newValue) {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setAttributesIfNecessary;\n","export function setNewAttributesIfValid(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const newValue = attributes[key];\n        if (newValue !== undefined && newValue !== '') {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setNewAttributesIfValid;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawCircle(svgDrawingHelper, annotationUID, circleUID, center, radius, options = {}, dataId = '') {\n    const { color, fill, width, lineWidth, lineDash, fillOpacity, strokeOpacity, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        fill: 'transparent',\n        width: '2',\n        lineDash: undefined,\n        lineWidth: undefined,\n        strokeOpacity: 1,\n        fillOpacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'circle', circleUID);\n    const existingCircleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        r: `${radius}`,\n        stroke: color,\n        fill,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n        'fill-opacity': fillOpacity,\n        'stroke-opacity': strokeOpacity,\n    };\n    if (existingCircleElement) {\n        setAttributesIfNecessary(attributes, existingCircleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newCircleElement = document.createElementNS(svgns, 'circle');\n        if (dataId !== '') {\n            newCircleElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newCircleElement);\n        svgDrawingHelper.appendNode(newCircleElement, svgNodeHash);\n    }\n}\nexport default drawCircle;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'ellipse', ellipseUID);\n    const existingEllipse = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [bottom, top, left, right] = canvasCoordinates;\n    const w = Math.hypot(left[0] - right[0], left[1] - right[1]);\n    const h = Math.hypot(top[0] - bottom[0], top[1] - bottom[1]);\n    const angle = (Math.atan2(left[1] - right[1], left[0] - right[0]) * 180) / Math.PI;\n    const center = [(left[0] + right[0]) / 2, (top[1] + bottom[1]) / 2];\n    const radiusX = w / 2;\n    const radiusY = h / 2;\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        rx: `${radiusX}`,\n        ry: `${radiusY}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingEllipse) {\n        setAttributesIfNecessary(attributes, existingEllipse);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgEllipseElement = document.createElementNS(svgns, 'ellipse');\n        if (dataId !== '') {\n            svgEllipseElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgEllipseElement);\n        svgDrawingHelper.appendNode(svgEllipseElement, svgNodeHash);\n    }\n}\nexport default drawEllipseByCoordinates;\n","import _getHash from './_getHash';\nimport drawEllipseByCoordinates from './drawEllipseByCoordinates';\nfunction drawEllipse(svgDrawingHelper, annotationUID, ellipseUID, corner1, corner2, options = {}, dataId = '') {\n    const top = [(corner1[0] + corner2[0]) / 2, corner1[1]];\n    const bottom = [(corner1[0] + corner2[0]) / 2, corner2[1]];\n    const left = [corner1[0], (corner1[1] + corner2[1]) / 2];\n    const right = [corner2[0], (corner1[1] + corner2[1]) / 2];\n    drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, [bottom, top, left, right], (options = {}), (dataId = ''));\n}\nexport default drawEllipse;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options = {}, uniqueIndex) {\n    const { color, handleRadius, width, lineWidth, fill, type, opacity } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        handleRadius: '6',\n        width: '2',\n        lineWidth: undefined,\n        fill: 'transparent',\n        type: 'circle',\n        opacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'handle', `hg-${handleGroupUID}-index-${uniqueIndex}`);\n    let attributes;\n    if (type === 'circle') {\n        attributes = {\n            cx: `${handle[0]}`,\n            cy: `${handle[1]}`,\n            r: handleRadius,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            opacity: opacity,\n        };\n    }\n    else if (type === 'rect') {\n        const handleRadiusFloat = parseFloat(handleRadius);\n        const side = handleRadiusFloat * 1.5;\n        const x = handle[0] - side * 0.5;\n        const y = handle[1] - side * 0.5;\n        attributes = {\n            x: `${x}`,\n            y: `${y}`,\n            width: `${side}`,\n            height: `${side}`,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            rx: `${side * 0.1}`,\n            opacity: opacity,\n        };\n    }\n    else {\n        throw new Error(`Unsupported handle type: ${type}`);\n    }\n    const existingHandleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingHandleElement) {\n        setAttributesIfNecessary(attributes, existingHandleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newHandleElement = document.createElementNS(svgns, type);\n        setNewAttributesIfValid(attributes, newHandleElement);\n        svgDrawingHelper.appendNode(newHandleElement, svgNodeHash);\n    }\n}\nexport default drawHandle;\n","import drawHandle from './drawHandle';\nfunction drawHandles(svgDrawingHelper, annotationUID, handleGroupUID, handlePoints, options = {}) {\n    handlePoints.forEach((handle, i) => {\n        drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options, i);\n    });\n}\nexport default drawHandles;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, options = {}, dataId = '') {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash, shadow } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n        shadow: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'line', lineUID);\n    const existingLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const dropShadowStyle = shadow\n        ? `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`\n        : '';\n    const attributes = {\n        x1: `${start[0]}`,\n        y1: `${start[1]}`,\n        x2: `${end[0]}`,\n        y2: `${end[1]}`,\n        stroke: color,\n        style: dropShadowStyle,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingLine) {\n        setAttributesIfNecessary(attributes, existingLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newLine = document.createElementNS(svgns, 'line');\n        if (dataId !== '') {\n            newLine.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newLine);\n        svgDrawingHelper.appendNode(newLine, svgNodeHash);\n    }\n}\n","import drawLine from './drawLine';\nexport default function drawHeight(svgDrawingHelper, annotationUID, heightUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const midX = end[0] + (start[0] - end[0]) / 2;\n    const endfirstLine = [midX, start[1]];\n    const endsecondLine = [midX, end[1]];\n    const firstLine = {\n        start: start,\n        end: endfirstLine,\n    };\n    const secondLine = {\n        start: endfirstLine,\n        end: endsecondLine,\n    };\n    const threeLine = {\n        start: endsecondLine,\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '1', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '2', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', threeLine.start, threeLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPolyline(svgDrawingHelper, annotationUID, polylineUID, points, options) {\n    if (points.length < 2) {\n        return;\n    }\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'polyline', polylineUID);\n    const existingPolyLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (const point of points) {\n        pointsAttribute += `${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n    }\n    if (closePath) {\n        const firstPoint = points[0];\n        pointsAttribute += `${firstPoint[0]}, ${firstPoint[1]}`;\n    }\n    const attributes = {\n        points: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingPolyLine) {\n        setAttributesIfNecessary(attributes, existingPolyLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newPolyLine = document.createElementNS(svgns, 'polyline');\n        setNewAttributesIfValid(attributes, newPolyLine);\n        svgDrawingHelper.appendNode(newPolyLine, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPath(svgDrawingHelper, annotationUID, pathUID, points, options) {\n    const hasSubArrays = points.length && points[0].length && Array.isArray(points[0][0]);\n    const pointsArrays = hasSubArrays ? points : [points];\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'path', pathUID);\n    const existingNode = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (let i = 0, numArrays = pointsArrays.length; i < numArrays; i++) {\n        const points = pointsArrays[i];\n        const numPoints = points.length;\n        if (numPoints < 2) {\n            continue;\n        }\n        for (let j = 0; j < numPoints; j++) {\n            const point = points[j];\n            const cmd = j ? 'L' : 'M';\n            pointsAttribute += `${cmd} ${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n        }\n        if (closePath) {\n            pointsAttribute += 'Z ';\n        }\n    }\n    if (!pointsAttribute) {\n        return;\n    }\n    const attributes = {\n        d: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingNode) {\n        setAttributesIfNecessary(attributes, existingNode);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newNode = document.createElementNS(svgns, 'path');\n        setNewAttributesIfValid(attributes, newNode);\n        svgDrawingHelper.appendNode(newNode, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawTextBox(svgDrawingHelper, annotationUID, textUID, textLines, position, options = {}) {\n    const mergedOptions = Object.assign({\n        fontFamily: 'Helvetica, Arial, sans-serif',\n        fontSize: '14px',\n        color: 'rgb(255, 255, 0)',\n        background: '',\n        padding: 25,\n        centerX: false,\n        centerY: true,\n    }, options);\n    const textGroupBoundingBox = _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines, position, mergedOptions);\n    return textGroupBoundingBox;\n}\nfunction _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines = [''], position, options) {\n    const { padding, color, fontFamily, fontSize, background } = options;\n    let textGroupBoundingBox;\n    const [x, y] = [position[0] + padding, position[1] + padding];\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'text', textUID);\n    const existingTextGroup = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingTextGroup) {\n        const textElement = existingTextGroup.querySelector('text');\n        const textSpans = Array.from(textElement.children);\n        for (let i = 0; i < textSpans.length; i++) {\n            const textSpanElement = textSpans[i];\n            const text = textLines[i] || '';\n            textSpanElement.textContent = text;\n        }\n        if (textLines.length > textSpans.length) {\n            for (let i = 0; i < textLines.length - textSpans.length; i++) {\n                const textLine = textLines[i + textSpans.length];\n                const textSpan = _createTextSpan(textLine);\n                textElement.appendChild(textSpan);\n            }\n            existingTextGroup.appendChild(textElement);\n            svgDrawingHelper.appendNode(existingTextGroup, svgNodeHash);\n        }\n        const textAttributes = {\n            fill: color,\n            'font-size': fontSize,\n            'font-family': fontFamily,\n        };\n        const textGroupAttributes = {\n            transform: `translate(${x} ${y})`,\n        };\n        setAttributesIfNecessary(textAttributes, textElement);\n        setAttributesIfNecessary(textGroupAttributes, existingTextGroup);\n        textGroupBoundingBox = _drawTextBackground(existingTextGroup, background);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const textGroup = document.createElementNS(svgns, 'g');\n        textGroup.setAttribute('transform', `translate(${x} ${y})`);\n        const textElement = _createTextElement(svgDrawingHelper, options);\n        for (let i = 0; i < textLines.length; i++) {\n            const textLine = textLines[i];\n            const textSpan = _createTextSpan(textLine);\n            textElement.appendChild(textSpan);\n        }\n        textGroup.appendChild(textElement);\n        svgDrawingHelper.appendNode(textGroup, svgNodeHash);\n        textGroupBoundingBox = _drawTextBackground(textGroup, background);\n    }\n    return Object.assign({}, textGroupBoundingBox, {\n        x,\n        y,\n        height: textGroupBoundingBox.height + padding,\n        width: textGroupBoundingBox.width + padding,\n    });\n}\nfunction _createTextElement(svgDrawingHelper, options) {\n    const { color, fontFamily, fontSize } = options;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textElement = document.createElementNS(svgns, 'text');\n    const noSelectStyle = 'user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);';\n    const dropShadowStyle = `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`;\n    const combinedStyle = `${noSelectStyle}${dropShadowStyle}`;\n    textElement.setAttribute('x', '0');\n    textElement.setAttribute('y', '0');\n    textElement.setAttribute('fill', color);\n    textElement.setAttribute('font-family', fontFamily);\n    textElement.setAttribute('font-size', fontSize);\n    textElement.setAttribute('style', combinedStyle);\n    return textElement;\n}\nfunction _createTextSpan(text) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textSpanElement = document.createElementNS(svgns, 'tspan');\n    textSpanElement.setAttribute('x', '0');\n    textSpanElement.setAttribute('dy', '1.2em');\n    textSpanElement.textContent = text;\n    return textSpanElement;\n}\nfunction _drawTextBackground(group, color) {\n    let element = group.querySelector('rect.background');\n    if (!color) {\n        if (element) {\n            group.removeChild(element);\n        }\n        return group.getBBox();\n    }\n    if (!element) {\n        element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        element.setAttribute('class', 'background');\n        group.insertBefore(element, group.firstChild);\n    }\n    const bBox = group.getBBox();\n    const attributes = {\n        x: `${bBox.x}`,\n        y: `${bBox.y}`,\n        width: `${bBox.width}`,\n        height: `${bBox.height}`,\n        fill: color,\n    };\n    setAttributesIfNecessary(attributes, element);\n    return bBox;\n}\nexport default drawTextBox;\n","import drawLine from './drawLine';\nimport findClosestPoint from '../utilities/math/vec2/findClosestPoint';\nfunction drawLink(svgDrawingHelper, annotationUID, linkUID, annotationAnchorPoints, refPoint, boundingBox, options = {}) {\n    const start = annotationAnchorPoints.length > 0\n        ? findClosestPoint(annotationAnchorPoints, refPoint)\n        : refPoint;\n    const boundingBoxPoints = _boundingBoxPoints(boundingBox);\n    const end = findClosestPoint(boundingBoxPoints, start);\n    const mergedOptions = Object.assign({\n        color: 'rgb(255, 255, 0)',\n        lineWidth: '1',\n        lineDash: '2,3',\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, `link-${linkUID}`, start, end, mergedOptions);\n}\nfunction _boundingBoxPoints(boundingBox) {\n    const { x: left, y: top, height, width } = boundingBox;\n    const halfWidth = width / 2;\n    const halfHeight = height / 2;\n    const topMiddle = [left + halfWidth, top];\n    const leftMiddle = [left, top + halfHeight];\n    const bottomMiddle = [left + halfWidth, top + height];\n    const rightMiddle = [left + width, top + halfHeight];\n    return [topMiddle, leftMiddle, bottomMiddle, rightMiddle];\n}\nexport default drawLink;\n","import drawTextBox from './drawTextBox';\nimport drawLink from './drawLink';\nfunction drawLinkedTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, annotationAnchorPoints, textBox, options = {}) {\n    const mergedOptions = Object.assign({\n        handleRadius: '6',\n        centering: {\n            x: false,\n            y: true,\n        },\n    }, options);\n    const canvasBoundingBox = drawTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, mergedOptions);\n    drawLink(svgDrawingHelper, annotationUID, textBoxUID, annotationAnchorPoints, textBoxPosition, canvasBoundingBox, mergedOptions);\n    return canvasBoundingBox;\n}\nexport default drawLinkedTextBox;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [topLeft, topRight, bottomLeft, bottomRight] = canvasCoordinates;\n    const width = Math.hypot(topLeft[0] - topRight[0], topLeft[1] - topRight[1]);\n    const height = Math.hypot(topLeft[0] - bottomLeft[0], topLeft[1] - bottomLeft[1]);\n    const center = [\n        (bottomRight[0] + topLeft[0]) / 2,\n        (bottomRight[1] + topLeft[1]) / 2,\n    ];\n    const leftEdgeCenter = [\n        (bottomLeft[0] + topLeft[0]) / 2,\n        (bottomLeft[1] + topLeft[1]) / 2,\n    ];\n    const angle = (Math.atan2(center[1] - leftEdgeCenter[1], center[0] - leftEdgeCenter[0]) *\n        180) /\n        Math.PI;\n    const attributes = {\n        x: `${center[0] - width / 2}`,\n        y: `${center[1] - height / 2}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        if (dataId !== '') {\n            svgRectElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport drawRectByCoordinates from './drawRectByCoordinates';\nexport default function drawRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}, dataId = '') {\n    const topLeft = [start[0], start[1]];\n    const topRight = [end[0], start[1]];\n    const bottomLeft = [start[0], end[1]];\n    const bottomRight = [end[0], end[1]];\n    drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, [topLeft, topRight, bottomLeft, bottomRight], options, dataId);\n}\n","import drawLine from './drawLine';\nexport default function drawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, arrowUID, start, end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    const headLength = 10;\n    const angle = Math.atan2(end[1] - start[1], end[0] - start[0]);\n    const firstLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle - Math.PI / 7),\n            end[1] - headLength * Math.sin(angle - Math.PI / 7),\n        ],\n        end: end,\n    };\n    const secondLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle + Math.PI / 7),\n            end[1] - headLength * Math.sin(angle + Math.PI / 7),\n        ],\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '2', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport _setAttributesIfNecessary from './setAttributesIfNecessary';\nimport _setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRedactionRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}) {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const tlhc = [Math.min(start[0], end[0]), Math.min(start[1], end[1])];\n    const width = Math.abs(start[0] - end[0]);\n    const height = Math.abs(start[1] - end[1]);\n    const attributes = {\n        x: `${tlhc[0]}`,\n        y: `${tlhc[1]}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'black',\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        _setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        _setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","import { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport getViewportsForAnnotation from '../../../utilities/getViewportsForAnnotation';\nimport * as math from '../../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getViewportIdsWithToolToRender } from '../../../utilities/viewportFilters';\nimport { addAnnotation, removeAnnotation, getAllAnnotations, getChildAnnotations, addChildAnnotation, clearParentAnnotation, } from '../../../stateManagement/annotation/annotationState';\nimport { ContourWindingDirection } from '../../../types/ContourAnnotation';\nimport { triggerAnnotationModified } from '../../../stateManagement/annotation/helpers/state';\nimport updateContourPolyline from '../../../utilities/contours/updateContourPolyline';\nimport { addContourSegmentationAnnotation, areSameSegment, isContourSegmentationAnnotation, removeContourSegmentationAnnotation, } from '../../../utilities/contourSegmentation';\nimport { getToolGroupForViewport } from '../../../store/ToolGroupManager';\nimport { hasTool, hasToolByName } from '../../../store/addTool';\nconst DEFAULT_CONTOUR_SEG_TOOL_NAME = 'PlanarFreehandContourSegmentationTool';\nexport default async function contourSegmentationCompletedListener(evt) {\n    const sourceAnnotation = evt.detail\n        .annotation;\n    if (!isContourSegmentationAnnotation(sourceAnnotation)) {\n        return;\n    }\n    const viewport = getViewport(sourceAnnotation);\n    const contourSegmentationAnnotations = getValidContourSegmentationAnnotations(viewport, sourceAnnotation);\n    if (!contourSegmentationAnnotations.length) {\n        return;\n    }\n    const sourcePolyline = convertContourPolylineToCanvasSpace(sourceAnnotation.data.contour.polyline, viewport);\n    const targetAnnotationInfo = findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations);\n    if (!targetAnnotationInfo) {\n        return;\n    }\n    const { targetAnnotation, targetPolyline, isContourHole } = targetAnnotationInfo;\n    if (isContourHole) {\n        const { contourHoleProcessingEnabled = false } = evt.detail;\n        if (!contourHoleProcessingEnabled) {\n            return;\n        }\n        createPolylineHole(viewport, targetAnnotation, sourceAnnotation);\n    }\n    else {\n        combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline);\n    }\n}\nfunction isFreehandContourSegToolRegisteredForViewport(viewport, silent = false) {\n    const toolName = 'PlanarFreehandContourSegmentationTool';\n    const toolGroup = getToolGroupForViewport(viewport.id, viewport.renderingEngineId);\n    let errorMessage;\n    if (!toolGroup.hasTool(toolName)) {\n        errorMessage = `Tool ${toolName} not added to ${toolGroup.id} toolGroup`;\n    }\n    else if (!toolGroup.getToolOptions(toolName)) {\n        errorMessage = `Tool ${toolName} must be in active/passive state`;\n    }\n    if (errorMessage && !silent) {\n        console.warn(errorMessage);\n    }\n    return !errorMessage;\n}\nfunction getViewport(annotation) {\n    const viewports = getViewportsForAnnotation(annotation);\n    const viewportWithToolRegistered = viewports.find((viewport) => isFreehandContourSegToolRegisteredForViewport(viewport, true));\n    return viewportWithToolRegistered ?? viewports[0];\n}\nfunction convertContourPolylineToCanvasSpace(polyline, viewport) {\n    const numPoints = polyline.length;\n    const projectedPolyline = new Array(numPoints);\n    for (let i = 0; i < numPoints; i++) {\n        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n    }\n    return projectedPolyline;\n}\nfunction getValidContourSegmentationAnnotations(viewport, sourceAnnotation) {\n    const { annotationUID: sourceAnnotationUID } = sourceAnnotation;\n    const allAnnotations = getAllAnnotations();\n    return allAnnotations.filter((targetAnnotation) => targetAnnotation.annotationUID &&\n        targetAnnotation.annotationUID !== sourceAnnotationUID &&\n        isContourSegmentationAnnotation(targetAnnotation) &&\n        areSameSegment(targetAnnotation, sourceAnnotation) &&\n        viewport.isReferenceViewable(targetAnnotation.metadata));\n}\nfunction findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations) {\n    const sourceAABB = math.polyline.getAABB(sourcePolyline);\n    for (let i = 0; i < contourSegmentationAnnotations.length; i++) {\n        const targetAnnotation = contourSegmentationAnnotations[i];\n        const targetPolyline = convertContourPolylineToCanvasSpace(targetAnnotation.data.contour.polyline, viewport);\n        const targetAABB = math.polyline.getAABB(targetPolyline);\n        const aabbIntersect = math.aabb.intersectAABB(sourceAABB, targetAABB);\n        const lineSegmentsIntersect = aabbIntersect &&\n            math.polyline.intersectPolyline(sourcePolyline, targetPolyline);\n        const isContourHole = aabbIntersect &&\n            !lineSegmentsIntersect &&\n            math.polyline.containsPoints(targetPolyline, sourcePolyline);\n        if (lineSegmentsIntersect || isContourHole) {\n            return { targetAnnotation, targetPolyline, isContourHole };\n        }\n    }\n}\nexport function createPolylineHole(viewport, targetAnnotation, holeAnnotation) {\n    const { windingDirection: targetWindingDirection } = targetAnnotation.data.contour;\n    const { windingDirection: holeWindingDirection } = holeAnnotation.data.contour;\n    addChildAnnotation(targetAnnotation, holeAnnotation);\n    removeContourSegmentationAnnotation(holeAnnotation);\n    const { contour: holeContour } = holeAnnotation.data;\n    const holePolyline = convertContourPolylineToCanvasSpace(holeContour.polyline, viewport);\n    updateContourPolyline(holeAnnotation, {\n        points: holePolyline,\n        closed: holeContour.closed,\n    }, viewport);\n    const { element } = viewport;\n    const updatedToolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        holeAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedToolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n}\nfunction getContourHolesData(viewport, annotation) {\n    return getChildAnnotations(annotation).map((holeAnnotation) => {\n        const polyline = convertContourPolylineToCanvasSpace(holeAnnotation.data.contour.polyline, viewport);\n        return { annotation: holeAnnotation, polyline };\n    });\n}\nfunction combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline) {\n    if (!hasToolByName(DEFAULT_CONTOUR_SEG_TOOL_NAME)) {\n        console.warn(`${DEFAULT_CONTOUR_SEG_TOOL_NAME} is not registered in cornerstone`);\n        return;\n    }\n    if (!isFreehandContourSegToolRegisteredForViewport(viewport)) {\n        return;\n    }\n    const sourceStartPoint = sourcePolyline[0];\n    const mergePolylines = math.polyline.containsPoint(targetPolyline, sourceStartPoint);\n    const contourHolesData = getContourHolesData(viewport, targetAnnotation);\n    const unassignedContourHolesSet = new Set(contourHolesData);\n    const reassignedContourHolesMap = new Map();\n    const assignHoleToPolyline = (parentPolyline, holeData) => {\n        let holes = reassignedContourHolesMap.get(parentPolyline);\n        if (!holes) {\n            holes = [];\n            reassignedContourHolesMap.set(parentPolyline, holes);\n        }\n        holes.push(holeData);\n        unassignedContourHolesSet.delete(holeData);\n    };\n    const newPolylines = [];\n    if (mergePolylines) {\n        const mergedPolyline = math.polyline.mergePolylines(targetPolyline, sourcePolyline);\n        newPolylines.push(mergedPolyline);\n        Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => assignHoleToPolyline(mergedPolyline, holeData));\n    }\n    else {\n        const subtractedPolylines = math.polyline.subtractPolylines(targetPolyline, sourcePolyline);\n        subtractedPolylines.forEach((newPolyline) => {\n            newPolylines.push(newPolyline);\n            Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => {\n                const containsHole = math.polyline.containsPoints(newPolyline, holeData.polyline);\n                if (containsHole) {\n                    assignHoleToPolyline(newPolyline, holeData);\n                    unassignedContourHolesSet.delete(holeData);\n                }\n            });\n        });\n    }\n    Array.from(reassignedContourHolesMap.values()).forEach((contourHolesDataArray) => contourHolesDataArray.forEach((contourHoleData) => clearParentAnnotation(contourHoleData.annotation)));\n    const { element } = viewport;\n    const enabledElement = getEnabledElement(element);\n    const { metadata, data } = targetAnnotation;\n    const { handles, segmentation } = data;\n    const { textBox } = handles;\n    removeAnnotation(sourceAnnotation.annotationUID);\n    removeAnnotation(targetAnnotation.annotationUID);\n    for (let i = 0; i < newPolylines.length; i++) {\n        const polyline = newPolylines[i];\n        const startPoint = viewport.canvasToWorld(polyline[0]);\n        const endPoint = viewport.canvasToWorld(polyline[polyline.length - 1]);\n        const newAnnotation = {\n            metadata: {\n                ...metadata,\n                toolName: DEFAULT_CONTOUR_SEG_TOOL_NAME,\n                originalToolName: metadata.originalToolName || metadata.toolName,\n            },\n            data: {\n                cachedStats: {},\n                handles: {\n                    points: [startPoint, endPoint],\n                    textBox: textBox ? { ...textBox } : undefined,\n                },\n                contour: {\n                    polyline: [],\n                    closed: true,\n                },\n                spline: targetAnnotation.data.spline,\n                segmentation: {\n                    ...segmentation,\n                },\n            },\n            annotationUID: csUtils.uuidv4(),\n            highlighted: true,\n            invalidated: true,\n            isLocked: false,\n            isVisible: undefined,\n            interpolationUID: targetAnnotation.interpolationUID,\n            interpolationCompleted: targetAnnotation.interpolationCompleted,\n        };\n        updateContourPolyline(newAnnotation, {\n            points: polyline,\n            closed: true,\n            targetWindingDirection: ContourWindingDirection.Clockwise,\n        }, viewport);\n        addAnnotation(newAnnotation, element);\n        addContourSegmentationAnnotation(newAnnotation);\n        triggerAnnotationModified(newAnnotation, viewport.element);\n        reassignedContourHolesMap\n            .get(polyline)\n            ?.forEach((holeData) => addChildAnnotation(newAnnotation, holeData.annotation));\n    }\n    updateViewports(enabledElement, targetAnnotation, sourceAnnotation);\n}\nfunction updateViewports(enabledElement, targetAnnotation, sourceAnnotation) {\n    const { viewport } = enabledElement;\n    const { element } = viewport;\n    const updatedTtoolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        sourceAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedTtoolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    return new Promise((resolve) => window.requestAnimationFrame(resolve));\n}\n","import mouseDoubleClickListener from './mouseDoubleClickListener';\nimport mouseDownListener, { mouseDoubleClickIgnoreListener, } from './mouseDownListener';\nimport mouseMoveListener from './mouseMoveListener';\nfunction disable(element) {\n    element.removeEventListener('dblclick', mouseDoubleClickListener);\n    element.removeEventListener('mousedown', mouseDownListener);\n    element.removeEventListener('mousemove', mouseMoveListener);\n    element.removeEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('dblclick', mouseDoubleClickListener);\n    element.addEventListener('mousedown', mouseDownListener);\n    element.addEventListener('mousemove', mouseMoveListener);\n    element.addEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import preventGhostClick from './preventGhostClick';\nimport touchStartListener from './touchStartListener';\nfunction disable(element) {\n    preventGhostClick.disable(element);\n    element.removeEventListener('touchstart', touchStartListener);\n}\nfunction enable(element) {\n    disable(element);\n    preventGhostClick.enable(element);\n    element.addEventListener('touchstart', touchStartListener, {\n        passive: false,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import wheelListener from './wheelListener';\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('wheel', wheelListener, { passive: false });\n}\nfunction disable(element) {\n    element.removeEventListener('wheel', wheelListener);\n}\nexport default {\n    enable,\n    disable,\n};\n","import { cache, utilities as csUtils, VolumeViewport, getEnabledElementByViewportId, StackViewport, } from '@cornerstonejs/core';\nimport * as SegmentationState from '../../../stateManagement/segmentation/segmentationState';\nimport { SegmentationRepresentations } from '../../../enums';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst onLabelmapSegmentationDataModified = function (evt) {\n    const { segmentationId, modifiedSlicesToUse } = evt.detail;\n    const { representationData } = SegmentationState.getSegmentation(segmentationId);\n    const viewportIds = SegmentationState.getViewportIdsWithSegmentation(segmentationId);\n    const hasVolumeViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof VolumeViewport;\n    });\n    const hasStackViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof StackViewport;\n    });\n    const hasBothStackAndVolume = hasVolumeViewport && hasStackViewport;\n    viewportIds.forEach((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        if (viewport instanceof VolumeViewport) {\n            performVolumeLabelmapUpdate({\n                modifiedSlicesToUse: hasBothStackAndVolume ? [] : modifiedSlicesToUse,\n                representationData,\n                type: SegmentationRepresentations.Labelmap,\n            });\n        }\n        if (viewport instanceof StackViewport) {\n            performStackLabelmapUpdate({\n                viewportIds,\n                segmentationId,\n            });\n        }\n    });\n};\nfunction performVolumeLabelmapUpdate({ modifiedSlicesToUse, representationData, type, }) {\n    const segmentationVolume = cache.getVolume(representationData[type].volumeId);\n    if (!segmentationVolume) {\n        console.warn('segmentation not found in cache');\n        return;\n    }\n    const { imageData, vtkOpenGLTexture } = segmentationVolume;\n    let slicesToUpdate;\n    if (modifiedSlicesToUse?.length > 0) {\n        slicesToUpdate = modifiedSlicesToUse;\n    }\n    else {\n        const numSlices = imageData.getDimensions()[2];\n        slicesToUpdate = [...Array(numSlices).keys()];\n    }\n    slicesToUpdate.forEach((i) => {\n        vtkOpenGLTexture.setUpdatedFrame(i);\n    });\n    imageData.modified();\n}\nfunction performStackLabelmapUpdate({ viewportIds, segmentationId }) {\n    viewportIds.forEach((viewportId) => {\n        let representations = SegmentationState.getSegmentationRepresentations(viewportId, { segmentationId });\n        representations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n        representations.forEach((representation) => {\n            if (representation.segmentationId !== segmentationId) {\n                return;\n            }\n            const enabledElement = getEnabledElementByViewportId(viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            if (viewport instanceof VolumeViewport) {\n                return;\n            }\n            const actorEntry = getLabelmapActorEntry(viewportId, segmentationId);\n            if (!actorEntry) {\n                return;\n            }\n            const segImageData = actorEntry.actor.getMapper().getInputData();\n            const currentSegmentationImageId = SegmentationState.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n            const segmentationImage = cache.getImage(currentSegmentationImageId);\n            segImageData.modified();\n            csUtils.updateVTKImageDataWithCornerstoneImage(segImageData, segmentationImage);\n        });\n    });\n}\nexport default onLabelmapSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport onLabelmapSegmentationDataModified from './labelmap/onLabelmapSegmentationDataModified';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nconst onSegmentationDataModified = function (evt) {\n    const { segmentationId } = evt.detail;\n    const { representationData } = getSegmentation(segmentationId);\n    if (representationData.Labelmap) {\n        onLabelmapSegmentationDataModified(evt);\n    }\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default onSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationModifiedListener = function (evt) {\n    const { segmentationId } = evt.detail;\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default segmentationModifiedListener;\n","import vtkDataArray from '@kitware/vtk.js/Common/Core/DataArray';\nimport vtkImageData from '@kitware/vtk.js/Common/DataModel/ImageData';\nimport { BaseVolumeViewport, getEnabledElement, Enums, getEnabledElementByIds, cache, utilities, } from '@cornerstonejs/core';\nimport { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport { updateLabelmapSegmentationImageReferences } from '../../stateManagement/segmentation/updateLabelmapSegmentationImageReferences';\nimport { getCurrentLabelmapImageIdForViewport } from '../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getLabelmapActorEntry } from '../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getSegmentationRepresentations } from '../../stateManagement/segmentation/getSegmentationRepresentation';\nconst enable = function (element) {\n    const { viewport } = getEnabledElement(element);\n    if (viewport instanceof BaseVolumeViewport) {\n        return;\n    }\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst perViewportManualTriggers = new Map();\nfunction _imageChangeEventListener(evt) {\n    const eventData = evt.detail;\n    const { viewportId, renderingEngineId } = eventData;\n    const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n    const representations = getSegmentationRepresentations(viewportId);\n    if (!representations?.length) {\n        return;\n    }\n    const labelmapRepresentations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n    const actors = viewport.getActors();\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n    });\n    const labelmapActors = labelmapRepresentations\n        .map((representation) => {\n        return getLabelmapActorEntry(viewportId, representation.segmentationId);\n    })\n        .filter((actor) => actor !== undefined);\n    if (!labelmapActors.length) {\n        return;\n    }\n    labelmapActors.forEach((actor) => {\n        const validActor = labelmapRepresentations.find((representation) => {\n            const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, representation.segmentationId);\n            return derivedImageId === actor.referencedId;\n        });\n        if (!validActor) {\n            viewport.removeActors([actor.uid]);\n        }\n    });\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        const currentImageId = viewport.getCurrentImageId();\n        const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n        if (!derivedImageId) {\n            return;\n        }\n        const derivedImage = cache.getImage(derivedImageId);\n        if (!derivedImage) {\n            console.warn('No derived image found in the cache for segmentation representation', representation);\n            return;\n        }\n        const segmentationActorInput = actors.find((actor) => actor.referencedId === derivedImageId);\n        if (!segmentationActorInput) {\n            const { dimensions, spacing, direction } = viewport.getImageDataMetadata(derivedImage);\n            const currentImage = cache.getImage(currentImageId) ||\n                {\n                    imageId: currentImageId,\n                };\n            const { origin: currentOrigin } = viewport.getImageDataMetadata(currentImage);\n            const originToUse = currentOrigin;\n            const constructor = derivedImage.voxelManager.getConstructor();\n            const newPixelData = derivedImage.voxelManager.getScalarData();\n            const scalarArray = vtkDataArray.newInstance({\n                name: 'Pixels',\n                numberOfComponents: 1,\n                values: new constructor(newPixelData),\n            });\n            const imageData = vtkImageData.newInstance();\n            imageData.setDimensions(dimensions[0], dimensions[1], 1);\n            imageData.setSpacing(spacing);\n            imageData.setDirection(direction);\n            imageData.setOrigin(originToUse);\n            imageData.getPointData().setScalars(scalarArray);\n            imageData.modified();\n            viewport.addImages([\n                {\n                    imageId: derivedImageId,\n                    representationUID: `${segmentationId}-${SegmentationRepresentations.Labelmap}`,\n                    callback: ({ imageActor }) => {\n                        imageActor.getMapper().setInputData(imageData);\n                    },\n                },\n            ]);\n            triggerSegmentationRender(viewportId);\n            return;\n        }\n        else {\n            const segmentationImageData = segmentationActorInput.actor\n                .getMapper()\n                .getInputData();\n            if (segmentationImageData.setDerivedImage) {\n                segmentationImageData.setDerivedImage(derivedImage);\n            }\n            else {\n                utilities.updateVTKImageDataWithCornerstoneImage(segmentationImageData, derivedImage);\n            }\n        }\n        viewport.render();\n        if (evt.type === Enums.Events.IMAGE_RENDERED) {\n            viewport.element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n        }\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationCompleted } from './contourSegmentation';\nexport default function annotationCompletedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationCompleted(evt);\n    }\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationSelectionListener(evt) {\n    const deselectedAnnotation = evt.detail.removed;\n    if (!deselectedAnnotation.length) {\n        return;\n    }\n    const renderingEngines = getRenderingEngines();\n    renderingEngines.forEach((renderingEngine) => {\n        const viewports = renderingEngine.getViewports();\n        const viewportIds = viewports.map((vp) => vp.id);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    });\n}\nexport default annotationSelectionListener;\n","import triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationModifiedListener(evt) {\n    const { viewportId } = evt.detail;\n    triggerAnnotationRenderForViewportIds([viewportId]);\n}\nexport default annotationModifiedListener;\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationRemoved } from './contourSegmentation';\nexport default function annotationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationRemoved(evt);\n    }\n}\n","import { removeContourSegmentationAnnotation } from '../../../utilities/contourSegmentation';\nexport default function contourSegmentationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    removeContourSegmentationAnnotation(annotation);\n}\n","import { Enums } from '@cornerstonejs/core';\nimport triggerAnnotationRender from '../utilities/triggerAnnotationRender';\nconst onImageRendered = function (evt) {\n    triggerAnnotationRender(evt.detail.element);\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { mouseClick, mouseDown, mouseDownActivate, mouseDoubleClick, mouseDrag, mouseMove, mouseUp, mouseWheel, } from './mouseEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.addEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.addEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.addEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.addEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.addEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.addEventListener(Events.MOUSE_UP, mouseUp);\n    element.addEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.removeEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.removeEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.removeEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.removeEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.removeEventListener(Events.MOUSE_UP, mouseUp);\n    element.removeEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst mouseToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default mouseToolEventDispatcher;\n","import Events from '../enums/Events';\nimport { keyDown, keyUp } from './keyboardEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.KEY_DOWN, keyDown);\n    element.addEventListener(Events.KEY_UP, keyUp);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.KEY_DOWN, keyDown);\n    element.removeEventListener(Events.KEY_UP, keyUp);\n};\nconst keyboardToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default keyboardToolEventDispatcher;\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraModified = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onCameraModified) {\n            tool.onCameraModified(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onImageSpacingCalibrated = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onImageSpacingCalibrated) {\n            tool.onImageSpacingCalibrated(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { touchStart, touchStartActivate, touchDrag, touchEnd, touchTap, touchPress, } from './touchEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.TOUCH_START, touchStart);\n    element.addEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.addEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.addEventListener(Events.TOUCH_END, touchEnd);\n    element.addEventListener(Events.TOUCH_TAP, touchTap);\n    element.addEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.TOUCH_START, touchStart);\n    element.removeEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.removeEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.removeEventListener(Events.TOUCH_END, touchEnd);\n    element.removeEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst touchToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default touchToolEventDispatcher;\n","import { eventTarget } from '@cornerstonejs/core';\nimport Events from '../enums/Events';\nimport InterpolationManager from '../utilities/segmentation/InterpolationManager/InterpolationManager';\nconst enable = function () {\n    eventTarget.addEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.addEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.addEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nconst disable = function () {\n    eventTarget.removeEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.removeEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.removeEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraReset = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onResetCamera) {\n            tool.onResetCamera(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, touchToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport { state } from './state';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nexport default function addEnabledElement(evt) {\n    const { element, viewportId } = evt.detail;\n    const svgLayer = _createSvgAnnotationLayer(viewportId);\n    _setSvgNodeCache(element);\n    _appendChild(svgLayer, element);\n    annotationRenderingEngine.addViewportElement(viewportId, element);\n    mouseEventListeners.enable(element);\n    wheelEventListener.enable(element);\n    touchEventListeners.enable(element);\n    keyEventListener.enable(element);\n    imageChangeEventListener.enable(element);\n    imageRenderedEventDispatcher.enable(element);\n    cameraModifiedEventDispatcher.enable(element);\n    imageSpacingCalibratedEventDispatcher.enable(element);\n    cameraResetEventDispatcher.enable(element);\n    mouseToolEventDispatcher.enable(element);\n    keyboardToolEventDispatcher.enable(element);\n    touchToolEventDispatcher.enable(element);\n    state.enabledElements.push(element);\n}\nfunction _createSvgAnnotationLayer(viewportId) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgLayer = document.createElementNS(svgns, 'svg');\n    const svgLayerId = `svg-layer-${viewportId}`;\n    svgLayer.classList.add('svg-layer');\n    svgLayer.setAttribute('id', svgLayerId);\n    svgLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgLayer.style.width = '100%';\n    svgLayer.style.height = '100%';\n    svgLayer.style.pointerEvents = 'none';\n    svgLayer.style.position = 'absolute';\n    const defs = document.createElementNS(svgns, 'defs');\n    const filter = document.createElementNS(svgns, 'filter');\n    const feOffset = document.createElementNS(svgns, 'feOffset');\n    const feColorMatrix = document.createElementNS(svgns, 'feColorMatrix');\n    const feBlend = document.createElementNS(svgns, 'feBlend');\n    filter.setAttribute('id', `shadow-${svgLayerId}`);\n    filter.setAttribute('filterUnits', 'userSpaceOnUse');\n    feOffset.setAttribute('result', 'offOut');\n    feOffset.setAttribute('in', 'SourceGraphic');\n    feOffset.setAttribute('dx', '0.5');\n    feOffset.setAttribute('dy', '0.5');\n    feColorMatrix.setAttribute('result', 'matrixOut');\n    feColorMatrix.setAttribute('in', 'offOut');\n    feColorMatrix.setAttribute('in2', 'matrix');\n    feColorMatrix.setAttribute('values', '0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0');\n    feBlend.setAttribute('in', 'SourceGraphic');\n    feBlend.setAttribute('in2', 'matrixOut');\n    feBlend.setAttribute('mode', 'normal');\n    filter.appendChild(feOffset);\n    filter.appendChild(feColorMatrix);\n    filter.appendChild(feBlend);\n    defs.appendChild(filter);\n    svgLayer.appendChild(defs);\n    return svgLayer;\n}\nfunction _setSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    state.svgNodeCache[elementHash] = {};\n}\nfunction _appendChild(newNode, referenceNode) {\n    referenceNode.querySelector('div.viewport-element').appendChild(newNode);\n}\n","import { state } from '../state';\nfunction getSynchronizersForViewport(viewportId, renderingEngineId) {\n    const synchronizersFilteredByIds = [];\n    if (!renderingEngineId && !viewportId) {\n        throw new Error('At least one of renderingEngineId or viewportId should be given');\n    }\n    for (let i = 0; i < state.synchronizers.length; i++) {\n        const synchronizer = state.synchronizers[i];\n        const notDisabled = !synchronizer.isDisabled();\n        const hasSourceViewport = synchronizer.hasSourceViewport(renderingEngineId, viewportId);\n        const hasTargetViewport = synchronizer.hasTargetViewport(renderingEngineId, viewportId);\n        if (notDisabled && (hasSourceViewport || hasTargetViewport)) {\n            synchronizersFilteredByIds.push(synchronizer);\n        }\n    }\n    return synchronizersFilteredByIds;\n}\nexport default getSynchronizersForViewport;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, touchToolEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nimport { state } from './state';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport { ToolModes } from '../enums';\nimport { removeAnnotation } from '../stateManagement';\nimport getSynchronizersForViewport from './SynchronizerManager/getSynchronizersForViewport';\nimport getToolGroupForViewport from './ToolGroupManager/getToolGroupForViewport';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction removeEnabledElement(elementDisabledEvt) {\n    const { element, viewportId } = elementDisabledEvt.detail;\n    _resetSvgNodeCache(element);\n    _removeSvgNode(element);\n    annotationRenderingEngine.removeViewportElement(viewportId, element);\n    mouseEventListeners.disable(element);\n    wheelEventListener.disable(element);\n    touchEventListeners.disable(element);\n    keyEventListener.disable(element);\n    imageChangeEventListener.disable(element);\n    imageRenderedEventDispatcher.disable(element);\n    cameraModifiedEventDispatcher.disable(element);\n    imageSpacingCalibratedEventDispatcher.disable(element);\n    cameraResetEventDispatcher.disable(element);\n    mouseToolEventDispatcher.disable(element);\n    keyboardToolEventDispatcher.disable(element);\n    touchToolEventDispatcher.disable(element);\n    _removeViewportFromSynchronizers(element);\n    _removeViewportFromToolGroup(element);\n    _removeEnabledElement(element);\n}\nconst _removeViewportFromSynchronizers = (element) => {\n    const enabledElement = getEnabledElement(element);\n    const synchronizers = getSynchronizersForViewport(enabledElement.viewportId, enabledElement.renderingEngineId);\n    synchronizers.forEach((sync) => {\n        sync.remove(enabledElement);\n    });\n};\nconst _removeViewportFromToolGroup = (element) => {\n    const { renderingEngineId, viewportId } = getEnabledElement(element);\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (toolGroup) {\n        toolGroup.removeViewports(renderingEngineId, viewportId);\n    }\n};\nconst _removeAllToolsForElement = function (element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    toolsWithData.forEach(({ annotations }) => {\n        annotations.forEach((annotation) => {\n            removeAnnotation(annotation.annotationUID);\n        });\n    });\n};\nfunction _resetSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    delete state.svgNodeCache[elementHash];\n}\nfunction _removeSvgNode(element) {\n    const internalViewportNode = element.querySelector(`div.${VIEWPORT_ELEMENT}`);\n    const svgLayer = internalViewportNode.querySelector('svg');\n    if (svgLayer) {\n        internalViewportNode.removeChild(svgLayer);\n    }\n}\nconst _removeEnabledElement = function (element) {\n    const foundElementIndex = state.enabledElements.findIndex((el) => el === element);\n    if (foundElementIndex > -1) {\n        state.enabledElements.splice(foundElementIndex, 1);\n    }\n};\nexport default removeEnabledElement;\n","import { ToolModes } from '../enums';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nexport default function cancelActiveManipulations(element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    for (const { tool } of toolsWithData) {\n        const annotationUID = tool.cancel(element);\n        if (annotationUID) {\n            return annotationUID;\n        }\n    }\n}\n","import { getRenderingEngine, getEnabledElement, eventTarget, Enums, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nclass Synchronizer {\n    constructor(synchronizerId, eventName, eventHandler, options) {\n        this._viewportOptions = {};\n        this._onEvent = (evt) => {\n            if (this._ignoreFiredEvents === true) {\n                return;\n            }\n            if (!this._targetViewports.length) {\n                return;\n            }\n            const enabledElement = this._eventSource === 'element'\n                ? getEnabledElement(evt.currentTarget)\n                : getEnabledElementByViewportId(evt.detail?.viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { renderingEngineId, viewportId } = enabledElement;\n            if (!this._sourceViewports.find((s) => s.viewportId === viewportId)) {\n                return;\n            }\n            this.fireEvent({\n                renderingEngineId,\n                viewportId,\n            }, evt);\n        };\n        this._enabled = true;\n        this._eventName = eventName;\n        this._eventHandler = eventHandler;\n        this._ignoreFiredEvents = false;\n        this._sourceViewports = [];\n        this._targetViewports = [];\n        this._options = options || {};\n        this._eventSource = this._options.eventSource || 'element';\n        this._auxiliaryEvents = this._options.auxiliaryEvents || [];\n        this.id = synchronizerId;\n    }\n    isDisabled() {\n        return !this._enabled || !this._hasSourceElements();\n    }\n    setOptions(viewportId, options = {}) {\n        this._viewportOptions[viewportId] = options;\n    }\n    setEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    getOptions(viewportId) {\n        return this._viewportOptions[viewportId];\n    }\n    add(viewportInfo) {\n        this.addTarget(viewportInfo);\n        this.addSource(viewportInfo);\n    }\n    addSource(viewportInfo) {\n        if (_containsViewport(this._sourceViewports, viewportInfo)) {\n            return;\n        }\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const viewport = getRenderingEngine(renderingEngineId).getViewport(viewportId);\n        if (!viewport) {\n            console.warn(`Synchronizer.addSource: No viewport for ${renderingEngineId} ${viewportId}`);\n            return;\n        }\n        const eventSource = this._eventSource === 'element' ? viewport.element : eventTarget;\n        eventSource.addEventListener(this._eventName, this._onEvent.bind(this));\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element' ? viewport.element : eventTarget;\n            target.addEventListener(name, this._onEvent.bind(this));\n        });\n        this._updateDisableHandlers();\n        this._sourceViewports.push(viewportInfo);\n    }\n    addTarget(viewportInfo) {\n        if (_containsViewport(this._targetViewports, viewportInfo)) {\n            return;\n        }\n        this._targetViewports.push(viewportInfo);\n        this._updateDisableHandlers();\n    }\n    getSourceViewports() {\n        return this._sourceViewports;\n    }\n    getTargetViewports() {\n        return this._targetViewports;\n    }\n    destroy() {\n        this._sourceViewports.forEach((s) => this.removeSource(s));\n        this._targetViewports.forEach((t) => this.removeTarget(t));\n    }\n    remove(viewportInfo) {\n        this.removeTarget(viewportInfo);\n        this.removeSource(viewportInfo);\n    }\n    removeSource(viewportInfo) {\n        const index = _getViewportIndex(this._sourceViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        const eventSource = this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n        this._sourceViewports.splice(index, 1);\n        eventSource.removeEventListener(this._eventName, this._eventHandler);\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element'\n                ? this.getViewportElement(viewportInfo)\n                : eventTarget;\n            target.removeEventListener(name, this._eventHandler);\n        });\n        this._updateDisableHandlers();\n    }\n    removeTarget(viewportInfo) {\n        const index = _getViewportIndex(this._targetViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        this._targetViewports.splice(index, 1);\n        this._updateDisableHandlers();\n    }\n    hasSourceViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._sourceViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    hasTargetViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._targetViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    fireEvent(sourceViewport, sourceEvent) {\n        if (this.isDisabled() || this._ignoreFiredEvents) {\n            return;\n        }\n        this._ignoreFiredEvents = true;\n        const promises = [];\n        try {\n            for (let i = 0; i < this._targetViewports.length; i++) {\n                const targetViewport = this._targetViewports[i];\n                const targetIsSource = sourceViewport.viewportId === targetViewport.viewportId;\n                if (targetIsSource) {\n                    continue;\n                }\n                const result = this._eventHandler(this, sourceViewport, targetViewport, sourceEvent, this._options);\n                if (result instanceof Promise) {\n                    promises.push(result);\n                }\n            }\n        }\n        catch (ex) {\n            console.warn(`Synchronizer, for: ${this._eventName}`, ex);\n        }\n        finally {\n            if (promises.length) {\n                Promise.allSettled(promises).then(() => {\n                    this._ignoreFiredEvents = false;\n                });\n            }\n            else {\n                this._ignoreFiredEvents = false;\n            }\n        }\n    }\n    _hasSourceElements() {\n        return this._sourceViewports.length !== 0;\n    }\n    _updateDisableHandlers() {\n        const viewports = _getUniqueViewports(this._sourceViewports, this._targetViewports);\n        const _remove = this.remove.bind(this);\n        const disableHandler = (elementDisabledEvent) => {\n            _remove(elementDisabledEvent.detail.element);\n        };\n        viewports.forEach((vp) => {\n            const eventSource = this.getEventSource(vp);\n            if (!eventSource) {\n                return;\n            }\n            eventSource.removeEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n            eventSource.addEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n        });\n    }\n    getEventSource(viewportInfo) {\n        return this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n    }\n    getViewportElement(viewportInfo) {\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        if (!renderingEngine) {\n            return null;\n        }\n        const viewport = renderingEngine.getViewport(viewportId);\n        if (!viewport) {\n            return null;\n        }\n        return viewport.element;\n    }\n}\nfunction _getUniqueViewports(vp1, vp2) {\n    const unique = [];\n    const vps = vp1.concat(vp2);\n    for (let i = 0; i < vps.length; i++) {\n        const vp = vps[i];\n        if (!unique.some((u) => vp.renderingEngineId === u.renderingEngineId &&\n            vp.viewportId === u.viewportId)) {\n            unique.push(vp);\n        }\n    }\n    return unique;\n}\nfunction _getViewportIndex(arr, vp) {\n    return arr.findIndex((ar) => vp.renderingEngineId === ar.renderingEngineId &&\n        vp.viewportId === ar.viewportId);\n}\nfunction _containsViewport(arr, vp) {\n    return arr.some((ar) => ar.renderingEngineId === vp.renderingEngineId &&\n        ar.viewportId === vp.viewportId);\n}\nexport default Synchronizer;\n","import { state } from '../state';\nimport Synchronizer, {} from './Synchronizer';\nfunction createSynchronizer(synchronizerId, eventName, eventHandler, options) {\n    const synchronizerWithSameIdExists = state.synchronizers.some((sync) => sync.id === synchronizerId);\n    if (synchronizerWithSameIdExists) {\n        throw new Error(`Synchronizer with id '${synchronizerId}' already exists.`);\n    }\n    const synchronizer = new Synchronizer(synchronizerId, eventName, eventHandler, options);\n    state.synchronizers.push(synchronizer);\n    return synchronizer;\n}\nexport default createSynchronizer;\n","import { state } from '../state';\nfunction destroy() {\n    while (state.synchronizers.length > 0) {\n        const synchronizer = state.synchronizers.pop();\n        synchronizer.destroy();\n    }\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getSynchronizer(synchronizerId) {\n    return state.synchronizers.find((s) => s.id === synchronizerId);\n}\nexport default getSynchronizer;\n","import { state } from '../state';\nfunction getAllSynchronizers() {\n    return state.synchronizers;\n}\nexport default getAllSynchronizers;\n","import { state } from '../state';\nfunction destroySynchronizer(synchronizerId) {\n    const synchronizerIndex = state.synchronizers.findIndex((sync) => sync.id === synchronizerId);\n    if (synchronizerIndex > -1) {\n        const synchronizer = state.synchronizers[synchronizerIndex];\n        synchronizer.destroy();\n        state.synchronizers.splice(synchronizerIndex, 1);\n    }\n}\nexport default destroySynchronizer;\n","import { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationRepresentationModifiedListener = function (evt) {\n    const { viewportId } = evt.detail;\n    triggerSegmentationRender(viewportId);\n};\nexport default segmentationRepresentationModifiedListener;\n","import { eventTarget, Enums } from '@cornerstonejs/core';\nimport { getAnnotationManager } from './stateManagement/annotation/annotationState';\nimport { Events as TOOLS_EVENTS } from './enums';\nimport { addEnabledElement, removeEnabledElement } from './store';\nimport { resetCornerstoneToolsState } from './store/state';\nimport { annotationCompletedListener, annotationRemovedListener, annotationSelectionListener, annotationModifiedListener, segmentationDataModifiedEventListener, segmentationModifiedListener, } from './eventListeners';\nimport { annotationInterpolationEventDispatcher } from './eventDispatchers';\nimport * as ToolGroupManager from './store/ToolGroupManager';\nimport { defaultSegmentationStateManager } from './stateManagement/segmentation/SegmentationStateManager';\nimport segmentationRepresentationModifiedListener from './eventListeners/segmentation/segmentationRepresentationModifiedListener';\nlet csToolsInitialized = false;\nexport function init(defaultConfiguration = {}) {\n    if (csToolsInitialized) {\n        return;\n    }\n    _addCornerstoneEventListeners();\n    _addCornerstoneToolsEventListeners();\n    csToolsInitialized = true;\n}\nexport function destroy() {\n    _removeCornerstoneEventListeners();\n    _removeCornerstoneToolsEventListeners();\n    ToolGroupManager.destroy();\n    resetCornerstoneToolsState();\n    const annotationManager = getAnnotationManager();\n    const segmentationStateManager = defaultSegmentationStateManager;\n    annotationManager.restoreAnnotations({});\n    segmentationStateManager.resetState();\n    csToolsInitialized = false;\n}\nfunction _addCornerstoneEventListeners() {\n    _removeCornerstoneEventListeners();\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.addEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.addEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.enable();\n}\nfunction _removeCornerstoneEventListeners() {\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.removeEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.removeEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.disable();\n}\nfunction _addCornerstoneToolsEventListeners() {\n    _removeCornerstoneToolsEventListeners();\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_REMOVED, annotationRemovedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nfunction _removeCornerstoneToolsEventListeners() {\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nexport default init;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function cameraSyncCallback(synchronizerInstance, sourceViewport, targetViewport, cameraModifiedEvent) {\n    const { camera } = cameraModifiedEvent.detail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    tViewport.setCamera(camera);\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport cameraSyncCallback from '../callbacks/cameraSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createCameraPositionSynchronizer(synchronizerName) {\n    const cameraPositionSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, cameraSyncCallback);\n    return cameraPositionSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function presentationViewSyncCallback(_synchronizerInstance, sourceViewport, targetViewport, _sourceEvent, options) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const presentationView = sViewport.getViewPresentation(options);\n    tViewport.setViewPresentation(presentationView);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport presentationViewSyncCallback from '../callbacks/presentationViewSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName, options) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, presentationViewSyncCallback, { viewPresentation: options });\n    return presentationView;\n}\n","import { BaseVolumeViewport, getRenderingEngine, StackViewport, } from '@cornerstonejs/core';\nexport default function voiSyncCallback(synchronizerInstance, sourceViewport, targetViewport, modifiedEvent, options) {\n    const eventDetail = modifiedEvent.detail;\n    const { volumeId, range, invertStateChanged, invert, colormap } = eventDetail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`Rendering Engine does not exist: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const tProperties = {\n        voiRange: range,\n    };\n    if (options?.syncInvertState && invertStateChanged) {\n        tProperties.invert = invert;\n    }\n    if (options?.syncColormap && colormap) {\n        tProperties.colormap = colormap;\n    }\n    if (tViewport instanceof BaseVolumeViewport) {\n        const isFusion = tViewport._actors && tViewport._actors.size > 1;\n        if (isFusion) {\n            tViewport.setProperties(tProperties, volumeId);\n        }\n        else {\n            tViewport.setProperties(tProperties);\n        }\n    }\n    else if (tViewport instanceof StackViewport) {\n        tViewport.setProperties(tProperties);\n    }\n    else {\n        throw new Error('Viewport type not supported.');\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport voiSyncCallback from '../callbacks/voiSyncCallback';\nexport default function createVOISynchronizer(synchronizerName, options) {\n    options = Object.assign({ syncInvertState: true, syncColormap: true }, options);\n    const VOISynchronizer = createSynchronizer(synchronizerName, Enums.Events.VOI_MODIFIED, voiSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: Enums.Events.COLORMAP_MODIFIED,\n            },\n        ],\n        ...options,\n    });\n    return VOISynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function zoomPanSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    if (options?.syncZoom !== false) {\n        const srcZoom = sViewport.getZoom();\n        tViewport.setZoom(srcZoom);\n    }\n    if (options?.syncPan !== false) {\n        const srcPan = sViewport.getPan();\n        tViewport.setPan(srcPan);\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport zoomPanSyncCallback from '../callbacks/zoomPanSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createZoomPanSynchronizer(synchronizerName) {\n    const zoomPanSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, zoomPanSyncCallback);\n    return zoomPanSynchronizer;\n}\n","import { vec3, mat4 } from 'gl-matrix';\nimport { getRenderingEngine, metaData, utilities, VolumeViewport, } from '@cornerstonejs/core';\nimport areViewportsCoplanar from './areViewportsCoplanar';\nconst getSpatialRegistration = (targetId, sourceId) => utilities.spatialRegistrationMetadataProvider.get('spatialRegistrationModule', targetId, sourceId);\nexport default async function imageSliceSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    if (options?.disabled) {\n        return;\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const imageId1 = sViewport.getCurrentImageId();\n    const imagePlaneModule1 = metaData.get('imagePlaneModule', imageId1);\n    const sourceImagePositionPatient = imagePlaneModule1.imagePositionPatient;\n    const targetImageIds = tViewport.getImageIds();\n    if (!areViewportsCoplanar(sViewport, tViewport)) {\n        return;\n    }\n    let registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n    if (!registrationMatrixMat4) {\n        const frameOfReferenceUID1 = sViewport.getFrameOfReferenceUID();\n        const frameOfReferenceUID2 = tViewport.getFrameOfReferenceUID();\n        if (frameOfReferenceUID1 === frameOfReferenceUID2 &&\n            options?.useInitialPosition !== false) {\n            registrationMatrixMat4 = mat4.identity(mat4.create());\n        }\n        else {\n            utilities.calculateViewportsSpatialRegistration(sViewport, tViewport);\n            registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n        }\n        if (!registrationMatrixMat4) {\n            return;\n        }\n    }\n    const targetImagePositionPatientWithRegistrationMatrix = vec3.transformMat4(vec3.create(), sourceImagePositionPatient, registrationMatrixMat4);\n    const closestImageIdIndex2 = _getClosestImageIdIndex(targetImagePositionPatientWithRegistrationMatrix, targetImageIds);\n    let imageIndexToSet = closestImageIdIndex2.index;\n    if (tViewport instanceof VolumeViewport) {\n        imageIndexToSet = targetImageIds.length - closestImageIdIndex2.index - 1;\n    }\n    if (closestImageIdIndex2.index !== -1 &&\n        tViewport.getCurrentImageIdIndex() !== closestImageIdIndex2.index) {\n        await utilities.jumpToSlice(tViewport.element, {\n            imageIndex: imageIndexToSet,\n        });\n    }\n}\nfunction _getClosestImageIdIndex(targetPoint, imageIds) {\n    return imageIds.reduce((closestImageIdIndex, imageId, index) => {\n        const { imagePositionPatient } = metaData.get('imagePlaneModule', imageId);\n        const distance = vec3.distance(imagePositionPatient, targetPoint);\n        if (distance < closestImageIdIndex.distance) {\n            return {\n                distance,\n                index,\n            };\n        }\n        return closestImageIdIndex;\n    }, {\n        distance: Infinity,\n        index: -1,\n    });\n}\n","import { vec3 } from 'gl-matrix';\nexport default function areViewportsCoplanar(viewport1, viewport2) {\n    const { viewPlaneNormal: viewPlaneNormal1 } = viewport1.getCamera();\n    const { viewPlaneNormal: viewPlaneNormal2 } = viewport2.getCamera();\n    const dotProducts = vec3.dot(viewPlaneNormal1, viewPlaneNormal2);\n    return Math.abs(dotProducts) > 0.9;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport imageSliceSyncCallback from '../callbacks/imageSliceSyncCallback';\nconst { STACK_NEW_IMAGE, VOLUME_NEW_IMAGE } = Enums.Events;\nexport default function createImageSliceSynchronizer(synchronizerName) {\n    const stackImageSynchronizer = createSynchronizer(synchronizerName, STACK_NEW_IMAGE, imageSliceSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: 'VOLUME_NEW_IMAGE',\n            },\n        ],\n    });\n    return stackImageSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function slabThicknessSyncCallback(_synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const slabThickness = sViewport.getSlabThickness?.();\n    if (!slabThickness) {\n        return;\n    }\n    tViewport.setSlabThickness?.(slabThickness);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport slabThicknessSyncCallback from '../callbacks/slabThicknessSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, slabThicknessSyncCallback);\n    return presentationView;\n}\n","import createCameraPositionSynchronizer from './synchronizers/createCameraPositionSynchronizer';\nimport createPresentationViewSynchronizer from './synchronizers/createPresentationViewSynchronizer';\nimport createVOISynchronizer from './synchronizers/createVOISynchronizer';\nimport createZoomPanSynchronizer from './synchronizers/createZoomPanSynchronizer';\nimport createImageSliceSynchronizer from './synchronizers/createImageSliceSynchronizer';\nimport createSlabThicknessSynchronizer from './synchronizers/createSlabThicknessSynchronizer';\nconst createStackImageSynchronizer = createImageSliceSynchronizer;\nexport { createCameraPositionSynchronizer, createPresentationViewSynchronizer, createVOISynchronizer, createZoomPanSynchronizer, createImageSliceSynchronizer, createStackImageSynchronizer, createSlabThicknessSynchronizer, };\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nclass PanTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        if (deltaPointsWorld[0] === 0 &&\n            deltaPointsWorld[1] === 0 &&\n            deltaPointsWorld[2] === 0) {\n            return;\n        }\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nPanTool.toolName = 'Pan';\nexport default PanTool;\n","import vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { Events } from '../enums';\nimport { eventTarget, getEnabledElement, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass TrackballRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            rotateIncrementDegrees: 2,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this._hasResolutionChanged = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const actorEntry = viewport.getDefaultActor();\n            const actor = actorEntry.actor;\n            const mapper = actor.getMapper();\n            const hasSampleDistance = 'getSampleDistance' in mapper || 'getCurrentSampleDistance' in mapper;\n            if (!hasSampleDistance) {\n                return true;\n            }\n            const originalSampleDistance = mapper.getSampleDistance();\n            if (!this._hasResolutionChanged) {\n                mapper.setSampleDistance(originalSampleDistance * 2);\n                this._hasResolutionChanged = true;\n                if (this.cleanUp !== null) {\n                    document.removeEventListener('mouseup', this.cleanUp);\n                }\n                this.cleanUp = () => {\n                    mapper.setSampleDistance(originalSampleDistance);\n                    viewport.render();\n                    this._hasResolutionChanged = false;\n                };\n                document.addEventListener('mouseup', this.cleanUp, { once: true });\n            }\n            return true;\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.onSetToolActive = () => {\n            const subscribeToElementResize = () => {\n                const viewportsInfo = this._getViewportsInfo();\n                viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                    if (!this._resizeObservers.has(viewportId)) {\n                        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId) || { viewport: null };\n                        if (!viewport) {\n                            return;\n                        }\n                        const { element } = viewport;\n                        const resizeObserver = new ResizeObserver(() => {\n                            const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                            if (!element) {\n                                return;\n                            }\n                            const { viewport } = element;\n                            viewport.resetCamera();\n                            viewport.render();\n                        });\n                        resizeObserver.observe(element);\n                        this._resizeObservers.set(viewportId, resizeObserver);\n                    }\n                });\n            };\n            subscribeToElementResize();\n            this._viewportAddedListener = (evt) => {\n                if (evt.detail.toolGroupId === this.toolGroupId) {\n                    subscribeToElementResize();\n                }\n            };\n            eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n        };\n        this.onSetToolDisabled = () => {\n            this._resizeObservers.forEach((resizeObserver, viewportId) => {\n                resizeObserver.disconnect();\n                this._resizeObservers.delete(viewportId);\n            });\n            if (this._viewportAddedListener) {\n                eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n                this._viewportAddedListener = null;\n            }\n        };\n        this.rotateCamera = (viewport, centerWorld, axis, angle) => {\n            const vtkCamera = viewport.getVtkActiveCamera();\n            const viewUp = vtkCamera.getViewUp();\n            const focalPoint = vtkCamera.getFocalPoint();\n            const position = vtkCamera.getPosition();\n            const newPosition = [0, 0, 0];\n            const newFocalPoint = [0, 0, 0];\n            const newViewUp = [0, 0, 0];\n            const transform = mat4.identity(new Float32Array(16));\n            mat4.translate(transform, transform, centerWorld);\n            mat4.rotate(transform, transform, angle, axis);\n            mat4.translate(transform, transform, [\n                -centerWorld[0],\n                -centerWorld[1],\n                -centerWorld[2],\n            ]);\n            vec3.transformMat4(newPosition, position, transform);\n            vec3.transformMat4(newFocalPoint, focalPoint, transform);\n            mat4.identity(transform);\n            mat4.rotate(transform, transform, angle, axis);\n            vec3.transformMat4(newViewUp, viewUp, transform);\n            viewport.setCamera({\n                position: newPosition,\n                viewUp: newViewUp,\n                focalPoint: newFocalPoint,\n            });\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, lastPoints } = evt.detail;\n        const currentPointsCanvas = currentPoints.canvas;\n        const lastPointsCanvas = lastPoints.canvas;\n        const { rotateIncrementDegrees } = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const normalizedPosition = [\n            currentPointsCanvas[0] / width,\n            currentPointsCanvas[1] / height,\n        ];\n        const normalizedPreviousPosition = [\n            lastPointsCanvas[0] / width,\n            lastPointsCanvas[1] / height,\n        ];\n        const center = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(center);\n        const normalizedCenter = [0.5, 0.5];\n        const radsq = (1.0 + Math.abs(normalizedCenter[0])) ** 2.0;\n        const op = [normalizedPreviousPosition[0], 0, 0];\n        const oe = [normalizedPosition[0], 0, 0];\n        const opsq = op[0] ** 2;\n        const oesq = oe[0] ** 2;\n        const lop = opsq > radsq ? 0 : Math.sqrt(radsq - opsq);\n        const loe = oesq > radsq ? 0 : Math.sqrt(radsq - oesq);\n        const nop = [op[0], 0, lop];\n        vtkMath.normalize(nop);\n        const noe = [oe[0], 0, loe];\n        vtkMath.normalize(noe);\n        const dot = vtkMath.dot(nop, noe);\n        if (Math.abs(dot) > 0.0001) {\n            const angleX = -2 *\n                Math.acos(vtkMath.clampValue(dot, -1.0, 1.0)) *\n                Math.sign(normalizedPosition[0] - normalizedPreviousPosition[0]) *\n                rotateIncrementDegrees;\n            const upVec = camera.viewUp;\n            const atV = camera.viewPlaneNormal;\n            const rightV = [0, 0, 0];\n            const forwardV = [0, 0, 0];\n            vtkMath.cross(upVec, atV, rightV);\n            vtkMath.normalize(rightV);\n            vtkMath.cross(atV, rightV, forwardV);\n            vtkMath.normalize(forwardV);\n            vtkMath.normalize(upVec);\n            this.rotateCamera(viewport, centerWorld, forwardV, angleX);\n            const angleY = (normalizedPreviousPosition[1] - normalizedPosition[1]) *\n                rotateIncrementDegrees;\n            this.rotateCamera(viewport, centerWorld, rightV, angleY);\n            viewport.render();\n        }\n    }\n}\nTrackballRotateTool.toolName = 'TrackballRotate';\nexport default TrackballRotateTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport, cache, utilities, } from '@cornerstonejs/core';\nconst DEFAULT_MULTIPLIER = 4;\nconst DEFAULT_IMAGE_DYNAMIC_RANGE = 1024;\nconst PT = 'PT';\nclass WindowLevelTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this._getImageDynamicRangeFromMiddleSlice = (scalarData, dimensions) => {\n            const middleSliceIndex = Math.floor(dimensions[2] / 2);\n            const frameLength = dimensions[0] * dimensions[1];\n            let bytesPerVoxel;\n            let TypedArrayConstructor;\n            if (scalarData instanceof Float32Array) {\n                bytesPerVoxel = 4;\n                TypedArrayConstructor = Float32Array;\n            }\n            else if (scalarData instanceof Uint8Array) {\n                bytesPerVoxel = 1;\n                TypedArrayConstructor = Uint8Array;\n            }\n            else if (scalarData instanceof Uint16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Uint16Array;\n            }\n            else if (scalarData instanceof Int16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Int16Array;\n            }\n            const buffer = scalarData.buffer;\n            const byteOffset = middleSliceIndex * frameLength * bytesPerVoxel;\n            const frame = new TypedArrayConstructor(buffer, byteOffset, frameLength);\n            const { max, min } = this._getMinMax(frame, frameLength);\n            return max - min;\n        };\n    }\n    touchDragCallback(evt) {\n        this.mouseDragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let volumeId, lower, upper, modality, newRange, viewportsContainingVolumeUID;\n        let isPreScaled = false;\n        const properties = viewport.getProperties();\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n            viewportsContainingVolumeUID =\n                utilities.getViewportsWithVolumeId(volumeId);\n            ({ lower, upper } = properties.voiRange);\n            const volume = cache.getVolume(volumeId);\n            if (!volume) {\n                throw new Error('Volume not found ' + volumeId);\n            }\n            modality = volume.metadata.Modality;\n            isPreScaled = volume.scaling && Object.keys(volume.scaling).length > 0;\n        }\n        else if (properties.voiRange) {\n            modality = viewport.modality;\n            ({ lower, upper } = properties.voiRange);\n            const { preScale = { scaled: false } } = viewport.getImageData?.() || {};\n            isPreScaled =\n                preScale.scaled && preScale.scalingParameters?.suvbw !== undefined;\n        }\n        else {\n            throw new Error('Viewport is not a valid type');\n        }\n        if (modality === PT && isPreScaled) {\n            newRange = this.getPTScaledNewRange({\n                deltaPointsCanvas: deltaPoints.canvas,\n                lower,\n                upper,\n                clientHeight: element.clientHeight,\n                isPreScaled,\n                viewport,\n                volumeId,\n            });\n        }\n        else {\n            newRange = this.getNewRange({\n                viewport,\n                deltaPointsCanvas: deltaPoints.canvas,\n                volumeId,\n                lower,\n                upper,\n            });\n        }\n        if (newRange.lower >= newRange.upper) {\n            return;\n        }\n        viewport.setProperties({\n            voiRange: newRange,\n        });\n        viewport.render();\n        if (viewport instanceof VolumeViewport) {\n            viewportsContainingVolumeUID.forEach((vp) => {\n                if (viewport !== vp) {\n                    vp.render();\n                }\n            });\n            return;\n        }\n    }\n    getPTScaledNewRange({ deltaPointsCanvas, lower, upper, clientHeight, viewport, volumeId, isPreScaled, }) {\n        let multiplier = DEFAULT_MULTIPLIER;\n        if (isPreScaled) {\n            multiplier = 5 / clientHeight;\n        }\n        else {\n            multiplier =\n                this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n                    DEFAULT_MULTIPLIER;\n        }\n        const deltaY = deltaPointsCanvas[1];\n        const wcDelta = deltaY * multiplier;\n        upper -= wcDelta;\n        upper = isPreScaled ? Math.max(upper, 0.1) : upper;\n        return { lower, upper };\n    }\n    getNewRange({ viewport, deltaPointsCanvas, volumeId, lower, upper }) {\n        const multiplier = this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n            DEFAULT_MULTIPLIER;\n        const wwDelta = deltaPointsCanvas[0] * multiplier;\n        const wcDelta = deltaPointsCanvas[1] * multiplier;\n        let { windowWidth, windowCenter } = utilities.windowLevel.toWindowLevel(lower, upper);\n        windowWidth += wwDelta;\n        windowCenter += wcDelta;\n        windowWidth = Math.max(windowWidth, 1);\n        return utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n    }\n    _getMultiplierFromDynamicRange(viewport, volumeId) {\n        let imageDynamicRange;\n        if (volumeId) {\n            const imageVolume = cache.getVolume(volumeId);\n            const { voxelManager } = viewport.getImageData();\n            const middleSlicePixelData = voxelManager.getMiddleSliceData();\n            const calculatedDynamicRange = middleSlicePixelData.reduce((acc, pixel) => {\n                return [Math.min(acc[0], pixel), Math.max(acc[1], pixel)];\n            }, [Infinity, -Infinity]);\n            const BitsStored = imageVolume?.metadata?.BitsStored;\n            const metadataDynamicRange = BitsStored ? 2 ** BitsStored : Infinity;\n            imageDynamicRange = Math.min(calculatedDynamicRange, metadataDynamicRange);\n        }\n        else {\n            imageDynamicRange = this._getImageDynamicRangeFromViewport(viewport);\n        }\n        const ratio = imageDynamicRange / DEFAULT_IMAGE_DYNAMIC_RANGE;\n        return ratio > 1 ? Math.round(ratio) : ratio;\n    }\n    _getImageDynamicRangeFromViewport(viewport) {\n        const { imageData, voxelManager } = viewport.getImageData();\n        if (voxelManager?.getRange) {\n            const range = voxelManager.getRange();\n            return range[1] - range[0];\n        }\n        const dimensions = imageData.getDimensions();\n        if (imageData.getRange) {\n            const imageDataRange = imageData.getRange();\n            return imageDataRange[1] - imageDataRange[0];\n        }\n        let scalarData;\n        if (imageData.getScalarData) {\n            scalarData = imageData.getScalarData();\n        }\n        else {\n            scalarData = imageData.getPointData().getScalars().getData();\n        }\n        if (dimensions[2] !== 1) {\n            return this._getImageDynamicRangeFromMiddleSlice(scalarData, dimensions);\n        }\n        let range;\n        if (scalarData.getRange) {\n            range = scalarData.getRange();\n        }\n        else {\n            const { min, max } = this._getMinMax(scalarData, scalarData.length);\n            range = [min, max];\n        }\n        return range[1] - range[0];\n    }\n    _getMinMax(frame, frameLength) {\n        let min = Infinity;\n        let max = -Infinity;\n        for (let i = 0; i < frameLength; i++) {\n            const voxel = frame[i];\n            if (voxel < min) {\n                min = voxel;\n            }\n            if (voxel > max) {\n                max = voxel;\n            }\n        }\n        return { max, min };\n    }\n}\nWindowLevelTool.toolName = 'WindowLevel';\nexport default WindowLevelTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawRect as drawRectSvg } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { windowLevel } from '../utilities/voi';\nclass WindowLevelRegionTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minWindowWidth: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            removeAnnotation(annotation.annotationUID);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationCompleted(annotation);\n            this.applyWindowLevelRegion(annotation, element);\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            const DEFAULT_HANDLE_INDEX = 3;\n            points[DEFAULT_HANDLE_INDEX] = [...worldPos];\n            const bottomLeftCanvas = worldToCanvas(points[0]);\n            const topRightCanvas = worldToCanvas(points[3]);\n            const bottomRightCanvas = [\n                topRightCanvas[0],\n                bottomLeftCanvas[1],\n            ];\n            const topLeftCanvas = [\n                bottomLeftCanvas[0],\n                topRightCanvas[1],\n            ];\n            const bottomRightWorld = canvasToWorld(bottomRightCanvas);\n            const topLeftWorld = canvasToWorld(topLeftCanvas);\n            points[1] = bottomRightWorld;\n            points[2] = topLeftWorld;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this.applyWindowLevelRegion = (annotation, element) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const imageData = windowLevel.extractWindowLevelRegionToolData(viewport);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const startCanvas = canvasCoordinates[0];\n            const endCanvas = canvasCoordinates[3];\n            let left = Math.min(startCanvas[0], endCanvas[0]);\n            let top = Math.min(startCanvas[1], endCanvas[1]);\n            let width = Math.abs(startCanvas[0] - endCanvas[0]);\n            let height = Math.abs(startCanvas[1] - endCanvas[1]);\n            left = utilities.clip(left, 0, imageData.width);\n            top = utilities.clip(top, 0, imageData.height);\n            width = Math.floor(Math.min(width, Math.abs(imageData.width - left)));\n            height = Math.floor(Math.min(height, Math.abs(imageData.height - top)));\n            const pixelLuminanceData = windowLevel.getLuminanceFromRegion(imageData, Math.round(left), Math.round(top), width, height);\n            const minMaxMean = windowLevel.calculateMinMaxMean(pixelLuminanceData, imageData.minPixelValue, imageData.maxPixelValue);\n            if (this.configuration.minWindowWidth === undefined) {\n                this.configuration.minWindowWidth = 10;\n            }\n            const windowWidth = Math.max(Math.abs(minMaxMean.max - minMaxMean.min), this.configuration.minWindowWidth);\n            const windowCenter = minMaxMean.mean;\n            const voiRange = utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n            viewport.setProperties({ voiRange });\n            viewport.render();\n        };\n        this.cancel = () => {\n            return null;\n        };\n        this.isPointNearTool = () => {\n            return null;\n        };\n        this.toolSelectedCallback = () => {\n            return null;\n        };\n        this.handleSelectedCallback = () => {\n            return null;\n        };\n        this._activateModify = () => {\n            return null;\n        };\n        this._deactivateModify = () => {\n            return null;\n        };\n    }\n}\nWindowLevelRegionTool.toolName = 'WindowLevelRegion';\nexport default WindowLevelRegionTool;\n","import { getEnabledElementByIds, getEnabledElement, VolumeViewport, BaseVolumeViewport, utilities, } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass StackScrollTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            invert: false,\n            debounceIfNotLoaded: true,\n            loop: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.deltaY = 1;\n    }\n    mouseWheelCallback(evt) {\n        this._scroll(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        this._scrollDrag(evt);\n    }\n    _scrollDrag(evt) {\n        const { deltaPoints, viewportId, renderingEngineId } = evt.detail;\n        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n        const { debounceIfNotLoaded, invert, loop } = this.configuration;\n        const deltaPointY = deltaPoints.canvas[1];\n        let volumeId;\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n        }\n        const pixelsPerImage = this._getPixelPerImage(viewport);\n        const deltaY = deltaPointY + this.deltaY;\n        if (!pixelsPerImage) {\n            return;\n        }\n        if (Math.abs(deltaY) >= pixelsPerImage) {\n            const imageIdIndexOffset = Math.round(deltaY / pixelsPerImage);\n            utilities.scroll(viewport, {\n                delta: invert ? -imageIdIndexOffset : imageIdIndexOffset,\n                volumeId,\n                debounceLoading: debounceIfNotLoaded,\n                loop: loop,\n            });\n            this.deltaY = deltaY % pixelsPerImage;\n        }\n        else {\n            this.deltaY = deltaY;\n        }\n    }\n    _scroll(evt) {\n        const { wheel, element } = evt.detail;\n        const { direction } = wheel;\n        const { invert } = this.configuration;\n        const { viewport } = getEnabledElement(element);\n        const delta = direction * (invert ? -1 : 1);\n        utilities.scroll(viewport, {\n            delta,\n            debounceLoading: this.configuration.debounceIfNotLoaded,\n            loop: this.configuration.loop,\n            volumeId: viewport instanceof BaseVolumeViewport\n                ? viewport.getVolumeId()\n                : undefined,\n            scrollSlabs: this.configuration.scrollSlabs,\n        });\n    }\n    _getPixelPerImage(viewport) {\n        const { element } = viewport;\n        const numberOfSlices = viewport.getNumberOfSlices();\n        return Math.max(2, element.offsetHeight / Math.max(numberOfSlices, 8));\n    }\n}\nStackScrollTool.toolName = 'StackScroll';\nexport default StackScrollTool;\n","import { BaseVolumeViewport, getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport angleBetweenLines from '../utilities/math/angle/angleBetweenLines';\nclass PlanarRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseWheelCallback = (evt) => {\n            const { element, wheel } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { invert } = this.configuration;\n            const angle = wheel.direction * 10 * (invert ? -1 : 1);\n            this.setAngle(viewport, angle);\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, startPoints } = evt.detail;\n        const currentPointWorld = currentPoints.world;\n        const startPointWorld = startPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const centerCanvas = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(centerCanvas);\n        let angle = angleBetweenLines([startPointWorld, centerWorld], [centerWorld, currentPointWorld]);\n        const { viewPlaneNormal } = camera;\n        const v1 = vec3.sub(vec3.create(), centerWorld, startPointWorld);\n        const v2 = vec3.sub(vec3.create(), centerWorld, currentPointWorld);\n        const cross = vec3.cross(vec3.create(), v1, v2);\n        if (vec3.dot(viewPlaneNormal, cross) > 0) {\n            angle = -angle;\n        }\n        if (Number.isNaN(angle)) {\n            return;\n        }\n        this.setAngle(viewport, angle);\n    }\n    setAngle(viewport, angle) {\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        if (viewport instanceof BaseVolumeViewport) {\n            const rotAngle = (((angle + 360) % 360) * Math.PI) / 180;\n            const rotMat = mat4.identity(new Float32Array(16));\n            mat4.rotate(rotMat, rotMat, rotAngle, viewPlaneNormal);\n            const rotatedViewUp = vec3.transformMat4(vec3.create(), viewUp, rotMat);\n            viewport.setCamera({ viewUp: rotatedViewUp });\n        }\n        else {\n            const { rotation } = viewport.getViewPresentation();\n            viewport.setViewPresentation({\n                rotation: (rotation + angle + 360) % 360,\n            });\n        }\n        viewport.render();\n    }\n}\nPlanarRotateTool.toolName = 'PlanarRotate';\nexport default PlanarRotateTool;\n","import { vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass ZoomTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            zoomToCenter: false,\n            minZoomScale: 0.001,\n            maxZoomScale: 3000,\n            pinchToZoom: true,\n            pan: true,\n            invert: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const camera = enabledElement.viewport.getCamera();\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            return false;\n        };\n        this.preTouchStartCallback = (evt) => {\n            if (!this.configuration.pinchToZoom) {\n                return this.preMouseDownCallback(evt);\n            }\n        };\n        this._dragParallelProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { parallelScale, focalPoint, position } = camera;\n            const zoomScale = 5 / size[1];\n            const k = deltaY * zoomScale * (this.configuration.invert ? -1 : 1);\n            const parallelScaleToSet = (1.0 - k) * parallelScale;\n            let focalPointToSet = focalPoint;\n            let positionToSet = position;\n            if (!this.configuration.zoomToCenter) {\n                const distanceToCanvasCenter = vec3.distance(focalPoint, this.initialMousePosWorld);\n                positionToSet = vec3.scaleAndAdd(vec3.create(), position, this.dirVec, -distanceToCanvasCenter * k);\n                focalPointToSet = vec3.scaleAndAdd(vec3.create(), focalPoint, this.dirVec, -distanceToCanvasCenter * k);\n            }\n            const imageData = viewport.getImageData();\n            let spacing = [1, 1, 1];\n            if (imageData) {\n                spacing = imageData.spacing;\n            }\n            const { minZoomScale, maxZoomScale } = this.configuration;\n            const t = element.clientHeight * spacing[1] * 0.5;\n            const scale = t / parallelScaleToSet;\n            let cappedParallelScale = parallelScaleToSet;\n            let thresholdExceeded = false;\n            if (imageData) {\n                if (scale < minZoomScale) {\n                    cappedParallelScale = t / minZoomScale;\n                    thresholdExceeded = true;\n                }\n                else if (scale >= maxZoomScale) {\n                    cappedParallelScale = t / maxZoomScale;\n                    thresholdExceeded = true;\n                }\n            }\n            viewport.setCamera({\n                parallelScale: cappedParallelScale,\n                focalPoint: thresholdExceeded ? focalPoint : focalPointToSet,\n                position: thresholdExceeded ? position : positionToSet,\n            });\n        };\n        this._dragPerspectiveProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { position, focalPoint, viewPlaneNormal } = camera;\n            const distance = vtkMath.distance2BetweenPoints(position, focalPoint);\n            const zoomScale = Math.sqrt(distance) / size[1];\n            const directionOfProjection = [\n                -viewPlaneNormal[0],\n                -viewPlaneNormal[1],\n                -viewPlaneNormal[2],\n            ];\n            const k = this.configuration.invert\n                ? deltaY / zoomScale\n                : deltaY * zoomScale;\n            let tmp = k * directionOfProjection[0];\n            position[0] += tmp;\n            focalPoint[0] += tmp;\n            tmp = k * directionOfProjection[1];\n            position[1] += tmp;\n            focalPoint[1] += tmp;\n            tmp = k * directionOfProjection[2];\n            position[2] += tmp;\n            focalPoint[2] += tmp;\n            viewport.setCamera({ position, focalPoint });\n        };\n        this.initialMousePosWorld = [0, 0, 0];\n        this.dirVec = [0, 0, 0];\n        if (this.configuration.pinchToZoom) {\n            this.touchDragCallback = this._pinchCallback.bind(this);\n        }\n        else {\n            this.touchDragCallback = this._dragCallback.bind(this);\n        }\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _pinchCallback(evt) {\n        const pointsList = evt.detail\n            .currentPointsList;\n        if (pointsList.length > 1) {\n            const { element, currentPoints } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const worldPos = currentPoints.world;\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            if (camera.parallelProjection) {\n                this._dragParallelProjection(evt, viewport, camera, true);\n            }\n            else {\n                this._dragPerspectiveProjection(evt, viewport, camera, true);\n            }\n            viewport.render();\n        }\n        if (this.configuration.pan) {\n            this._panCallback(evt);\n        }\n    }\n    _dragCallback(evt) {\n        const { element } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        if (camera.parallelProjection) {\n            this._dragParallelProjection(evt, viewport, camera);\n        }\n        else {\n            this._dragPerspectiveProjection(evt, viewport, camera);\n        }\n        viewport.render();\n    }\n    _panCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nZoomTool.toolName = 'Zoom';\nexport default ZoomTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { getPointInLineOfSightWithCriteria } from '../utilities/planar';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass MIPJumpToClickTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            targetViewportIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseClickCallback(evt) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const volumeId = viewport.getVolumeId();\n        if (!volumeId) {\n            throw new Error(`MIPJumpToClickTool: targetId is not a volumeId, you should only use MIPJumpToClickTool with a volumeId as the targetId`);\n        }\n        let maxIntensity = -Infinity;\n        const maxFn = (intensity, point) => {\n            if (intensity > maxIntensity) {\n                maxIntensity = intensity;\n                return point;\n            }\n        };\n        const brightestPoint = getPointInLineOfSightWithCriteria(viewport, currentPoints.world, volumeId, maxFn);\n        if (!brightestPoint || !brightestPoint.length) {\n            return;\n        }\n        const { targetViewportIds, toolGroupId } = this.configuration;\n        const viewports = renderingEngine.getViewports().filter((vp) => {\n            if (targetViewportIds?.indexOf(vp.id) >= 0) {\n                return true;\n            }\n            const foundToolGroup = getToolGroupForViewport(vp.id, renderingEngine.id);\n            if (toolGroupId && toolGroupId === foundToolGroup?.id) {\n                return true;\n            }\n            return false;\n        });\n        viewports.forEach((viewport) => {\n            if (viewport instanceof VolumeViewport) {\n                viewport.jumpToWorld(brightestPoint);\n            }\n            else {\n                console.warn('Cannot jump to specified world coordinates for a viewport that is not a VolumeViewport');\n            }\n        });\n    }\n}\nMIPJumpToClickTool.toolName = 'MIPJumpToClickTool';\nexport default MIPJumpToClickTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport vtkMatrixBuilder from '@kitware/vtk.js/Common/Core/MatrixBuilder';\nimport { AnnotationTool } from './base';\nimport { getEnabledElementByIds, getEnabledElement, utilities as csUtils, Enums, CONSTANTS, } from '@cornerstonejs/core';\nimport { getToolGroup, getToolGroupForViewport, } from '../store/ToolGroupManager';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLine as drawLineSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport liangBarksyClip from '../utilities/math/vec2/liangBarksyClip';\nimport * as lineSegment from '../utilities/math/line';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nconst { RENDERING_DEFAULTS } = CONSTANTS;\nfunction defaultReferenceLineColor() {\n    return 'rgb(0, 200, 0)';\n}\nfunction defaultReferenceLineControllable() {\n    return true;\n}\nfunction defaultReferenceLineDraggableRotatable() {\n    return true;\n}\nfunction defaultReferenceLineSlabThicknessControlsOn() {\n    return true;\n}\nconst OPERATION = {\n    DRAG: 1,\n    ROTATE: 2,\n    SLAB: 3,\n};\nconst EPSILON = 1e-3;\nclass CrosshairsTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse'],\n        configuration: {\n            shadow: true,\n            viewportIndicators: false,\n            viewportIndicatorsConfig: {\n                radius: 5,\n                x: null,\n                y: null,\n            },\n            autoPan: {\n                enabled: false,\n                panSize: 10,\n            },\n            referenceLinesCenterGapRadius: 20,\n            filterActorUIDsToSetSlabThickness: [],\n            slabThicknessBlendMode: Enums.BlendModes.MAXIMUM_INTENSITY_BLEND,\n            mobile: {\n                enabled: false,\n                opacity: 0.8,\n                handleRadius: 9,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.toolCenter = [0, 0, 0];\n        this.initializeViewport = ({ renderingEngineId, viewportId, }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { FrameOfReferenceUID, viewport } = enabledElement;\n            const { element } = viewport;\n            const { position, focalPoint, viewPlaneNormal } = viewport.getCamera();\n            let annotations = this._getAnnotations(enabledElement);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (annotations.length) {\n                removeAnnotation(annotations[0].annotationUID);\n            }\n            const annotation = {\n                highlighted: false,\n                metadata: {\n                    cameraPosition: [...position],\n                    cameraFocalPoint: [...focalPoint],\n                    FrameOfReferenceUID,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    handles: {\n                        rotationPoints: [],\n                        slabThicknessPoints: [],\n                        toolCenter: this.toolCenter,\n                    },\n                    activeOperation: null,\n                    activeViewportIds: [],\n                    viewportId,\n                },\n            };\n            addAnnotation(annotation, element);\n            return {\n                normal: viewPlaneNormal,\n                point: viewport.canvasToWorld([\n                    viewport.canvas.clientWidth / 2,\n                    viewport.canvas.clientHeight / 2,\n                ]),\n            };\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resetCrosshairs = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            for (const viewportInfo of viewportsInfo) {\n                const { viewportId, renderingEngineId } = viewportInfo;\n                const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n                const viewport = enabledElement.viewport;\n                const resetPan = true;\n                const resetZoom = true;\n                const resetToCenter = true;\n                const resetRotation = true;\n                const suppressEvents = true;\n                viewport.resetCamera({\n                    resetPan,\n                    resetZoom,\n                    resetToCenter,\n                    resetRotation,\n                    suppressEvents,\n                });\n                viewport.resetSlabThickness();\n                const { element } = viewport;\n                let annotations = this._getAnnotations(enabledElement);\n                annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n                if (annotations.length) {\n                    removeAnnotation(annotations[0].annotationUID);\n                }\n                viewport.render();\n            }\n            this._computeToolCenter(viewportsInfo);\n        };\n        this.computeToolCenter = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._computeToolCenter = (viewportsInfo) => {\n            if (!viewportsInfo.length || viewportsInfo.length === 1) {\n                console.warn('For crosshairs to operate, at least two viewports must be given.');\n                return;\n            }\n            const [firstViewport, secondViewport, thirdViewport] = viewportsInfo;\n            const { normal: normal1, point: point1 } = this.initializeViewport(firstViewport);\n            const { normal: normal2, point: point2 } = this.initializeViewport(secondViewport);\n            let normal3 = [0, 0, 0];\n            let point3 = vec3.create();\n            if (thirdViewport) {\n                ({ normal: normal3, point: point3 } =\n                    this.initializeViewport(thirdViewport));\n            }\n            else {\n                vec3.add(point3, point1, point2);\n                vec3.scale(point3, point3, 0.5);\n                vec3.cross(normal3, normal1, normal2);\n            }\n            const firstPlane = csUtils.planar.planeEquation(normal1, point1);\n            const secondPlane = csUtils.planar.planeEquation(normal2, point2);\n            const thirdPlane = csUtils.planar.planeEquation(normal3, point3);\n            this.toolCenter = csUtils.planar.threePlaneIntersection(firstPlane, secondPlane, thirdPlane);\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const jumpWorld = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this._jump(enabledElement, jumpWorld);\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(viewport.element, annotations);\n            const { data } = filteredAnnotations[0];\n            const { rotationPoints } = data.handles;\n            const viewportIdArray = [];\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                if (!viewportControllable || !viewportDraggableRotatable) {\n                    continue;\n                }\n                viewportIdArray.push(otherViewport.id);\n                i++;\n            }\n            data.activeViewportIds = [...viewportIdArray];\n            data.handles.activeOperation = OPERATION.DRAG;\n            evt.preventDefault();\n            hideElementCursor(element);\n            this._activateModify(element);\n            return filteredAnnotations[0];\n        };\n        this.cancel = () => {\n            console.log('Not implemented yet');\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            if (this._pointNearTool(element, annotation, canvasCoords, 6)) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const viewport = enabledElement.viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const currentCamera = viewport.getCamera();\n            const oldCameraPosition = viewportAnnotation.metadata.cameraPosition;\n            const deltaCameraPosition = [0, 0, 0];\n            vtkMath.subtract(currentCamera.position, oldCameraPosition, deltaCameraPosition);\n            const oldCameraFocalPoint = viewportAnnotation.metadata.cameraFocalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(currentCamera.focalPoint, oldCameraFocalPoint, deltaCameraFocalPoint);\n            viewportAnnotation.metadata.cameraPosition = [...currentCamera.position];\n            viewportAnnotation.metadata.cameraFocalPoint = [\n                ...currentCamera.focalPoint,\n            ];\n            const viewportControllable = this._getReferenceLineControllable(viewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(viewport.id);\n            if (!csUtils.isEqual(currentCamera.position, oldCameraPosition, 1e-3) &&\n                viewportControllable &&\n                viewportDraggableRotatable) {\n                let isRotation = false;\n                const cameraModifiedSameForPosAndFocalPoint = csUtils.isEqual(deltaCameraPosition, deltaCameraFocalPoint, 1e-3);\n                if (!cameraModifiedSameForPosAndFocalPoint) {\n                    isRotation = true;\n                }\n                const cameraModifiedInPlane = Math.abs(vtkMath.dot(deltaCameraPosition, currentCamera.viewPlaneNormal)) < 1e-2;\n                if (!isRotation && !cameraModifiedInPlane) {\n                    this.toolCenter[0] += deltaCameraPosition[0];\n                    this.toolCenter[1] += deltaCameraPosition[1];\n                    this.toolCenter[2] += deltaCameraPosition[2];\n                }\n            }\n            if (this.configuration.autoPan?.enabled) {\n                const toolGroup = getToolGroupForViewport(viewport.id, renderingEngine.id);\n                const otherViewportIds = toolGroup\n                    .getViewportIds()\n                    .filter((id) => id !== viewport.id);\n                otherViewportIds.forEach((viewportId) => {\n                    this._autoPanViewportIfNecessary(viewportId, renderingEngine);\n                });\n            }\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onResetCamera = (evt) => {\n            this.resetCrosshairs();\n        };\n        this.mouseMoveCallback = (evt, filteredToolAnnotations) => {\n            const { element, currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            let imageNeedsUpdate = false;\n            for (let i = 0; i < filteredToolAnnotations.length; i++) {\n                const annotation = filteredToolAnnotations[i];\n                if (isAnnotationLocked(annotation.annotationUID)) {\n                    continue;\n                }\n                const { data, highlighted } = annotation;\n                if (!data.handles) {\n                    continue;\n                }\n                const previousActiveOperation = data.handles.activeOperation;\n                const previousActiveViewportIds = data.activeViewportIds && data.activeViewportIds.length > 0\n                    ? [...data.activeViewportIds]\n                    : [];\n                data.activeViewportIds = [];\n                data.handles.activeOperation = null;\n                const handleNearImagePoint = this.getHandleNearImagePoint(element, annotation, canvasCoords, 6);\n                let near = false;\n                if (handleNearImagePoint) {\n                    near = true;\n                }\n                else {\n                    near = this._pointNearTool(element, annotation, canvasCoords, 6);\n                }\n                const nearToolAndNotMarkedActive = near && !highlighted;\n                const notNearToolAndMarkedActive = !near && highlighted;\n                if (nearToolAndNotMarkedActive || notNearToolAndMarkedActive) {\n                    annotation.highlighted = !highlighted;\n                    imageNeedsUpdate = true;\n                }\n                else if (data.handles.activeOperation !== previousActiveOperation ||\n                    !this._areViewportIdArraysEqual(data.activeViewportIds, previousActiveViewportIds)) {\n                    imageNeedsUpdate = true;\n                }\n            }\n            return imageNeedsUpdate;\n        };\n        this.filterInteractableAnnotationsForElement = (element, annotations) => {\n            if (!annotations || !annotations.length) {\n                return [];\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewportId } = enabledElement;\n            const viewportUIDSpecificCrosshairs = annotations.filter((annotation) => annotation.data.viewportId === viewportId);\n            return viewportUIDSpecificCrosshairs;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, renderingEngine } = enabledElement;\n            const { element } = viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const camera = viewport.getCamera();\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!annotations?.length || !viewportAnnotation?.data) {\n                return renderStatus;\n            }\n            const annotationUID = viewportAnnotation.annotationUID;\n            const { clientWidth, clientHeight } = viewport.canvas;\n            const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n            const canvasMinDimensionLength = Math.min(clientWidth, clientHeight);\n            const data = viewportAnnotation.data;\n            const crosshairCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n            const otherViewportAnnotations = this._filterAnnotationsByUniqueViewportOrientations(enabledElement, annotations);\n            const referenceLines = [];\n            const canvasBox = [0, 0, clientWidth, clientHeight];\n            otherViewportAnnotations.forEach((annotation) => {\n                const { data } = annotation;\n                data.handles.toolCenter = this.toolCenter;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                const { clientWidth, clientHeight } = otherViewport.canvas;\n                const otherCanvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n                const otherCanvasCenter = [\n                    clientWidth * 0.5,\n                    clientHeight * 0.5,\n                ];\n                const otherViewportCenterWorld = otherViewport.canvasToWorld(otherCanvasCenter);\n                const direction = [0, 0, 0];\n                vtkMath.cross(camera.viewPlaneNormal, otherCamera.viewPlaneNormal, direction);\n                vtkMath.normalize(direction);\n                vtkMath.multiplyScalar(direction, otherCanvasDiagonalLength);\n                const pointWorld0 = [0, 0, 0];\n                vtkMath.add(otherViewportCenterWorld, direction, pointWorld0);\n                const pointWorld1 = [0, 0, 0];\n                vtkMath.subtract(otherViewportCenterWorld, direction, pointWorld1);\n                const pointCanvas0 = viewport.worldToCanvas(pointWorld0);\n                const otherViewportCenterCanvas = viewport.worldToCanvas(otherViewportCenterWorld);\n                const canvasUnitVectorFromCenter = vec2.create();\n                vec2.subtract(canvasUnitVectorFromCenter, pointCanvas0, otherViewportCenterCanvas);\n                vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n                const canvasVectorFromCenterLong = vec2.create();\n                vec2.scale(canvasVectorFromCenterLong, canvasUnitVectorFromCenter, canvasDiagonalLength * 100);\n                const canvasVectorFromCenterMid = vec2.create();\n                vec2.scale(canvasVectorFromCenterMid, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.4);\n                const canvasVectorFromCenterShort = vec2.create();\n                vec2.scale(canvasVectorFromCenterShort, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.2);\n                const canvasVectorFromCenterStart = vec2.create();\n                const centerGap = this.configuration.referenceLinesCenterGapRadius;\n                vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, otherViewportAnnotations.length === 2 ? centerGap : 0);\n                const refLinePointOne = vec2.create();\n                const refLinePointTwo = vec2.create();\n                const refLinePointThree = vec2.create();\n                const refLinePointFour = vec2.create();\n                let refLinesCenter = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable || !otherViewportControllable) {\n                    refLinesCenter = vec2.clone(otherViewportCenterCanvas);\n                }\n                vec2.add(refLinePointOne, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.add(refLinePointTwo, refLinesCenter, canvasVectorFromCenterLong);\n                vec2.subtract(refLinePointThree, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.subtract(refLinePointFour, refLinesCenter, canvasVectorFromCenterLong);\n                liangBarksyClip(refLinePointOne, refLinePointTwo, canvasBox);\n                liangBarksyClip(refLinePointThree, refLinePointFour, canvasBox);\n                const rotHandleOne = vec2.create();\n                vec2.subtract(rotHandleOne, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                const rotHandleTwo = vec2.create();\n                vec2.add(rotHandleTwo, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                let stHandlesCenterCanvas = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterCanvas = vec2.clone(otherViewportCenterCanvas);\n                }\n                let stHandlesCenterWorld = [...this.toolCenter];\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterWorld = [...otherViewportCenterWorld];\n                }\n                const worldUnitVectorFromCenter = [0, 0, 0];\n                vtkMath.subtract(pointWorld0, pointWorld1, worldUnitVectorFromCenter);\n                vtkMath.normalize(worldUnitVectorFromCenter);\n                const { viewPlaneNormal } = camera;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromDegree()\n                    .rotate(90, viewPlaneNormal);\n                const worldUnitOrthoVectorFromCenter = [0, 0, 0];\n                vec3.transformMat4(worldUnitOrthoVectorFromCenter, worldUnitVectorFromCenter, matrix);\n                const slabThicknessValue = otherViewport.getSlabThickness();\n                const worldOrthoVectorFromCenter = [\n                    ...worldUnitOrthoVectorFromCenter,\n                ];\n                vtkMath.multiplyScalar(worldOrthoVectorFromCenter, slabThicknessValue);\n                const worldVerticalRefPoint = [0, 0, 0];\n                vtkMath.add(stHandlesCenterWorld, worldOrthoVectorFromCenter, worldVerticalRefPoint);\n                const canvasVerticalRefPoint = viewport.worldToCanvas(worldVerticalRefPoint);\n                const canvasOrthoVectorFromCenter = vec2.create();\n                vec2.subtract(canvasOrthoVectorFromCenter, stHandlesCenterCanvas, canvasVerticalRefPoint);\n                const stLinePointOne = vec2.create();\n                vec2.subtract(stLinePointOne, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointOne, stLinePointOne, canvasOrthoVectorFromCenter);\n                const stLinePointTwo = vec2.create();\n                vec2.add(stLinePointTwo, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointTwo, stLinePointTwo, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointOne, stLinePointTwo, canvasBox);\n                const stLinePointThree = vec2.create();\n                vec2.add(stLinePointThree, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointThree, stLinePointThree, canvasOrthoVectorFromCenter);\n                const stLinePointFour = vec2.create();\n                vec2.subtract(stLinePointFour, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointFour, stLinePointFour, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointThree, stLinePointFour, canvasBox);\n                const stHandleOne = vec2.create();\n                const stHandleTwo = vec2.create();\n                const stHandleThree = vec2.create();\n                const stHandleFour = vec2.create();\n                vec2.subtract(stHandleOne, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleOne, stHandleOne, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleTwo, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleTwo, stHandleTwo, canvasOrthoVectorFromCenter);\n                vec2.subtract(stHandleThree, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleThree, stHandleThree, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleFour, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleFour, stHandleFour, canvasOrthoVectorFromCenter);\n                referenceLines.push([\n                    otherViewport,\n                    refLinePointOne,\n                    refLinePointTwo,\n                    refLinePointThree,\n                    refLinePointFour,\n                    stLinePointOne,\n                    stLinePointTwo,\n                    stLinePointThree,\n                    stLinePointFour,\n                    rotHandleOne,\n                    rotHandleTwo,\n                    stHandleOne,\n                    stHandleTwo,\n                    stHandleThree,\n                    stHandleFour,\n                ]);\n            });\n            const newRtpoints = [];\n            const newStpoints = [];\n            const viewportColor = this._getReferenceLineColor(viewport.id);\n            const color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n            referenceLines.forEach((line, lineIndex) => {\n                const otherViewport = line[0];\n                const viewportColor = this._getReferenceLineColor(otherViewport.id);\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const selectedViewportId = data.activeViewportIds.find((id) => id === otherViewport.id);\n                let color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                let lineWidth = 1;\n                const lineActive = data.handles.activeOperation !== null &&\n                    data.handles.activeOperation === OPERATION.DRAG &&\n                    selectedViewportId;\n                if (lineActive) {\n                    lineWidth = 2.5;\n                }\n                let lineUID = `${lineIndex}`;\n                if (viewportControllable && viewportDraggableRotatable) {\n                    lineUID = `${lineIndex}One`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[1], line[2], {\n                        color,\n                        lineWidth,\n                    });\n                    lineUID = `${lineIndex}Two`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[3], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                else {\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[2], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                if (viewportControllable) {\n                    color =\n                        viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                    const rotHandlesActive = data.handles.activeOperation === OPERATION.ROTATE;\n                    const rotationHandles = [line[9], line[10]];\n                    const rotHandleWorldOne = [\n                        viewport.canvasToWorld(line[9]),\n                        otherViewport,\n                        line[1],\n                        line[2],\n                    ];\n                    const rotHandleWorldTwo = [\n                        viewport.canvasToWorld(line[10]),\n                        otherViewport,\n                        line[3],\n                        line[4],\n                    ];\n                    newRtpoints.push(rotHandleWorldOne, rotHandleWorldTwo);\n                    const slabThicknessHandlesActive = data.handles.activeOperation === OPERATION.SLAB;\n                    const slabThicknessHandles = [line[11], line[12], line[13], line[14]];\n                    const slabThicknessHandleWorldOne = [\n                        viewport.canvasToWorld(line[11]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldTwo = [\n                        viewport.canvasToWorld(line[12]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldThree = [\n                        viewport.canvasToWorld(line[13]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    const slabThicknessHandleWorldFour = [\n                        viewport.canvasToWorld(line[14]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    newStpoints.push(slabThicknessHandleWorldOne, slabThicknessHandleWorldTwo, slabThicknessHandleWorldThree, slabThicknessHandleWorldFour);\n                    if ((lineActive || this.configuration.mobile?.enabled) &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable &&\n                        viewportSlabThicknessControlsOn) {\n                        let handleUID = `${lineIndex}One`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                        handleUID = `${lineIndex}Two`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (lineActive &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                    }\n                    else if (selectedViewportId &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportSlabThicknessControlsOn) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (rotHandlesActive && viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'circle',\n                        });\n                    }\n                    else if (slabThicknessHandlesActive &&\n                        selectedViewportId &&\n                        viewportSlabThicknessControlsOn) {\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, lineUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'rect',\n                        });\n                    }\n                    const slabThicknessValue = otherViewport.getSlabThickness();\n                    if (slabThicknessValue > 0.5 && viewportSlabThicknessControlsOn) {\n                        lineUID = `${lineIndex}STOne`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[5], line[6], {\n                            color,\n                            width: 1,\n                            lineDash: [2, 3],\n                        });\n                        lineUID = `${lineIndex}STTwo`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[7], line[8], {\n                            color,\n                            width: line,\n                            lineDash: [2, 3],\n                        });\n                    }\n                }\n            });\n            renderStatus = true;\n            data.handles.rotationPoints = newRtpoints;\n            data.handles.slabThicknessPoints = newStpoints;\n            if (this.configuration.viewportIndicators) {\n                const { viewportIndicatorsConfig } = this.configuration;\n                const xOffset = viewportIndicatorsConfig?.xOffset || 0.95;\n                const yOffset = viewportIndicatorsConfig?.yOffset || 0.05;\n                const referenceColorCoordinates = [\n                    clientWidth * xOffset,\n                    clientHeight * yOffset,\n                ];\n                const circleRadius = viewportIndicatorsConfig?.circleRadius || canvasDiagonalLength * 0.01;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, referenceColorCoordinates, circleRadius, { color, fill: color });\n            }\n            return renderStatus;\n        };\n        this._getAnnotations = (enabledElement) => {\n            const { viewport } = enabledElement;\n            const annotations = getAnnotations(this.getToolName(), viewport.element) || [];\n            const viewportIds = this._getViewportsInfo().map(({ viewportId }) => viewportId);\n            const toolGroupAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                return viewportIds.includes(data.viewportId);\n            });\n            return toolGroupAnnotations;\n        };\n        this._onNewVolume = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._areViewportIdArraysEqual = (viewportIdArrayOne, viewportIdArrayTwo) => {\n            if (viewportIdArrayOne.length !== viewportIdArrayTwo.length) {\n                return false;\n            }\n            viewportIdArrayOne.forEach((id) => {\n                let itemFound = false;\n                for (let i = 0; i < viewportIdArrayTwo.length; ++i) {\n                    if (id === viewportIdArrayTwo[i]) {\n                        itemFound = true;\n                        break;\n                    }\n                }\n                if (itemFound === false) {\n                    return false;\n                }\n            });\n            return true;\n        };\n        this._getAnnotationsForViewportsWithDifferentCameras = (enabledElement, annotations) => {\n            const { viewportId, renderingEngine, viewport } = enabledElement;\n            const otherViewportAnnotations = annotations.filter((annotation) => annotation.data.viewportId !== viewportId);\n            if (!otherViewportAnnotations || !otherViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, position } = camera;\n            const viewportsWithDifferentCameras = otherViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const targetViewport = renderingEngine.getViewport(viewportId);\n                const cameraOfTarget = targetViewport.getCamera();\n                return !(csUtils.isEqual(cameraOfTarget.viewPlaneNormal, viewPlaneNormal, 1e-2) && csUtils.isEqual(cameraOfTarget.position, position, 1));\n            });\n            return viewportsWithDifferentCameras;\n        };\n        this._filterViewportWithSameOrientation = (enabledElement, referenceAnnotation, annotations) => {\n            const { renderingEngine } = enabledElement;\n            const { data } = referenceAnnotation;\n            const viewport = renderingEngine.getViewport(data.viewportId);\n            const linkedViewportAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return otherViewportControllable === true;\n            });\n            if (!linkedViewportAnnotations || !linkedViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherViewportsAnnotationsWithSameCameraDirection = linkedViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                return (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) &&\n                    csUtils.isEqual(camera.viewUp, otherCamera.viewUp, 1e-2));\n            });\n            return otherViewportsAnnotationsWithSameCameraDirection;\n        };\n        this._filterAnnotationsByUniqueViewportOrientations = (enabledElement, annotations) => {\n            const { renderingEngine, viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable === true);\n            });\n            const otherViewportsAnnotationsWithUniqueCameras = [];\n            for (let i = 0; i < otherLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherNonLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable !== true);\n            });\n            for (let i = 0; i < otherNonLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherNonLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            for (let i = 0; i < otherViewportAnnotations.length; ++i) {\n                const annotation = otherViewportAnnotations[i];\n                if (otherViewportsAnnotationsWithUniqueCameras.some((element) => element === annotation)) {\n                    continue;\n                }\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            return otherViewportsAnnotationsWithUniqueCameras;\n        };\n        this._checkIfViewportsRenderingSameScene = (viewport, otherViewport) => {\n            const volumeIds = viewport.getAllVolumeIds();\n            const otherVolumeIds = otherViewport.getAllVolumeIds();\n            return (volumeIds.length === otherVolumeIds.length &&\n                volumeIds.every((id) => otherVolumeIds.includes(id)));\n        };\n        this._jump = (enabledElement, jumpWorld) => {\n            state.isInteractingWithTool = true;\n            const { viewport, renderingEngine } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const delta = [0, 0, 0];\n            vtkMath.subtract(jumpWorld, this.toolCenter, delta);\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const sameScene = this._checkIfViewportsRenderingSameScene(viewport, otherViewport);\n                return (this._getReferenceLineControllable(otherViewport.id) &&\n                    this._getReferenceLineDraggableRotatable(otherViewport.id) &&\n                    sameScene);\n            });\n            if (viewportsAnnotationsToUpdate.length === 0) {\n                state.isInteractingWithTool = false;\n                return false;\n            }\n            this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            state.isInteractingWithTool = false;\n            return true;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = !this.configuration.mobile?.enabled;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this.editData.annotation.data.handles.activeOperation = null;\n            this.editData.annotation.data.activeViewportIds = [];\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const delta = eventDetail.deltaPoints.world;\n            if (Math.abs(delta[0]) < 1e-3 &&\n                Math.abs(delta[1]) < 1e-3 &&\n                Math.abs(delta[2]) < 1e-3) {\n                return;\n            }\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const { handles } = viewportAnnotation.data;\n            const { currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            if (handles.activeOperation === OPERATION.DRAG) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            }\n            else if (handles.activeOperation === OPERATION.ROTATE) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true);\n                });\n                const dir1 = vec2.create();\n                const dir2 = vec2.create();\n                const center = [\n                    this.toolCenter[0],\n                    this.toolCenter[1],\n                    this.toolCenter[2],\n                ];\n                const centerCanvas = viewport.worldToCanvas(center);\n                const finalPointCanvas = eventDetail.currentPoints.canvas;\n                const originalPointCanvas = vec2.create();\n                vec2.sub(originalPointCanvas, finalPointCanvas, eventDetail.deltaPoints.canvas);\n                vec2.sub(dir1, originalPointCanvas, centerCanvas);\n                vec2.sub(dir2, finalPointCanvas, centerCanvas);\n                let angle = vec2.angle(dir1, dir2);\n                if (this._isClockWise(centerCanvas, originalPointCanvas, finalPointCanvas)) {\n                    angle *= -1;\n                }\n                angle = Math.round(angle * 100) / 100;\n                const rotationAxis = viewport.getCamera().viewPlaneNormal;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromRadian()\n                    .translate(center[0], center[1], center[2])\n                    .rotate(angle, rotationAxis)\n                    .translate(-center[0], -center[1], -center[2]);\n                const otherViewportsIds = [];\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    data.handles.toolCenter = center;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const { viewUp, position, focalPoint } = camera;\n                    viewUp[0] += position[0];\n                    viewUp[1] += position[1];\n                    viewUp[2] += position[2];\n                    vec3.transformMat4(focalPoint, focalPoint, matrix);\n                    vec3.transformMat4(position, position, matrix);\n                    vec3.transformMat4(viewUp, viewUp, matrix);\n                    viewUp[0] -= position[0];\n                    viewUp[1] -= position[1];\n                    viewUp[2] -= position[2];\n                    otherViewport.setCamera({\n                        position,\n                        viewUp,\n                        focalPoint,\n                    });\n                    otherViewportsIds.push(otherViewport.id);\n                });\n                renderingEngine.renderViewports(otherViewportsIds);\n            }\n            else if (handles.activeOperation === OPERATION.SLAB) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const referenceAnnotations = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportSlabThicknessControlsOn === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                if (referenceAnnotations.length === 0) {\n                    return;\n                }\n                const viewportsAnnotationsToUpdate = this._filterViewportWithSameOrientation(enabledElement, referenceAnnotations[0], annotations);\n                const viewportsIds = [];\n                viewportsIds.push(viewport.id);\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const normal = camera.viewPlaneNormal;\n                    const dotProd = vtkMath.dot(delta, normal);\n                    const projectedDelta = [...normal];\n                    vtkMath.multiplyScalar(projectedDelta, dotProd);\n                    if (Math.abs(projectedDelta[0]) > 1e-3 ||\n                        Math.abs(projectedDelta[1]) > 1e-3 ||\n                        Math.abs(projectedDelta[2]) > 1e-3) {\n                        const mod = Math.sqrt(projectedDelta[0] * projectedDelta[0] +\n                            projectedDelta[1] * projectedDelta[1] +\n                            projectedDelta[2] * projectedDelta[2]);\n                        const currentPoint = eventDetail.lastPoints.world;\n                        const direction = [0, 0, 0];\n                        const currentCenter = [\n                            this.toolCenter[0],\n                            this.toolCenter[1],\n                            this.toolCenter[2],\n                        ];\n                        const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                        if (!viewportDraggableRotatable) {\n                            const { rotationPoints } = this.editData.annotation.data.handles;\n                            const otherViewportRotationPoints = rotationPoints.filter((point) => point[1].uid === otherViewport.id);\n                            if (otherViewportRotationPoints.length === 2) {\n                                const point1 = viewport.canvasToWorld(otherViewportRotationPoints[0][3]);\n                                const point2 = viewport.canvasToWorld(otherViewportRotationPoints[1][3]);\n                                vtkMath.add(point1, point2, currentCenter);\n                                vtkMath.multiplyScalar(currentCenter, 0.5);\n                            }\n                        }\n                        vtkMath.subtract(currentPoint, currentCenter, direction);\n                        const dotProdDirection = vtkMath.dot(direction, normal);\n                        const projectedDirection = [...normal];\n                        vtkMath.multiplyScalar(projectedDirection, dotProdDirection);\n                        const normalizedProjectedDirection = [\n                            projectedDirection[0],\n                            projectedDirection[1],\n                            projectedDirection[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDirection, normalizedProjectedDirection);\n                        const normalizedProjectedDelta = [\n                            projectedDelta[0],\n                            projectedDelta[1],\n                            projectedDelta[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDelta, normalizedProjectedDelta);\n                        let slabThicknessValue = otherViewport.getSlabThickness();\n                        if (csUtils.isOpposite(normalizedProjectedDirection, normalizedProjectedDelta, 1e-3)) {\n                            slabThicknessValue -= mod;\n                        }\n                        else {\n                            slabThicknessValue += mod;\n                        }\n                        slabThicknessValue = Math.abs(slabThicknessValue);\n                        slabThicknessValue = Math.max(RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS, slabThicknessValue);\n                        const near = this._pointNearReferenceLine(viewportAnnotation, canvasCoords, 6, otherViewport);\n                        if (near) {\n                            slabThicknessValue = RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;\n                        }\n                        const toolGroup = getToolGroupForViewport(otherViewport.id, renderingEngine.id);\n                        const crosshairsInstance = toolGroup.getToolInstance(this.getToolName());\n                        crosshairsInstance.setSlabThickness(otherViewport, slabThicknessValue);\n                        viewportsIds.push(otherViewport.id);\n                    }\n                });\n                renderingEngine.renderViewports(viewportsIds);\n            }\n        };\n        this._pointNearReferenceLine = (annotation, canvasCoords, proximity, lineViewport) => {\n            const { data } = annotation;\n            const { rotationPoints } = data.handles;\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                if (otherViewport.id !== lineViewport.id) {\n                    continue;\n                }\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                if (!viewportControllable) {\n                    continue;\n                }\n                const lineSegment1 = {\n                    start: {\n                        x: rotationPoints[i][2][0],\n                        y: rotationPoints[i][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i][3][0],\n                        y: rotationPoints[i][3][1],\n                    },\n                };\n                const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n                const lineSegment2 = {\n                    start: {\n                        x: rotationPoints[i + 1][2][0],\n                        y: rotationPoints[i + 1][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i + 1][3][0],\n                        y: rotationPoints[i + 1][3][1],\n                    },\n                };\n                const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n                if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                    return true;\n                }\n                i++;\n            }\n            return false;\n        };\n        this._getReferenceLineColor =\n            toolProps.configuration?.getReferenceLineColor ||\n                defaultReferenceLineColor;\n        this._getReferenceLineControllable =\n            toolProps.configuration?.getReferenceLineControllable ||\n                defaultReferenceLineControllable;\n        this._getReferenceLineDraggableRotatable =\n            toolProps.configuration?.getReferenceLineDraggableRotatable ||\n                defaultReferenceLineDraggableRotatable;\n        this._getReferenceLineSlabThicknessControlsOn =\n            toolProps.configuration?.getReferenceLineSlabThicknessControlsOn ||\n                defaultReferenceLineSlabThicknessControlsOn;\n    }\n    onSetToolActive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        this._subscribeToViewportNewVolumeSet(viewportsInfo);\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolPassive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolEnabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolDisabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const annotations = this._getAnnotations(enabledElement);\n            if (annotations?.length) {\n                annotations.forEach((annotation) => {\n                    removeAnnotation(annotation.annotationUID);\n                });\n            }\n        });\n    }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let point = this._getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n        point = this._getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n    }\n    _unsubscribeToViewportNewVolumeSet(viewportsInfo) {\n        viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _subscribeToViewportNewVolumeSet(viewports) {\n        viewports.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _autoPanViewportIfNecessary(viewportId, renderingEngine) {\n        const viewport = renderingEngine.getViewport(viewportId);\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const toolCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n        const pan = this.configuration.autoPan.panSize;\n        const visiblePointCanvas = [\n            toolCenterCanvas[0],\n            toolCenterCanvas[1],\n        ];\n        if (toolCenterCanvas[0] < 0) {\n            visiblePointCanvas[0] = pan;\n        }\n        else if (toolCenterCanvas[0] > clientWidth) {\n            visiblePointCanvas[0] = clientWidth - pan;\n        }\n        if (toolCenterCanvas[1] < 0) {\n            visiblePointCanvas[1] = pan;\n        }\n        else if (toolCenterCanvas[1] > clientHeight) {\n            visiblePointCanvas[1] = clientHeight - pan;\n        }\n        if (visiblePointCanvas[0] === toolCenterCanvas[0] &&\n            visiblePointCanvas[1] === toolCenterCanvas[1]) {\n            return;\n        }\n        const visiblePointWorld = viewport.canvasToWorld(visiblePointCanvas);\n        const deltaPointsWorld = [\n            visiblePointWorld[0] - this.toolCenter[0],\n            visiblePointWorld[1] - this.toolCenter[1],\n            visiblePointWorld[2] - this.toolCenter[2],\n        ];\n        const camera = viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        viewport.render();\n    }\n    setSlabThickness(viewport, slabThickness) {\n        let actorUIDs;\n        const { filterActorUIDsToSetSlabThickness } = this.configuration;\n        if (filterActorUIDsToSetSlabThickness &&\n            filterActorUIDsToSetSlabThickness.length > 0) {\n            actorUIDs = filterActorUIDsToSetSlabThickness;\n        }\n        let blendModeToUse = this.configuration.slabThicknessBlendMode;\n        if (slabThickness === RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS) {\n            blendModeToUse = Enums.BlendModes.COMPOSITE;\n        }\n        const immediate = false;\n        viewport.setBlendMode(blendModeToUse, actorUIDs, immediate);\n        viewport.setSlabThickness(slabThickness, actorUIDs);\n    }\n    _isClockWise(a, b, c) {\n        return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]) > 0;\n    }\n    _applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta) {\n        viewportsAnnotationsToUpdate.forEach((annotation) => {\n            this._applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta);\n        });\n    }\n    _applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta) {\n        const { data } = annotation;\n        const viewport = renderingEngine.getViewport(data.viewportId);\n        const camera = viewport.getCamera();\n        const normal = camera.viewPlaneNormal;\n        const dotProd = vtkMath.dot(delta, normal);\n        const projectedDelta = [...normal];\n        vtkMath.multiplyScalar(projectedDelta, dotProd);\n        if (Math.abs(projectedDelta[0]) > 1e-3 ||\n            Math.abs(projectedDelta[1]) > 1e-3 ||\n            Math.abs(projectedDelta[2]) > 1e-3) {\n            const newFocalPoint = [0, 0, 0];\n            const newPosition = [0, 0, 0];\n            vtkMath.add(camera.focalPoint, projectedDelta, newFocalPoint);\n            vtkMath.add(camera.position, projectedDelta, newPosition);\n            viewport.setCamera({\n                focalPoint: newFocalPoint,\n                position: newPosition,\n            });\n            viewport.render();\n        }\n    }\n    _getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        for (let i = 0; i < rotationPoints.length; i++) {\n            const point = rotationPoints[i][0];\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportDraggableRotatable) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.ROTATE;\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { slabThicknessPoints } = data.handles;\n        for (let i = 0; i < slabThicknessPoints.length; i++) {\n            const point = slabThicknessPoints[i][0];\n            const otherViewport = slabThicknessPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.SLAB;\n                data.activeViewportIds = [otherViewport.id];\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _pointNearTool(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        const { slabThicknessPoints } = data.handles;\n        const viewportIdArray = [];\n        for (let i = 0; i < rotationPoints.length - 1; ++i) {\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportControllable || !viewportDraggableRotatable) {\n                continue;\n            }\n            const lineSegment1 = {\n                start: {\n                    x: rotationPoints[i][2][0],\n                    y: rotationPoints[i][2][1],\n                },\n                end: {\n                    x: rotationPoints[i][3][0],\n                    y: rotationPoints[i][3][1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: rotationPoints[i + 1][2][0],\n                    y: rotationPoints[i + 1][2][1],\n                },\n                end: {\n                    x: rotationPoints[i + 1][3][0],\n                    y: rotationPoints[i + 1][3][1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = OPERATION.DRAG;\n            }\n            i++;\n        }\n        for (let i = 0; i < slabThicknessPoints.length - 1; ++i) {\n            const otherViewport = slabThicknessPoints[i][1];\n            if (viewportIdArray.find((id) => id === otherViewport.id)) {\n                continue;\n            }\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportControllable || !viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const stPointLineCanvas1 = slabThicknessPoints[i][2];\n            const stPointLineCanvas2 = slabThicknessPoints[i][3];\n            const centerCanvas = vec2.create();\n            vec2.add(centerCanvas, stPointLineCanvas1, stPointLineCanvas2);\n            vec2.scale(centerCanvas, centerCanvas, 0.5);\n            const canvasUnitVectorFromCenter = vec2.create();\n            vec2.subtract(canvasUnitVectorFromCenter, stPointLineCanvas1, centerCanvas);\n            vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n            const canvasVectorFromCenterStart = vec2.create();\n            vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, canvasDiagonalLength * 0.05);\n            const stPointLineCanvas1Start = vec2.create();\n            const stPointLineCanvas2Start = vec2.create();\n            vec2.add(stPointLineCanvas1Start, centerCanvas, canvasVectorFromCenterStart);\n            vec2.subtract(stPointLineCanvas2Start, centerCanvas, canvasVectorFromCenterStart);\n            const lineSegment1 = {\n                start: {\n                    x: stPointLineCanvas1Start[0],\n                    y: stPointLineCanvas1Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas1[0],\n                    y: stPointLineCanvas1[1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: stPointLineCanvas2Start[0],\n                    y: stPointLineCanvas2Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas2[0],\n                    y: stPointLineCanvas2[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = null;\n            }\n            i++;\n        }\n        data.activeViewportIds = [...viewportIdArray];\n        this.editData = {\n            annotation,\n        };\n        return data.handles.activeOperation === OPERATION.DRAG ? true : false;\n    }\n}\nCrosshairsTool.toolName = 'Crosshairs';\nexport default CrosshairsTool;\n","import { BaseTool } from './base';\nimport { Events } from '../enums';\nimport { getEnabledElement, StackViewport } from '@cornerstonejs/core';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { state } from '../store/state';\nimport { Enums } from '@cornerstonejs/core';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nconst MAGNIFY_VIEWPORT_ID = 'magnify-viewport';\nclass MagnifyTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            magnifySize: 10,\n            magnifyWidth: 250,\n            magnifyHeight: 250,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._hasBeenRemoved = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('MagnifyTool only works on StackViewports');\n            }\n            const referencedImageId = this._getReferencedImageId(viewport);\n            if (!referencedImageId) {\n                throw new Error('MagnifyTool: No referenced image id found, reconstructed planes not supported yet');\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                referencedImageId,\n                viewportIdsToRender,\n                enabledElement,\n                renderingEngine,\n                currentPoints,\n            };\n            this._createMagnificationViewport();\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this.preTouchStartCallback = (evt) => {\n            this.preMouseDownCallback(evt);\n        };\n        this._createMagnificationViewport = () => {\n            const { enabledElement, referencedImageId, viewportIdsToRender, renderingEngine, currentPoints, } = this.editData;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const viewportProperties = viewport.getProperties();\n            const { canvas: canvasPos, world: worldPos } = currentPoints;\n            let magnifyToolElement;\n            magnifyToolElement = element.querySelector('.magnifyTool');\n            if (magnifyToolElement === null) {\n                const magnifyElement = document.createElement('div');\n                magnifyElement.classList.add('magnifyTool');\n                magnifyElement.style.display = 'block';\n                magnifyElement.style.width = `${this.configuration.magnifyWidth}px`;\n                magnifyElement.style.height = `${this.configuration.magnifyHeight}px`;\n                magnifyElement.style.position = 'absolute';\n                magnifyToolElement = magnifyElement;\n                const viewportElement = element.querySelector('.viewport-element');\n                viewportElement.appendChild(magnifyElement);\n                const viewportInput = {\n                    viewportId: MAGNIFY_VIEWPORT_ID,\n                    type: Enums.ViewportType.STACK,\n                    element: magnifyToolElement,\n                };\n                renderingEngine.enableElement(viewportInput);\n            }\n            magnifyToolElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyToolElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            magnifyViewport.setStack([referencedImageId]).then(() => {\n                if (this._hasBeenRemoved) {\n                    return;\n                }\n                magnifyViewport.setProperties(viewportProperties);\n                const { parallelScale } = viewport.getCamera();\n                const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n                const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n                    Math.pow(focalPoint[1] - position[1], 2) +\n                    Math.pow(focalPoint[2] - position[2], 2));\n                const updatedFocalPoint = [\n                    worldPos[0],\n                    worldPos[1],\n                    worldPos[2],\n                ];\n                const updatedPosition = [\n                    updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n                    updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n                    updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n                ];\n                magnifyViewport.setCamera({\n                    parallelScale: parallelScale * (1 / this.configuration.magnifySize),\n                    focalPoint: updatedFocalPoint,\n                    position: updatedPosition,\n                });\n                magnifyViewport.render();\n            });\n            magnifyToolElement.style.display = 'block';\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { deltaPoints, element, currentPoints } = eventDetail;\n            const deltaPointsWorld = deltaPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            const magnifyElement = element.querySelector('.magnifyTool');\n            if (!magnifyElement) {\n                return;\n            }\n            magnifyElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const { focalPoint, position } = magnifyViewport.getCamera();\n            const updatedPosition = [\n                position[0] + deltaPointsWorld[0],\n                position[1] + deltaPointsWorld[1],\n                position[2] + deltaPointsWorld[2],\n            ];\n            const updatedFocalPoint = [\n                focalPoint[0] + deltaPointsWorld[0],\n                focalPoint[1] + deltaPointsWorld[1],\n                focalPoint[2] + deltaPointsWorld[2],\n            ];\n            magnifyViewport.setCamera({\n                focalPoint: updatedFocalPoint,\n                position: updatedPosition,\n            });\n            magnifyViewport.render();\n        };\n        this._dragEndCallback = (evt) => {\n            const { element } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            renderingEngine.disableElement(MAGNIFY_VIEWPORT_ID);\n            const viewportElement = element.querySelector('.viewport-element');\n            const magnifyToolElement = viewportElement.querySelector('.magnifyTool');\n            viewportElement.removeChild(magnifyToolElement);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this._hasBeenRemoved = true;\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            this._hasBeenRemoved = false;\n            element.addEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n    }\n    _getReferencedImageId(viewport) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId;\n        if (viewport instanceof StackViewport) {\n            referencedImageId = targetId.split('imageId:')[1];\n        }\n        return referencedImageId;\n    }\n}\nMagnifyTool.toolName = 'Magnify';\nexport default MagnifyTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities as csUtils, eventTarget, Enums, getRenderingEngine, CONSTANTS, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { addAnnotation, getAllAnnotations, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events, MouseBindings, KeyboardBindings, Events as cstEvents, SegmentationRepresentations, ToolModes, } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../utilities/math/circle';\nimport { vec2, vec3 } from 'gl-matrix';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nimport debounce from '../utilities/debounce';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { addSegmentationRepresentations } from '../stateManagement/segmentation';\nconst MAGNIFY_CLASSNAME = 'advancedMagnifyTool';\nconst MAGNIFY_VIEWPORT_INITIAL_RADIUS = 125;\nconst { Events: csEvents } = Enums;\nconst isSegmentation = (actor) => actor.uid !== actor.referencedId;\nvar AdvancedMagnifyToolActions;\n(function (AdvancedMagnifyToolActions) {\n    AdvancedMagnifyToolActions[\"ShowZoomFactorsList\"] = \"showZoomFactorsList\";\n})(AdvancedMagnifyToolActions || (AdvancedMagnifyToolActions = {}));\nconst ADVANCED_MAGNIFY_TOOL_NAME = 'AdvancedMagnify';\nconst PARALLEL_THRESHOLD = 1 - CONSTANTS.EPSILON;\nclass AdvancedMagnifyTool extends AnnotationTool {\n    static { this.Actions = AdvancedMagnifyToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            magnifyingGlass: {\n                radius: 125,\n                zoomFactor: 3,\n                zoomFactorList: [1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5],\n                autoPan: {\n                    enabled: true,\n                    padding: 10,\n                },\n            },\n            actions: {\n                showZoomFactorsList: {\n                    method: 'showZoomFactorsList',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Secondary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const { magnifyingGlass: config } = this.configuration;\n            const { radius, zoomFactor, autoPan } = config;\n            const canvasHandlePoints = this._getCanvasHandlePoints(canvasPos, radius);\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotationUID = csUtils.uuidv4();\n            const magnifyViewportId = csUtils.uuidv4();\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                annotationUID,\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    sourceViewportId: viewport.id,\n                    magnifyViewportId,\n                    zoomFactor,\n                    isCanvasAnnotation: true,\n                    handles: {\n                        points: canvasHandlePoints,\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            this.magnifyViewportManager.createViewport(annotation, {\n                magnifyViewportId,\n                sourceEnabledElement: enabledElement,\n                position: canvasPos,\n                radius,\n                zoomFactor,\n                autoPan: {\n                    enabled: autoPan.enabled,\n                    padding: autoPan.padding,\n                    callback: (data) => {\n                        const annotationPoints = annotation.data.handles.points;\n                        const { canvas: canvasDelta } = data.delta;\n                        for (let i = 0, len = annotationPoints.length; i < len; i++) {\n                            const point = annotationPoints[i];\n                            point[0] += canvasDelta[0];\n                            point[1] += canvasDelta[1];\n                            annotation.invalidated = true;\n                        }\n                    },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.onSetToolDisabled = () => {\n            this.magnifyViewportManager.dispose();\n            const annotations = getAllAnnotations();\n            annotations.forEach((annotation) => {\n                if (annotation.metadata.toolName === this.getToolName()) {\n                    removeAnnotation(annotation.annotationUID);\n                }\n            });\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const center = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const radiusPoint = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radiusPoint - radius) < proximity * 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            const { points } = data.handles;\n            const handleIndex = points.findIndex((p) => p === handle);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { deltaPoints } = eventDetail;\n            const canvasDelta = deltaPoints?.canvas ?? [0, 0, 0];\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { points } = annotation.data.handles;\n            points.forEach((point) => {\n                point[0] += canvasDelta[0];\n                point[1] += canvasDelta[1];\n            });\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const canvasDelta = deltaPoints.canvas;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += canvasDelta[0];\n                    point[1] += canvasDelta[1];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const canvasCenter = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const newRadius = getCanvasCircleRadius([\n                canvasCenter,\n                currentCanvasPoints,\n            ]);\n            const newCanvasHandlePoints = this._getCanvasHandlePoints(canvasCenter, newRadius);\n            points[0] = newCanvasHandlePoints[0];\n            points[1] = newCanvasHandlePoints[1];\n            points[2] = newCanvasHandlePoints[2];\n            points[3] = newCanvasHandlePoints[3];\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = annotations?.filter((annotation) => annotation.data.sourceViewportId ===\n                viewport.id);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!filteredAnnotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < filteredAnnotations.length; i++) {\n                const annotation = filteredAnnotations[i];\n                const { annotationUID, data } = annotation;\n                const { magnifyViewportId, zoomFactor, handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points;\n                const canvasTop = canvasCoordinates[0];\n                const canvasBottom = canvasCoordinates[2];\n                const canvasLeft = canvasCoordinates[3];\n                const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n                const center = [\n                    canvasLeft[0] + radius,\n                    canvasTop[1] + radius,\n                ];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-advancedMagnify`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineWidth: 5,\n                }, dataId);\n                const magnifyViewport = this.magnifyViewportManager.getViewport(magnifyViewportId);\n                magnifyViewport.position = center;\n                magnifyViewport.radius = radius;\n                magnifyViewport.zoomFactor = zoomFactor;\n                magnifyViewport.update();\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._getCanvasHandlePoints = (canvasCenterPos, canvasRadius) => {\n            return [\n                [canvasCenterPos[0], canvasCenterPos[1] - canvasRadius, 0],\n                [canvasCenterPos[0] + canvasRadius, canvasCenterPos[1], 0],\n                [canvasCenterPos[0], canvasCenterPos[1] + canvasRadius, 0],\n                [canvasCenterPos[0] - canvasRadius, canvasCenterPos[1], 0],\n            ];\n        };\n        this.magnifyViewportManager = AdvancedMagnifyViewportManager.getInstance();\n    }\n    showZoomFactorsList(evt, annotation) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvas: canvasPoint } = currentPoints;\n        const viewportElement = element.querySelector(':scope .viewport-element');\n        const currentZoomFactor = annotation.data.zoomFactor;\n        const remove = () => dropdown.parentElement.removeChild(dropdown);\n        const dropdown = this._getZoomFactorsListDropdown(currentZoomFactor, (newZoomFactor) => {\n            if (newZoomFactor !== undefined) {\n                annotation.data.zoomFactor = Number.parseFloat(newZoomFactor);\n                annotation.invalidated = true;\n            }\n            remove();\n            viewport.render();\n        });\n        Object.assign(dropdown.style, {\n            left: `${canvasPoint[0]}px`,\n            top: `${canvasPoint[1]}px`,\n        });\n        viewportElement.appendChild(dropdown);\n        dropdown.focus();\n    }\n    _getZoomFactorsListDropdown(currentZoomFactor, onChangeCallback) {\n        const { zoomFactorList } = this.configuration.magnifyingGlass;\n        const dropdown = document.createElement('select');\n        dropdown.size = 5;\n        Object.assign(dropdown.style, {\n            width: '50px',\n            position: 'absolute',\n        });\n        ['mousedown', 'mouseup', 'mousemove', 'click'].forEach((eventName) => {\n            dropdown.addEventListener(eventName, (evt) => evt.stopPropagation());\n        });\n        dropdown.addEventListener('change', (evt) => {\n            evt.stopPropagation();\n            onChangeCallback(dropdown.value);\n        });\n        dropdown.addEventListener('keydown', (evt) => {\n            const shouldCancel = (evt.keyCode ?? evt.which === 27) ||\n                evt.key?.toLowerCase() === 'escape';\n            if (shouldCancel) {\n                evt.stopPropagation();\n                onChangeCallback();\n            }\n        });\n        zoomFactorList.forEach((zoomFactor) => {\n            const option = document.createElement('option');\n            option.label = zoomFactor;\n            option.title = `Zoom factor ${zoomFactor.toFixed(1)}`;\n            option.value = zoomFactor;\n            option.defaultSelected = zoomFactor === currentZoomFactor;\n            dropdown.add(option);\n        });\n        return dropdown;\n    }\n}\nclass AdvancedMagnifyViewportManager {\n    constructor() {\n        this.createViewport = (annotation, viewportInfo) => {\n            const { magnifyViewportId, sourceEnabledElement, position, radius, zoomFactor, autoPan, } = viewportInfo;\n            const { viewport: sourceViewport } = sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            const magnifyViewport = new AdvancedMagnifyViewport({\n                magnifyViewportId,\n                sourceEnabledElement,\n                radius,\n                position,\n                zoomFactor,\n                autoPan,\n            });\n            this._addSourceElementEventListener(sourceElement);\n            this._magnifyViewportsMap.set(magnifyViewport.viewportId, {\n                annotation,\n                magnifyViewport,\n                magnifyViewportInfo: viewportInfo,\n            });\n            return magnifyViewport;\n        };\n        this._annotationRemovedCallback = (evt) => {\n            const { annotation } = evt.detail;\n            if (annotation.metadata.toolName !== ADVANCED_MAGNIFY_TOOL_NAME) {\n                return;\n            }\n            this.destroyViewport(annotation.data.magnifyViewportId);\n        };\n        this._newStackImageCallback = (evt) => {\n            const { viewportId: sourceViewportId, imageId } = evt.detail;\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            const { viewport } = getEnabledElementByViewportId(sourceViewportId);\n            if (viewport.stackActorReInitialized) {\n                this._reset(sourceViewportId);\n            }\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                annotation.metadata.referencedImageId = imageId;\n                annotation.invalidated = true;\n            });\n        };\n        this._newVolumeImageCallback = (evt) => {\n            const { renderingEngineId, viewportId: sourceViewportId } = evt.detail;\n            const renderingEngine = getRenderingEngine(renderingEngineId);\n            const sourceViewport = renderingEngine.getViewport(sourceViewportId);\n            const { viewPlaneNormal: currentViewPlaneNormal } = sourceViewport.getCamera();\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                const { viewPlaneNormal } = annotation.metadata;\n                const isParallel = Math.abs(vec3.dot(viewPlaneNormal, currentViewPlaneNormal)) >\n                    PARALLEL_THRESHOLD;\n                if (!isParallel) {\n                    return;\n                }\n                const { handles } = annotation.data;\n                const worldImagePlanePoint = sourceViewport.canvasToWorld([0, 0]);\n                const vecHandleToImagePlane = vec3.sub(vec3.create(), worldImagePlanePoint, handles.points[0]);\n                const worldDist = vec3.dot(vecHandleToImagePlane, currentViewPlaneNormal);\n                const worldDelta = vec3.scale(vec3.create(), currentViewPlaneNormal, worldDist);\n                for (let i = 0, len = handles.points.length; i < len; i++) {\n                    const point = handles.points[i];\n                    point[0] += worldDelta[0];\n                    point[1] += worldDelta[1];\n                    point[2] += worldDelta[2];\n                }\n                annotation.invalidated = true;\n            });\n        };\n        this._magnifyViewportsMap = new Map();\n        this._initialize();\n    }\n    static getInstance() {\n        AdvancedMagnifyViewportManager._singleton =\n            AdvancedMagnifyViewportManager._singleton ??\n                new AdvancedMagnifyViewportManager();\n        return AdvancedMagnifyViewportManager._singleton;\n    }\n    getViewport(magnifyViewportId) {\n        return this._magnifyViewportsMap.get(magnifyViewportId)?.magnifyViewport;\n    }\n    dispose() {\n        this._removeEventListeners();\n        this._destroyViewports();\n    }\n    destroyViewport(magnifyViewportId) {\n        const magnifyViewportMapEntry = this._magnifyViewportsMap.get(magnifyViewportId);\n        if (magnifyViewportMapEntry) {\n            const { magnifyViewport } = magnifyViewportMapEntry;\n            const { viewport: sourceViewport } = magnifyViewport.sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            this._removeSourceElementEventListener(sourceElement);\n            magnifyViewport.dispose();\n            this._magnifyViewportsMap.delete(magnifyViewportId);\n        }\n    }\n    _destroyViewports() {\n        const magnifyViewportIds = Array.from(this._magnifyViewportsMap.keys());\n        magnifyViewportIds.forEach((magnifyViewportId) => this.destroyViewport(magnifyViewportId));\n    }\n    _getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId) {\n        const magnifyViewportsMapEntries = Array.from(this._magnifyViewportsMap.values());\n        return magnifyViewportsMapEntries.filter(({ magnifyViewport }) => {\n            const { viewport } = magnifyViewport.sourceEnabledElement;\n            return viewport.id === sourceViewportId;\n        });\n    }\n    _reset(sourceViewportId) {\n        const magnifyViewports = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n        magnifyViewports.forEach(({ magnifyViewport, annotation, magnifyViewportInfo }) => {\n            this.destroyViewport(magnifyViewport.viewportId);\n            const newEnabledElement = getEnabledElementByViewportId(sourceViewportId);\n            this.createViewport(annotation, {\n                ...magnifyViewportInfo,\n                sourceEnabledElement: {\n                    ...newEnabledElement,\n                },\n            });\n        });\n    }\n    _addEventListeners() {\n        eventTarget.addEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _removeEventListeners() {\n        eventTarget.removeEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _addSourceElementEventListener(element) {\n        element.addEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        const newStackHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, newStackHandler);\n        const newVolumeHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, newVolumeHandler);\n        element.addEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.newStackHandler = newStackHandler;\n        element.newVolumeHandler = newVolumeHandler;\n    }\n    _removeSourceElementEventListener(element) {\n        element.removeEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        element.removeEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.removeEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, element.newStackHandler);\n        element.removeEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, element.newVolumeHandler);\n        delete element.newStackHandler;\n        delete element.newVolumeHandler;\n    }\n    _initialize() {\n        this._addEventListeners();\n    }\n}\nclass AdvancedMagnifyViewport {\n    constructor({ magnifyViewportId, sourceEnabledElement, radius = MAGNIFY_VIEWPORT_INITIAL_RADIUS, position = [0, 0], zoomFactor, autoPan, }) {\n        this._enabledElement = null;\n        this._sourceToolGroup = null;\n        this._magnifyToolGroup = null;\n        this._isViewportReady = false;\n        this._radius = 0;\n        this._resized = false;\n        this._canAutoPan = false;\n        this._viewportId = magnifyViewportId ?? csUtils.uuidv4();\n        this._sourceEnabledElement = sourceEnabledElement;\n        this._autoPan = autoPan;\n        this.radius = radius;\n        this.position = position;\n        this.zoomFactor = zoomFactor;\n        this.visible = true;\n        this._browserMouseDownCallback = this._browserMouseDownCallback.bind(this);\n        this._browserMouseUpCallback = this._browserMouseUpCallback.bind(this);\n        this._handleToolModeChanged = this._handleToolModeChanged.bind(this);\n        this._mouseDragCallback = this._mouseDragCallback.bind(this);\n        this._resizeViewportAsync = (debounce(this._resizeViewport.bind(this), 1));\n        this._initialize();\n    }\n    get sourceEnabledElement() {\n        return this._sourceEnabledElement;\n    }\n    get viewportId() {\n        return this._viewportId;\n    }\n    get radius() {\n        return this._radius;\n    }\n    set radius(radius) {\n        if (Math.abs(this._radius - radius) > 0.00001) {\n            this._radius = radius;\n            this._resized = true;\n        }\n    }\n    update() {\n        const { radius, position, visible } = this;\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const size = 2 * radius;\n        const [x, y] = position;\n        if (this._resized) {\n            this._resizeViewportAsync();\n            this._resized = false;\n        }\n        Object.assign(element.style, {\n            display: visible ? 'block' : 'hidden',\n            width: `${size}px`,\n            height: `${size}px`,\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(${x}px, ${y}px)`,\n        });\n        if (this._isViewportReady) {\n            this._syncViewports();\n            viewport.render();\n        }\n    }\n    dispose() {\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const renderingEngine = viewport.getRenderingEngine();\n        this._removeEventListeners(element);\n        renderingEngine.disableElement(viewport.id);\n        if (element.parentNode) {\n            element.parentNode.removeChild(element);\n        }\n    }\n    _handleToolModeChanged(evt) {\n        const { _magnifyToolGroup: magnifyToolGroup } = this;\n        const { toolGroupId, toolName, mode, toolBindingsOptions } = evt.detail;\n        if (this._sourceToolGroup?.id !== toolGroupId) {\n            return;\n        }\n        switch (mode) {\n            case ToolModes.Active:\n                magnifyToolGroup.setToolActive(toolName, toolBindingsOptions);\n                break;\n            case ToolModes.Passive:\n                magnifyToolGroup.setToolPassive(toolName);\n                break;\n            case ToolModes.Enabled:\n                magnifyToolGroup.setToolEnabled(toolName);\n                break;\n            case ToolModes.Disabled:\n                magnifyToolGroup.setToolDisabled(toolName);\n                break;\n            default:\n                throw new Error(`Unknow tool mode (${mode})`);\n        }\n    }\n    _inheritBorderRadius(magnifyElement) {\n        const viewport = magnifyElement.querySelector('.viewport-element');\n        const canvas = magnifyElement.querySelector('.cornerstone-canvas');\n        viewport.style.borderRadius = 'inherit';\n        canvas.style.borderRadius = 'inherit';\n    }\n    _createViewportNode() {\n        const magnifyElement = document.createElement('div');\n        const { radius } = this;\n        const size = radius * 2;\n        magnifyElement.classList.add(MAGNIFY_CLASSNAME);\n        Object.assign(magnifyElement.style, {\n            display: 'block',\n            width: `${size}px`,\n            height: `${size}px`,\n            position: 'absolute',\n            overflow: 'hidden',\n            borderRadius: '50%',\n            boxSizing: 'border-box',\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(-1000px, -1000px)`,\n        });\n        return magnifyElement;\n    }\n    _convertZoomFactorToParallelScale(viewport, magnifyViewport, zoomFactor) {\n        const { parallelScale } = viewport.getCamera();\n        const canvasRatio = magnifyViewport.canvas.offsetWidth / viewport.canvas.offsetWidth;\n        return parallelScale * (1 / zoomFactor) * canvasRatio;\n    }\n    _isStackViewport(viewport) {\n        return 'setStack' in viewport;\n    }\n    _isVolumeViewport(viewport) {\n        return 'addVolumes' in viewport;\n    }\n    _cloneToolGroups(sourceViewport, magnifyViewport) {\n        const sourceActors = sourceViewport.getActors();\n        const magnifyToolGroupId = `${magnifyViewport.id}-toolGroup`;\n        const sourceToolGroup = getToolGroupForViewport(sourceViewport.id, sourceViewport.renderingEngineId);\n        const magnifyToolGroup = sourceToolGroup.clone(magnifyToolGroupId, (toolName) => {\n            const toolInstance = sourceToolGroup.getToolInstance(toolName);\n            const isAnnotationTool = toolInstance instanceof AnnotationTool &&\n                !(toolInstance instanceof AdvancedMagnifyTool);\n            return isAnnotationTool;\n        });\n        magnifyToolGroup.addViewport(magnifyViewport.id, magnifyViewport.renderingEngineId);\n        sourceActors.filter(isSegmentation).forEach((actor) => {\n            addSegmentationRepresentations(this.viewportId, [\n                {\n                    segmentationId: actor.referencedId,\n                    type: SegmentationRepresentations.Labelmap,\n                },\n            ]);\n        });\n        return { sourceToolGroup, magnifyToolGroup };\n    }\n    _cloneStack(sourceViewport, magnifyViewport) {\n        const imageIds = sourceViewport.getImageIds();\n        magnifyViewport.setStack(imageIds).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n    }\n    _cloneVolumes(sourceViewport, magnifyViewport) {\n        const actors = sourceViewport.getActors();\n        const volumeInputArray = actors\n            .filter((actor) => !isSegmentation(actor))\n            .map((actor) => ({ volumeId: actor.uid }));\n        magnifyViewport.setVolumes(volumeInputArray).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n        return magnifyViewport;\n    }\n    _cloneViewport(sourceViewport, magnifyElement) {\n        const { viewportId: magnifyViewportId } = this;\n        const renderingEngine = sourceViewport.getRenderingEngine();\n        const { options: sourceViewportOptions } = sourceViewport;\n        const viewportInput = {\n            element: magnifyElement,\n            viewportId: magnifyViewportId,\n            type: sourceViewport.type,\n            defaultOptions: { ...sourceViewportOptions },\n        };\n        renderingEngine.enableElement(viewportInput);\n        const magnifyViewport = (renderingEngine.getViewport(magnifyViewportId));\n        if (this._isStackViewport(sourceViewport)) {\n            this._cloneStack(sourceViewport, magnifyViewport);\n        }\n        else if (this._isVolumeViewport(sourceViewport)) {\n            this._cloneVolumes(sourceViewport, magnifyViewport);\n        }\n        this._inheritBorderRadius(magnifyElement);\n        const toolGroups = this._cloneToolGroups(sourceViewport, magnifyViewport);\n        this._sourceToolGroup = toolGroups.sourceToolGroup;\n        this._magnifyToolGroup = toolGroups.magnifyToolGroup;\n    }\n    _cancelMouseEventCallback(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    }\n    _browserMouseUpCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _browserMouseDownCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        this._canAutoPan = !!evt.target?.closest('.advancedMagnifyTool');\n        document.addEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _mouseDragCallback(evt) {\n        if (!state.isInteractingWithTool) {\n            return;\n        }\n        const { _autoPan: autoPan } = this;\n        if (!autoPan.enabled || !this._canAutoPan) {\n            return;\n        }\n        const { currentPoints } = evt.detail;\n        const { viewport } = this._enabledElement;\n        const { canvasToWorld } = viewport;\n        const { canvas: canvasCurrent } = currentPoints;\n        const { radius: magnifyRadius } = this;\n        const canvasCenter = [magnifyRadius, magnifyRadius];\n        const dist = distanceToPoint(canvasCenter, canvasCurrent);\n        const maxDist = magnifyRadius - autoPan.padding;\n        if (dist <= maxDist) {\n            return;\n        }\n        const panDist = dist - maxDist;\n        const canvasDeltaPos = vec2.sub(vec2.create(), canvasCurrent, canvasCenter);\n        vec2.normalize(canvasDeltaPos, canvasDeltaPos);\n        vec2.scale(canvasDeltaPos, canvasDeltaPos, panDist);\n        const newCanvasPosition = vec2.add(vec2.create(), this.position, canvasDeltaPos);\n        const currentWorldPos = canvasToWorld(this.position);\n        const newWorldPos = canvasToWorld(newCanvasPosition);\n        const worldDeltaPos = vec3.sub(vec3.create(), newWorldPos, currentWorldPos);\n        const autoPanCallbackData = {\n            points: {\n                currentPosition: {\n                    canvas: this.position,\n                    world: currentWorldPos,\n                },\n                newPosition: {\n                    canvas: newCanvasPosition,\n                    world: newWorldPos,\n                },\n            },\n            delta: {\n                canvas: canvasDeltaPos,\n                world: worldDeltaPos,\n            },\n        };\n        autoPan.callback(autoPanCallbackData);\n    }\n    _addBrowserEventListeners(element) {\n        document.addEventListener('mousedown', this._browserMouseDownCallback, true);\n        element.addEventListener('mousedown', this._cancelMouseEventCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n        element.addEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _removeBrowserEventListeners(element) {\n        document.removeEventListener('mousedown', this._browserMouseDownCallback, true);\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mousedown', this._cancelMouseEventCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n        element.removeEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _addEventListeners(element) {\n        eventTarget.addEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._addBrowserEventListeners(element);\n    }\n    _removeEventListeners(element) {\n        eventTarget.removeEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._removeBrowserEventListeners(element);\n    }\n    _initialize() {\n        const { _sourceEnabledElement: sourceEnabledElement } = this;\n        const { viewport: sourceViewport } = sourceEnabledElement;\n        const { canvas: sourceCanvas } = sourceViewport;\n        const magnifyElement = this._createViewportNode();\n        sourceCanvas.parentNode.appendChild(magnifyElement);\n        this._addEventListeners(magnifyElement);\n        this._cloneViewport(sourceViewport, magnifyElement);\n        this._enabledElement = getEnabledElement(magnifyElement);\n    }\n    _syncViewportsCameras(sourceViewport, magnifyViewport) {\n        const worldPos = sourceViewport.canvasToWorld(this.position);\n        const parallelScale = this._convertZoomFactorToParallelScale(sourceViewport, magnifyViewport, this.zoomFactor);\n        const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n        const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n            Math.pow(focalPoint[1] - position[1], 2) +\n            Math.pow(focalPoint[2] - position[2], 2));\n        const updatedFocalPoint = [\n            worldPos[0],\n            worldPos[1],\n            worldPos[2],\n        ];\n        const updatedPosition = [\n            updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n            updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n            updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n        ];\n        magnifyViewport.setCamera({\n            parallelScale,\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n    }\n    _syncStackViewports(sourceViewport, magnifyViewport) {\n        magnifyViewport.setImageIdIndex(sourceViewport.getCurrentImageIdIndex());\n    }\n    _syncViewports() {\n        const { viewport: sourceViewport } = this._sourceEnabledElement;\n        const { viewport: magnifyViewport } = this._enabledElement;\n        const sourceProperties = sourceViewport.getProperties();\n        const imageData = magnifyViewport.getImageData();\n        if (!imageData) {\n            return;\n        }\n        magnifyViewport.setProperties(sourceProperties);\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        if (this._isStackViewport(sourceViewport)) {\n            this._syncStackViewports(sourceViewport, magnifyViewport);\n        }\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        magnifyViewport.render();\n    }\n    _resizeViewport() {\n        const { viewport } = this._enabledElement;\n        const renderingEngine = viewport.getRenderingEngine();\n        renderingEngine.resize();\n    }\n}\nAdvancedMagnifyTool.toolName = 'AdvancedMagnify';\nexport { AdvancedMagnifyTool as default };\n","import { vec3 } from 'gl-matrix';\nimport { getRenderingEngines, CONSTANTS, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { addAnnotation } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass ReferenceLines extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceViewportId: '',\n            enforceSameFrameOfReference: true,\n            showFullDimension: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            let viewports = renderingEngine.getViewports();\n            viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n            const sourceViewport = renderingEngine.getViewport(this.configuration.sourceViewportId);\n            if (!sourceViewport?.getImageData()) {\n                return;\n            }\n            const { element } = sourceViewport;\n            const { viewUp, viewPlaneNormal } = sourceViewport.getCamera();\n            const sourceViewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(sourceViewport);\n            let annotation = this.editData?.annotation;\n            const FrameOfReferenceUID = sourceViewport.getFrameOfReferenceUID();\n            if (!annotation) {\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        viewPlaneNormal: [...viewPlaneNormal],\n                        viewUp: [...viewUp],\n                        FrameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        handles: {\n                            points: sourceViewportCanvasCornersInWorld,\n                        },\n                    },\n                };\n                addAnnotation(newAnnotation, element);\n                annotation = newAnnotation;\n            }\n            else {\n                this.editData.annotation.data.handles.points =\n                    sourceViewportCanvasCornersInWorld;\n            }\n            this.editData = {\n                sourceViewportId: sourceViewport.id,\n                renderingEngine,\n                annotation,\n            };\n            triggerAnnotationRenderForViewportIds(viewports\n                .filter((viewport) => viewport.id !== sourceViewport.id)\n                .map((viewport) => viewport.id));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolConfiguration = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport: targetViewport } = enabledElement;\n            if (!this.editData) {\n                return false;\n            }\n            const { annotation, sourceViewportId } = this.editData;\n            let renderStatus = false;\n            const { viewport: sourceViewport } = getEnabledElementByViewportId(sourceViewportId) || {};\n            if (!sourceViewport) {\n                return renderStatus;\n            }\n            if (sourceViewport.id === targetViewport.id) {\n                return renderStatus;\n            }\n            if (!annotation || !annotation?.data?.handles?.points) {\n                return renderStatus;\n            }\n            if (this.configuration.enforceSameFrameOfReference &&\n                sourceViewport.getFrameOfReferenceUID() !==\n                    targetViewport.getFrameOfReferenceUID()) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const topLeft = annotation.data.handles.points[0];\n            const topRight = annotation.data.handles.points[1];\n            const bottomLeft = annotation.data.handles.points[2];\n            const bottomRight = annotation.data.handles.points[3];\n            const { focalPoint, viewPlaneNormal, viewUp } = targetViewport.getCamera();\n            const { viewPlaneNormal: sourceViewPlaneNormal } = sourceViewport.getCamera();\n            if (this.isParallel(viewPlaneNormal, sourceViewPlaneNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            let pointSetToUse = pointSet1;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet1[2], pointSet1[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const newNormal = vec3.cross(vec3.create(), topBottomVec, topRightVec);\n            if (this.isParallel(newNormal, viewPlaneNormal)) {\n                return renderStatus;\n            }\n            if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                pointSetToUse = pointSet2;\n            }\n            const lineStartWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n            const lineEndWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n            const { annotationUID } = annotation;\n            styleSpecifier.annotationUID = annotationUID;\n            const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n            const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n            const color = this.getStyle('color', styleSpecifier, annotation);\n            const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n            let canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n            if (this.configuration.showFullDimension) {\n                canvasCoordinates = this.handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates);\n            }\n            if (canvasCoordinates.length < 2) {\n                return renderStatus;\n            }\n            const dataId = `${annotationUID}-line`;\n            const lineUID = '1';\n            drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, dataId);\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates) {\n        const renderingEngine = targetViewport.getRenderingEngine();\n        const targetId = this.getTargetId(targetViewport);\n        const targetImage = this.getTargetImageData(targetId);\n        const referencedImageId = this.getReferencedImageId(targetViewport, lineStartWorld, viewPlaneNormal, viewUp);\n        if (referencedImageId && targetImage) {\n            try {\n                const { imageData, dimensions } = targetImage;\n                const [topLeftImageCoord, topRightImageCoord, bottomRightImageCoord, bottomLeftImageCoord,] = [\n                    imageData.indexToWorld([0, 0, 0]),\n                    imageData.indexToWorld([dimensions[0] - 1, 0, 0]),\n                    imageData.indexToWorld([\n                        dimensions[0] - 1,\n                        dimensions[1] - 1,\n                        0,\n                    ]),\n                    imageData.indexToWorld([0, dimensions[1] - 1, 0]),\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                const [lineStartImageCoord, lineEndImageCoord] = [\n                    lineStartWorld,\n                    lineEndWorld,\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                canvasCoordinates = [\n                    [topLeftImageCoord, topRightImageCoord],\n                    [topRightImageCoord, bottomRightImageCoord],\n                    [bottomLeftImageCoord, bottomRightImageCoord],\n                    [topLeftImageCoord, bottomLeftImageCoord],\n                ]\n                    .map(([start, end]) => this.intersectInfiniteLines(start, end, lineStartImageCoord, lineEndImageCoord))\n                    .filter((point) => point && this.isInBound(point, dimensions))\n                    .map((point) => {\n                    const world = csUtils.imageToWorldCoords(referencedImageId, point);\n                    return targetViewport.worldToCanvas(world);\n                });\n            }\n            catch (err) {\n                console.log(err);\n            }\n        }\n        return canvasCoordinates;\n    }\n    intersectInfiniteLines(line1Start, line1End, line2Start, line2End) {\n        const [x1, y1] = line1Start;\n        const [x2, y2] = line1End;\n        const [x3, y3] = line2Start;\n        const [x4, y4] = line2End;\n        const a1 = y2 - y1;\n        const b1 = x1 - x2;\n        const c1 = x2 * y1 - x1 * y2;\n        const a2 = y4 - y3;\n        const b2 = x3 - x4;\n        const c2 = x4 * y3 - x3 * y4;\n        if (Math.abs(a1 * b2 - a2 * b1) < EPSILON) {\n            return;\n        }\n        const x = (b1 * c2 - b2 * c1) / (a1 * b2 - a2 * b1);\n        const y = (a2 * c1 - a1 * c2) / (a1 * b2 - a2 * b1);\n        return [x, y];\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    isInBound(point, dimensions) {\n        return (point[0] >= 0 &&\n            point[0] <= dimensions[0] &&\n            point[1] >= 0 &&\n            point[1] <= dimensions[1]);\n    }\n}\nReferenceLines.toolName = 'ReferenceLines';\nexport default ReferenceLines;\n","import { vec3 } from 'gl-matrix';\nimport { metaData, CONSTANTS, getRenderingEngine, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass OverlayGridTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceImageIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolActive = () => {\n            this._init();\n        };\n        this._init = () => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            if (!sourceImageIds?.length) {\n                console.warn('OverlayGridTool: No sourceImageIds provided in configuration');\n                return;\n            }\n            const imagePlaneModule = metaData.get('imagePlaneModule', sourceImageIds[0]);\n            if (!imagePlaneModule) {\n                console.warn('OverlayGridTool: No imagePlaneModule found for sourceImageIds');\n                return;\n            }\n            const { frameOfReferenceUID } = imagePlaneModule;\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn('OverlayGridTool: No viewports found');\n                return;\n            }\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const pointSets = sourceImageIds.map((id) => {\n                    return this.calculateImageIdPointSets(id);\n                });\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        viewportData: new Map(),\n                        pointSets,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.calculateImageIdPointSets = (imageId) => {\n            const { imagePositionPatient, rows, columns, rowCosines, columnCosines, rowPixelSpacing, columnPixelSpacing, } = metaData.get('imagePlaneModule', imageId);\n            const topLeft = [...imagePositionPatient];\n            const topRight = [...imagePositionPatient];\n            const bottomLeft = [...imagePositionPatient];\n            const bottomRight = [...imagePositionPatient];\n            vec3.scaleAndAdd(topRight, imagePositionPatient, columnCosines, columns * columnPixelSpacing);\n            vec3.scaleAndAdd(bottomLeft, imagePositionPatient, rowCosines, rows * rowPixelSpacing);\n            vec3.scaleAndAdd(bottomRight, bottomLeft, columnCosines, columns * columnPixelSpacing);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            return { pointSet1, pointSet2 };\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            let renderStatus = false;\n            if (!sourceImageIds?.length) {\n                return renderStatus;\n            }\n            const { viewport: targetViewport, FrameOfReferenceUID } = enabledElement;\n            const targetImageIds = targetViewport.getImageIds();\n            if (targetImageIds.length < 2) {\n                return renderStatus;\n            }\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const { focalPoint, viewPlaneNormal } = targetViewport.getCamera();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const imageIdNormal = (this.getImageIdNormal(sourceImageIds[0]));\n            if (this.isParallel(viewPlaneNormal, imageIdNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSets = annotation.data.pointSets;\n            const viewportData = annotation.data.viewportData;\n            for (let i = 0; i < sourceImageIds.length; i++) {\n                const { pointSet1, pointSet2 } = pointSets[i];\n                const targetData = viewportData.get(targetViewport.id) ||\n                    this.initializeViewportData(viewportData, targetViewport.id);\n                if (!targetData.pointSetsToUse[i]) {\n                    let pointSetToUse = pointSet1;\n                    let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n                    topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n                    if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                        pointSetToUse = pointSet2;\n                    }\n                    targetData.pointSetsToUse[i] = pointSetToUse;\n                    targetData.lineStartsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n                    targetData.lineEndsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n                }\n                const lineStartWorld = targetData.lineStartsWorld[i];\n                const lineEndWorld = targetData.lineEndsWorld[i];\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n                const canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n                const dataId = `${annotationUID}-line`;\n                const lineUID = `${i}`;\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n            }\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.initializeViewportData = (viewportData, id) => {\n            viewportData.set(id, {\n                pointSetsToUse: [],\n                lineStartsWorld: [],\n                lineEndsWorld: [],\n            });\n            return viewportData.get(id);\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    getImageIdNormal(imageId) {\n        const { imageOrientationPatient } = metaData.get('imagePlaneModule', imageId);\n        const rowCosineVec = vec3.fromValues(imageOrientationPatient[0], imageOrientationPatient[1], imageOrientationPatient[2]);\n        const colCosineVec = vec3.fromValues(imageOrientationPatient[3], imageOrientationPatient[4], imageOrientationPatient[5]);\n        return vec3.cross(vec3.create(), rowCosineVec, colCosineVec);\n    }\n}\nOverlayGridTool.toolName = 'OverlayGrid';\nexport default OverlayGridTool;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawPath } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { pointToString } from '../utilities/pointToString';\nimport { polyDataUtils } from '../utilities';\nclass SegmentationIntersectionTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            opacity: 0.5,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._init = () => {\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn(this.getToolName() + 'Tool: No viewports found');\n                return;\n            }\n            const firstViewport = getRenderingEngine(viewportsInfo[0].renderingEngineId)?.getViewport(viewportsInfo[0].viewportId);\n            if (!firstViewport) {\n                return;\n            }\n            const frameOfReferenceUID = firstViewport.getFrameOfReferenceUID();\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const actorsWorldPointsMap = new Map();\n                calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo);\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        actorsWorldPointsMap,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            let renderStatus = false;\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const actorsWorldPointsMap = annotation.data.actorsWorldPointsMap;\n            calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n            const actorEntries = viewport.getActors();\n            const cacheId = getCacheId(viewport);\n            actorEntries.forEach((actorEntry) => {\n                if (!actorEntry?.clippingFilter) {\n                    return;\n                }\n                const actorWorldPointMap = actorsWorldPointsMap.get(actorEntry.uid);\n                if (!actorWorldPointMap) {\n                    return;\n                }\n                if (!actorWorldPointMap.get(cacheId)) {\n                    return;\n                }\n                let polyLineIdx = 1;\n                const { worldPointsSet, color } = actorWorldPointMap.get(cacheId);\n                for (let i = 0; i < worldPointsSet.length; i++) {\n                    const worldPoints = worldPointsSet[i];\n                    const canvasPoints = worldPoints.map((point) => viewport.worldToCanvas(point));\n                    const options = {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: this.configuration.opacity,\n                        closePath: true,\n                        lineWidth: 2,\n                    };\n                    const polyLineUID = actorEntry.uid + '#' + polyLineIdx;\n                    drawPath(svgDrawingHelper, annotationUID, polyLineUID, canvasPoints, options);\n                    polyLineIdx++;\n                }\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nfunction calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo) {\n    viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n        const viewport = getRenderingEngine(renderingEngineId)?.getViewport(viewportId);\n        calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n    });\n}\nfunction calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport) {\n    const actorEntries = viewport.getActors();\n    const cacheId = getCacheId(viewport);\n    actorEntries.forEach((actorEntry) => {\n        if (!actorEntry?.clippingFilter) {\n            return;\n        }\n        let actorWorldPointsMap = actorsWorldPointsMap.get(actorEntry.uid);\n        if (!actorWorldPointsMap) {\n            actorWorldPointsMap = new Map();\n            actorsWorldPointsMap.set(actorEntry.uid, actorWorldPointsMap);\n        }\n        if (!actorWorldPointsMap.get(cacheId)) {\n            const polyData = actorEntry.clippingFilter.getOutputData();\n            const worldPointsSet = polyDataUtils.getPolyDataPoints(polyData);\n            if (!worldPointsSet) {\n                return;\n            }\n            const colorArray = actorEntry.actor.getProperty().getColor();\n            const color = colorToString(colorArray);\n            actorWorldPointsMap.set(cacheId, { worldPointsSet, color });\n        }\n    });\n}\nfunction getCacheId(viewport) {\n    const { viewPlaneNormal } = viewport.getCamera();\n    const imageIndex = viewport.getCurrentImageIdIndex();\n    return `${viewport.id}-${pointToString(viewPlaneNormal)}-${imageIndex}`;\n}\nfunction colorToString(colorArray) {\n    function colorComponentToString(component) {\n        let componentString = Math.floor(component * 255).toString(16);\n        if (componentString.length === 1) {\n            componentString = '0' + componentString;\n        }\n        return componentString;\n    }\n    return ('#' +\n        colorComponentToString(colorArray[0]) +\n        colorComponentToString(colorArray[1]) +\n        colorComponentToString(colorArray[2]));\n}\nfunction removeExtraPoints(viewport, worldPointsSet) {\n    return worldPointsSet.map((worldPoints) => {\n        const canvasPoints = worldPoints.map((point) => {\n            const canvasPoint = viewport.worldToCanvas(point);\n            return [Math.floor(canvasPoint[0]), Math.floor(canvasPoint[1])];\n        });\n        let lastPoint;\n        const newWorldPoints = [];\n        let newCanvasPoints = [];\n        for (let i = 0; i < worldPoints.length; i++) {\n            if (lastPoint) {\n                if (distanceToPoint(lastPoint, canvasPoints[i]) > 0) {\n                    newWorldPoints.push(worldPoints[i]);\n                    newCanvasPoints.push(canvasPoints[i]);\n                }\n            }\n            lastPoint = canvasPoints[i];\n        }\n        const firstPoint = newCanvasPoints[0];\n        for (let j = Math.min(30, newCanvasPoints.length); j < newCanvasPoints.length; j++) {\n            if (distanceToPoint(firstPoint, newCanvasPoints[j]) < 0.5) {\n                newCanvasPoints = newCanvasPoints.slice(0, j);\n                return newWorldPoints.slice(0, j);\n            }\n        }\n        return newWorldPoints;\n    });\n}\nSegmentationIntersectionTool.toolName = 'SegmentationIntersection';\nexport default SegmentationIntersectionTool;\n","import { getEnabledElement, StackViewport, VolumeViewport, utilities, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { drawLine } from '../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { vec3 } from 'gl-matrix';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass ReferenceCursors extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            displayThreshold: 5,\n            positionSync: true,\n            disableCursor: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isHandleOutsideImage = false;\n        this._elementWithCursor = null;\n        this._currentCursorWorldPosition = null;\n        this._currentCanvasPosition = null;\n        this._disableCursorEnabled = false;\n        this.mouseMoveCallback = (evt) => {\n            const { detail } = evt;\n            const { element, currentPoints } = detail;\n            this._currentCursorWorldPosition = currentPoints.world;\n            this._currentCanvasPosition = currentPoints.canvas;\n            this._elementWithCursor = element;\n            const annotation = this.getActiveAnnotation(element);\n            if (annotation === null) {\n                this.createInitialAnnotation(currentPoints.world, element);\n                return false;\n            }\n            this.updateAnnotationPosition(element, annotation);\n            return false;\n        };\n        this.createInitialAnnotation = (worldPos, element) => {\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('No enabled element found');\n            }\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            if (!viewPlaneNormal || !viewUp) {\n                throw new Error('Camera not found');\n            }\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                },\n            };\n            const annotations = getAnnotations(this.getToolName(), element);\n            if (annotations.length > 0) {\n                return null;\n            }\n            const annotationId = addAnnotation(annotation, element);\n            if (annotationId === null) {\n                return;\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, previousCamera, camera } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const viewport = enabledElement.viewport;\n            if (element !== this._elementWithCursor) {\n                return;\n            }\n            const oldFocalPoint = previousCamera.focalPoint;\n            const cameraNormal = camera.viewPlaneNormal;\n            const newFocalPoint = camera.focalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(newFocalPoint, oldFocalPoint, deltaCameraFocalPoint);\n            if (deltaCameraFocalPoint.reduce((a, b) => a + b, 0) === 0) {\n                return;\n            }\n            const dotProduct = vtkMath.dot(deltaCameraFocalPoint, cameraNormal);\n            if (Math.abs(dotProduct) < 1e-2) {\n                return;\n            }\n            if (!this._currentCanvasPosition) {\n                return;\n            }\n            const newWorldPos = viewport.canvasToWorld(this._currentCanvasPosition);\n            this._currentCursorWorldPosition = newWorldPos;\n            this.updateAnnotationPosition(element, this.getActiveAnnotation(element));\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            const isElementWithCursor = this._elementWithCursor === viewport.element;\n            if (this.configuration.positionSync && !isElementWithCursor) {\n                this.updateViewportImage(viewport);\n            }\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                if (!annotationUID) {\n                    return renderStatus;\n                }\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidthBase = parseFloat(this.getStyle('lineWidth', styleSpecifier, annotation));\n                const lineWidth = typeof lineWidthBase === 'number' && isElementWithCursor\n                    ? lineWidthBase\n                    : lineWidthBase;\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (points[0].some((e) => isNaN(e))) {\n                    return renderStatus;\n                }\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                const crosshairUIDs = {\n                    upper: 'upper',\n                    right: 'right',\n                    lower: 'lower',\n                    left: 'left',\n                };\n                const [x, y] = canvasCoordinates[0];\n                const centerSpace = isElementWithCursor ? 20 : 7;\n                const lineLength = isElementWithCursor ? 5 : 7;\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.upper, [x, y - (centerSpace / 2 + lineLength)], [x, y - centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.lower, [x, y + (centerSpace / 2 + lineLength)], [x, y + centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.right, [x + (centerSpace / 2 + lineLength), y], [x + centerSpace / 2, y], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.left, [x - (centerSpace / 2 + lineLength), y], [x - centerSpace / 2, y], { color, lineDash, lineWidth });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._disableCursorEnabled = this.configuration.disableCursor;\n    }\n    onSetToolActive() {\n        this._disableCursorEnabled = this.configuration.disableCursor;\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                hideElementCursor(element.viewport.element);\n            }\n        });\n    }\n    onSetToolDisabled() {\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                resetElementCursor(element.viewport.element);\n            }\n        });\n    }\n    getActiveAnnotation(element) {\n        const annotations = getAnnotations(this.getToolName(), element);\n        if (!annotations.length) {\n            return null;\n        }\n        const targetAnnotation = annotations[0];\n        return targetAnnotation;\n    }\n    updateAnnotationPosition(element, annotation) {\n        const worldPos = this._currentCursorWorldPosition;\n        if (!worldPos) {\n            return;\n        }\n        if (!annotation.data?.handles?.points) {\n            return;\n        }\n        annotation.data.handles.points = [[...worldPos]];\n        annotation.invalidated = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!(annotations instanceof Array) || annotations.length === 0) {\n            return [];\n        }\n        const annotation = annotations[0];\n        const viewport = getEnabledElement(element)?.viewport;\n        if (!viewport) {\n            return [];\n        }\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, focalPoint } = camera;\n        if (!viewPlaneNormal || !focalPoint) {\n            return [];\n        }\n        const points = annotation.data?.handles?.points;\n        if (!(points instanceof Array) || points.length !== 1) {\n            return [];\n        }\n        const worldPos = points[0];\n        const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n        const distance = utilities.planar.planeDistanceToPoint(plane, worldPos);\n        return distance < this.configuration.displayThreshold ? [annotation] : [];\n    }\n    updateViewportImage(viewport) {\n        const currentMousePosition = this._currentCursorWorldPosition;\n        if (!currentMousePosition || currentMousePosition.some((e) => isNaN(e))) {\n            return;\n        }\n        if (viewport instanceof StackViewport) {\n            const closestIndex = utilities.getClosestStackImageIndexForPoint(currentMousePosition, viewport);\n            if (closestIndex === null) {\n                return;\n            }\n            if (closestIndex !== viewport.getCurrentImageIdIndex()) {\n                viewport.setImageIdIndex(closestIndex);\n            }\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n            if (!focalPoint || !viewPlaneNormal) {\n                return;\n            }\n            const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const currentDistance = utilities.planar.planeDistanceToPoint(plane, currentMousePosition, true);\n            if (Math.abs(currentDistance) < 0.5) {\n                return;\n            }\n            const normalizedViewPlane = vec3.normalize(vec3.create(), vec3.fromValues(...viewPlaneNormal));\n            const scaledPlaneNormal = vec3.scale(vec3.create(), normalizedViewPlane, currentDistance);\n            const newFocalPoint = vec3.add(vec3.create(), vec3.fromValues(...focalPoint), scaledPlaneNormal);\n            const isInBounds = true;\n            if (isInBounds) {\n                viewport.setCamera({ focalPoint: newFocalPoint });\n                const renderingEngine = viewport.getRenderingEngine();\n                if (renderingEngine) {\n                    renderingEngine.renderViewport(viewport.id);\n                }\n            }\n        }\n    }\n}\nReferenceCursors.toolName = 'ReferenceCursors';\nexport default ReferenceCursors;\n","import AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { vec3 } from 'gl-matrix';\nimport { getEnabledElementByIds, getRenderingEngines, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg, drawTextBox as drawTextBoxSvg, } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nconst viewportsWithAnnotations = [];\nclass ScaleOverlayTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            viewportId: '',\n            scaleLocation: 'bottom',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportIds) {\n                return;\n            }\n            const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n            let { viewport } = enabledElements[0];\n            const { FrameOfReferenceUID } = enabledElements[0];\n            if (this.configuration.viewportId) {\n                enabledElements.forEach((element) => {\n                    if (element.viewport.id == this.configuration.viewportId) {\n                        viewport = element.viewport;\n                    }\n                });\n            }\n            if (!viewport) {\n                return;\n            }\n            const { viewUp, viewPlaneNormal } = viewport.getCamera();\n            const viewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(viewport);\n            let annotation = this.editData?.annotation;\n            const annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (annotations.length) {\n                annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n            }\n            enabledElements.forEach((element) => {\n                const { viewport } = element;\n                if (!viewportsWithAnnotations.includes(viewport.id)) {\n                    const newAnnotation = {\n                        metadata: {\n                            toolName: this.getToolName(),\n                            viewPlaneNormal: [...viewPlaneNormal],\n                            viewUp: [...viewUp],\n                            FrameOfReferenceUID,\n                            referencedImageId: null,\n                        },\n                        data: {\n                            handles: {\n                                points: csUtils.getViewportImageCornersInWorld(viewport),\n                            },\n                            viewportId: viewport.id,\n                        },\n                    };\n                    viewportsWithAnnotations.push(viewport.id);\n                    addAnnotation(newAnnotation, viewport.element);\n                    annotation = newAnnotation;\n                }\n            });\n            if (this.editData?.annotation &&\n                this.editData.annotation.data.viewportId == viewport.id) {\n                this.editData.annotation.data.handles.points =\n                    viewportCanvasCornersInWorld;\n                this.editData.annotation.data.viewportId = viewport.id;\n            }\n            this.editData = {\n                viewport,\n                renderingEngine,\n                annotation,\n            };\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this.configuration.viewportId = evt.detail.viewportId;\n            this._init();\n        };\n        this.computeScaleSize = (worldWidthViewport, worldHeightViewport, location) => {\n            const scaleSizes = [\n                16000, 8000, 4000, 2000, 1000, 500, 250, 100, 50, 25, 10, 5, 2,\n            ];\n            let currentScaleSize;\n            if (location == 'top' || location == 'bottom') {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldWidthViewport * 0.6 &&\n                    scaleSize > worldWidthViewport * 0.2);\n            }\n            else {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldHeightViewport * 0.6 &&\n                    scaleSize > worldHeightViewport * 0.2);\n            }\n            return currentScaleSize[0];\n        };\n        this.computeEndScaleTicks = (canvasCoordinates, location) => {\n            const locationTickOffset = {\n                bottom: [\n                    [0, -10],\n                    [0, -10],\n                ],\n                top: [\n                    [0, 10],\n                    [0, 10],\n                ],\n                left: [\n                    [0, 0],\n                    [10, 0],\n                ],\n                right: [\n                    [0, 0],\n                    [-10, 0],\n                ],\n            };\n            const endTick1 = [\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            const endTick2 = [\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            return {\n                endTick1: endTick1,\n                endTick2: endTick2,\n            };\n        };\n        this.computeInnerScaleTicks = (scaleSize, location, annotationUID, leftTick, rightTick) => {\n            let canvasScaleSize;\n            if (location == 'bottom' || location == 'top') {\n                canvasScaleSize = rightTick[0][0] - leftTick[0][0];\n            }\n            else if (location == 'left' || location == 'right') {\n                canvasScaleSize = rightTick[0][1] - leftTick[0][1];\n            }\n            const tickIds = [];\n            const tickUIDs = [];\n            const tickCoordinates = [];\n            let numberSmallTicks = scaleSize;\n            if (scaleSize >= 50) {\n                numberSmallTicks = scaleSize / 10;\n            }\n            const tickSpacing = canvasScaleSize / numberSmallTicks;\n            for (let i = 0; i < numberSmallTicks - 1; i++) {\n                const locationOffset = {\n                    bottom: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), 5],\n                    ],\n                    top: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), -5],\n                    ],\n                    left: [\n                        [0, tickSpacing * (i + 1)],\n                        [-5, tickSpacing * (i + 1)],\n                    ],\n                    right: [\n                        [0, tickSpacing * (i + 1)],\n                        [5, tickSpacing * (i + 1)],\n                    ],\n                };\n                tickIds.push(`${annotationUID}-tick${i}`);\n                tickUIDs.push(`tick${i}`);\n                if ((i + 1) % 5 == 0) {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][0][0],\n                            leftTick[1][1] + locationOffset[location][0][1],\n                        ],\n                    ]);\n                }\n                else {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][1][0],\n                            leftTick[1][1] + locationOffset[location][1][1],\n                        ],\n                    ]);\n                }\n            }\n            return { tickIds, tickUIDs, tickCoordinates };\n        };\n        this.computeWorldScaleCoordinates = (scaleSize, location, pointSet) => {\n            let worldCoordinates;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet[0], pointSet[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet[2], pointSet[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const midpointLocation = {\n                bottom: [pointSet[1], pointSet[2]],\n                top: [pointSet[0], pointSet[3]],\n                right: [pointSet[2], pointSet[3]],\n                left: [pointSet[0], pointSet[1]],\n            };\n            const midpoint = vec3\n                .add(vec3.create(), midpointLocation[location][0], midpointLocation[location][0])\n                .map((i) => i / 2);\n            const offset = scaleSize /\n                2 /\n                Math.sqrt(Math.pow(topBottomVec[0], 2) +\n                    Math.pow(topBottomVec[1], 2) +\n                    Math.pow(topBottomVec[2], 2));\n            if (location == 'top' || location == 'bottom') {\n                worldCoordinates = [\n                    vec3.subtract(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                    vec3.add(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                worldCoordinates = [\n                    vec3.add(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                    vec3.subtract(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                ];\n            }\n            return worldCoordinates;\n        };\n        this.computeCanvasScaleCoordinates = (canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location) => {\n            let scaleCanvasCoordinates;\n            if (location == 'top' || location == 'bottom') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][0] - canvasCoordinates[1][0];\n                scaleCanvasCoordinates = [\n                    [canvasSize.width / 2 - worldDistanceOnCanvas / 2, vscaleBounds.height],\n                    [canvasSize.width / 2 + worldDistanceOnCanvas / 2, vscaleBounds.height],\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][1] - canvasCoordinates[1][1];\n                scaleCanvasCoordinates = [\n                    [hscaleBounds.width, canvasSize.height / 2 - worldDistanceOnCanvas / 2],\n                    [hscaleBounds.width, canvasSize.height / 2 + worldDistanceOnCanvas / 2],\n                ];\n            }\n            return scaleCanvasCoordinates;\n        };\n        this.computeScaleBounds = (canvasSize, horizontalReduction, verticalReduction, location) => {\n            const hReduction = horizontalReduction * Math.min(1000, canvasSize.width);\n            const vReduction = verticalReduction * Math.min(1000, canvasSize.height);\n            const locationBounds = {\n                bottom: [-vReduction, -hReduction],\n                top: [vReduction, hReduction],\n                left: [vReduction, hReduction],\n                right: [-vReduction, -hReduction],\n            };\n            const canvasBounds = {\n                bottom: [canvasSize.height, canvasSize.width],\n                top: [0, canvasSize.width],\n                left: [canvasSize.height, 0],\n                right: [canvasSize.height, canvasSize.width],\n            };\n            return {\n                height: canvasBounds[location][0] + locationBounds[location][0],\n                width: canvasBounds[location][1] + locationBounds[location][1],\n            };\n        };\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.editData || !this.editData.viewport) {\n            return;\n        }\n        const location = this.configuration.scaleLocation;\n        const { viewport } = enabledElement;\n        const annotations = getAnnotations(this.getToolName(), viewport.element);\n        const annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n        const canvas = enabledElement.viewport.canvas;\n        const renderStatus = false;\n        if (!viewport) {\n            return renderStatus;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        const canvasSize = {\n            width: canvas.width / window.devicePixelRatio || 1,\n            height: canvas.height / window.devicePixelRatio || 1,\n        };\n        const topLeft = annotation.data.handles.points[0];\n        const topRight = annotation.data.handles.points[1];\n        const bottomLeft = annotation.data.handles.points[2];\n        const bottomRight = annotation.data.handles.points[3];\n        const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n        const worldWidthViewport = vec3.distance(bottomLeft, bottomRight);\n        const worldHeightViewport = vec3.distance(topLeft, bottomLeft);\n        const hscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const vscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const scaleSize = this.computeScaleSize(worldWidthViewport, worldHeightViewport, location);\n        const canvasCoordinates = this.computeWorldScaleCoordinates(scaleSize, location, pointSet1).map((world) => viewport.worldToCanvas(world));\n        const scaleCanvasCoordinates = this.computeCanvasScaleCoordinates(canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location);\n        const scaleTicks = this.computeEndScaleTicks(scaleCanvasCoordinates, location);\n        const { annotationUID } = annotation;\n        styleSpecifier.annotationUID = annotationUID;\n        const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n        const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n        const color = this.getStyle('color', styleSpecifier, annotation);\n        const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n        const scaleId = `${annotationUID}-scaleline`;\n        const scaleLineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, scaleLineUID, scaleCanvasCoordinates[0], scaleCanvasCoordinates[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, scaleId);\n        const leftTickId = `${annotationUID}-left`;\n        const leftTickUID = '2';\n        drawLineSvg(svgDrawingHelper, annotationUID, leftTickUID, scaleTicks.endTick1[0], scaleTicks.endTick1[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, leftTickId);\n        const rightTickId = `${annotationUID}-right`;\n        const rightTickUID = '3';\n        drawLineSvg(svgDrawingHelper, annotationUID, rightTickUID, scaleTicks.endTick2[0], scaleTicks.endTick2[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, rightTickId);\n        const locationTextOffest = {\n            bottom: [-10, -42],\n            top: [-12, -35],\n            left: [-40, -20],\n            right: [-50, -20],\n        };\n        const textCanvasCoordinates = [\n            scaleCanvasCoordinates[0][0] + locationTextOffest[location][0],\n            scaleCanvasCoordinates[0][1] + locationTextOffest[location][1],\n        ];\n        const textBoxLines = this._getTextLines(scaleSize);\n        const { tickIds, tickUIDs, tickCoordinates } = this.computeInnerScaleTicks(scaleSize, location, annotationUID, scaleTicks.endTick1, scaleTicks.endTick2);\n        for (let i = 0; i < tickUIDs.length; i++) {\n            drawLineSvg(svgDrawingHelper, annotationUID, tickUIDs[i], tickCoordinates[i][0], tickCoordinates[i][1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, tickIds[i]);\n        }\n        const textUID = 'text0';\n        drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textBoxLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], {\n            fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            fontSize: '14px',\n            lineDash: '2,3',\n            lineWidth: '1',\n            shadow: true,\n            color: color,\n        });\n        return renderStatus;\n    }\n    _getTextLines(scaleSize) {\n        let scaleSizeDisplayValue;\n        let scaleSizeUnits;\n        if (scaleSize >= 50) {\n            scaleSizeDisplayValue = scaleSize / 10;\n            scaleSizeUnits = ' cm';\n        }\n        else {\n            scaleSizeDisplayValue = scaleSize;\n            scaleSizeUnits = ' mm';\n        }\n        const textLines = [scaleSizeDisplayValue.toString().concat(scaleSizeUnits)];\n        return textLines;\n    }\n}\nScaleOverlayTool.toolName = 'ScaleOverlay';\nexport default ScaleOverlayTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nimport { getAnnotations } from '../stateManagement';\nimport { point } from '../utilities/math';\nimport { Events, ToolModes, AnnotationStyleStates } from '../enums';\nimport { triggerAnnotationRenderForViewportIds } from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nimport { triggerAnnotationModified } from '../stateManagement/annotation/helpers/state';\nimport CircleSculptCursor from './SculptorTool/CircleSculptCursor';\nimport { distancePointToContour } from './distancePointToContour';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass SculptorTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minSpacing: 1,\n            referencedToolNames: [\n                'PlanarFreehandROI',\n                'PlanarFreehandContourSegmentationTool',\n            ],\n            toolShape: 'circle',\n            referencedToolName: 'PlanarFreehandROI',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.registeredShapes = new Map();\n        this.isActive = false;\n        this.commonData = {\n            activeAnnotationUID: null,\n            viewportIdsToRender: [],\n            isEditingOpenContour: false,\n            canvasLocation: undefined,\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.configureToolSize(evt);\n            this.selectFreehandTool(eventData);\n            if (this.commonData.activeAnnotationUID === null) {\n                return;\n            }\n            this.isActive = true;\n            hideElementCursor(element);\n            this.activateModify(element);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.configureToolSize(evt);\n                this.updateCursor(evt);\n            }\n            else {\n                this.commonData.canvasLocation = undefined;\n            }\n        };\n        this.endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const config = this.configuration;\n            const enabledElement = getEnabledElement(element);\n            this.isActive = false;\n            this.deactivateModify(element);\n            resetElementCursor(element);\n            const { renderingEngineId, viewportId } = enabledElement;\n            const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n            const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (toolInstance.configuration.calculateStats) {\n                activeAnnotation.invalidated = true;\n            }\n            triggerAnnotationModified(activeAnnotation, element);\n        };\n        this.dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.updateCursor(evt);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (!annotations?.length || !this.isActive) {\n                return;\n            }\n            const points = activeAnnotation.data.contour.polyline;\n            this.sculpt(eventData, points);\n        };\n        this.registerShapes(CircleSculptCursor.shapeName, CircleSculptCursor);\n        this.setToolShape(this.configuration.toolShape);\n    }\n    registerShapes(shapeName, shapeClass) {\n        const shape = new shapeClass();\n        this.registeredShapes.set(shapeName, shape);\n    }\n    sculpt(eventData, points) {\n        const config = this.configuration;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        this.sculptData = {\n            mousePoint: eventData.currentPoints.world,\n            mouseCanvasPoint: eventData.currentPoints.canvas,\n            points,\n            maxSpacing: cursorShape.getMaxSpacing(config.minSpacing),\n            element: element,\n        };\n        const pushedHandles = cursorShape.pushHandles(viewport, this.sculptData);\n        if (pushedHandles.first !== undefined) {\n            this.insertNewHandles(pushedHandles);\n        }\n    }\n    interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing) {\n        const { element } = this.sculptData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const nextHandleIndex = contourIndex(i + 1, points.length);\n        const currentCanvasPoint = viewport.worldToCanvas(points[i]);\n        const nextCanvasPoint = viewport.worldToCanvas(points[nextHandleIndex]);\n        const distanceToNextHandle = point.distanceToPoint(currentCanvasPoint, nextCanvasPoint);\n        if (distanceToNextHandle > maxSpacing) {\n            indicesToInsertAfter.push(i);\n        }\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine, viewport } = enabledElement;\n        this.commonData.viewportIdsToRender = [viewport.id];\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n        this.commonData.canvasLocation = eventData.currentPoints.canvas;\n        if (this.isActive) {\n            activeAnnotation.highlighted = true;\n        }\n        else {\n            const cursorShape = this.registeredShapes.get(this.selectedShape);\n            const canvasCoords = eventData.currentPoints.canvas;\n            cursorShape.updateToolSize(canvasCoords, viewport, activeAnnotation);\n        }\n        triggerAnnotationRenderForViewportIds(this.commonData.viewportIdsToRender);\n    }\n    filterSculptableAnnotationsForElement(element) {\n        const config = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const sculptableAnnotations = [];\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n        config.referencedToolNames.forEach((referencedToolName) => {\n            const annotations = getAnnotations(referencedToolName, element);\n            if (annotations) {\n                sculptableAnnotations.push(...annotations);\n            }\n        });\n        return toolInstance.filterInteractableAnnotationsForElement(element, sculptableAnnotations);\n    }\n    configureToolSize(evt) {\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.configureToolSize(evt);\n    }\n    insertNewHandles(pushedHandles) {\n        const indicesToInsertAfter = this.findNewHandleIndices(pushedHandles);\n        let newIndexModifier = 0;\n        for (let i = 0; i < indicesToInsertAfter?.length; i++) {\n            const insertIndex = indicesToInsertAfter[i] + 1 + newIndexModifier;\n            this.insertHandleRadially(insertIndex);\n            newIndexModifier++;\n        }\n    }\n    findNewHandleIndices(pushedHandles) {\n        const { points, maxSpacing } = this.sculptData;\n        const indicesToInsertAfter = [];\n        for (let i = pushedHandles.first; i <= pushedHandles.last; i++) {\n            this.interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing);\n        }\n        return indicesToInsertAfter;\n    }\n    insertHandleRadially(insertIndex) {\n        const { points } = this.sculptData;\n        if (insertIndex > points.length - 1 &&\n            this.commonData.isEditingOpenContour) {\n            return;\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        const previousIndex = insertIndex - 1;\n        const nextIndex = contourIndex(insertIndex, points.length);\n        const insertPosition = cursorShape.getInsertPosition(previousIndex, nextIndex, this.sculptData);\n        const handleData = insertPosition;\n        points.splice(insertIndex, 0, handleData);\n    }\n    selectFreehandTool(eventData) {\n        const closestAnnotationUID = this.getClosestFreehandToolOnElement(eventData);\n        if (closestAnnotationUID === undefined) {\n            return;\n        }\n        this.commonData.activeAnnotationUID = closestAnnotationUID;\n    }\n    getClosestFreehandToolOnElement(eventData) {\n        const { element } = eventData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const config = this.configuration;\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const canvasPoints = eventData.currentPoints.canvas;\n        const closest = {\n            distance: Infinity,\n            toolIndex: undefined,\n            annotationUID: undefined,\n        };\n        for (let i = 0; i < annotations?.length; i++) {\n            if (annotations[i].isLocked || !annotations[i].isVisible) {\n                continue;\n            }\n            const distanceFromTool = distancePointToContour(viewport, annotations[i], canvasPoints);\n            if (distanceFromTool === -1) {\n                continue;\n            }\n            if (distanceFromTool < closest.distance) {\n                closest.distance = distanceFromTool;\n                closest.toolIndex = i;\n                closest.annotationUID = annotations[i].annotationUID;\n            }\n        }\n        this.commonData.isEditingOpenContour =\n            !annotations[closest.toolIndex].data.contour.closed;\n        config.referencedToolName =\n            annotations[closest.toolIndex].metadata.toolName;\n        return closest.annotationUID;\n    }\n    activateModify(element) {\n        element.addEventListener(Events.MOUSE_UP, this.endCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.addEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.addEventListener(Events.TOUCH_END, this.endCallback);\n        element.addEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    deactivateModify(element) {\n        element.removeEventListener(Events.MOUSE_UP, this.endCallback);\n        element.removeEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.removeEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.removeEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.removeEventListener(Events.TOUCH_END, this.endCallback);\n        element.removeEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    setToolShape(toolShape) {\n        this.selectedShape =\n            this.registeredShapes.get(toolShape) ?? CircleSculptCursor.shapeName;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const viewportIdsToRender = this.commonData.viewportIdsToRender;\n        if (!this.commonData.canvasLocation ||\n            this.mode !== ToolModes.Active ||\n            !viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        let color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Default, this.mode);\n        if (this.isActive) {\n            color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Highlighted, this.mode);\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.renderShape(svgDrawingHelper, this.commonData.canvasLocation, {\n            color,\n        });\n    }\n}\nexport const contourIndex = (i, length) => {\n    return (i + length) % length;\n};\nSculptorTool.toolName = 'SculptorTool';\nexport default SculptorTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nconst DIRECTIONS = {\n    X: [1, 0, 0],\n    Y: [0, 1, 0],\n    Z: [0, 0, 1],\n    CUSTOM: [],\n};\nclass VolumeRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            direction: DIRECTIONS.Z,\n            rotateIncrementDegrees: 30,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseWheelCallback(evt) {\n        const { element, wheel } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { direction, rotateIncrementDegrees } = this.configuration;\n        const camera = viewport.getCamera();\n        const { viewUp, position, focalPoint } = camera;\n        const { direction: deltaY } = wheel;\n        const [cx, cy, cz] = focalPoint;\n        const [ax, ay, az] = direction;\n        const angle = (deltaY * (rotateIncrementDegrees * Math.PI)) / 180;\n        const newPosition = [0, 0, 0];\n        const newFocalPoint = [0, 0, 0];\n        const newViewUp = [0, 0, 0];\n        const transform = mat4.identity(new Float32Array(16));\n        mat4.translate(transform, transform, [cx, cy, cz]);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        mat4.translate(transform, transform, [-cx, -cy, -cz]);\n        vec3.transformMat4(newPosition, position, transform);\n        vec3.transformMat4(newFocalPoint, focalPoint, transform);\n        mat4.identity(transform);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        vec3.transformMat4(newViewUp, viewUp, transform);\n        viewport.setCamera({\n            position: newPosition,\n            viewUp: newViewUp,\n            focalPoint: newFocalPoint,\n        });\n        viewport.render();\n    }\n}\nVolumeRotateTool.toolName = 'VolumeRotateMouseWheel';\nexport default VolumeRotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass LengthTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const dataId = `${annotationUID}-line`;\n                const lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const length = this._calculateLength(worldPos1, worldPos2) / scale;\n            this._isInsideVolume(index1, index2, dimensions)\n                ? (this.isHandleOutsideImage = false)\n                : (this.isHandleOutsideImage = true);\n            cachedStats[targetId] = {\n                length,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { length, unit } = cachedVolumeStats;\n    if (length === undefined || length === null || isNaN(length)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(length)} ${unit}`];\n    return textLines;\n}\nLengthTool.toolName = 'Length';\nexport default LengthTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawHeight as drawHeightSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass HeightTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const enabledElement = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const heightUID = '0';\n                drawHeightSvg(svgDrawingHelper, annotationUID, heightUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash: lineDash,\n                });\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateHeight(pos1, pos2) {\n        const dx = pos2[0] - pos1[0];\n        const dy = pos2[1] - pos1[1];\n        const dz = pos2[2] - pos1[2];\n        if (dx == 0) {\n            if (dy != 0) {\n                return Math.abs(dz);\n            }\n            else {\n                return 0;\n            }\n        }\n        else if (dy == 0) {\n            return Math.abs(dz);\n        }\n        else if (dz == 0) {\n            return Math.abs(dy);\n        }\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const height = this._calculateHeight(worldPos1, worldPos2) / scale;\n            const outside = this._isInsideVolume(index1, index2, dimensions);\n            this.isHandleOutsideImage = outside;\n            cachedStats[targetId] = {\n                height,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { height, unit } = cachedVolumeStats;\n    if (height === undefined || height === null || isNaN(height)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(height)} ${unit}`];\n    return textLines;\n}\nHeightTool.toolName = 'Height';\nexport default HeightTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nconst { transformWorldToIndex } = csUtils;\nclass ProbeTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { viewportId, renderingEngine } = getEnabledElement(element);\n            this.eventDispatchDetail = {\n                viewportId,\n                renderingEngineId: renderingEngine.id,\n            };\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points[0] = [...worldPos];\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const annotationUID = annotation.annotationUID;\n                const data = annotation.data;\n                const point = data.handles.points[0];\n                const canvasCoordinates = viewport.worldToCanvas(point);\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({ annotation, styleSpecifier });\n                if (!data.cachedStats) {\n                    data.cachedStats = {};\n                }\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].value == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        index: null,\n                        value: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const handleGroupUID = '0';\n                drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (textLines) {\n                    const textCanvasCoordinates = [\n                        canvasCoordinates[0] + 6,\n                        canvasCoordinates[1] - 6,\n                    ];\n                    const textUID = '0';\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], options);\n                }\n            }\n            return renderStatus;\n        };\n    }\n    isPointNearTool() {\n        return false;\n    }\n    toolSelectedCallback() { }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { data } = annotation;\n        const point = data.handles.points[0];\n        const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n        const near = vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity;\n        if (near === true) {\n            return point;\n        }\n    }\n    handleSelectedCallback(evt, annotation) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { renderingEngineId, viewport } = enabledElement;\n        const { element } = viewport;\n        const worldPos = data.handles.points[0];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const pixelUnitsOptions = {\n                isPreScaled: isViewportPreScaled(viewport, targetId),\n                isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n            };\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { dimensions, imageData, metadata, voxelManager } = image;\n            const modality = metadata.Modality;\n            let ijk = transformWorldToIndex(imageData, worldPos);\n            ijk = vec3.round(ijk, ijk);\n            if (csUtils.indexWithinDimensions(ijk, dimensions)) {\n                this.isHandleOutsideImage = false;\n                let value = voxelManager.getAtIJKPoint(ijk);\n                if (targetId.startsWith('imageId:')) {\n                    const imageId = targetId.split('imageId:')[1];\n                    const imageURI = csUtils.imageIdToURI(imageId);\n                    const viewports = csUtils.getViewportsWithImageURI(imageURI);\n                    const viewport = viewports[0];\n                    ijk[2] = viewport.getCurrentImageIdIndex();\n                }\n                let modalityUnit;\n                if (modality === 'US') {\n                    const calibratedResults = getCalibratedProbeUnitsAndValue(image, [\n                        ijk,\n                    ]);\n                    const hasEnhancedRegionValues = calibratedResults.values.every((value) => value !== null);\n                    value = (hasEnhancedRegionValues ? calibratedResults.values : value);\n                    modalityUnit = hasEnhancedRegionValues\n                        ? calibratedResults.units\n                        : 'raw';\n                }\n                else {\n                    modalityUnit = getPixelValueUnits(modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                }\n                cachedStats[targetId] = {\n                    index: ijk,\n                    value,\n                    Modality: modality,\n                    modalityUnit,\n                };\n            }\n            else {\n                this.isHandleOutsideImage = true;\n                cachedStats[targetId] = {\n                    index: ijk,\n                    Modality: modality,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    if (value instanceof Array && modalityUnit instanceof Array) {\n        for (let i = 0; i < value.length; i++) {\n            textLines.push(`${csUtils.roundNumber(value[i])} ${modalityUnit[i]}`);\n        }\n    }\n    else {\n        textLines.push(`${csUtils.roundNumber(value)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nProbeTool.toolName = 'Probe';\nexport default ProbeTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport ProbeTool from './ProbeTool';\nclass DragProbeTool extends ProbeTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.postMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                isVisible: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.postTouchStartCallback = (evt) => {\n            return this.postMouseDownCallback(evt);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const annotations = this.filterInteractableAnnotationsForElement(viewport.element, [this.editData.annotation]);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const annotation = this.editData.annotation;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const point = data.handles.points[0];\n            const canvasCoordinates = viewport.worldToCanvas(point);\n            styleSpecifier.annotationUID = annotationUID;\n            const { color } = this.getAnnotationStyle({\n                annotation,\n                styleSpecifier,\n            });\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].value == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    index: null,\n                    value: null,\n                };\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n            renderStatus = true;\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (textLines) {\n                const textCanvasCoordinates = [\n                    canvasCoordinates[0] + 6,\n                    canvasCoordinates[1] - 6,\n                ];\n                const textUID = '0';\n                drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], this.getLinkedTextBoxStyle(styleSpecifier, annotation));\n            }\n            return renderStatus;\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    textLines.push(`${value.toFixed(2)} ${modalityUnit}`);\n    return textLines;\n}\nDragProbeTool.toolName = 'DragProbe';\nexport default DragProbeTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawEllipseByCoordinates as drawEllipseSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { pointInEllipse, getCanvasEllipseCorners, } from '../../utilities/math/ellipse';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass EllipticalROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    initialRotation: viewport.getRotation(),\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                centerWorld: worldPos,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const canvasCorners = getCanvasEllipseCorners(canvasCoordinates);\n            const [canvasPoint1, canvasPoint2] = canvasCorners;\n            const minorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) + proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) + proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) - proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) - proximity,\n            };\n            const majorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) - proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) - proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) + proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) + proximity,\n            };\n            const pointInMinorEllipse = this._pointInEllipseCanvas(minorEllipse, canvasCoords);\n            const pointInMajorEllipse = this._pointInEllipseCanvas(majorEllipse, canvasCoords);\n            if (pointInMajorEllipse && !pointInMinorEllipse) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            let centerCanvas;\n            let centerWorld;\n            let canvasWidth;\n            let canvasHeight;\n            let originalHandleCanvas;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                const { viewport } = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = viewport;\n                handleIndex = points.findIndex((p) => p === handle);\n                const pointsCanvas = points.map(worldToCanvas);\n                originalHandleCanvas = pointsCanvas[handleIndex];\n                canvasWidth = Math.abs(pointsCanvas[2][0] - pointsCanvas[3][0]);\n                canvasHeight = Math.abs(pointsCanvas[0][1] - pointsCanvas[1][1]);\n                centerCanvas = [\n                    (pointsCanvas[2][0] + pointsCanvas[3][0]) / 2,\n                    (pointsCanvas[0][1] + pointsCanvas[1][1]) / 2,\n                ];\n                centerWorld = canvasToWorld(centerCanvas);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                canvasWidth,\n                canvasHeight,\n                centerWorld,\n                originalHandleCanvas,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerWorld } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const bottomCanvas = [centerCanvas[0], centerCanvas[1] - dY];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] + dY];\n            const leftCanvas = [centerCanvas[0] - dX, centerCanvas[1]];\n            const rightCanvas = [centerCanvas[0] + dX, centerCanvas[1]];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { viewport } = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = viewport;\n            const { annotation, canvasWidth, canvasHeight, handleIndex, centerWorld, originalHandleCanvas, } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0 || handleIndex === 1) {\n                const dYCanvas = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - dYCanvas,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n                const dXCanvas = currentCanvasPoints[0] - originalHandleCanvas[0];\n                const newHalfCanvasWidth = canvasWidth / 2 + dXCanvas;\n                const canvasLeft = [\n                    centerCanvas[0] - newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n            }\n            else {\n                const dXCanvas = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n                const canvasLeft = [\n                    centerCanvas[0] - dXCanvas,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + dXCanvas,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n                const dYCanvas = currentCanvasPoints[1] - originalHandleCanvas[1];\n                const newHalfCanvasHeight = canvasHeight / 2 + dYCanvas;\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - newHalfCanvasHeight,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + newHalfCanvasHeight,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasCorners = (getCanvasEllipseCorners(canvasCoordinates));\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-ellipse`;\n                const ellipseUID = '0';\n                drawEllipseSvg(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    const minRadius = Math.min(Math.abs(canvasCorners[0][0] - canvasCorners[1][0]) / 2, Math.abs(canvasCorners[0][1] - canvasCorners[1][1]) / 2);\n                    if (minRadius > 3 * centerPointRadius) {\n                        const centerPoint = this._getCanvasEllipseCenter(canvasCoordinates);\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${ellipseUID}-center`, centerPoint, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasEllipseCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const post2Index = transformWorldToIndex(imageData, worldPos2);\n                post2Index[0] = Math.floor(post2Index[0]);\n                post2Index[1] = Math.floor(post2Index[1]);\n                post2Index[2] = Math.floor(post2Index[2]);\n                this.isHandleOutsideImage = !this._isInsideVolume(pos1Index, post2Index, dimensions);\n                const iMin = Math.min(pos1Index[0], post2Index[0]);\n                const iMax = Math.max(pos1Index[0], post2Index[0]);\n                const jMin = Math.min(pos1Index[1], post2Index[1]);\n                const jMax = Math.max(pos1Index[1], post2Index[1]);\n                const kMin = Math.min(pos1Index[2], post2Index[2]);\n                const kMax = Math.max(pos1Index[2], post2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = [\n                    (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                    (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                    (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                ];\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                const handles = [pos1Index, post2Index];\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                const area = Math.abs(Math.PI * (worldWidth / 2) * (worldHeight / 2)) /\n                    scale /\n                    scale;\n                const pixelUnitsOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                    returnPoints: this.configuration.storePointData,\n                });\n                const stats = this.configuration.statsCalculator.getStatistics();\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    mean: stats.mean?.value,\n                    max: stats.max?.value,\n                    stdDev: stats.stdDev?.value,\n                    statsArray: stats.array,\n                    pointsInShape,\n                    isEmptyArea,\n                    areaUnit,\n                    modalityUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    _pointInEllipseCanvas(ellipse, location) {\n        const xRadius = ellipse.width / 2;\n        const yRadius = ellipse.height / 2;\n        if (xRadius <= 0.0 || yRadius <= 0.0) {\n            return false;\n        }\n        const center = [ellipse.left + xRadius, ellipse.top + yRadius];\n        const normalized = [location[0] - center[0], location[1] - center[1]];\n        const inEllipse = (normalized[0] * normalized[0]) / (xRadius * xRadius) +\n            (normalized[1] * normalized[1]) / (yRadius * yRadius) <=\n            1.0;\n        return inEllipse;\n    }\n    _getCanvasEllipseCenter(ellipseCanvasPoints) {\n        const [bottom, top, left, right] = ellipseCanvasPoints;\n        const topLeft = [left[0], top[1]];\n        const bottomRight = [right[0], bottom[1]];\n        return [\n            (topLeft[0] + bottomRight[0]) / 2,\n            (topLeft[1] + bottomRight[1]) / 2,\n        ];\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nEllipticalROITool.toolName = 'EllipticalROI';\nexport default EllipticalROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedAspect, getCalibratedLengthUnitsAndScale, } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const radius = getCanvasCircleRadius(canvasCoordinates);\n            const radiusPoint = getCanvasCircleRadius([\n                canvasCoordinates[0],\n                canvasCoords,\n            ]);\n            if (Math.abs(radiusPoint - radius) < proximity / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                data.handles.points[0],\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0) {\n                const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n                const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n                const canvasCenter = currentCanvasPoints;\n                const canvasEnd = [\n                    canvasCoordinates[1][0] + dXCanvas,\n                    canvasCoordinates[1][1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasCenter);\n                points[1] = canvasToWorld(canvasEnd);\n            }\n            else {\n                points[1] = canvasToWorld(currentCanvasPoints);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                        radius: null,\n                        radiusUnit: null,\n                        perimeter: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-circle`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const center = [\n                        (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                        (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                        (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                    ];\n                    const ellipseObj = {\n                        center,\n                        xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                        yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                        zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                    };\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, unit, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const aspect = getCalibratedAspect(image);\n                    const area = Math.abs(Math.PI *\n                        (worldWidth / scale / 2) *\n                        (worldHeight / aspect / scale / 2));\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        max: stats.max?.value,\n                        stdDev: stats.stdDev?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        isEmptyArea,\n                        areaUnit,\n                        radius: worldWidth / 2 / scale,\n                        radiusUnit: unit,\n                        perimeter: (2 * Math.PI * (worldWidth / 2)) / scale,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { radius, radiusUnit, area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit, } = cachedVolumeStats;\n    const textLines = [];\n    if (radius) {\n        const radiusLine = isEmptyArea\n            ? `Radius: Oblique not supported`\n            : `Radius: ${csUtils.roundNumber(radius)} ${radiusUnit}`;\n        textLines.push(radiusLine);\n    }\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nCircleROITool.toolName = 'CircleROI';\nexport default CircleROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawLine } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../../utilities/math/circle';\nimport { vec3 } from 'gl-matrix';\nconst CROSSHAIR_SIZE = 5;\nclass ETDRSGridTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            degrees: [45, 135, 225, 315],\n            diameters: [10, 30, 60],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                    },\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const center = viewport.worldToCanvas(points[0]);\n            const radius = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radius) < proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                canvasToWorld(currentCanvasPoints),\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { deltaPoints } = eventDetail;\n            const worldPosDelta = deltaPoints.world;\n            const points = data.handles.points;\n            points.forEach((point) => {\n                point[0] += worldPosDelta[0];\n                point[1] += worldPosDelta[1];\n                point[2] += worldPosDelta[2];\n            });\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n            const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n            const canvasCenter = currentCanvasPoints;\n            const canvasEnd = [\n                canvasCoordinates[1][0] + dXCanvas,\n                canvasCoordinates[1][1] + dYCanvas,\n            ];\n            points[0] = canvasToWorld(canvasCenter);\n            points[1] = canvasToWorld(canvasEnd);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const { renderingEngine } = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                let lineUID = `${annotationUID}-crosshair-vertical`;\n                let start = [center[0], center[1] + CROSSHAIR_SIZE];\n                let end = [center[0], center[1] - CROSSHAIR_SIZE];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                lineUID = `${annotationUID}-crosshair-horizontal`;\n                start = [center[0] + CROSSHAIR_SIZE, center[1]];\n                end = [center[0] - CROSSHAIR_SIZE, center[1]];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                const diametersCanvas = this.configuration.diameters.map((diameter) => this.worldMeasureToCanvas(diameter, viewport));\n                for (let i = 0; i < diametersCanvas.length; i++) {\n                    const dataId = `${annotationUID}-circle-${i}`;\n                    const circleUID = `${annotationUID}-circle-${i}`;\n                    drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, diametersCanvas[i] / 2, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    }, dataId);\n                }\n                const degreesRad = (x) => (x * Math.PI) / 180;\n                const angleRadians = this.configuration.degrees.map((degree) => degreesRad(degree));\n                for (let i = 0; i < angleRadians.length; i++) {\n                    const lineUID = `${annotationUID}-line-${i}`;\n                    const start = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[0]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[0]) / 2 + center[1],\n                    ];\n                    const end = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[2]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[2]) / 2 + center[1],\n                    ];\n                    drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n    worldMeasureToCanvas(measurement, viewport) {\n        const p1 = viewport.canvasToWorld([\n            viewport.canvas.width / 2,\n            viewport.canvas.height / 2,\n        ]);\n        const { viewUp } = viewport.getCamera();\n        const p2 = vec3.scaleAndAdd(vec3.create(), p1, viewUp, measurement);\n        const p1Canvas = viewport.worldToCanvas(p1);\n        const p2Canvas = viewport.worldToCanvas(p2);\n        const distance = Math.sqrt(Math.pow(p2Canvas[0] - p1Canvas[0], 2) +\n            Math.pow(p2Canvas[1] - p1Canvas[1], 2));\n        return distance;\n    }\n}\nETDRSGridTool.toolName = 'ETDRSGrid';\nexport default ETDRSGridTool;\n","import { getEnabledElement, eventTarget, triggerEvent, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getChildAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawPolyline as drawPolylineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, MouseBindings, KeyboardBindings, ChangeTypes, } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport * as math from '../../utilities/math';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { CardinalSpline } from './splines/CardinalSpline';\nimport { LinearSpline } from './splines/LinearSpline';\nimport { CatmullRomSpline } from './splines/CatmullRomSpline';\nimport { BSpline } from './splines/BSpline';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities';\nconst SPLINE_MIN_POINTS = 3;\nconst SPLINE_CLICK_CLOSE_CURVE_DIST = 10;\nconst DEFAULT_SPLINE_CONFIG = {\n    resolution: 20,\n    controlPointAdditionDistance: 6,\n    controlPointDeletionDistance: 6,\n    showControlPointsConnectors: false,\n    controlPointAdditionEnabled: true,\n    controlPointDeletionEnabled: true,\n};\nvar SplineTypesEnum;\n(function (SplineTypesEnum) {\n    SplineTypesEnum[\"Cardinal\"] = \"CARDINAL\";\n    SplineTypesEnum[\"Linear\"] = \"LINEAR\";\n    SplineTypesEnum[\"CatmullRom\"] = \"CATMULLROM\";\n    SplineTypesEnum[\"BSpline\"] = \"BSPLINE\";\n})(SplineTypesEnum || (SplineTypesEnum = {}));\nvar SplineToolActions;\n(function (SplineToolActions) {\n    SplineToolActions[\"AddControlPoint\"] = \"addControlPoint\";\n    SplineToolActions[\"DeleteControlPoint\"] = \"deleteControlPoint\";\n})(SplineToolActions || (SplineToolActions = {}));\nclass SplineROITool extends ContourSegmentationBaseTool {\n    static { this.SplineTypes = SplineTypesEnum; }\n    static { this.Actions = SplineToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            spline: {\n                configuration: {\n                    [SplineTypesEnum.Cardinal]: {\n                        Class: CardinalSpline,\n                        scale: 0.5,\n                    },\n                    [SplineTypesEnum.CatmullRom]: {\n                        Class: CatmullRomSpline,\n                    },\n                    [SplineTypesEnum.Linear]: {\n                        Class: LinearSpline,\n                    },\n                    [SplineTypesEnum.BSpline]: {\n                        Class: BSpline,\n                        controlPointAdditionEnabled: false,\n                        controlPointDeletionEnabled: false,\n                        showControlPointsConnectors: true,\n                    },\n                },\n                type: SplineTypesEnum.CatmullRom,\n                drawPreviewEnabled: true,\n                lastControlPointDeletionKeys: ['Backspace', 'Delete'],\n            },\n            actions: {\n                [SplineToolActions.AddControlPoint]: {\n                    method: 'addControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n                [SplineToolActions.DeleteControlPoint]: {\n                    method: 'deleteControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Ctrl,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.fireChangeOnUpdate = null;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { instance: spline } = annotation.data.spline;\n            return spline.isPointNearCurve(canvasCoords, proximity);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            annotation.autoGenerated = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const image = this.getTargetImageData(this.getTargetId(enabledElement.viewport));\n            const { imageData, dimensions } = image;\n            this.isHandleOutsideImage = data.handles.points\n                .map((p) => utilities.transformWorldToIndex(imageData, p))\n                .some((index) => !utilities.indexWithinDimensions(index, dimensions));\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            if (!this.fireChangeOnUpdate) {\n                this.fireChangeOnUpdate = {\n                    annotationUID: annotation.annotationUID,\n                    changeType,\n                    contourHoleProcessingEnabled,\n                };\n            }\n            else {\n                this.fireChangeOnUpdate.annotationUID = annotation.annotationUID;\n                this.fireChangeOnUpdate.changeType = changeType;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._keyDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const key = eventDetail.key ?? '';\n            const { lastControlPointDeletionKeys } = this.configuration.spline;\n            const deleteLastPoint = lastControlPointDeletionKeys.includes(key);\n            if (!deleteLastPoint) {\n                return;\n            }\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length === SPLINE_MIN_POINTS) {\n                this.cancel(element);\n                return;\n            }\n            else {\n                const controlPointIndex = data.handles.points.length - 1;\n                this._deleteControlPointByIndex(element, annotation, controlPointIndex);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { drawPreviewEnabled } = this.configuration.spline;\n            if (!drawPreviewEnabled) {\n                return;\n            }\n            const { element } = evt.detail;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = evt.detail.currentPoints.canvas;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            if (data.contour.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPoint, world: worldPoint } = currentPoints;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            let closeContour = data.handles.points.length >= 2 && doubleClick;\n            let addNewPoint = true;\n            if (data.handles.points.length >= 3) {\n                const { instance: spline } = data.spline;\n                const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n                if (closestControlPoint?.index === 0) {\n                    addNewPoint = false;\n                    closeContour = true;\n                }\n            }\n            if (addNewPoint) {\n                data.handles.points.push(worldPoint);\n            }\n            data.contour.closed = data.contour.closed || closeContour;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (data.contour.closed) {\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                this.moveAnnotation(annotation, worldPosDelta);\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.triggerAnnotationCompleted = (annotation, contourHoleProcessingEnabled) => {\n            const eventType = Events.ANNOTATION_COMPLETED;\n            const eventDetail = {\n                annotation,\n                changeType: ChangeTypes.Completed,\n                contourHoleProcessingEnabled,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled) => {\n            if (changeType === ChangeTypes.Completed) {\n                this.triggerAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                this.triggerAnnotationModified(annotation, enabledElement, changeType);\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.spline.instance.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.addControlPointCallback = (evt, annotation) => {\n            const { data } = annotation;\n            const splineType = data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointAdditionDistance;\n            if (splineConfig.controlPointAdditionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { instance: spline } = data.spline;\n            const canvasPos = evt.detail.currentPoints.canvas;\n            const closestPointInfo = spline.getClosestPoint(canvasPos);\n            if (closestPointInfo.distance > maxDist) {\n                return;\n            }\n            const { index, point: canvasPoint } = spline.addControlPointAtU(closestPointInfo.uValue);\n            data.handles.points.splice(index, 0, canvasToWorld(canvasPoint));\n            annotation.invalidated = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.deleteControlPointCallback = (evt, annotation) => {\n            const splineType = annotation.data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointDeletionDistance;\n            if (splineConfig.controlPointDeletionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const { canvas: canvasPos } = currentPoints;\n            const { instance: spline } = annotation.data.spline;\n            const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPos, maxDist);\n            if (!closestControlPoint) {\n                return;\n            }\n            this._deleteControlPointByIndex(element, annotation, closestControlPoint.index);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { canvas: canvasPos } = currentPoints;\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const annotation = this.createAnnotation(evt);\n        this.isDrawing = true;\n        this.addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n            lastCanvasPoint: canvasPos,\n            contourHoleProcessingEnabled,\n        };\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n        if (newAnnotation) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        super.cancelAnnotation(annotation);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        this.editData = null;\n        return annotation.annotationUID;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper, annotationStyle } = renderContext;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { element } = viewport;\n        const annotation = renderContext.annotation;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const { points: controlPoints, activeHandleIndex } = handles;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color, locked: annotationLocked, } = annotationStyle;\n        const canvasCoordinates = controlPoints.map((p) => worldToCanvas(p));\n        const { drawPreviewEnabled } = this.configuration.spline;\n        const splineType = annotation.data.spline.type;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = annotation.data.spline.instance;\n        const childAnnotations = getChildAnnotations(annotation);\n        const missingAnnotation = childAnnotations.findIndex((it) => !it);\n        if (missingAnnotation !== -1) {\n            throw new Error(`Can't find annotation for child ${annotation.childAnnotationUIDs.join()}`);\n        }\n        const splineAnnotationsGroup = [annotation, ...childAnnotations].filter((annotation) => this._isSplineROIAnnotation(annotation));\n        splineAnnotationsGroup.forEach((annotation) => {\n            const spline = this._updateSplineInstance(element, annotation);\n            const splinePolylineCanvas = spline.getPolylinePoints();\n            this.updateContourPolyline(annotation, {\n                points: splinePolylineCanvas,\n                closed: data.contour.closed,\n                targetWindingDirection: ContourWindingDirection.Clockwise,\n            }, viewport, { updateWindingDirection: data.contour.closed });\n        });\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        let activeHandleCanvasCoords;\n        if (!annotationLocked && !this.editData && activeHandleIndex !== null) {\n            activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (activeHandleCanvasCoords || newAnnotation || highlighted) {\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                color,\n                lineWidth,\n                handleRadius: '3',\n            });\n        }\n        if (drawPreviewEnabled &&\n            spline.numControlPoints > 1 &&\n            this.editData?.lastCanvasPoint &&\n            !spline.closed) {\n            const { lastCanvasPoint } = this.editData;\n            const previewPolylinePoints = spline.getPreviewPolylinePoints(lastCanvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'previewSplineChange', previewPolylinePoints, {\n                color: '#9EA0CA',\n                lineDash: lineDash,\n                lineWidth: 1,\n            });\n        }\n        if (splineConfig.showControlPointsConnectors) {\n            const controlPointsConnectors = [...canvasCoordinates];\n            if (spline.closed) {\n                controlPointsConnectors.push(canvasCoordinates[0]);\n            }\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'controlPointsConnectors', controlPointsConnectors, {\n                color: 'rgba(255, 255, 255, 0.5)',\n                lineWidth: 1,\n            });\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        if (this.fireChangeOnUpdate?.annotationUID === annotationUID) {\n            this.triggerChangeEvent(annotation, enabledElement, this.fireChangeOnUpdate.changeType, this.fireChangeOnUpdate.contourHoleProcessingEnabled);\n            this.fireChangeOnUpdate = null;\n        }\n        annotation.invalidated = false;\n        return true;\n    }\n    createInterpolatedSplineControl(annotation) {\n        if (annotation.data.handles.points?.length) {\n            return;\n        }\n        const { polyline } = annotation.data.contour;\n        if (!polyline || !polyline.length) {\n            return;\n        }\n        annotation.data.handles.points = [];\n        const { points } = annotation.data.handles;\n        const increment = Math.max(10, Math.floor(polyline.length / 20));\n        for (let i = 0; i < polyline.length - increment; i += increment) {\n            points.push(polyline[i]);\n        }\n        points.push(polyline[polyline.length - 1]);\n    }\n    createAnnotation(evt) {\n        const contourAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const { type: splineType } = this.configuration.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = new splineConfig.Class();\n        const createSpline = () => ({\n            type: splineConfig.type,\n            instance: spline,\n            resolution: splineConfig.resolution,\n        });\n        let onInterpolationComplete;\n        if (this.configuration.interpolation?.enabled) {\n            onInterpolationComplete = (annotation) => {\n                annotation.data.spline ||= createSpline();\n                this.createInterpolatedSplineControl(annotation);\n            };\n        }\n        return utilities.deepMerge(contourAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n                spline: createSpline(),\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n    }\n    _deleteControlPointByIndex(element, annotation, controlPointIndex) {\n        const enabledElement = getEnabledElement(element);\n        const { points: controlPoints } = annotation.data.handles;\n        if (controlPoints.length === 3) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        else {\n            controlPoints.splice(controlPointIndex, 1);\n        }\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        annotation.invalidated = true;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    _isSplineROIAnnotation(annotation) {\n        return !!annotation.data?.spline;\n    }\n    _getSplineConfig(type) {\n        const { configuration: config } = this;\n        const splineConfigs = config.spline.configuration;\n        return Object.assign({ type }, DEFAULT_SPLINE_CONFIG, splineConfigs[type]);\n    }\n    _updateSplineInstance(element, annotation) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { data } = annotation;\n        const { type: splineType, instance: spline } = annotation.data.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const worldPoints = data.handles.points;\n        const canvasPoints = worldPoints.map(worldToCanvas);\n        const resolution = splineConfig.resolution !== undefined\n            ? parseInt(splineConfig.resolution)\n            : undefined;\n        const scale = splineConfig.scale !== undefined\n            ? parseFloat(splineConfig.scale)\n            : undefined;\n        spline.setControlPoints(canvasPoints);\n        spline.closed = !!data.contour.closed;\n        if (!spline.fixedResolution &&\n            resolution !== undefined &&\n            spline.resolution !== resolution) {\n            spline.resolution = resolution;\n            annotation.invalidated = true;\n        }\n        if (spline instanceof CardinalSpline &&\n            !spline.fixedScale &&\n            scale !== undefined &&\n            spline.scale !== scale) {\n            spline.scale = scale;\n            annotation.invalidated = true;\n        }\n        return spline;\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (points.length < SPLINE_MIN_POINTS) {\n            console.warn('Spline requires at least 3 control points');\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const splineType = options?.splineType || SplineTypesEnum.CatmullRom;\n        const splineConfig = instance._getSplineConfig(splineType);\n        const SplineClass = splineConfig.Class;\n        const splineInstance = new SplineClass();\n        const canvasPoints = points.map((point) => viewport.worldToCanvas(point));\n        splineInstance.setControlPoints(canvasPoints);\n        const splinePolylineCanvas = splineInstance.getPolylinePoints();\n        const splinePolylineWorld = splinePolylineCanvas.map((point) => viewport.canvasToWorld(point));\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n                label: '',\n                cachedStats: {},\n                spline: {\n                    type: splineType,\n                    instance: splineInstance,\n                },\n                contour: {\n                    closed: true,\n                    polyline: splinePolylineWorld,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: true,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, isEmptyArea, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${utilities.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\nSplineROITool.toolName = 'SplineROI';\nexport default SplineROITool;\n","import { utilities } from '@cornerstonejs/core';\nimport SplineROITool from './SplineROITool';\nclass SplineContourSegmentationTool extends SplineROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nSplineContourSegmentationTool.toolName = 'SplineContourSegmentationTool';\nexport default SplineContourSegmentationTool;\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, VolumeViewport, utilities, triggerEvent, eventTarget, } from '@cornerstonejs/core';\nimport { removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, KeyboardBindings, ChangeTypes } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport * as math from '../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport findHandlePolylineIndex from '../../utilities/contours/findHandlePolylineIndex';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { triggerAnnotationModified, triggerContourAnnotationCompleted, } from '../../stateManagement/annotation/helpers/state';\nimport { LivewireScissors } from '../../utilities/livewire/LivewireScissors';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale, throttle } from '../../utilities';\nconst CLICK_CLOSE_CURVE_SQR_DIST = 10 ** 2;\nclass LivewireContourTool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextLines: defaultGetTextLines,\n            calculateStats: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            snapHandleNearby: 2,\n            interpolation: {\n                enabled: false,\n                nearestEdge: 2,\n                showInterpolationPolyline: false,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            actions: {\n                undo: {\n                    method: 'undo',\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const proximitySquared = proximity * proximity;\n            const canvasPoints = annotation.data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            let startPoint = canvasPoints[canvasPoints.length - 1];\n            for (let i = 0; i < canvasPoints.length; i++) {\n                const endPoint = canvasPoints[i];\n                const distanceToPointSquared = math.lineSegment.distanceToPointSquared(startPoint, endPoint, canvasCoords);\n                if (distanceToPointSquared <= proximitySquared) {\n                    return true;\n                }\n                startPoint = endPoint;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt, clearAnnotation = false) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            if ((this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) ||\n                clearAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n                this.clearEditData();\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                return;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            this.triggerChangeEvent(annotation, enabledElement, changeType, contourHoleProcessingEnabled);\n            this.clearEditData();\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled = false) => {\n            if (changeType === ChangeTypes.Completed) {\n                triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, changeType);\n            }\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender, worldToSlice, sliceToWorld } = this.editData;\n            if (this.editData.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPos, world: worldPosOriginal } = currentPoints;\n            let worldPos = worldPosOriginal;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const controlPoints = this.editData.currentPath.getControlPoints();\n            let closePath = controlPoints.length >= 2 && doubleClick;\n            if (controlPoints.length >= 2) {\n                const closestHandlePoint = {\n                    index: -1,\n                    distSquared: Infinity,\n                };\n                for (let i = 0, len = controlPoints.length; i < len; i++) {\n                    const controlPoint = controlPoints[i];\n                    const worldControlPoint = sliceToWorld(controlPoint);\n                    const canvasControlPoint = viewport.worldToCanvas(worldControlPoint);\n                    const distSquared = math.point.distanceToPointSquared(canvasPos, canvasControlPoint);\n                    if (distSquared <= CLICK_CLOSE_CURVE_SQR_DIST &&\n                        distSquared < closestHandlePoint.distSquared) {\n                        closestHandlePoint.distSquared = distSquared;\n                        closestHandlePoint.index = i;\n                    }\n                }\n                if (closestHandlePoint.index === 0) {\n                    closePath = true;\n                }\n            }\n            const { snapHandleNearby } = this.configuration;\n            if (snapHandleNearby && !this.editData.closed) {\n                const currentPath = new LivewirePath();\n                const snapPoint = this.scissors.findMinNearby(worldToSlice(worldPosOriginal), 1);\n                const pathPoints = this.scissors.findPathToPoint(snapPoint);\n                currentPath.addPoints(pathPoints);\n                currentPath.prependPath(this.editData.confirmedPath);\n                worldPos = sliceToWorld(snapPoint);\n                this.editData.currentPath = currentPath;\n            }\n            this.editData.closed = this.editData.closed || closePath;\n            this.editData.confirmedPath = this.editData.currentPath;\n            const lastPoint = this.editData.currentPath.getLastPoint();\n            this.editData.confirmedPath.addControlPoint(lastPoint);\n            annotation.data.handles.points.push(sliceToWorld(lastPoint));\n            this.scissors.startSearch(worldToSlice(worldPos));\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (this.editData.closed) {\n                this.updateAnnotation(this.editData.confirmedPath);\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { element, currentPoints } = evt.detail;\n            const { world: worldPos, canvas: canvasPos } = currentPoints;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = canvasPos;\n            const { width: imgWidth, height: imgHeight } = this.scissors;\n            const { worldToSlice } = this.editData;\n            const slicePoint = worldToSlice(worldPos);\n            if (slicePoint[0] < 0 ||\n                slicePoint[1] < 0 ||\n                slicePoint[0] >= imgWidth ||\n                slicePoint[1] >= imgHeight) {\n                return;\n            }\n            const pathPoints = this.scissors.findPathToPoint(slicePoint);\n            const currentPath = new LivewirePath();\n            currentPath.addPoints(pathPoints);\n            currentPath.prependPath(this.editData.confirmedPath);\n            this.editData.currentPath = currentPath;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                console.warn('Drag annotation not implemented');\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                this.editHandle(worldPos, element, annotation, handleIndex);\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            if (newAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.scissors = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit: areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.contour.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    setupBaseEditData(worldPos, element, annotation, nextPos, contourHoleProcessingEnabled) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        this.isDrawing = true;\n        const viewportImageData = viewport.getImageData();\n        const { imageData: vtkImageData } = viewportImageData;\n        let worldToSlice;\n        let sliceToWorld;\n        let width;\n        let height;\n        let scalarData;\n        if (!(viewport instanceof VolumeViewport)) {\n            width = viewportImageData.dimensions[0];\n            height = viewportImageData.dimensions[1];\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                return [ijkPoint[0], ijkPoint[1]];\n            };\n            sliceToWorld = (point) => csUtils.transformIndexToWorld(vtkImageData, [point[0], point[1], 0]);\n            scalarData = viewportImageData.scalarData;\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const sliceImageData = csUtils.getCurrentVolumeViewportSlice(viewport);\n            const { sliceToIndexMatrix, indexToSliceMatrix } = sliceImageData;\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                const slicePoint = vec3.transformMat4([0, 0, 0], ijkPoint, indexToSliceMatrix);\n                return [slicePoint[0], slicePoint[1]];\n            };\n            sliceToWorld = (point) => {\n                const ijkPoint = vec3.transformMat4([0, 0, 0], [point[0], point[1], 0], sliceToIndexMatrix);\n                return csUtils.transformIndexToWorld(vtkImageData, ijkPoint);\n            };\n            scalarData = sliceImageData.scalarData;\n            width = sliceImageData.width;\n            height = sliceImageData.height;\n        }\n        else {\n            throw new Error('Viewport not supported');\n        }\n        scalarData = csUtils.convertToGrayscale(scalarData, width, height);\n        const { voiRange } = viewport.getProperties();\n        const startPos = worldToSlice(worldPos);\n        this.scissors = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n        if (nextPos) {\n            this.scissorsNext = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n            this.scissorsNext.startSearch(worldToSlice(nextPos));\n        }\n        this.scissors.startSearch(startPos);\n        const newAnnotation = !nextPos;\n        const confirmedPath = new LivewirePath();\n        const currentPath = new LivewirePath();\n        const currentPathNext = newAnnotation ? undefined : new LivewirePath();\n        confirmedPath.addPoint(startPos);\n        confirmedPath.addControlPoint(startPos);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        const lastCanvasPoint = viewport.worldToCanvas(worldPos);\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            newAnnotation,\n            hasMoved: false,\n            lastCanvasPoint,\n            confirmedPath,\n            currentPath,\n            confirmedPathNext: currentPathNext,\n            closed: false,\n            handleIndex: this.editData?.handleIndex ?? annotation.handles?.activeHandleIndex,\n            worldToSlice,\n            sliceToWorld,\n            contourHoleProcessingEnabled,\n        };\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { world: worldPos } = currentPoints;\n        const annotation = this.createAnnotation(evt);\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        this.setupBaseEditData(worldPos, element, annotation, undefined, contourHoleProcessingEnabled);\n        this.addAnnotation(annotation, element);\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(this.editData.viewportIdsToRender);\n        return annotation;\n    }\n    clearEditData() {\n        this.editData = null;\n        this.scissors = null;\n        this.scissorsNext = null;\n        this.isDrawing = false;\n    }\n    editHandle(worldPos, element, annotation, handleIndex) {\n        const { data } = annotation;\n        const { points: handlePoints } = data.handles;\n        const { length: numHandles } = handlePoints;\n        const previousHandle = handlePoints[(handleIndex - 1 + numHandles) % numHandles];\n        const nextHandle = handlePoints[(handleIndex + 1) % numHandles];\n        if (!this.editData?.confirmedPathNext) {\n            this.setupBaseEditData(previousHandle, element, annotation, nextHandle);\n            const { polyline } = data.contour;\n            const confirmedPath = new LivewirePath();\n            const confirmedPathNext = new LivewirePath();\n            const { worldToSlice } = this.editData;\n            const previousIndex = findHandlePolylineIndex(annotation, handleIndex - 1);\n            const nextIndex = findHandlePolylineIndex(annotation, handleIndex + 1);\n            if (nextIndex === -1 || previousIndex === -1) {\n                throw new Error(`Can't find handle index ${nextIndex === -1 && nextHandle} ${previousIndex === -1 && previousHandle}`);\n            }\n            if (handleIndex === 0) {\n                confirmedPathNext.addPoints(polyline.slice(nextIndex + 1, previousIndex).map(worldToSlice));\n            }\n            else {\n                confirmedPath.addPoints(polyline.slice(0, previousIndex + 1).map(worldToSlice));\n                confirmedPathNext.addPoints(polyline.slice(nextIndex, polyline.length).map(worldToSlice));\n            }\n            this.editData.confirmedPath = confirmedPath;\n            this.editData.confirmedPathNext = confirmedPathNext;\n        }\n        const { editData, scissors } = this;\n        const { worldToSlice, sliceToWorld } = editData;\n        const { activeHandleIndex } = data.handles;\n        if (activeHandleIndex === null || activeHandleIndex === undefined) {\n            data.handles.activeHandleIndex = handleIndex;\n        }\n        else if (activeHandleIndex !== handleIndex) {\n            throw new Error(`Trying to edit a different handle than the one currently being edited ${handleIndex}!==${data.handles.activeHandleIndex}`);\n        }\n        const slicePos = worldToSlice(worldPos);\n        if (slicePos[0] < 0 ||\n            slicePos[0] >= scissors.width ||\n            slicePos[1] < 0 ||\n            slicePos[1] >= scissors.height) {\n            return;\n        }\n        handlePoints[handleIndex] = sliceToWorld(slicePos);\n        const pathPointsLeft = scissors.findPathToPoint(slicePos);\n        const pathPointsRight = this.scissorsNext.findPathToPoint(slicePos);\n        const currentPath = new LivewirePath();\n        currentPath.prependPath(editData.confirmedPath);\n        if (handleIndex !== 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        currentPath.addPoints(pathPointsRight.reverse());\n        currentPath.appendPath(editData.confirmedPathNext);\n        if (handleIndex === 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        editData.currentPath = currentPath;\n        annotation.invalidated = true;\n        editData.hasMoved = true;\n        editData.closed = true;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        this.updateAnnotation(this.editData?.currentPath);\n        return super.renderAnnotation(enabledElement, svgDrawingHelper);\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const contourSegmentationAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const annotation = csUtils.deepMerge(contourSegmentationAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n            },\n        });\n        return annotation;\n    }\n    undo(element, config, evt) {\n        if (!this.editData) {\n            return;\n        }\n        this._endCallback(evt, true);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { annotation, enabledElement, svgDrawingHelper, annotationStyle, targetId, } = renderContext;\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const { worldToCanvas } = viewport;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color } = annotationStyle;\n        if (highlighted ||\n            (newAnnotation &&\n                annotation.annotationUID === this.editData?.annotation?.annotationUID)) {\n            const handleGroupUID = '0';\n            const canvasHandles = handles.points.map(worldToCanvas);\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasHandles, {\n                color,\n                lineDash,\n                lineWidth,\n            });\n        }\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        return true;\n    }\n    updateAnnotation(livewirePath) {\n        if (!this.editData || !livewirePath) {\n            return;\n        }\n        const { annotation, sliceToWorld, worldToSlice, closed, newAnnotation } = this.editData;\n        let { pointArray: imagePoints } = livewirePath;\n        if (imagePoints.length > 1) {\n            imagePoints = [...imagePoints, imagePoints[0]];\n        }\n        const targetWindingDirection = newAnnotation && closed ? ContourWindingDirection.Clockwise : undefined;\n        this.updateContourPolyline(annotation, {\n            points: imagePoints,\n            closed,\n            targetWindingDirection,\n        }, {\n            canvasToWorld: sliceToWorld,\n            worldToCanvas: worldToSlice,\n        });\n    }\n}\nLivewireContourTool.toolName = 'LivewireContour';\nexport default LivewireContourTool;\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport LivewireContourTool from './LivewireContourTool';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { ChangeTypes } from '../../enums';\nimport { drawPolyline as drawPolylineSvg } from '../../drawingSvg';\nclass LivewireContourSegmentationTool extends LivewireContourTool {\n    updateInterpolatedAnnotation(annotation, enabledElement) {\n        if (this.editData ||\n            !annotation.invalidated ||\n            !annotation.data.handles.interpolationSources) {\n            return;\n        }\n        annotation.data.contour.originalPolyline = annotation.data.contour.polyline;\n        queueMicrotask(() => {\n            if (!annotation.data.handles.interpolationSources) {\n                return;\n            }\n            const { points } = annotation.data.handles;\n            const { element } = enabledElement.viewport;\n            this.setupBaseEditData(points[0], element, annotation);\n            const { length: count } = points;\n            const { scissors } = this;\n            const { nearestEdge, repeatInterpolation } = this.configuration.interpolation;\n            annotation.data.handles.originalPoints = points;\n            const { worldToSlice, sliceToWorld } = this.editData;\n            const handleSmoothing = [];\n            if (nearestEdge) {\n                let lastPoint = worldToSlice(points[points.length - 1]);\n                points.forEach((point, hIndex) => {\n                    const testPoint = worldToSlice(point);\n                    lastPoint = testPoint;\n                    handleSmoothing.push(testPoint);\n                    scissors.startSearch(lastPoint);\n                    scissors.findPathToPoint(testPoint);\n                    scissors.findPathToPoint(worldToSlice(points[(hIndex + 3) % points.length]));\n                    const minPoint = scissors.findMinNearby(testPoint, nearestEdge);\n                    if (!csUtils.isEqual(testPoint, minPoint)) {\n                        handleSmoothing[hIndex] = minPoint;\n                        lastPoint = minPoint;\n                        points[hIndex] = sliceToWorld(minPoint);\n                    }\n                });\n            }\n            const acceptedPath = new LivewirePath();\n            for (let i = 0; i < count; i++) {\n                scissors.startSearch(worldToSlice(points[i]));\n                const path = scissors.findPathToPoint(worldToSlice(points[(i + 1) % count]));\n                acceptedPath.addPoints(path);\n            }\n            this.updateAnnotation(acceptedPath);\n            this.scissors = null;\n            this.scissorsNext = null;\n            this.editData = null;\n            annotation.data.handles.interpolationSources = null;\n            if (repeatInterpolation) {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.InterpolationUpdated);\n            }\n        });\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        const { annotationUID } = annotation;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { showInterpolationPolyline } = this.configuration.interpolation || {};\n        this.updateInterpolatedAnnotation?.(annotation, enabledElement);\n        const { originalPolyline } = annotation.data.contour;\n        const rendered = super.renderAnnotationInstance(renderContext);\n        if (showInterpolationPolyline &&\n            originalPolyline &&\n            annotation.autoGenerated) {\n            const polylineCanvasPoints = originalPolyline.map(worldToCanvas);\n            polylineCanvasPoints.push(polylineCanvasPoints[0]);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'interpolationContour-0', polylineCanvasPoints, {\n                color: '#70ffff',\n                lineWidth: 1,\n                fillOpacity: 0,\n            });\n        }\n        return rendered;\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nLivewireContourSegmentationTool.toolName = 'LivewireContourSegmentationTool';\nexport default LivewireContourSegmentationTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawArrow as drawArrowSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass ArrowAnnotateTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            getTextCallback,\n            changeTextCallback,\n            preventHandleOutsideImage: false,\n            arrowFirst: true,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const { arrowFirst } = this.configuration;\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    text: '',\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        arrowFirst,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            if (newAnnotation) {\n                this.configuration.getTextCallback((text) => {\n                    if (!text) {\n                        removeAnnotation(annotation.annotationUID);\n                        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                        this.editData = null;\n                        this.isDrawing = false;\n                        return;\n                    }\n                    annotation.data.text = text;\n                    triggerAnnotationCompleted(annotation);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                });\n            }\n            else {\n                triggerAnnotationModified(annotation, element);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.touchTapCallback = (evt) => {\n            if (evt.detail.taps == 2) {\n                this.doubleClickCallback(evt);\n            }\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.editData = null;\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles, text } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineWidth,\n                    });\n                }\n                const arrowUID = '1';\n                if (this.configuration.arrowFirst) {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[1], canvasCoordinates[0], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                else {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!text) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, [text], textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nArrowAnnotateTool.toolName = 'ArrowAnnotate';\nexport default ArrowAnnotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass AngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2, point3] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            if (!point3) {\n                return false;\n            }\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const line2 = {\n                start: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n                end: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length === 2) {\n                this.editData.handleIndex = 2;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.angleStartedNotYetCompleted = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotation.annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                let lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length !== 3) {\n                    return renderStatus;\n                }\n                lineUID = '2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], canvasCoordinates[2], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 3) {\n            return;\n        }\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const worldPos3 = data.handles.points[2];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const angle = angleBetweenLines([worldPos1, worldPos2], [worldPos2, worldPos3]);\n            const { dimensions, imageData } = this.getTargetImageData(targetId);\n            this.isHandleOutsideImage = [worldPos1, worldPos2, worldPos3]\n                .map((worldPos) => csUtils.transformWorldToIndex(imageData, worldPos))\n                .some((index) => !csUtils.indexWithinDimensions(index, dimensions));\n            cachedStats[targetId] = {\n                angle: isNaN(angle) ? 'Incomplete Angle' : angle,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    if (isNaN(angle)) {\n        return [`${angle}`];\n    }\n    const textLines = [\n        `${csUtils.roundNumber(angle)} ${String.fromCharCode(176)}`,\n    ];\n    return textLines;\n}\nAngleTool.toolName = 'Angle';\nexport default AngleTool;\n","import { vec3 } from 'gl-matrix';\nimport { Events } from '../../enums';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { midPoint2 } from '../../utilities/math/midPoint';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass CobbAngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            showArcLines: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { distanceToPoint, distanceToPoint2 } = this.distanceToLines({\n                viewport,\n                points: data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            if (distanceToPoint <= proximity || distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType, canvasCoords, proximity = 6) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { isNearFirstLine, isNearSecondLine } = this.distanceToLines({\n                viewport,\n                points: annotation.data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length < 4) {\n                resetElementCursor(element);\n                this.editData.handleIndex = data.handles.points.length;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._mouseDownCallback = (evt) => {\n            const { annotation, handleIndex } = this.editData;\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { data } = annotation;\n            if (handleIndex === 1) {\n                data.handles.points[1] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[1][0] !== data.handles.points[0][0] ||\n                        data.handles.points[1][1] !== data.handles.points[0][0];\n                return;\n            }\n            if (handleIndex === 3) {\n                data.handles.points[3] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[3][0] !== data.handles.points[2][0] ||\n                        data.handles.points[3][1] !== data.handles.points[2][0];\n                this.angleStartedNotYetCompleted = false;\n                return;\n            }\n            this.editData.hasMoved = false;\n            hideElementCursor(element);\n            data.handles.points[2] = data.handles.points[3] = worldPos;\n            this.editData.handleIndex = data.handles.points.length - 1;\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, isNearFirstLine, isNearSecondLine, } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined &&\n                (isNearFirstLine || isNearSecondLine)) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                if (isNearFirstLine) {\n                    const firstLinePoints = [points[0], points[1]];\n                    firstLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                else if (isNearSecondLine) {\n                    const secondLinePoints = [points[2], points[3]];\n                    secondLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length < 4) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.angleStartedNotYetCompleted = false;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                        arc1Angle: null,\n                        arc2Angle: null,\n                        points: {\n                            world: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                            canvas: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                        },\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const firstLine = [canvasCoordinates[0], canvasCoordinates[1]];\n                const secondLine = [canvasCoordinates[2], canvasCoordinates[3]];\n                let lineUID = 'line1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, firstLine[0], firstLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length < 4) {\n                    return renderStatus;\n                }\n                lineUID = 'line2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, secondLine[0], secondLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                lineUID = 'linkLine';\n                const mid1 = midPoint2(firstLine[0], firstLine[1]);\n                const mid2 = midPoint2(secondLine[0], secondLine[1]);\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, mid1, mid2, {\n                    color,\n                    lineWidth: '1',\n                    lineDash: '1,4',\n                });\n                const { arc1Start, arc1End, arc2End, arc2Start } = data.cachedStats[targetId].points.canvas;\n                const { arc1Angle, arc2Angle } = data.cachedStats[targetId];\n                if (this.configuration.showArcLines) {\n                    lineUID = 'arc1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc1Start, arc1End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                    lineUID = 'arc2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc2Start, arc2End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                }\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = 'cobbAngleText';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n                if (this.configuration.showArcLines) {\n                    const arc1TextBoxUID = 'arcAngle1';\n                    const arc1TextLine = [\n                        `${arc1Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch1TextPosCanvas = midPoint2(arc1Start, arc1End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc1TextBoxUID, arc1TextLine, arch1TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                    const arc2TextBoxUID = 'arcAngle2';\n                    const arc2TextLine = [\n                        `${arc2Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch2TextPosCanvas = midPoint2(arc2Start, arc2End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc2TextBoxUID, arc2TextLine, arch2TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                }\n            }\n            return renderStatus;\n        };\n        this.distanceToLines = ({ viewport, points, canvasCoords, proximity }) => {\n            const [point1, point2, point3, point4] = points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const canvasPoint4 = viewport.worldToCanvas(point4);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const line2 = {\n                start: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n                end: {\n                    x: canvasPoint4[0],\n                    y: canvasPoint4[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            let isNearFirstLine = false;\n            let isNearSecondLine = false;\n            if (distanceToPoint <= proximity) {\n                isNearFirstLine = true;\n            }\n            else if (distanceToPoint2 <= proximity) {\n                isNearSecondLine = true;\n            }\n            return {\n                distanceToPoint,\n                distanceToPoint2,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n        };\n        this.getArcsStartEndPoints = ({ firstLine, secondLine, mid1, mid2, }) => {\n            const linkLine = [mid1, mid2];\n            const arc1Angle = angleBetweenLines(firstLine, linkLine);\n            const arc2Angle = angleBetweenLines(secondLine, linkLine);\n            const arc1Side = arc1Angle > 90 ? 1 : 0;\n            const arc2Side = arc2Angle > 90 ? 0 : 1;\n            const midLinkLine = midPoint2(linkLine[0], linkLine[1]);\n            const linkLineLength = Math.sqrt((linkLine[1][0] - linkLine[0][0]) ** 2 +\n                (linkLine[1][1] - linkLine[0][1]) ** 2);\n            const ratio = 0.1;\n            const midFirstLine = midPoint2(firstLine[0], firstLine[1]);\n            const midSecondLine = midPoint2(secondLine[0], secondLine[1]);\n            const directionVectorStartArc1 = [\n                firstLine[arc1Side][0] - midFirstLine[0],\n                firstLine[arc1Side][1] - midFirstLine[1],\n            ];\n            const magnitudeStartArc1 = Math.sqrt(directionVectorStartArc1[0] ** 2 + directionVectorStartArc1[1] ** 2);\n            const normalizedDirectionStartArc1 = [\n                directionVectorStartArc1[0] / magnitudeStartArc1,\n                directionVectorStartArc1[1] / magnitudeStartArc1,\n            ];\n            const arc1Start = [\n                midFirstLine[0] +\n                    normalizedDirectionStartArc1[0] * linkLineLength * ratio,\n                midFirstLine[1] +\n                    normalizedDirectionStartArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc1 = [\n                midLinkLine[0] - mid1[0],\n                midLinkLine[1] - mid1[1],\n            ];\n            const magnitudeEndArc1 = Math.sqrt(directionVectorEndArc1[0] ** 2 + directionVectorEndArc1[1] ** 2);\n            const normalizedDirectionEndArc1 = [\n                directionVectorEndArc1[0] / magnitudeEndArc1,\n                directionVectorEndArc1[1] / magnitudeEndArc1,\n            ];\n            const arc1End = [\n                mid1[0] + normalizedDirectionEndArc1[0] * linkLineLength * ratio,\n                mid1[1] + normalizedDirectionEndArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorStartArc2 = [\n                secondLine[arc2Side][0] - midSecondLine[0],\n                secondLine[arc2Side][1] - midSecondLine[1],\n            ];\n            const magnitudeStartArc2 = Math.sqrt(directionVectorStartArc2[0] ** 2 + directionVectorStartArc2[1] ** 2);\n            const normalizedDirectionStartArc2 = [\n                directionVectorStartArc2[0] / magnitudeStartArc2,\n                directionVectorStartArc2[1] / magnitudeStartArc2,\n            ];\n            const arc2Start = [\n                midSecondLine[0] +\n                    normalizedDirectionStartArc2[0] * linkLineLength * ratio,\n                midSecondLine[1] +\n                    normalizedDirectionStartArc2[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc2 = [\n                midLinkLine[0] - mid2[0],\n                midLinkLine[1] - mid2[1],\n            ];\n            const magnitudeEndArc2 = Math.sqrt(directionVectorEndArc2[0] ** 2 + directionVectorEndArc2[1] ** 2);\n            const normalizedDirectionEndArc2 = [\n                directionVectorEndArc2[0] / magnitudeEndArc2,\n                directionVectorEndArc2[1] / magnitudeEndArc2,\n            ];\n            const arc2End = [\n                mid2[0] + normalizedDirectionEndArc2[0] * linkLineLength * ratio,\n                mid2[1] + normalizedDirectionEndArc2[1] * linkLineLength * ratio,\n            ];\n            return {\n                arc1Start,\n                arc1End,\n                arc2Start,\n                arc2End,\n                arc1Angle: arc1Angle > 90 ? 180 - arc1Angle : arc1Angle,\n                arc2Angle: arc2Angle > 90 ? 180 - arc2Angle : arc2Angle,\n            };\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 25, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle, interactionType = 'mouse') {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        if (data.handles.points.length !== 4) {\n            return;\n        }\n        const seg1 = [null, null];\n        const seg2 = [null, null];\n        let minDist = Number.MAX_VALUE;\n        for (let i = 0; i < 2; i += 1) {\n            for (let j = 2; j < 4; j += 1) {\n                const dist = vec3.distance(data.handles.points[i], data.handles.points[j]);\n                if (dist < minDist) {\n                    minDist = dist;\n                    seg1[1] = data.handles.points[i];\n                    seg1[0] = data.handles.points[(i + 1) % 2];\n                    seg2[0] = data.handles.points[j];\n                    seg2[1] = data.handles.points[2 + ((j - 1) % 2)];\n                }\n            }\n        }\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const canvasPoints = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const firstLine = [canvasPoints[0], canvasPoints[1]];\n        const secondLine = [canvasPoints[2], canvasPoints[3]];\n        const mid1 = midPoint2(firstLine[0], firstLine[1]);\n        const mid2 = midPoint2(secondLine[0], secondLine[1]);\n        const { arc1Start, arc1End, arc2End, arc2Start, arc1Angle, arc2Angle } = this.getArcsStartEndPoints({\n            firstLine,\n            secondLine,\n            mid1,\n            mid2,\n        });\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            cachedStats[targetId] = {\n                angle: angleBetweenLines(seg1, seg2),\n                arc1Angle,\n                arc2Angle,\n                points: {\n                    canvas: {\n                        arc1Start,\n                        arc1End,\n                        arc2End,\n                        arc2Start,\n                    },\n                    world: {\n                        arc1Start: viewport.canvasToWorld(arc1Start),\n                        arc1End: viewport.canvasToWorld(arc1End),\n                        arc2End: viewport.canvasToWorld(arc2End),\n                        arc2Start: viewport.canvasToWorld(arc2Start),\n                    },\n                },\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    const textLines = [`${angle.toFixed(2)} ${String.fromCharCode(176)}`];\n    return textLines;\n}\nCobbAngleTool.toolName = 'CobbAngle';\nexport default CobbAngleTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, StackViewport, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandle as drawHandleSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { distanceToPoint } from '../../utilities/math/point';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nconst { transformWorldToIndex } = csUtils;\nclass UltrasoundDirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            displayBothAxesDistances: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.startedDrawing) {\n                return;\n            }\n            this.startedDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('UltrasoundDirectionalTool can only be used on a StackViewport');\n            }\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            return false;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.startedDrawing && data.handles.points.length === 1) {\n                this.editData.handleIndex = 1;\n                return;\n            }\n            this.startedDrawing = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.startedDrawing = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].xValues == null) {\n                    data.cachedStats[targetId] = {\n                        xValues: [0, 0],\n                        yValues: [0, 0],\n                        isHorizontal: false,\n                        units: [''],\n                        isUnitless: false,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let handleGroupUID = '0';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[0], {\n                    color,\n                }, 0);\n                renderStatus = true;\n                if (canvasCoordinates.length !== 2) {\n                    return renderStatus;\n                }\n                handleGroupUID = '1';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[1], {\n                    color,\n                }, 1);\n                const isUnitless = data.cachedStats[targetId].isUnitless;\n                if (!isUnitless) {\n                    const canvasPoint1 = canvasCoordinates[0];\n                    const canvasPoint2 = canvasCoordinates[1];\n                    const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                    const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                    const isHorizontal = data.cachedStats[targetId].isHorizontal;\n                    let projectedPointCanvas = [0, 0];\n                    if (isHorizontal) {\n                        projectedPointCanvas = [\n                            canvasPoint1[0] + canvasDeltaX,\n                            canvasPoint1[1],\n                        ];\n                    }\n                    else {\n                        projectedPointCanvas = [\n                            canvasPoint1[0],\n                            canvasPoint1[1] + canvasDeltaY,\n                        ];\n                    }\n                    let dataId = `${annotationUID}-line-1`;\n                    let lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                    dataId = `${annotationUID}-line-2`;\n                    lineUID = '2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        lineDash: [1, 1],\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                else {\n                    const dataId = `${annotationUID}-line-1`;\n                    const lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId, this.configuration);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    toolSelectedCallback(evt, annotation, interactionType, canvasCoords) {\n        return;\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        this.editData = {\n            handleIndex,\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 2) {\n            return;\n        }\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData } = image;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const imageIndex1 = transformWorldToIndex(imageData, worldPos1);\n            const imageIndex2 = transformWorldToIndex(imageData, worldPos2);\n            const { values: values1, units: units1 } = getCalibratedProbeUnitsAndValue(image, [imageIndex1]);\n            const { values: values2, units: units2 } = getCalibratedProbeUnitsAndValue(image, [imageIndex2]);\n            let xValues, yValues, units, isHorizontal;\n            let isUnitless = false;\n            if (units1[0] !== units2[0] ||\n                units1[1] !== units2[1] ||\n                (units1[0] === 'raw' && units2[0] === 'raw')) {\n                const value = distanceToPoint(worldPos1, worldPos2);\n                xValues = [value, 0];\n                yValues = [value, 0];\n                units = ['px'];\n                isUnitless = true;\n            }\n            else {\n                const canvasPoint1 = enabledElement.viewport.worldToCanvas(worldPos1);\n                const canvasPoint2 = enabledElement.viewport.worldToCanvas(worldPos2);\n                const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                isHorizontal = Math.abs(canvasDeltaX) > Math.abs(canvasDeltaY);\n                xValues = [values1[0], values2[0]];\n                yValues = [values1[1], values2[1]];\n                units = [units1[0], units1[1]];\n            }\n            cachedStats[targetId] = {\n                xValues,\n                yValues,\n                isHorizontal,\n                units,\n                isUnitless,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId, configuration) {\n    const cachedStats = data.cachedStats[targetId];\n    const { xValues, yValues, units, isUnitless, isHorizontal } = cachedStats;\n    if (isUnitless) {\n        return [`${csUtils.roundNumber(xValues[0])} px`];\n    }\n    if (configuration.displayBothAxesDistances) {\n        const dist1 = Math.abs(xValues[1] - xValues[0]);\n        const dist2 = Math.abs(yValues[1] - yValues[0]);\n        return [\n            `${csUtils.roundNumber(dist1)} ${units[0]}`,\n            `${csUtils.roundNumber(dist2)} ${units[1]}`,\n        ];\n    }\n    if (isHorizontal) {\n        const dist = Math.abs(xValues[1] - xValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[0]}`];\n    }\n    else {\n        const dist = Math.abs(yValues[1] - yValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[1]}`];\n    }\n}\nUltrasoundDirectionalTool.toolName = 'UltrasoundDirectionalTool';\nexport default UltrasoundDirectionalTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawArrow as drawArrowSvg } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nclass KeyImageTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextCallback,\n            changeTextCallback,\n            canvasPosition: [10, 10],\n            canvasSize: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = KeyImageTool.createAnnotation({\n                metadata: { ...viewport.getViewReference(), referencedImageId },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.configuration.getTextCallback((text) => {\n                if (!text) {\n                    removeAnnotation(annotation.annotationUID);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                    this.isDrawing = false;\n                    return;\n                }\n                annotation.data.text = text;\n                triggerAnnotationCompleted(annotation);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            });\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { canvasPosition, canvasSize } = this.configuration;\n            if (!canvasPosition?.length) {\n                return false;\n            }\n            if (Math.abs(canvasCoords[0] - canvasPosition[0] + canvasSize / 2) <=\n                canvasSize / 2 &&\n                Math.abs(canvasCoords[1] - canvasPosition[1] + canvasSize / 2) <=\n                    canvasSize / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            annotation.highlighted = true;\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { canvasPosition, canvasSize } = this.configuration;\n                if (canvasPosition?.length) {\n                    const arrowUID = '1';\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasPosition.map((it) => it + canvasSize), canvasPosition, {\n                        color,\n                        width: 1,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n            }\n            return renderStatus;\n        };\n    }\n    cancel() {\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nKeyImageTool.toolName = 'KeyImage';\nexport default KeyImageTool;\n","import { BaseTool } from './base';\nimport { getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { setAnnotationSelected } from '../stateManagement/annotation/annotationSelection';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass AnnotationEraserTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'mouse');\n        };\n        this.preTouchStartCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'touch');\n        };\n    }\n    _deleteNearbyAnnotations(evt, interactionType) {\n        const { renderingEngineId, viewportId, element, currentPoints } = evt.detail;\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        if (!toolGroup) {\n            return false;\n        }\n        const tools = toolGroup._toolInstances;\n        const annotationsToRemove = [];\n        for (const toolName in tools) {\n            const toolInstance = tools[toolName];\n            if (typeof toolInstance.isPointNearTool !== 'function' ||\n                typeof toolInstance.filterInteractableAnnotationsForElement !==\n                    'function') {\n                continue;\n            }\n            const annotations = getAnnotations(toolName, element);\n            if (!annotations.length) {\n                continue;\n            }\n            const interactableAnnotations = toolInstance.filterInteractableAnnotationsForElement(element, annotations) || [];\n            for (const annotation of interactableAnnotations) {\n                if (toolInstance.isPointNearTool(element, annotation, currentPoints.canvas, 10, interactionType)) {\n                    annotationsToRemove.push(annotation.annotationUID);\n                }\n            }\n        }\n        for (const annotationUID of annotationsToRemove) {\n            setAnnotationSelected(annotationUID);\n            removeAnnotation(annotationUID);\n        }\n        evt.preventDefault();\n        return true;\n    }\n}\nAnnotationEraserTool.toolName = 'Eraser';\nexport default AnnotationEraserTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideRectangle } from './strategies/fillRectangle';\nimport { eraseInsideRectangle } from './strategies/eraseRectangle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawRect as drawRectSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nclass RectangleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideRectangle,\n                ERASE_INSIDE: eraseInsideRectangle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            points[handleIndex] = [...worldPos];\n            let bottomLeftCanvas;\n            let bottomRightCanvas;\n            let topLeftCanvas;\n            let topRightCanvas;\n            let bottomLeftWorld;\n            let bottomRightWorld;\n            let topLeftWorld;\n            let topRightWorld;\n            switch (handleIndex) {\n                case 0:\n                case 3:\n                    bottomLeftCanvas = worldToCanvas(points[0]);\n                    topRightCanvas = worldToCanvas(points[3]);\n                    bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                    topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                    bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                    topLeftWorld = canvasToWorld(topLeftCanvas);\n                    points[1] = bottomRightWorld;\n                    points[2] = topLeftWorld;\n                    break;\n                case 1:\n                case 2:\n                    bottomRightCanvas = worldToCanvas(points[1]);\n                    topLeftCanvas = worldToCanvas(points[2]);\n                    bottomLeftCanvas = [\n                        topLeftCanvas[0],\n                        bottomRightCanvas[1],\n                    ];\n                    topRightCanvas = [bottomRightCanvas[0], topLeftCanvas[1]];\n                    bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                    topRightWorld = canvasToWorld(topRightCanvas);\n                    points[0] = bottomLeftWorld;\n                    points[3] = topRightWorld;\n                    break;\n            }\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const rectangleUID = '0';\n            drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nRectangleScissorsTool.toolName = 'RectangleScissor';\nexport default RectangleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideCircle } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, config as segmentationConfig, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nclass CircleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideCircle,\n                ERASE_INSIDE: eraseInsideCircle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData.Labelmap;\n            if (!labelmapData) {\n                throw new Error('No labelmap data found for the active segmentation, create one before using scissors tool');\n            }\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    isDrawing: true,\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                viewPlaneNormal,\n                viewUp,\n                strategySpecificConfiguration: {},\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nCircleScissorsTool.toolName = 'CircleScissor';\nexport default CircleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getSegmentation } from '../../stateManagement/segmentation/segmentationState';\nclass SphereScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideSphere,\n                ERASE_INSIDE: eraseInsideSphere,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            this.isDrawing = true;\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    highlighted: true,\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                toolGroupId: this.toolGroupId,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                this.editData = {\n                    ...this.editData,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved, segmentIndex, segmentsLocked, } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                segmentIndex,\n                segmentsLocked,\n                viewPlaneNormal,\n                viewUp,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nSphereScissorsTool.toolName = 'SphereScissor';\nexport default SphereScissorsTool;\n","import { StackViewport, cache, getEnabledElement, utilities as csUtils, utilities as coreUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, removeAnnotation, getAnnotations, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport throttle from '../../utilities/throttle';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport CircleROITool from '../annotation/CircleROITool';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedAspect, } from '../../utilities/getCalibratedUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROIStartEndThresholdTool extends CircleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            calculatePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    volumeId,\n                    spacingInNormal,\n                    enabledElement,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        statistics: [],\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let tempStartCoordinate = startCoordinate;\n                let tempEndCoordinate = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    tempStartCoordinate = this._getCoordinateForViewplaneNormal(tempStartCoordinate, viewplaneNormal);\n                    data.startCoordinate = tempStartCoordinate;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    tempEndCoordinate = this._getCoordinateForViewplaneNormal(tempEndCoordinate, viewplaneNormal);\n                    data.endCoordinate = tempEndCoordinate;\n                }\n                const roundedStartCoordinate = coreUtils.roundToPrecision(data.startCoordinate);\n                const roundedEndCoordinate = coreUtils.roundToPrecision(data.endCoordinate);\n                const cameraCoordinate = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCameraCoordinate = coreUtils.roundToPrecision(cameraCoordinate);\n                if (roundedCameraCoordinate <\n                    Math.min(roundedStartCoordinate, roundedEndCoordinate) ||\n                    roundedCameraCoordinate >\n                        Math.max(roundedStartCoordinate, roundedEndCoordinate)) {\n                    continue;\n                }\n                const middleCoordinate = coreUtils.roundToPrecision((data.startCoordinate + data.endCoordinate) / 2);\n                let isMiddleSlice = false;\n                if (roundedCameraCoordinate === middleCoordinate) {\n                    isMiddleSlice = true;\n                }\n                data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = middleCoordinate;\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    isMiddleSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineWidthToUse = lineWidth;\n                let lineDashToUse = lineDash;\n                if (isMiddleSlice) {\n                    lineWidthToUse = lineWidth;\n                    lineDashToUse = [];\n                }\n                else {\n                    lineDashToUse = [5, 5];\n                }\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth: lineWidthToUse,\n                });\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                if (this.configuration.showTextBox == true &&\n                    this.configuration.calculatePointsInsideVolume == true) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    let canvasTextBoxCoords;\n                    if (!data.handles.textBox.hasMoved) {\n                        canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const handlesToStart = csUtils.deepClone(points);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n            handlesToStart[0][2] = startCoordinate;\n            handlesToStart[1][2] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n            handlesToStart[0][0] = startCoordinate;\n            handlesToStart[1][0] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n            handlesToStart[0][1] = startCoordinate;\n            handlesToStart[1][1] = startCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(handlesToStart.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n        const pos1 = viewport.canvasToWorld(topLeftCanvas);\n        const pos2 = viewport.canvasToWorld(bottomRightCanvas);\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, pos1, pos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.handles);\n        const aspect = getCalibratedAspect(image);\n        const area = Math.abs(Math.PI *\n            (worldWidth / measureInfo.scale / 2) *\n            (worldHeight / aspect / measureInfo.scale / 2));\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const centerWorld = projectionPoints[i][0];\n            const canvasCoordinates = projectionPoints[i].map((p) => viewport.worldToCanvas(p));\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, centerWorld);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = centerWorld;\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS),\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateFromStart = Math.round(numSlicesToPropagate / 2);\n        const startPos = vec3.create();\n        vec3.scaleAndAdd(startPos, worldPos, viewPlaneNormal, numSlicesToPropagateFromStart * -spacingInNormal);\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateToEnd = numSlicesToPropagate - Math.round(numSlicesToPropagate / 2);\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagateToEnd * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nCircleROIStartEndThresholdTool.toolName = 'CircleROIStartEndThreshold';\nexport default CircleROIStartEndThresholdTool;\n","import { cache, getEnabledElement, utilities as csUtils, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, } from '../../stateManagement/segmentation';\nimport floodFill from '../../utilities/segmentation/floodFill';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nconst { transformWorldToIndex, isEqual } = csUtils;\nclass PaintFillTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const { representationData } = getSegmentation(segmentationId);\n            let dimensions;\n            let direction;\n            let scalarData;\n            let index;\n            let voxelManager;\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n                const segmentation = cache.getVolume(volumeId);\n                ({ dimensions, direction } = segmentation);\n                voxelManager = segmentation.voxelManager;\n                index = transformWorldToIndex(segmentation.imageData, worldPos);\n            }\n            else {\n                const currentSegmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                if (!currentSegmentationImageId) {\n                    throw new Error('No active segmentation imageId detected, create one before using scissors tool');\n                }\n                const { imageData } = viewport.getImageData();\n                dimensions = imageData.getDimensions();\n                direction = imageData.getDirection();\n                const image = cache.getImage(currentSegmentationImageId);\n                voxelManager = image.voxelManager;\n                index = transformWorldToIndex(imageData, worldPos);\n            }\n            const fixedDimension = this.getFixedDimension(viewPlaneNormal, direction);\n            if (fixedDimension === undefined) {\n                console.warn('Oblique paint fill not yet supported');\n                return;\n            }\n            const { floodFillGetter, getLabelValue, getScalarDataPositionFromPlane, inPlaneSeedPoint, fixedDimensionValue, } = this.generateHelpers(voxelManager, dimensions, index, fixedDimension);\n            if (index[0] < 0 ||\n                index[0] >= dimensions[0] ||\n                index[1] < 0 ||\n                index[1] >= dimensions[1] ||\n                index[2] < 0 ||\n                index[2] >= dimensions[2]) {\n                return;\n            }\n            const clickedLabelValue = getLabelValue(index[0], index[1], index[2]);\n            if (segmentsLocked.includes(clickedLabelValue)) {\n                return;\n            }\n            const floodFillResult = floodFill(floodFillGetter, inPlaneSeedPoint);\n            const { flooded } = floodFillResult;\n            flooded.forEach((index) => {\n                const scalarDataIndex = getScalarDataPositionFromPlane(index[0], index[1]);\n                voxelManager.setAtIndex(scalarDataIndex, segmentIndex);\n            });\n            const framesModified = this.getFramesModified(fixedDimension, fixedDimensionValue, floodFillResult);\n            triggerSegmentationDataModified(segmentationId, framesModified);\n            return true;\n        };\n        this.getFramesModified = (fixedDimension, fixedDimensionValue, floodFillResult) => {\n            const { boundaries } = floodFillResult;\n            if (fixedDimension === 2) {\n                return [fixedDimensionValue];\n            }\n            let minJ = Infinity;\n            let maxJ = -Infinity;\n            for (let b = 0; b < boundaries.length; b++) {\n                const j = boundaries[b][1];\n                if (j < minJ) {\n                    minJ = j;\n                }\n                if (j > maxJ) {\n                    maxJ = j;\n                }\n            }\n            const framesModified = [];\n            for (let frame = minJ; frame <= maxJ; frame++) {\n                framesModified.push(frame);\n            }\n            return framesModified;\n        };\n        this.generateHelpers = (voxelManager, dimensions, seedIndex3D, fixedDimension = 2) => {\n            let fixedDimensionValue;\n            let inPlaneSeedPoint;\n            switch (fixedDimension) {\n                case 0:\n                    fixedDimensionValue = seedIndex3D[0];\n                    inPlaneSeedPoint = [seedIndex3D[1], seedIndex3D[2]];\n                    break;\n                case 1:\n                    fixedDimensionValue = seedIndex3D[1];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[2]];\n                    break;\n                case 2:\n                    fixedDimensionValue = seedIndex3D[2];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[1]];\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            const getScalarDataPosition = (x, y, z) => {\n                return voxelManager.toIndex([x, y, z]);\n            };\n            const getLabelValue = (x, y, z) => {\n                return voxelManager.getAtIJK(x, y, z);\n            };\n            const floodFillGetter = this.generateFloodFillGetter(dimensions, fixedDimension, fixedDimensionValue, getLabelValue);\n            const getScalarDataPositionFromPlane = this.generateGetScalarDataPositionFromPlane(getScalarDataPosition, fixedDimension, fixedDimensionValue);\n            return {\n                getScalarDataPositionFromPlane,\n                getLabelValue,\n                floodFillGetter,\n                inPlaneSeedPoint,\n                fixedDimensionValue,\n            };\n        };\n        this.generateFloodFillGetter = (dimensions, fixedDimension, fixedDimensionValue, getLabelValue) => {\n            let floodFillGetter;\n            switch (fixedDimension) {\n                case 0:\n                    floodFillGetter = (y, z) => {\n                        if (y >= dimensions[1] || y < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    floodFillGetter = (x, z) => {\n                        if (x >= dimensions[0] || x < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    floodFillGetter = (x, y) => {\n                        if (x >= dimensions[0] || x < 0 || y >= dimensions[1] || y < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return floodFillGetter;\n        };\n        this.generateGetScalarDataPositionFromPlane = (getScalarDataPosition, fixedDimension, fixedDimensionValue) => {\n            let getScalarDataPositionFromPlane;\n            switch (fixedDimension) {\n                case 0:\n                    getScalarDataPositionFromPlane = (y, z) => {\n                        return getScalarDataPosition(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    getScalarDataPositionFromPlane = (x, z) => {\n                        return getScalarDataPosition(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    getScalarDataPositionFromPlane = (x, y) => {\n                        return getScalarDataPosition(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return getScalarDataPositionFromPlane;\n        };\n    }\n    getFixedDimension(viewPlaneNormal, direction) {\n        const xDirection = direction.slice(0, 3);\n        const yDirection = direction.slice(3, 6);\n        const zDirection = direction.slice(6, 9);\n        const absoluteOfViewPlaneNormal = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const absoluteOfXDirection = [\n            Math.abs(xDirection[0]),\n            Math.abs(xDirection[1]),\n            Math.abs(xDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfXDirection)) {\n            return 0;\n        }\n        const absoluteOfYDirection = [\n            Math.abs(yDirection[0]),\n            Math.abs(yDirection[1]),\n            Math.abs(yDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfYDirection)) {\n            return 1;\n        }\n        const absoluteOfZDirection = [\n            Math.abs(zDirection[0]),\n            Math.abs(zDirection[1]),\n            Math.abs(zDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfZDirection)) {\n            return 2;\n        }\n    }\n}\nPaintFillTool.toolName = 'PaintFill';\nexport default PaintFillTool;\n","import vtkOrientationMarkerWidget from '@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget';\nimport vtkAnnotatedCubeActor from '@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor';\nimport vtkAxesActor from '@kitware/vtk.js/Rendering/Core/AxesActor';\nimport vtkActor from '@kitware/vtk.js/Rendering/Core/Actor';\nimport vtkMapper from '@kitware/vtk.js/Rendering/Core/Mapper';\nimport vtkXMLPolyDataReader from '@kitware/vtk.js/IO/XML/XMLPolyDataReader';\nimport vtkPolyData from '@kitware/vtk.js/Common/DataModel/PolyData';\nimport { BaseTool } from './base';\nimport { Enums, eventTarget, getEnabledElementByIds, getRenderingEngines, } from '@cornerstonejs/core';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { Events } from '../enums';\nvar OverlayMarkerType;\n(function (OverlayMarkerType) {\n    OverlayMarkerType[OverlayMarkerType[\"ANNOTATED_CUBE\"] = 1] = \"ANNOTATED_CUBE\";\n    OverlayMarkerType[OverlayMarkerType[\"AXES\"] = 2] = \"AXES\";\n    OverlayMarkerType[OverlayMarkerType[\"CUSTOM\"] = 3] = \"CUSTOM\";\n})(OverlayMarkerType || (OverlayMarkerType = {}));\nclass OrientationMarkerTool extends BaseTool {\n    static { this.CUBE = 1; }\n    static { this.AXIS = 2; }\n    static { this.VTPFILE = 3; }\n    static { this.OVERLAY_MARKER_TYPES = OverlayMarkerType; }\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            orientationWidget: {\n                enabled: true,\n                viewportCorner: vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT,\n                viewportSize: 0.15,\n                minPixelSize: 100,\n                maxPixelSize: 300,\n            },\n            overlayMarkerType: OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE,\n            overlayConfiguration: {\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE]: {\n                    faceProperties: {\n                        xPlus: { text: 'L', faceColor: '#ffff00', faceRotation: 90 },\n                        xMinus: { text: 'R', faceColor: '#ffff00', faceRotation: 270 },\n                        yPlus: {\n                            text: 'P',\n                            faceColor: '#00ffff',\n                            fontColor: 'white',\n                            faceRotation: 180,\n                        },\n                        yMinus: { text: 'A', faceColor: '#00ffff', fontColor: 'white' },\n                        zPlus: { text: 'S' },\n                        zMinus: { text: 'I' },\n                    },\n                    defaultStyle: {\n                        fontStyle: 'bold',\n                        fontFamily: 'Arial',\n                        fontColor: 'black',\n                        fontSizeScale: (res) => res / 2,\n                        faceColor: '#0000ff',\n                        edgeThickness: 0.1,\n                        edgeColor: 'black',\n                        resolution: 400,\n                    },\n                },\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.AXES]: {},\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.CUSTOM]: {\n                    polyDataURL: 'https://raw.githubusercontent.com/Slicer/Slicer/80ad0a04dacf134754459557bf2638c63f3d1d1b/Base/Logic/Resources/OrientationMarkers/Human.vtp',\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this.onSetToolEnabled = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolActive = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolDisabled = () => {\n            this.cleanUpData();\n            this._unsubscribeToViewportNewVolumeSet();\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resize = (viewportId) => {\n            const orientationMarker = this.orientationMarkers[viewportId];\n            if (!orientationMarker) {\n                return;\n            }\n            const { orientationWidget } = orientationMarker;\n            orientationWidget.updateViewport();\n        };\n        this.orientationMarkers = {};\n        this.updatingOrientationMarker = {};\n    }\n    _unsubscribeToViewportNewVolumeSet() {\n        const unsubscribe = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = this._resizeObservers.get(viewportId);\n                resizeObserver.unobserve(element);\n            });\n        };\n        eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            unsubscribe();\n            this.initViewports();\n        });\n    }\n    _subscribeToViewportEvents() {\n        const subscribeToElementResize = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                this.initViewports();\n                element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = new ResizeObserver(() => {\n                    setTimeout(() => {\n                        const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                        if (!element) {\n                            return;\n                        }\n                        const { viewport } = element;\n                        this.resize(viewportId);\n                        viewport.render();\n                    }, 100);\n                });\n                resizeObserver.observe(element);\n                this._resizeObservers.set(viewportId, resizeObserver);\n            });\n        };\n        subscribeToElementResize();\n        eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            subscribeToElementResize();\n            this.initViewports();\n        });\n    }\n    cleanUpData() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        const viewports = renderingEngine.getViewports();\n        viewports.forEach((viewport) => {\n            const orientationMarker = this.orientationMarkers[viewport.id];\n            if (!orientationMarker) {\n                return;\n            }\n            const { actor, orientationWidget } = orientationMarker;\n            orientationWidget?.setEnabled(false);\n            orientationWidget?.delete();\n            actor?.delete();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            delete this.orientationMarkers[viewport.id];\n        });\n    }\n    initViewports() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        if (!renderingEngine) {\n            return;\n        }\n        let viewports = renderingEngine.getViewports();\n        viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n        viewports.forEach((viewport) => {\n            const widget = viewport.getWidget(this.getToolName());\n            if (!widget || widget.isDeleted()) {\n                this.addAxisActorInViewport(viewport);\n            }\n        });\n    }\n    async addAxisActorInViewport(viewport) {\n        const viewportId = viewport.id;\n        if (!this.updatingOrientationMarker[viewportId]) {\n            this.updatingOrientationMarker[viewportId] = true;\n            const type = this.configuration.overlayMarkerType;\n            const overlayConfiguration = this.configuration.overlayConfiguration[type];\n            if (this.orientationMarkers[viewportId]) {\n                const { actor, orientationWidget } = this.orientationMarkers[viewportId];\n                viewport.getRenderer().removeActor(actor);\n                orientationWidget.setEnabled(false);\n            }\n            let actor;\n            if (type === 1) {\n                actor = this.createAnnotationCube(overlayConfiguration);\n            }\n            else if (type === 2) {\n                actor = vtkAxesActor.newInstance();\n            }\n            else if (type === 3) {\n                actor = await this.createCustomActor();\n            }\n            const renderer = viewport.getRenderer();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            const { enabled, viewportCorner, viewportSize, minPixelSize, maxPixelSize, } = this.configuration.orientationWidget;\n            const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n                actor,\n                interactor: renderWindow.getInteractor(),\n                parentRenderer: renderer,\n            });\n            orientationWidget.setEnabled(enabled);\n            orientationWidget.setViewportCorner(viewportCorner);\n            orientationWidget.setViewportSize(viewportSize);\n            orientationWidget.setMinPixelSize(minPixelSize);\n            orientationWidget.setMaxPixelSize(maxPixelSize);\n            orientationWidget.updateMarkerOrientation();\n            this.orientationMarkers[viewportId] = {\n                orientationWidget,\n                actor,\n            };\n            viewport.addWidget(this.getToolName(), orientationWidget);\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            this.updatingOrientationMarker[viewportId] = false;\n        }\n    }\n    async createCustomActor() {\n        const url = this.configuration.overlayConfiguration[OverlayMarkerType.CUSTOM]\n            .polyDataURL;\n        const response = await fetch(url);\n        const arrayBuffer = await response.arrayBuffer();\n        const vtpReader = vtkXMLPolyDataReader.newInstance();\n        vtpReader.parseAsArrayBuffer(arrayBuffer);\n        vtpReader.update();\n        const polyData = vtkPolyData.newInstance();\n        polyData.shallowCopy(vtpReader.getOutputData());\n        polyData.getPointData().setActiveScalars('Color');\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputData(polyData);\n        mapper.setColorModeToDirectScalars();\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n        actor.rotateZ(180);\n        return actor;\n    }\n    createAnnotationCube(overlayConfiguration) {\n        const actor = vtkAnnotatedCubeActor.newInstance();\n        actor.setDefaultStyle({ ...overlayConfiguration.defaultStyle });\n        actor.setXPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.xPlus,\n        });\n        actor.setXMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.xMinus,\n        });\n        actor.setYPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.yPlus,\n        });\n        actor.setYMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.yMinus,\n        });\n        actor.setZPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.zPlus,\n        });\n        actor.setZMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.zMinus,\n        });\n        return actor;\n    }\n    async createAnnotatedCubeActor() {\n        const axes = vtkAnnotatedCubeActor.newInstance();\n        const { faceProperties, defaultStyle } = this.configuration.annotatedCube;\n        axes.setDefaultStyle(defaultStyle);\n        Object.keys(faceProperties).forEach((key) => {\n            const methodName = `set${key.charAt(0).toUpperCase() + key.slice(1)}FaceProperty`;\n            axes[methodName](faceProperties[key]);\n        });\n        return axes;\n    }\n}\nOrientationMarkerTool.toolName = 'OrientationMarker';\nexport default OrientationMarkerTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { triggerSegmentationModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/activeSegmentation';\nimport RepresentationTypes from '../../enums/SegmentationRepresentations';\nimport { setActiveSegmentIndex } from '../../stateManagement/segmentation/segmentIndex';\nimport { getHoveredContourSegmentationAnnotation, getSegmentIndexAtLabelmapBorder, getSegmentIndexAtWorldPoint, } from '../../utilities/segmentation';\nimport { state } from '../../store/state';\nimport SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nclass SegmentSelectTool extends BaseTool {\n    static { this.SelectMode = {\n        Inside: 'Inside',\n        Border: 'Border',\n    }; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            hoverTimeout: 100,\n            mode: SegmentSelectTool.SelectMode.Border,\n            searchRadius: 6,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseMoveCallback = (evt) => {\n            if (this.hoverTimer) {\n                clearTimeout(this.hoverTimer);\n            }\n            this.hoverTimer = setTimeout(() => {\n                this._setActiveSegment(evt);\n                this.hoverTimer = null;\n            }, this.configuration.hoverTimeout);\n            return true;\n        };\n        this.onSetToolEnabled = () => {\n            this.onSetToolActive();\n        };\n        this.onSetToolActive = () => {\n            this.hoverTimer = null;\n        };\n        this.onSetToolDisabled = () => {\n            this.hoverTimer = null;\n        };\n        this.hoverTimer = null;\n    }\n    _setActiveSegment(evt = {}) {\n        if (state.isInteractingWithTool) {\n            return;\n        }\n        const { element, currentPoints } = evt.detail;\n        const worldPoint = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            return;\n        }\n        this._setActiveSegmentForType(activeSegmentation, worldPoint, viewport);\n    }\n    _setActiveSegmentForType(activeSegmentation, worldPoint, viewport) {\n        const imageDataInfo = viewport.getImageData();\n        if (!imageDataInfo) {\n            return;\n        }\n        const { segmentationId, representationData } = activeSegmentation;\n        let hoveredSegmentIndex;\n        if (this.configuration.mode === SegmentSelectTool.SelectMode.Inside) {\n            hoveredSegmentIndex = getSegmentIndexAtWorldPoint(segmentationId, worldPoint, {\n                viewport,\n            });\n        }\n        else {\n            if (representationData.Labelmap) {\n                hoveredSegmentIndex = getSegmentIndexAtLabelmapBorder(segmentationId, worldPoint, {\n                    viewport,\n                    searchRadius: this.configuration.searchRadius,\n                });\n            }\n            else if (representationData.Contour) {\n                hoveredSegmentIndex =\n                    getHoveredContourSegmentationAnnotation(segmentationId);\n            }\n            else if (representationData.Surface) {\n            }\n        }\n        if (!hoveredSegmentIndex || hoveredSegmentIndex === 0) {\n            return;\n        }\n        setActiveSegmentIndex(segmentationId, hoveredSegmentIndex);\n        const renderingEngine = viewport.getRenderingEngine();\n        const viewportIds = renderingEngine.getViewports().map((v) => v.id);\n        triggerSegmentationModified(segmentationId);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    }\n}\nSegmentSelectTool.toolName = 'SegmentSelectTool';\nexport default SegmentSelectTool;\n","import { vec3, vec2 } from 'gl-matrix';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils, cache, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { drawHandles as drawHandlesSvg, drawRedactionRect as drawRedactionRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nclass VideoRedactionTool extends AnnotationTool {\n    constructor(toolConfiguration = {}) {\n        super(toolConfiguration, {\n            supportedInteractionTypes: ['Mouse', 'Touch'],\n            configuration: { shadow: true, preventHandleOutsideImage: false },\n        });\n        this.addNewAnnotation = (evt) => {\n            const eventData = evt.detail;\n            const { currentPoints, element } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [0, 0, 1],\n                    viewUp: [0, 1, 0],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    active: true,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            return annotation;\n        };\n        this.getHandleNearImagePoint = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            for (let i = 0; i < points.length; i++) {\n                const point = points[i];\n                const toolDataCanvasCoordinate = viewport.worldToCanvas(point);\n                const near = vec2.distance(canvasCoords, toolDataCanvasCoordinate) < proximity;\n                if (near === true) {\n                    data.handles.activeHandleIndex = i;\n                    return point;\n                }\n            }\n            data.handles.activeHandleIndex = null;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.active = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventData;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                data.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventData;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                data.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                const toolMetadata = annotation.metadata;\n                const data = annotation.data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return;\n                }\n                let activeHandleCanvasCoords;\n                if (!this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRedactionRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color: 'black',\n                    lineDash,\n                    lineWidth,\n                });\n            }\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewportUID, renderingEngineUID, sceneUID } = enabledElement;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetUIDs = Object.keys(cachedStats);\n            for (let i = 0; i < targetUIDs.length; i++) {\n                const targetUID = targetUIDs[i];\n                const { imageVolume } = this._getImageVolumeFromTargetUID(targetUID, renderingEngine);\n                const { dimensions, scalarData, vtkImageData: imageData, metadata, } = imageVolume;\n                const worldPos1Index = vec3.fromValues(0, 0, 0);\n                const worldPos2Index = vec3.fromValues(0, 0, 0);\n                imageData.worldToIndexVec3(worldPos1, worldPos1Index);\n                worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n                worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n                worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n                imageData.worldToIndexVec3(worldPos2, worldPos2Index);\n                worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n                worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n                worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n                if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                    const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                    const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                    const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                    const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                    const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const area = worldWidth * worldHeight;\n                    let count = 0;\n                    let mean = 0;\n                    let stdDev = 0;\n                    const yMultiple = dimensions[0];\n                    const zMultiple = dimensions[0] * dimensions[1];\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                count++;\n                                mean += value;\n                            }\n                        }\n                    }\n                    mean /= count;\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                const valueMinusMean = value - mean;\n                                stdDev += valueMinusMean * valueMinusMean;\n                            }\n                        }\n                    }\n                    stdDev /= count;\n                    stdDev = Math.sqrt(stdDev);\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean,\n                        stdDev,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            data.invalidated = false;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportUID,\n                renderingEngineUID,\n                sceneUID: sceneUID,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._getTargetVolumeUID = (scene) => {\n            if (this.configuration.volumeUID) {\n                return this.configuration.volumeUID;\n            }\n            const volumeActors = scene.getVolumeActors();\n            if (!volumeActors && !volumeActors.length) {\n                return;\n            }\n            return volumeActors[0].uid;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportUIDsToRender } = this.editData;\n        const { data } = annotation;\n        data.active = false;\n        data.handles.activeHandleIndex = null;\n        triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        this.editData = null;\n        return annotation.metadata.annotationUID;\n    }\n    _getImageVolumeFromTargetUID(targetUID, renderingEngine) {\n        let imageVolume, viewport;\n        if (targetUID.startsWith('stackTarget')) {\n            const coloneIndex = targetUID.indexOf(':');\n            const viewportUID = targetUID.substring(coloneIndex + 1);\n            const viewport = renderingEngine.getViewport(viewportUID);\n            imageVolume = viewport.getImageData();\n        }\n        else {\n            imageVolume = cache.getVolume(targetUID);\n        }\n        return { imageVolume, viewport };\n    }\n    _getTargetStackUID(viewport) {\n        return `stackTarget:${viewport.uid}`;\n    }\n}\nVideoRedactionTool.toolName = 'VideoRedaction';\nexport default VideoRedactionTool;\n","import { getEnabledElement, triggerEvent, getRenderingEngine, } from '@cornerstonejs/core';\nimport { Events, ToolModes } from '../../enums';\nimport { draw as drawSvg } from '../../drawingSvg';\nimport getToolsWithModesForElement from '../../utilities/getToolsWithModesForElement';\nconst { Active, Passive, Enabled } = ToolModes;\nclass AnnotationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._renderFlaggedViewports = () => {\n            this._throwIfDestroyed();\n            const elements = Array.from(this._viewportElements.values());\n            for (let i = 0; i < elements.length; i++) {\n                const element = elements[i];\n                if (this._needsRender.has(element)) {\n                    this._triggerRender(element);\n                    this._needsRender.delete(element);\n                    if (this._needsRender.size === 0) {\n                        break;\n                    }\n                }\n            }\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n            this._render();\n        };\n        this._viewportElements = new Map();\n    }\n    addViewportElement(viewportId, element) {\n        this._viewportElements.set(viewportId, element);\n    }\n    removeViewportElement(viewportId, element) {\n        this._viewportElements.delete(viewportId);\n        this._needsRender.delete(element);\n        this._reset();\n    }\n    renderViewport(element) {\n        this._setViewportsToBeRenderedNextFrame([element]);\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setAllViewportsToBeRenderedNextFrame() {\n        const elements = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            this._needsRender.add(element);\n        });\n        this._renderFlaggedViewports();\n    }\n    _setViewportsToBeRenderedNextFrame(elements) {\n        const elementsEnabled = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            if (elementsEnabled.indexOf(element) !== -1) {\n                this._needsRender.add(element);\n            }\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedViewports);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(element) {\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const renderingEngine = getRenderingEngine(enabledElement.renderingEngineId);\n        if (!renderingEngine) {\n            console.warn('rendering Engine has been destroyed');\n            return;\n        }\n        const enabledTools = getToolsWithModesForElement(element, [\n            Active,\n            Passive,\n            Enabled,\n        ]);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const eventDetail = {\n            element,\n            renderingEngineId,\n            viewportId,\n        };\n        drawSvg(element, (svgDrawingHelper) => {\n            let anyRendered = false;\n            const handleDrawSvg = (tool) => {\n                if (tool.renderAnnotation) {\n                    const rendered = tool.renderAnnotation(enabledElement, svgDrawingHelper);\n                    anyRendered = anyRendered || rendered;\n                }\n            };\n            enabledTools.forEach(handleDrawSvg);\n            if (anyRendered) {\n                triggerEvent(element, Events.ANNOTATION_RENDERED, { ...eventDetail });\n            }\n        });\n    }\n    _reset() {\n        window.cancelAnimationFrame(this._animationFrameHandle);\n        this._needsRender.clear();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._setAllViewportsToBeRenderedNextFrame();\n    }\n}\nconst annotationRenderingEngine = new AnnotationRenderingEngine();\nexport { annotationRenderingEngine };\n","import { Enums, eventTarget, getEnabledElement, utilities, } from '@cornerstonejs/core';\nclass FrameOfReferenceSpecificAnnotationManager {\n    constructor(uid) {\n        this.getGroupKey = (annotationGroupSelector) => {\n            if (typeof annotationGroupSelector === 'string') {\n                return annotationGroupSelector;\n            }\n            const element = annotationGroupSelector;\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID');\n            }\n            return enabledElement.FrameOfReferenceUID;\n        };\n        this._imageVolumeModifiedHandler = (evt) => {\n            const eventDetail = evt.detail;\n            const { FrameOfReferenceUID } = eventDetail;\n            const annotations = this.annotations;\n            const frameOfReferenceSpecificAnnotations = annotations[FrameOfReferenceUID];\n            if (!frameOfReferenceSpecificAnnotations) {\n                return;\n            }\n            Object.keys(frameOfReferenceSpecificAnnotations).forEach((toolName) => {\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                toolSpecificAnnotations.forEach((annotation) => {\n                    const invalidated = annotation.invalidated;\n                    if (invalidated !== undefined) {\n                        annotation.invalidated = true;\n                    }\n                });\n            });\n        };\n        this.getFramesOfReference = () => {\n            return Object.keys(this.annotations);\n        };\n        this.getAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (!annotations[groupKey]) {\n                return [];\n            }\n            if (toolName) {\n                return annotations[groupKey][toolName]\n                    ? annotations[groupKey][toolName]\n                    : [];\n            }\n            return annotations[groupKey];\n        };\n        this.getAnnotation = (annotationUID) => {\n            const annotations = this.annotations;\n            for (const frameOfReferenceUID in annotations) {\n                const frameOfReferenceAnnotations = annotations[frameOfReferenceUID];\n                for (const toolName in frameOfReferenceAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceAnnotations[toolName];\n                    for (const annotation of toolSpecificAnnotations) {\n                        if (annotationUID === annotation.annotationUID) {\n                            return annotation;\n                        }\n                    }\n                }\n            }\n        };\n        this.getNumberOfAnnotations = (groupKey, toolName) => {\n            const annotations = this.getAnnotations(groupKey, toolName);\n            if (!annotations.length) {\n                return 0;\n            }\n            if (toolName) {\n                return annotations.length;\n            }\n            let total = 0;\n            for (const toolName in annotations) {\n                total += annotations[toolName].length;\n            }\n            return total;\n        };\n        this.addAnnotation = (annotation, groupKey) => {\n            const { metadata } = annotation;\n            const { FrameOfReferenceUID, toolName } = metadata;\n            groupKey = groupKey || FrameOfReferenceUID;\n            const annotations = this.annotations;\n            let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            if (!frameOfReferenceSpecificAnnotations) {\n                annotations[groupKey] = {};\n                frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            }\n            let toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            if (!toolSpecificAnnotations) {\n                frameOfReferenceSpecificAnnotations[toolName] = [];\n                toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            }\n            if (this.preprocessingFn) {\n                annotation = this.preprocessingFn(annotation);\n            }\n            toolSpecificAnnotations.push(annotation);\n        };\n        this.removeAnnotation = (annotationUID) => {\n            const { annotations } = this;\n            for (const groupKey in annotations) {\n                const groupAnnotations = annotations[groupKey];\n                for (const toolName in groupAnnotations) {\n                    const toolAnnotations = groupAnnotations[toolName];\n                    const index = toolAnnotations.findIndex((annotation) => annotation.annotationUID === annotationUID);\n                    if (index !== -1) {\n                        toolAnnotations.splice(index, 1);\n                        if (toolAnnotations.length === 0) {\n                            delete groupAnnotations[toolName];\n                        }\n                    }\n                }\n                if (Object.keys(groupAnnotations).length === 0) {\n                    delete annotations[groupKey];\n                }\n            }\n        };\n        this.removeAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            const removedAnnotations = [];\n            if (!annotations[groupKey]) {\n                return removedAnnotations;\n            }\n            if (toolName) {\n                const annotationsForTool = annotations[groupKey][toolName];\n                for (const annotation of annotationsForTool) {\n                    this.removeAnnotation(annotation.annotationUID);\n                    removedAnnotations.push(annotation);\n                }\n            }\n            else {\n                for (const toolName in annotations[groupKey]) {\n                    const annotationsForTool = annotations[groupKey][toolName];\n                    for (const annotation of annotationsForTool) {\n                        this.removeAnnotation(annotation.annotationUID);\n                        removedAnnotations.push(annotation);\n                    }\n                }\n            }\n            return removedAnnotations;\n        };\n        this.saveAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    return;\n                }\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                return structuredClone(toolSpecificAnnotations);\n            }\n            else if (groupKey) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                return structuredClone(frameOfReferenceSpecificAnnotations);\n            }\n            return structuredClone(annotations);\n        };\n        this.restoreAnnotations = (state, groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    annotations[groupKey] = {};\n                    frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                }\n                frameOfReferenceSpecificAnnotations[toolName] = state;\n            }\n            else if (groupKey) {\n                annotations[groupKey] = state;\n            }\n            else {\n                this.annotations = structuredClone(state);\n            }\n        };\n        this.getAllAnnotations = () => {\n            return Object.values(this.annotations)\n                .map((frameOfReferenceSpecificAnnotations) => Object.values(frameOfReferenceSpecificAnnotations))\n                .flat(2);\n        };\n        this.getNumberOfAllAnnotations = () => {\n            let count = 0;\n            const annotations = this.annotations;\n            for (const groupKey in annotations) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                for (const toolName in frameOfReferenceSpecificAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                    count += toolSpecificAnnotations.length;\n                }\n            }\n            return count;\n        };\n        this.removeAllAnnotations = () => {\n            const removedAnnotations = [];\n            for (const annotation of this.getAllAnnotations()) {\n                this.removeAnnotation(annotation.annotationUID);\n                removedAnnotations.push(annotation);\n            }\n            return removedAnnotations;\n        };\n        if (!uid) {\n            uid = utilities.uuidv4();\n        }\n        this.annotations = {};\n        this.uid = uid;\n        eventTarget.addEventListener(Enums.Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedHandler);\n    }\n    setPreprocessingFn(preprocessingFn) {\n        this.preprocessingFn = preprocessingFn;\n    }\n}\nconst defaultFrameOfReferenceSpecificAnnotationManager = new FrameOfReferenceSpecificAnnotationManager('DEFAULT');\nexport { defaultFrameOfReferenceSpecificAnnotationManager };\nexport default FrameOfReferenceSpecificAnnotationManager;\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst globalLockedAnnotationUIDsSet = new Set();\nfunction setAnnotationLocked(annotationUID, locked = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (locked) {\n            lock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n        else {\n            unlock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction unlockAllAnnotations() {\n    const detail = makeEventDetail();\n    clearLockedAnnotationsSet(globalLockedAnnotationUIDsSet, detail);\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction getAnnotationsLocked() {\n    return Array.from(globalLockedAnnotationUIDsSet);\n}\nfunction isAnnotationLocked(annotationUID) {\n    return globalLockedAnnotationUIDsSet.has(annotationUID);\n}\nfunction getAnnotationsLockedCount() {\n    return globalLockedAnnotationUIDsSet.size;\n}\nfunction checkAndSetAnnotationLocked(annotationUID) {\n    const isLocked = isAnnotationLocked(annotationUID);\n    setAnnotationLocked(annotationUID, isLocked);\n    return isLocked;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        locked: [],\n    });\n}\nfunction lock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (!lockedAnnotationUIDsSet.has(annotationUID)) {\n        lockedAnnotationUIDsSet.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = true;\n        }\n    }\n}\nfunction unlock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (lockedAnnotationUIDsSet.delete(annotationUID)) {\n        detail.removed.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = false;\n        }\n    }\n}\nfunction clearLockedAnnotationsSet(lockedAnnotationUIDsSet, detail) {\n    lockedAnnotationUIDsSet.forEach((annotationUID) => {\n        unlock(annotationUID, lockedAnnotationUIDsSet, detail);\n    });\n}\nfunction publish(detail, lockedAnnotationUIDsSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        lockedAnnotationUIDsSet.forEach((item) => void detail.locked.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_LOCK_CHANGE, detail);\n    }\n}\nexport { setAnnotationLocked, getAnnotationsLocked, getAnnotationsLockedCount, unlockAllAnnotations, isAnnotationLocked, checkAndSetAnnotationLocked, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst selectedAnnotationUIDs = new Set();\nfunction setAnnotationSelected(annotationUID, selected = true, preserveSelected = false) {\n    if (selected) {\n        selectAnnotation(annotationUID, preserveSelected);\n    }\n    else {\n        deselectAnnotation(annotationUID);\n    }\n}\nfunction selectAnnotation(annotationUID, preserveSelected = false) {\n    const detail = makeEventDetail();\n    if (!preserveSelected) {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    if (annotationUID && !selectedAnnotationUIDs.has(annotationUID)) {\n        selectedAnnotationUIDs.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction deselectAnnotation(annotationUID) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (selectedAnnotationUIDs.delete(annotationUID)) {\n            detail.removed.push(annotationUID);\n            const annotation = getAnnotation(annotationUID);\n            annotation.isSelected = false;\n        }\n    }\n    else {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelected() {\n    return Array.from(selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelectedByToolName(toolName) {\n    return getAnnotationsSelected().filter((annotationUID) => {\n        const annotation = getAnnotation(annotationUID);\n        return annotation?.metadata?.toolName === toolName;\n    });\n}\nfunction isAnnotationSelected(annotationUID) {\n    return selectedAnnotationUIDs.has(annotationUID);\n}\nfunction getAnnotationsSelectedCount() {\n    return selectedAnnotationUIDs.size;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        selection: [],\n    });\n}\nfunction clearSelectionSet(selectionSet, detail) {\n    selectionSet.forEach((value) => {\n        if (selectionSet.delete(value)) {\n            detail.removed.push(value);\n            const annotation = getAnnotation(value);\n            if (annotation) {\n                annotation.isSelected = false;\n            }\n        }\n    });\n}\nfunction publish(detail, selectionSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        selectionSet.forEach((item) => void detail.selection.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_SELECTION_CHANGE, detail);\n    }\n}\nexport { setAnnotationSelected, getAnnotationsSelected, getAnnotationsSelectedByToolName, getAnnotationsSelectedCount, deselectAnnotation, isAnnotationSelected, };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nimport { getAnnotation } from './getAnnotation';\nimport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, } from './helpers/state';\nimport { checkAndSetAnnotationLocked } from './annotationLocking';\nimport { checkAndDefineCachedStatsProperty, checkAndDefineTextBoxProperty, } from './utilities/defineProperties';\nimport { checkAndSetAnnotationVisibility } from './annotationVisibility';\nlet defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\nconst preprocessingFn = (annotation) => {\n    annotation = checkAndDefineTextBoxProperty(annotation);\n    annotation = checkAndDefineCachedStatsProperty(annotation);\n    const uid = annotation.annotationUID;\n    const isLocked = checkAndSetAnnotationLocked(uid);\n    annotation.isLocked = isLocked;\n    const isVisible = checkAndSetAnnotationVisibility(uid);\n    annotation.isVisible = isVisible;\n    return annotation;\n};\ndefaultManager.setPreprocessingFn(preprocessingFn);\nfunction getAnnotationManager() {\n    return defaultManager;\n}\nfunction setAnnotationManager(annotationManager) {\n    defaultManager = annotationManager;\n}\nfunction resetAnnotationManager() {\n    defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\n}\nfunction getAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getAnnotations(groupKey, toolName);\n}\nfunction getAllAnnotations() {\n    const manager = getAnnotationManager();\n    return manager.getAllAnnotations();\n}\nfunction clearParentAnnotation(annotation) {\n    const { annotationUID: childUID, parentAnnotationUID } = annotation;\n    if (!parentAnnotationUID) {\n        return;\n    }\n    const parentAnnotation = getAnnotation(parentAnnotationUID);\n    const childUIDIndex = parentAnnotation.childAnnotationUIDs.indexOf(childUID);\n    parentAnnotation.childAnnotationUIDs.splice(childUIDIndex, 1);\n    annotation.parentAnnotationUID = undefined;\n}\nfunction addChildAnnotation(parentAnnotation, childAnnotation) {\n    const { annotationUID: parentUID } = parentAnnotation;\n    const { annotationUID: childUID } = childAnnotation;\n    clearParentAnnotation(childAnnotation);\n    if (!parentAnnotation.childAnnotationUIDs) {\n        parentAnnotation.childAnnotationUIDs = [];\n    }\n    if (parentAnnotation.childAnnotationUIDs.includes(childUID)) {\n        return;\n    }\n    parentAnnotation.childAnnotationUIDs.push(childUID);\n    childAnnotation.parentAnnotationUID = parentUID;\n}\nfunction getParentAnnotation(annotation) {\n    return annotation.parentAnnotationUID\n        ? getAnnotation(annotation.parentAnnotationUID)\n        : undefined;\n}\nfunction getChildAnnotations(annotation) {\n    return (annotation.childAnnotationUIDs?.map((childAnnotationUID) => getAnnotation(childAnnotationUID)) ?? []);\n}\nfunction addAnnotation(annotation, annotationGroupSelector) {\n    if (!annotation.annotationUID) {\n        annotation.annotationUID = csUtils.uuidv4();\n    }\n    const manager = getAnnotationManager();\n    if (annotationGroupSelector instanceof HTMLDivElement) {\n        const groupKey = manager.getGroupKey(annotationGroupSelector);\n        manager.addAnnotation(annotation, groupKey);\n        triggerAnnotationAddedForElement(annotation, annotationGroupSelector);\n    }\n    else {\n        manager.addAnnotation(annotation, undefined);\n        triggerAnnotationAddedForFOR(annotation);\n    }\n    return annotation.annotationUID;\n}\nfunction getNumberOfAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getNumberOfAnnotations(groupKey, toolName);\n}\nfunction removeAnnotation(annotationUID) {\n    if (!annotationUID) {\n        return;\n    }\n    const manager = getAnnotationManager();\n    const annotation = manager.getAnnotation(annotationUID);\n    if (!annotation) {\n        return;\n    }\n    annotation.childAnnotationUIDs?.forEach((childAnnotationUID) => removeAnnotation(childAnnotationUID));\n    manager.removeAnnotation(annotationUID);\n    triggerAnnotationRemoved({ annotation, annotationManagerUID: manager.uid });\n}\nfunction removeAllAnnotations() {\n    const manager = getAnnotationManager();\n    const removedAnnotations = manager.removeAllAnnotations();\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction removeAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    const removedAnnotations = manager.removeAnnotations(groupKey, toolName);\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction invalidateAnnotation(annotation) {\n    let currAnnotation = annotation;\n    while (currAnnotation) {\n        currAnnotation.invalidated = true;\n        currAnnotation = currAnnotation.parentAnnotationUID\n            ? getAnnotation(currAnnotation.parentAnnotationUID)\n            : undefined;\n    }\n}\nexport { getAllAnnotations, getAnnotations, getParentAnnotation, getChildAnnotations, clearParentAnnotation, addChildAnnotation, getNumberOfAnnotations, addAnnotation, removeAnnotation, removeAnnotations, removeAllAnnotations, setAnnotationManager, getAnnotationManager, resetAnnotationManager, invalidateAnnotation, getAnnotation, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { isAnnotationSelected, deselectAnnotation, } from './annotationSelection';\nimport { getAnnotation } from './getAnnotation';\nconst globalHiddenAnnotationUIDsSet = new Set();\nfunction setAnnotationVisibility(annotationUID, visible = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (visible) {\n            show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n        else {\n            hide(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail);\n}\nfunction showAllAnnotations() {\n    const detail = makeEventDetail();\n    globalHiddenAnnotationUIDsSet.forEach((annotationUID) => {\n        show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n    });\n    publish(detail);\n}\nfunction isAnnotationVisible(annotationUID) {\n    const annotation = getAnnotation(annotationUID);\n    if (annotation) {\n        return !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    }\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        lastVisible: [],\n        lastHidden: [],\n        hidden: [],\n    });\n}\nfunction show(annotationUID, annotationUIDsSet, detail) {\n    if (annotationUIDsSet.delete(annotationUID)) {\n        detail.lastVisible.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        annotation.isVisible = true;\n    }\n}\nfunction hide(annotationUID, annotationUIDsSet, detail) {\n    if (!annotationUIDsSet.has(annotationUID)) {\n        annotationUIDsSet.add(annotationUID);\n        if (isAnnotationSelected(annotationUID)) {\n            deselectAnnotation(annotationUID);\n        }\n        detail.lastHidden.push(annotationUID);\n    }\n}\nfunction publish(detail) {\n    if (detail.lastHidden.length > 0 || detail.lastVisible.length > 0) {\n        globalHiddenAnnotationUIDsSet.forEach((item) => void detail.hidden.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_VISIBILITY_CHANGE, detail);\n    }\n}\nfunction checkAndSetAnnotationVisibility(annotationUID) {\n    const isVisible = !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    setAnnotationVisibility(annotationUID, isVisible);\n    return isVisible;\n}\nexport { setAnnotationVisibility, showAllAnnotations, isAnnotationVisible, checkAndSetAnnotationVisibility, };\n","class ToolStyle {\n    constructor() {\n        const defaultConfig = {\n            color: 'rgb(255, 255, 0)',\n            colorHighlighted: 'rgb(0, 255, 0)',\n            colorSelected: 'rgb(0, 220, 0)',\n            colorLocked: 'rgb(209, 193, 90)',\n            lineWidth: '1',\n            lineDash: '',\n            shadow: true,\n            textBoxVisibility: true,\n            textBoxFontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            textBoxFontSize: '14px',\n            textBoxColor: 'rgb(255, 255, 0)',\n            textBoxColorHighlighted: 'rgb(0, 255, 0)',\n            textBoxColorSelected: 'rgb(0, 255, 0)',\n            textBoxColorLocked: 'rgb(209, 193, 90)',\n            textBoxBackground: '',\n            textBoxLinkLineWidth: '1',\n            textBoxLinkLineDash: '2,3',\n            textBoxShadow: true,\n        };\n        this._initializeConfig(defaultConfig);\n    }\n    getAnnotationToolStyles(annotationUID) {\n        return this.config.annotations && this.config.annotations[annotationUID];\n    }\n    getViewportToolStyles(viewportId) {\n        return this.config.viewports && this.config.viewports[viewportId];\n    }\n    getToolGroupToolStyles(toolGroupId) {\n        return this.config.toolGroups && this.config.toolGroups[toolGroupId];\n    }\n    getDefaultToolStyles() {\n        return this.config.default;\n    }\n    setAnnotationStyles(annotationUID, styles) {\n        let annotationSpecificStyles = this.config.annotations;\n        if (!annotationSpecificStyles) {\n            this.config = {\n                ...this.config,\n                annotations: {},\n            };\n            annotationSpecificStyles = this.config.annotations;\n        }\n        annotationSpecificStyles[annotationUID] = styles;\n    }\n    setViewportToolStyles(viewportId, styles) {\n        let viewportSpecificStyles = this.config.viewports;\n        if (!viewportSpecificStyles) {\n            this.config = {\n                ...this.config,\n                viewports: {},\n            };\n            viewportSpecificStyles = this.config.viewports;\n        }\n        viewportSpecificStyles[viewportId] = styles;\n    }\n    setToolGroupToolStyles(toolGroupId, styles) {\n        let toolGroupSpecificStyles = this.config.toolGroups;\n        if (!toolGroupSpecificStyles) {\n            this.config = {\n                ...this.config,\n                toolGroups: {},\n            };\n            toolGroupSpecificStyles = this.config.toolGroups;\n        }\n        toolGroupSpecificStyles[toolGroupId] = styles;\n    }\n    setDefaultToolStyles(styles) {\n        this.config.default = styles;\n    }\n    getStyleProperty(toolStyle, specifications) {\n        const { annotationUID, viewportId, toolGroupId, toolName } = specifications;\n        return this._getToolStyle(toolStyle, annotationUID, viewportId, toolGroupId, toolName);\n    }\n    _getToolStyle(property, annotationUID, viewportId, toolGroupId, toolName) {\n        if (annotationUID) {\n            const annotationToolStyles = this.getAnnotationToolStyles(annotationUID);\n            if (annotationToolStyles) {\n                if (annotationToolStyles[property] !== undefined) {\n                    return annotationToolStyles[property];\n                }\n            }\n        }\n        if (viewportId) {\n            const viewportToolStyles = this.getViewportToolStyles(viewportId);\n            if (viewportToolStyles) {\n                if (viewportToolStyles[toolName] &&\n                    viewportToolStyles[toolName][property] !== undefined) {\n                    return viewportToolStyles[toolName][property];\n                }\n                if (viewportToolStyles.global &&\n                    viewportToolStyles.global[property] !== undefined) {\n                    return viewportToolStyles.global[property];\n                }\n            }\n        }\n        if (toolGroupId) {\n            const toolGroupToolStyles = this.getToolGroupToolStyles(toolGroupId);\n            if (toolGroupToolStyles) {\n                if (toolGroupToolStyles[toolName] &&\n                    toolGroupToolStyles[toolName][property] !== undefined) {\n                    return toolGroupToolStyles[toolName][property];\n                }\n                if (toolGroupToolStyles.global &&\n                    toolGroupToolStyles.global[property] !== undefined) {\n                    return toolGroupToolStyles.global[property];\n                }\n            }\n        }\n        const globalStyles = this.getDefaultToolStyles();\n        if (globalStyles[toolName] &&\n            globalStyles[toolName][property] !== undefined) {\n            return globalStyles[toolName][property];\n        }\n        if (globalStyles.global && globalStyles.global[property] !== undefined) {\n            return globalStyles.global[property];\n        }\n    }\n    _initializeConfig(config) {\n        const toolStyles = {};\n        for (const name in config) {\n            toolStyles[name] = config[name];\n        }\n        this.config = {\n            default: {\n                global: toolStyles,\n            },\n        };\n    }\n}\nconst toolStyle = new ToolStyle();\nexport default toolStyle;\n","import toolStyle from './ToolStyle';\nfunction getHierarchalPropertyStyles(property, state, mode) {\n    const list = [`${property}`];\n    if (state) {\n        list.push(`${list[0]}${state}`);\n    }\n    if (mode) {\n        list.push(`${list[list.length - 1]}${mode}`);\n    }\n    return list;\n}\nfunction getStyleProperty(property, styleSpecifier, state, mode) {\n    const alternatives = getHierarchalPropertyStyles(property, state, mode);\n    for (let i = alternatives.length - 1; i >= 0; --i) {\n        const style = toolStyle.getStyleProperty(alternatives[i], styleSpecifier);\n        if (style !== undefined) {\n            return style;\n        }\n    }\n}\nexport { getStyleProperty };\n","import { isAnnotationLocked } from '../annotationLocking';\nimport { isAnnotationSelected } from '../annotationSelection';\nimport { AnnotationStyleStates } from '../../../enums';\nfunction getState(annotation) {\n    if (annotation) {\n        if (annotation.data && annotation.highlighted) {\n            return AnnotationStyleStates.Highlighted;\n        }\n        if (isAnnotationSelected(annotation.annotationUID)) {\n            return AnnotationStyleStates.Selected;\n        }\n        if (isAnnotationLocked(annotation.annotationUID)) {\n            return AnnotationStyleStates.Locked;\n        }\n        if (annotation.data && annotation.autoGenerated) {\n            return AnnotationStyleStates.AutoGenerated;\n        }\n    }\n    return AnnotationStyleStates.Default;\n}\nexport default getState;\n","import { getStyleProperty } from './helpers';\nfunction getFont(styleSpecifier, state, mode) {\n    const fontSize = getStyleProperty('textBoxFontSize', styleSpecifier, state, mode);\n    const fontFamily = getStyleProperty('textBoxFontFamily', styleSpecifier, state, mode);\n    return `${fontSize}px ${fontFamily}`;\n}\nexport default getFont;\n","import { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nexport function getAnnotation(annotationUID) {\n    const manager = defaultFrameOfReferenceSpecificAnnotationManager;\n    const annotation = manager.getAnnotation(annotationUID);\n    return annotation;\n}\n","import { getEnabledElement, triggerEvent, eventTarget, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { Events, ChangeTypes } from '../../../enums';\nimport { getToolGroupsWithToolName } from '../../../store/ToolGroupManager';\nfunction triggerAnnotationAddedForElement(annotation, element) {\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngine, viewportId } = enabledElement;\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId: renderingEngine.id,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationAddedForFOR(annotation) {\n    const { toolName } = annotation.metadata;\n    const toolGroups = getToolGroupsWithToolName(toolName);\n    if (!toolGroups.length) {\n        return;\n    }\n    const viewportsToRender = [];\n    toolGroups.forEach((toolGroup) => {\n        toolGroup.viewportsInfo.forEach((viewportInfo) => {\n            const { renderingEngineId, viewportId } = viewportInfo;\n            const { FrameOfReferenceUID } = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (annotation.metadata.FrameOfReferenceUID === FrameOfReferenceUID) {\n                viewportsToRender.push(viewportInfo);\n            }\n        });\n    });\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = { annotation };\n    if (!viewportsToRender.length) {\n        triggerEvent(eventTarget, eventType, eventDetail);\n        return;\n    }\n    viewportsToRender.forEach(({ renderingEngineId, viewportId }) => {\n        eventDetail.viewportId = viewportId;\n        eventDetail.renderingEngineId = renderingEngineId;\n        triggerEvent(eventTarget, eventType, eventDetail);\n    });\n}\nfunction triggerAnnotationRemoved(eventDetail) {\n    const eventType = Events.ANNOTATION_REMOVED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationModified(annotation, element, changeType = ChangeTypes.HandlesUpdated) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId,\n        changeType,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationCompleted(annotation) {\n    const eventDetail = {\n        annotation,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled = false) {\n    const eventDetail = {\n        annotation,\n        contourHoleProcessingEnabled,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction _triggerAnnotationCompleted(eventDetail) {\n    const eventType = Events.ANNOTATION_COMPLETED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nexport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, triggerAnnotationModified, triggerAnnotationCompleted, triggerContourAnnotationCompleted, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport { getAnnotation } from './annotationState';\nexport default class AnnotationGroup {\n    constructor() {\n        this.annotationUIDs = new Set();\n        this._isVisible = true;\n        this.visibleFilter = this.unboundVisibleFilter.bind(this);\n    }\n    unboundVisibleFilter(uid) {\n        return !this._isVisible || !this.annotationUIDs.has(uid);\n    }\n    has(uid) {\n        return this.annotationUIDs.has(uid);\n    }\n    setVisible(isVisible = true, baseEvent, filter) {\n        if (this._isVisible === isVisible) {\n            return;\n        }\n        this._isVisible = isVisible;\n        this.annotationUIDs.forEach((uid) => {\n            const annotation = getAnnotation(uid);\n            if (!annotation) {\n                this.annotationUIDs.delete(uid);\n                return;\n            }\n            if (annotation.isVisible === isVisible) {\n                return;\n            }\n            if (!isVisible && filter?.(uid) === false) {\n                return;\n            }\n            annotation.isVisible = isVisible;\n            const eventDetail = {\n                ...baseEvent,\n                annotation,\n            };\n            triggerEvent(eventTarget, Events.ANNOTATION_MODIFIED, eventDetail);\n        });\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    findNearby(uid, direction) {\n        const uids = [...this.annotationUIDs];\n        if (uids.length === 0) {\n            return null;\n        }\n        if (!uid) {\n            return uids[direction === 1 ? 0 : uids.length - 1];\n        }\n        const index = uids.indexOf(uid);\n        if (index === -1 ||\n            index + direction < 0 ||\n            index + direction >= uids.length) {\n            return null;\n        }\n        return uids[index + direction];\n    }\n    add(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.add(annotationUID));\n    }\n    remove(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.delete(annotationUID));\n    }\n    clear() {\n        this.annotationUIDs.clear();\n    }\n}\n","import { triggerEvent, eventTarget, Enums, getRenderingEngines, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations, Events as csToolsEvents, } from '../../enums';\nimport Representations from '../../enums/SegmentationRepresentations';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport surfaceDisplay from '../../tools/displayTools/Surface/surfaceDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport { addTool } from '../../store/addTool';\nimport { state } from '../../store/state';\nimport PlanarFreehandContourSegmentationTool from '../../tools/annotation/PlanarFreehandContourSegmentationTool';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst renderers = {\n    [Representations.Labelmap]: labelmapDisplay,\n    [Representations.Contour]: contourDisplay,\n    [Representations.Surface]: surfaceDisplay,\n};\nconst planarContourToolName = PlanarFreehandContourSegmentationTool.toolName;\nclass SegmentationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._getAllViewports = () => {\n            const renderingEngine = getRenderingEngines();\n            return renderingEngine.flatMap((renderingEngine) => renderingEngine.getViewports());\n        };\n        this._renderFlaggedSegmentations = () => {\n            this._throwIfDestroyed();\n            const viewportIds = Array.from(this._needsRender);\n            viewportIds.forEach((viewportId) => {\n                this._triggerRender(viewportId);\n            });\n            this._needsRender.clear();\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n        };\n    }\n    renderSegmentationsForViewport(viewportId) {\n        const viewportIds = viewportId\n            ? [viewportId]\n            : this._getViewportIdsForSegmentation();\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    renderSegmentation(segmentationId) {\n        const viewportIds = this._getViewportIdsForSegmentation(segmentationId);\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    _getViewportIdsForSegmentation(segmentationId) {\n        const viewports = this._getAllViewports();\n        const viewportIds = [];\n        for (const viewport of viewports) {\n            const viewportId = viewport.id;\n            if (segmentationId) {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n            else {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n        }\n        return viewportIds;\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setViewportsToBeRenderedNextFrame(viewportIds) {\n        viewportIds.forEach((viewportId) => {\n            this._needsRender.add(viewportId);\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedSegmentations);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(viewportId) {\n        const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n        if (!segmentationRepresentations?.length) {\n            return;\n        }\n        const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n        if (!viewport) {\n            return;\n        }\n        const viewportRenderList = [];\n        const segmentationRenderList = segmentationRepresentations.map((representation) => {\n            if (representation.type === SegmentationRepresentations.Contour) {\n                this._addPlanarFreeHandToolIfAbsent(viewport);\n            }\n            const display = renderers[representation.type];\n            try {\n                const viewportId = display.render(viewport, representation);\n                viewportRenderList.push(viewportId);\n            }\n            catch (error) {\n                console.error(error);\n            }\n            return Promise.resolve({\n                segmentationId: representation.segmentationId,\n                type: representation.type,\n            });\n        });\n        Promise.allSettled(segmentationRenderList).then((results) => {\n            const segmentationDetails = results\n                .filter((r) => r.status === 'fulfilled')\n                .map((r) => r.value);\n            function onSegmentationRender(evt) {\n                const { element, viewportId } = evt.detail;\n                element.removeEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n                segmentationDetails.forEach((detail) => {\n                    const eventDetail = {\n                        viewportId,\n                        segmentationId: detail.segmentationId,\n                        type: detail.type,\n                    };\n                    triggerEvent(eventTarget, csToolsEvents.SEGMENTATION_RENDERED, {\n                        ...eventDetail,\n                    });\n                });\n            }\n            const element = viewport.element;\n            element.addEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n            viewport.render();\n        });\n    }\n    _addPlanarFreeHandToolIfAbsent(viewport) {\n        if (!(planarContourToolName in state.tools)) {\n            addTool(PlanarFreehandContourSegmentationTool);\n        }\n        const toolGroup = getToolGroupForViewport(viewport.id);\n        if (!toolGroup.hasTool(planarContourToolName)) {\n            toolGroup.addTool(planarContourToolName);\n            toolGroup.setToolPassive(planarContourToolName);\n        }\n    }\n}\nfunction triggerSegmentationRender(viewportId) {\n    segmentationRenderingEngine.renderSegmentationsForViewport(viewportId);\n}\nfunction triggerSegmentationRenderBySegmentationId(segmentationId) {\n    segmentationRenderingEngine.renderSegmentation(segmentationId);\n}\nconst segmentationRenderingEngine = new SegmentationRenderingEngine();\nexport { triggerSegmentationRender, triggerSegmentationRenderBySegmentationId, segmentationRenderingEngine, };\n","import { BaseVolumeViewport, cache, utilities as csUtils, getEnabledElementByViewportId, volumeLoader, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport vtkColorTransferFunction from '@kitware/vtk.js/Rendering/Core/ColorTransferFunction';\nimport vtkPiecewiseFunction from '@kitware/vtk.js/Common/DataModel/PiecewiseFunction';\nimport { triggerSegmentationModified, triggerSegmentationRemoved, triggerSegmentationRepresentationModified, triggerSegmentationRepresentationRemoved, } from './triggerSegmentationEvents';\nimport { segmentationStyle } from './SegmentationStyle';\nimport { triggerSegmentationAdded } from './events/triggerSegmentationAdded';\nconst initialDefaultState = {\n    colorLUT: [],\n    segmentations: [],\n    viewportSegRepresentations: {},\n};\nexport default class SegmentationStateManager {\n    constructor(uid) {\n        this._stackLabelmapImageIdReferenceMap = new Map();\n        uid ||= csUtils.uuidv4();\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n        this.uid = uid;\n    }\n    getState() {\n        return this.state;\n    }\n    updateState(updater) {\n        const newState = csUtils.deepClone(this.state);\n        updater(newState);\n        this.state = Object.freeze(newState);\n    }\n    getColorLUT(lutIndex) {\n        return this.state.colorLUT[lutIndex];\n    }\n    getNextColorLUTIndex() {\n        return this.state.colorLUT.length;\n    }\n    resetState() {\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n    }\n    getSegmentation(segmentationId) {\n        return this.state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n    }\n    updateSegmentation(segmentationId, payload) {\n        this.updateState((draftState) => {\n            const segmentation = draftState.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n            if (!segmentation) {\n                console.warn(`Segmentation with id ${segmentationId} not found. Update aborted.`);\n                return;\n            }\n            Object.assign(segmentation, payload);\n        });\n        triggerSegmentationModified(segmentationId);\n    }\n    addSegmentation(segmentation) {\n        if (this.getSegmentation(segmentation.segmentationId)) {\n            throw new Error(`Segmentation with id ${segmentation.segmentationId} already exists`);\n        }\n        this.updateState((state) => {\n            const newSegmentation = csUtils.deepClone(segmentation);\n            if (newSegmentation.representationData.Labelmap &&\n                'volumeId' in newSegmentation.representationData.Labelmap &&\n                !('imageIds' in newSegmentation.representationData.Labelmap)) {\n                const imageIds = this.getLabelmapImageIds(newSegmentation.representationData);\n                newSegmentation.representationData\n                    .Labelmap.imageIds = imageIds;\n            }\n            state.segmentations.push(newSegmentation);\n        });\n        triggerSegmentationAdded(segmentation.segmentationId);\n    }\n    removeSegmentation(segmentationId) {\n        this.updateState((state) => {\n            const filteredSegmentations = state.segmentations.filter((segmentation) => segmentation.segmentationId !== segmentationId);\n            state.segmentations.splice(0, state.segmentations.length, ...filteredSegmentations);\n        });\n        triggerSegmentationRemoved(segmentationId);\n    }\n    addSegmentationRepresentation(viewportId, segmentationId, type, renderingConfig) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const existingRepresentations = this.getSegmentationRepresentations(viewportId, {\n            type: type,\n            segmentationId,\n        });\n        if (existingRepresentations.length > 0) {\n            console.debug('A segmentation representation of type', type, 'already exists in viewport', viewportId, 'for segmentation', segmentationId);\n            return;\n        }\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                state.viewportSegRepresentations[viewportId] = [];\n                segmentationStyle.setRenderInactiveSegmentations(viewportId, true);\n            }\n            if (type !== SegmentationRepresentations.Labelmap) {\n                this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig);\n            }\n            else {\n                this.addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig);\n            }\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId, type);\n    }\n    addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig) {\n        const segmentation = state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const segmentReps = {};\n        Object.keys(segmentation.segments).forEach((segmentIndex) => {\n            segmentReps[Number(segmentIndex)] = {\n                visible: true,\n            };\n        });\n        state.viewportSegRepresentations[viewportId].push({\n            segmentationId,\n            type,\n            active: true,\n            visible: true,\n            colorLUTIndex: renderingConfig?.colorLUTIndex || 0,\n            segments: segmentReps,\n            config: {\n                ...getDefaultRenderingConfig(type),\n                ...renderingConfig,\n            },\n        });\n        this._setActiveSegmentation(state, viewportId, segmentationId);\n    }\n    addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig = getDefaultRenderingConfig(SegmentationRepresentations.Labelmap)) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n        }\n        this.processLabelmapRepresentationAddition(viewportId, segmentationId);\n        this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n    }\n    async processLabelmapRepresentationAddition(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const volumeViewport = enabledElement.viewport instanceof BaseVolumeViewport;\n        const { representationData } = segmentation;\n        const isBaseVolumeSegmentation = 'volumeId' in representationData.Labelmap;\n        const viewport = enabledElement.viewport;\n        if (!volumeViewport && !isBaseVolumeSegmentation) {\n            !this.updateLabelmapSegmentationImageReferences(viewportId, segmentation.segmentationId);\n        }\n    }\n    _updateLabelmapSegmentationReferences(segmentationId, viewport, labelmapImageIds, updateCallback) {\n        const currentImageId = viewport.getCurrentImageId();\n        let viewableLabelmapImageIdFound = false;\n        for (const labelmapImageId of labelmapImageIds) {\n            const viewableImageId = viewport.isReferenceViewable({ referencedImageId: labelmapImageId }, { asOverlay: true });\n            if (viewableImageId) {\n                viewableLabelmapImageIdFound = true;\n                this._stackLabelmapImageIdReferenceMap\n                    .get(segmentationId)\n                    .set(currentImageId, labelmapImageId);\n            }\n        }\n        if (updateCallback) {\n            updateCallback(viewport, segmentationId, labelmapImageIds);\n        }\n        return viewableLabelmapImageIdFound\n            ? this._stackLabelmapImageIdReferenceMap\n                .get(segmentationId)\n                .get(currentImageId)\n            : undefined;\n    }\n    updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        return this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, null);\n    }\n    _updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, (stackViewport, segmentationId, labelmapImageIds) => {\n            const imageIds = stackViewport.getImageIds();\n            imageIds.forEach((imageId, index) => {\n                for (const labelmapImageId of labelmapImageIds) {\n                    const viewableImageId = stackViewport.isReferenceViewable({ referencedImageId: labelmapImageId, sliceIndex: index }, { asOverlay: true, withNavigation: true });\n                    if (viewableImageId) {\n                        this._stackLabelmapImageIdReferenceMap\n                            .get(segmentationId)\n                            .set(imageId, labelmapImageId);\n                    }\n                }\n            });\n        });\n    }\n    getLabelmapImageIds(representationData) {\n        const labelmapData = representationData.Labelmap;\n        let labelmapImageIds;\n        if (labelmapData.imageIds) {\n            labelmapImageIds = labelmapData\n                .imageIds;\n        }\n        else if (!labelmapImageIds &&\n            labelmapData.volumeId) {\n            const volumeId = labelmapData\n                .volumeId;\n            const volume = cache.getVolume(volumeId);\n            labelmapImageIds = volume.imageIds;\n        }\n        return labelmapImageIds;\n    }\n    getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            return;\n        }\n        const stackViewport = enabledElement.viewport;\n        const currentImageId = stackViewport.getCurrentImageId();\n        const imageIdReferenceMap = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIdReferenceMap.get(currentImageId);\n    }\n    getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return [];\n        }\n        this._updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId);\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        const imageIds = viewport.getImageIds();\n        const associatedReferenceImageAndLabelmapImageIds = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIds.map((imageId) => {\n            return associatedReferenceImageAndLabelmapImageIds.get(imageId);\n        });\n    }\n    removeSegmentationRepresentationsInternal(viewportId, specifier) {\n        const removedRepresentations = [];\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                return;\n            }\n            const currentRepresentations = state.viewportSegRepresentations[viewportId];\n            let activeRepresentationRemoved = false;\n            if (!specifier ||\n                Object.values(specifier).every((value) => value === undefined)) {\n                removedRepresentations.push(...currentRepresentations);\n                delete state.viewportSegRepresentations[viewportId];\n            }\n            else {\n                const { segmentationId, type } = specifier;\n                state.viewportSegRepresentations[viewportId] =\n                    currentRepresentations.filter((representation) => {\n                        const shouldRemove = (segmentationId &&\n                            type &&\n                            representation.segmentationId === segmentationId &&\n                            representation.type === type) ||\n                            (segmentationId &&\n                                !type &&\n                                representation.segmentationId === segmentationId) ||\n                            (!segmentationId && type && representation.type === type);\n                        if (shouldRemove) {\n                            removedRepresentations.push(representation);\n                            if (representation.active) {\n                                activeRepresentationRemoved = true;\n                            }\n                        }\n                        return !shouldRemove;\n                    });\n                if (state.viewportSegRepresentations[viewportId].length === 0) {\n                    delete state.viewportSegRepresentations[viewportId];\n                }\n                else if (activeRepresentationRemoved) {\n                    state.viewportSegRepresentations[viewportId][0].active = true;\n                }\n            }\n        });\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentations(viewportId, specifier) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        removedRepresentations.forEach((representation) => {\n            triggerSegmentationRepresentationRemoved(viewportId, representation.segmentationId, representation.type);\n        });\n        const remainingRepresentations = this.getSegmentationRepresentations(viewportId);\n        if (remainingRepresentations.length > 0 &&\n            remainingRepresentations[0].active) {\n            triggerSegmentationRepresentationModified(viewportId, remainingRepresentations[0].segmentationId, remainingRepresentations[0].type);\n        }\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentation(viewportId, specifier, suppressEvent) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        if (!suppressEvent) {\n            removedRepresentations.forEach(({ segmentationId, type }) => {\n                triggerSegmentationRepresentationRemoved(viewportId, segmentationId, type);\n            });\n        }\n        return removedRepresentations;\n    }\n    _setActiveSegmentation(state, viewportId, segmentationId) {\n        const viewport = state.viewportSegRepresentations[viewportId];\n        if (!viewport) {\n            return;\n        }\n        viewport.forEach((value) => {\n            value.active = value.segmentationId === segmentationId;\n        });\n    }\n    setActiveSegmentation(viewportId, segmentationId) {\n        this.updateState((state) => {\n            const viewport = state.viewportSegRepresentations[viewportId];\n            if (!viewport) {\n                return;\n            }\n            viewport.forEach((value) => {\n                value.active = value.segmentationId === segmentationId;\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId);\n    }\n    getActiveSegmentation(viewportId) {\n        if (!this.state.viewportSegRepresentations[viewportId]) {\n            return;\n        }\n        const activeSegRep = this.state.viewportSegRepresentations[viewportId].find((segRep) => segRep.active);\n        if (!activeSegRep) {\n            return;\n        }\n        return this.getSegmentation(activeSegRep.segmentationId);\n    }\n    getSegmentationRepresentations(viewportId, specifier = {}) {\n        const viewportRepresentations = this.state.viewportSegRepresentations[viewportId];\n        if (!viewportRepresentations) {\n            return [];\n        }\n        if (!specifier.type && !specifier.segmentationId) {\n            return viewportRepresentations;\n        }\n        return viewportRepresentations.filter((representation) => {\n            const typeMatch = specifier.type\n                ? representation.type === specifier.type\n                : true;\n            const idMatch = specifier.segmentationId\n                ? representation.segmentationId === specifier.segmentationId\n                : true;\n            return typeMatch && idMatch;\n        });\n    }\n    getSegmentationRepresentation(viewportId, specifier) {\n        return this.getSegmentationRepresentations(viewportId, specifier)[0];\n    }\n    getSegmentationRepresentationVisibility(viewportId, specifier) {\n        const viewportRepresentation = this.getSegmentationRepresentation(viewportId, specifier);\n        return viewportRepresentation?.visible;\n    }\n    setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n        this.updateState((state) => {\n            const viewportRepresentations = this.getSegmentationRepresentations(viewportId, specifier);\n            if (!viewportRepresentations) {\n                return;\n            }\n            viewportRepresentations.forEach((representation) => {\n                representation.visible = visible;\n                Object.entries(representation.segments).forEach(([segmentIndex, segment]) => {\n                    segment.visible = visible;\n                });\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId, specifier.type);\n    }\n    addColorLUT(colorLUT, lutIndex) {\n        this.updateState((state) => {\n            if (state.colorLUT[lutIndex]) {\n                console.warn('Color LUT table already exists, overwriting');\n            }\n            state.colorLUT[lutIndex] = csUtils.deepClone(colorLUT);\n        });\n    }\n    removeColorLUT(colorLUTIndex) {\n        this.updateState((state) => {\n            delete state.colorLUT[colorLUTIndex];\n        });\n    }\n    _getStackIdForImageIds(imageIds) {\n        return imageIds\n            .map((imageId) => imageId.slice(-Math.round(imageId.length * 0.15)))\n            .join('_');\n    }\n    getAllViewportSegmentationRepresentations() {\n        return Object.entries(this.state.viewportSegRepresentations).map(([viewportId, representations]) => ({\n            viewportId,\n            representations,\n        }));\n    }\n    getSegmentationRepresentationsBySegmentationId(segmentationId) {\n        const result = [];\n        Object.entries(this.state.viewportSegRepresentations).forEach(([viewportId, viewportReps]) => {\n            const filteredReps = viewportReps.filter((representation) => representation.segmentationId === segmentationId);\n            if (filteredReps.length > 0) {\n                result.push({ viewportId, representations: filteredReps });\n            }\n        });\n        return result;\n    }\n}\nasync function internalComputeVolumeLabelmapFromStack({ imageIds, options, }) {\n    const segmentationImageIds = imageIds;\n    const volumeId = options?.volumeId || csUtils.uuidv4();\n    await volumeLoader.createAndCacheVolumeFromImages(volumeId, segmentationImageIds);\n    return { volumeId };\n}\nasync function internalConvertStackToVolumeLabelmap({ segmentationId, options, }) {\n    const segmentation = defaultSegmentationStateManager.getSegmentation(segmentationId);\n    const data = segmentation.representationData\n        .Labelmap;\n    const { volumeId } = await internalComputeVolumeLabelmapFromStack({\n        imageIds: data.imageIds,\n        options,\n    });\n    segmentation.representationData.Labelmap.volumeId = volumeId;\n}\nfunction getDefaultRenderingConfig(type) {\n    const cfun = vtkColorTransferFunction.newInstance();\n    const ofun = vtkPiecewiseFunction.newInstance();\n    ofun.addPoint(0, 0);\n    if (type === SegmentationRepresentations.Labelmap) {\n        return {\n            cfun,\n            ofun,\n        };\n    }\n    else {\n        return {};\n    }\n}\nconst defaultSegmentationStateManager = new SegmentationStateManager('DEFAULT');\nexport { internalConvertStackToVolumeLabelmap, internalComputeVolumeLabelmapFromStack, defaultSegmentationStateManager, };\n","import getDefaultContourConfig from '../../tools/displayTools/Contour/contourConfig';\nimport getDefaultLabelmapConfig from '../../tools/displayTools/Labelmap/labelmapConfig';\nimport * as Enums from '../../enums';\nimport { utilities } from '@cornerstonejs/core';\nclass SegmentationStyle {\n    constructor() {\n        this.config = {\n            global: {},\n            segmentations: {},\n            viewportsStyle: {},\n        };\n    }\n    setStyle(specifier, styles) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        const currentStyles = this.getStyle(specifier);\n        let updatedStyles;\n        if (!viewportId && !segmentationId) {\n            updatedStyles = {\n                ...currentStyles,\n                ...styles,\n            };\n        }\n        else {\n            updatedStyles = this.copyActiveToInactiveIfNotProvided({\n                ...currentStyles,\n                ...styles,\n            }, type);\n        }\n        if (!type) {\n            throw new Error('Type is required to set a style');\n        }\n        if (viewportId) {\n            if (!this.config.viewportsStyle[viewportId]) {\n                this.config.viewportsStyle[viewportId] = {\n                    renderInactiveSegmentations: false,\n                    representations: {},\n                };\n            }\n            const representations = this.config.viewportsStyle[viewportId].representations;\n            if (segmentationId) {\n                if (!representations[segmentationId]) {\n                    representations[segmentationId] = {};\n                }\n                if (!representations[segmentationId][type]) {\n                    representations[segmentationId][type] = {};\n                }\n                const repConfig = representations[segmentationId][type];\n                if (segmentIndex !== undefined) {\n                    if (!repConfig.perSegment) {\n                        repConfig.perSegment = {};\n                    }\n                    repConfig.perSegment[segmentIndex] = updatedStyles;\n                }\n                else {\n                    repConfig.allSegments = updatedStyles;\n                }\n            }\n            else {\n                const ALL_SEGMENTATIONS_KEY = '__allSegmentations__';\n                if (!representations[ALL_SEGMENTATIONS_KEY]) {\n                    representations[ALL_SEGMENTATIONS_KEY] = {};\n                }\n                if (!representations[ALL_SEGMENTATIONS_KEY][type]) {\n                    representations[ALL_SEGMENTATIONS_KEY][type] = {};\n                }\n                representations[ALL_SEGMENTATIONS_KEY][type].allSegments =\n                    updatedStyles;\n            }\n        }\n        else if (segmentationId) {\n            if (!this.config.segmentations[segmentationId]) {\n                this.config.segmentations[segmentationId] = {};\n            }\n            if (!this.config.segmentations[segmentationId][type]) {\n                this.config.segmentations[segmentationId][type] = {};\n            }\n            const segConfig = this.config.segmentations[segmentationId][type];\n            if (segmentIndex !== undefined) {\n                if (!segConfig.perSegment) {\n                    segConfig.perSegment = {};\n                }\n                segConfig.perSegment[segmentIndex] = updatedStyles;\n            }\n            else {\n                segConfig.allSegments = updatedStyles;\n            }\n        }\n        else {\n            this.config.global[type] = updatedStyles;\n        }\n    }\n    copyActiveToInactiveIfNotProvided(styles, type) {\n        const processedStyles = { ...styles };\n        if (type === Enums.SegmentationRepresentations.Labelmap) {\n            const labelmapStyles = processedStyles;\n            labelmapStyles.renderOutlineInactive = labelmapStyles.renderOutline;\n            labelmapStyles.outlineWidthInactive = labelmapStyles.outlineWidth;\n            labelmapStyles.renderFillInactive = labelmapStyles.renderFill;\n            labelmapStyles.fillAlphaInactive = labelmapStyles.fillAlpha;\n            labelmapStyles.outlineOpacityInactive = labelmapStyles.outlineOpacity;\n        }\n        else if (type === Enums.SegmentationRepresentations.Contour) {\n            const contourStyles = processedStyles;\n            contourStyles.outlineWidthInactive = contourStyles.outlineWidth;\n            contourStyles.outlineOpacityInactive = contourStyles.outlineOpacity;\n            contourStyles.outlineDashInactive = contourStyles.outlineDash;\n            contourStyles.renderOutlineInactive = contourStyles.renderOutline;\n            contourStyles.renderFillInactive = contourStyles.renderFill;\n            contourStyles.fillAlphaInactive = contourStyles.fillAlpha;\n        }\n        return processedStyles;\n    }\n    getStyle(specifier) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        let combinedStyle = this.getDefaultStyle(type);\n        let renderInactiveSegmentations = false;\n        if (this.config.global[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.global[type],\n            };\n        }\n        if (this.config.segmentations[segmentationId]?.[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.segmentations[segmentationId][type].allSegments,\n            };\n            if (segmentIndex !== undefined &&\n                this.config.segmentations[segmentationId][type].perSegment?.[segmentIndex]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.segmentations[segmentationId][type].perSegment[segmentIndex],\n                };\n            }\n        }\n        if (viewportId && this.config.viewportsStyle[viewportId]) {\n            renderInactiveSegmentations =\n                this.config.viewportsStyle[viewportId].renderInactiveSegmentations;\n            const allSegmentationsKey = '__allSegmentations__';\n            if (this.config.viewportsStyle[viewportId].representations[allSegmentationsKey]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[allSegmentationsKey][type].allSegments,\n                };\n            }\n            if (segmentationId &&\n                this.config.viewportsStyle[viewportId].representations[segmentationId]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].allSegments,\n                };\n                if (segmentIndex !== undefined &&\n                    this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment?.[segmentIndex]) {\n                    combinedStyle = {\n                        ...combinedStyle,\n                        ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment[segmentIndex],\n                    };\n                }\n            }\n        }\n        return combinedStyle;\n    }\n    getRenderInactiveSegmentations(viewportId) {\n        return this.config.viewportsStyle[viewportId]?.renderInactiveSegmentations;\n    }\n    setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n        if (!this.config.viewportsStyle[viewportId]) {\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations: false,\n                representations: {},\n            };\n        }\n        this.config.viewportsStyle[viewportId].renderInactiveSegmentations =\n            renderInactiveSegmentations;\n    }\n    getDefaultStyle(type) {\n        switch (type) {\n            case Enums.SegmentationRepresentations.Labelmap:\n                return getDefaultLabelmapConfig();\n            case Enums.SegmentationRepresentations.Contour:\n                return getDefaultContourConfig();\n            case Enums.SegmentationRepresentations.Surface:\n                return {};\n            default:\n                throw new Error(`Unknown representation type: ${type}`);\n        }\n    }\n    clearSegmentationStyle(segmentationId) {\n        if (this.config.segmentations[segmentationId]) {\n            delete this.config.segmentations[segmentationId];\n        }\n    }\n    clearAllSegmentationStyles() {\n        this.config.segmentations = {};\n    }\n    clearViewportStyle(viewportId) {\n        if (this.config.viewportsStyle[viewportId]) {\n            delete this.config.viewportsStyle[viewportId];\n        }\n    }\n    clearAllViewportStyles() {\n        for (const viewportId in this.config.viewportsStyle) {\n            const viewportStyle = this.config.viewportsStyle[viewportId];\n            const renderInactiveSegmentations = viewportStyle.renderInactiveSegmentations;\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations,\n                representations: {},\n            };\n        }\n    }\n    resetToGlobalStyle() {\n        this.clearAllSegmentationStyles();\n        this.clearAllViewportStyles();\n    }\n    hasCustomStyle(specifier) {\n        const { type } = specifier;\n        const style = this.getStyle(specifier);\n        const defaultStyle = this.getDefaultStyle(type);\n        return !utilities.deepEqual(style, defaultStyle);\n    }\n}\nconst segmentationStyle = new SegmentationStyle();\nexport { segmentationStyle };\n","import { getActiveSegmentation as _getActiveSegmentation } from './getActiveSegmentation';\nimport { setActiveSegmentation as _setActiveSegmentation } from './setActiveSegmentation';\nfunction getActiveSegmentation(viewportId) {\n    return _getActiveSegmentation(viewportId);\n}\nfunction setActiveSegmentation(viewportId, segmentationId, suppressEvent = false) {\n    _setActiveSegmentation(viewportId, segmentationId);\n}\nexport { getActiveSegmentation, setActiveSegmentation, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setActiveSegmentation(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setActiveSegmentation(viewportId, segmentationId);\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nexport function addColorLUT(colorLUT, index) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const indexToUse = index ?? getNextColorLUTIndex();\n    let colorLUTToUse = [...colorLUT];\n    if (!utilities.isEqual(colorLUTToUse[0], [0, 0, 0, 0])) {\n        console.warn('addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it');\n        colorLUTToUse = [[0, 0, 0, 0], ...colorLUTToUse];\n    }\n    colorLUTToUse = colorLUTToUse.map((color) => {\n        if (color.length === 3) {\n            return [color[0], color[1], color[2], 255];\n        }\n        return color;\n    });\n    if (colorLUTToUse.length < 255) {\n        const missingColorLUTs = CORNERSTONE_COLOR_LUT.slice(colorLUTToUse.length);\n        colorLUTToUse = [...colorLUTToUse, ...missingColorLUTs];\n    }\n    segmentationStateManager.addColorLUT(colorLUTToUse, indexToUse);\n    return indexToUse;\n}\n","import CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { addColorLUT } from './addColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getColorLUT } from './getColorLUT';\nfunction internalAddSegmentationRepresentation(viewportId, representationInput) {\n    const { segmentationId, config } = representationInput;\n    const renderingConfig = {\n        colorLUTIndex: getColorLUTIndex(config),\n    };\n    defaultSegmentationStateManager.addSegmentationRepresentation(viewportId, segmentationId, representationInput.type, renderingConfig);\n    if (representationInput.type === SegmentationRepresentations.Contour) {\n        triggerAnnotationRenderForViewportIds([viewportId]);\n    }\n    triggerSegmentationModified(segmentationId);\n}\nfunction getColorLUTIndex(config) {\n    const { colorLUTOrIndex } = config || {};\n    if (colorLUTOrIndex === undefined) {\n        const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n        return index;\n    }\n    if (typeof colorLUTOrIndex === 'number') {\n        return colorLUTOrIndex;\n    }\n    if (Array.isArray(colorLUTOrIndex) &&\n        colorLUTOrIndex.every((item) => Array.isArray(item) && item.length === 4)) {\n        const index = addColorLUT(colorLUTOrIndex);\n        return index;\n    }\n    const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n    return index;\n}\nexport { internalAddSegmentationRepresentation };\n","import { SegmentationRepresentations } from '../../enums';\nimport { internalAddSegmentationRepresentation } from './internalAddSegmentationRepresentation';\nexport function addSegmentationRepresentations(viewportId, segmentationInputArray) {\n    segmentationInputArray.map((segmentationInput) => {\n        return internalAddSegmentationRepresentation(viewportId, segmentationInput);\n    });\n}\nfunction addContourRepresentationToViewport(viewportId, contourInputArray) {\n    return addSegmentationRepresentations(viewportId, contourInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Contour,\n    })));\n}\nfunction addContourRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addContourRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nfunction addLabelmapRepresentationToViewport(viewportId, labelmapInputArray) {\n    return addSegmentationRepresentations(viewportId, labelmapInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Labelmap,\n    })));\n}\nfunction addLabelmapRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addLabelmapRepresentationToViewport(viewportId, inputArray.map((input) => ({\n            ...input,\n            type: SegmentationRepresentations.Labelmap,\n        })));\n    }\n}\nfunction addSurfaceRepresentationToViewport(viewportId, surfaceInputArray) {\n    return addSegmentationRepresentations(viewportId, surfaceInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Surface,\n    })));\n}\nfunction addSurfaceRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addSurfaceRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nexport { addContourRepresentationToViewport, addLabelmapRepresentationToViewport, addSurfaceRepresentationToViewport, addContourRepresentationToViewportMap, addLabelmapRepresentationToViewportMap, addSurfaceRepresentationToViewportMap, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { cache } from '@cornerstonejs/core';\nfunction normalizeSegmentationInput(segmentationInput) {\n    const { segmentationId, representation, config } = segmentationInput;\n    const { type, data: inputData } = representation;\n    const data = inputData ? { ...inputData } : {};\n    if (!data) {\n        throw new Error('Segmentation representation data may not be undefined');\n    }\n    if (type === SegmentationRepresentations.Contour) {\n        normalizeContourData(data);\n    }\n    const normalizedSegments = normalizeSegments(config?.segments, type, data);\n    delete config?.segments;\n    return {\n        segmentationId,\n        label: config?.label ?? null,\n        cachedStats: config?.cachedStats ?? {},\n        segments: normalizedSegments,\n        representationData: {\n            [type]: {\n                ...data,\n            },\n        },\n    };\n}\nfunction normalizeContourData(contourData) {\n    contourData.geometryIds = contourData.geometryIds ?? [];\n    contourData.annotationUIDsMap = contourData.annotationUIDsMap ?? new Map();\n}\nfunction normalizeSegments(segmentsConfig, type, data) {\n    const normalizedSegments = {};\n    if (segmentsConfig) {\n        Object.entries(segmentsConfig).forEach(([segmentIndex, segment]) => {\n            normalizedSegments[segmentIndex] = {\n                segmentIndex: Number(segmentIndex),\n                label: segment.label ?? `Segment ${segmentIndex}`,\n                locked: segment.locked ?? false,\n                cachedStats: segment.cachedStats ?? {},\n                active: segment.active ?? false,\n            };\n        });\n    }\n    else if (type === SegmentationRepresentations.Surface) {\n        normalizeSurfaceSegments(normalizedSegments, data);\n    }\n    else {\n        normalizedSegments[1] = createDefaultSegment();\n    }\n    return normalizedSegments;\n}\nfunction normalizeSurfaceSegments(normalizedSegments, surfaceData) {\n    const { geometryIds } = surfaceData;\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (geometry?.data) {\n            const { segmentIndex } = geometry.data;\n            normalizedSegments[segmentIndex] = { segmentIndex };\n        }\n    });\n}\nfunction createDefaultSegment() {\n    return {\n        segmentIndex: 1,\n        label: 'Segment 1',\n        locked: false,\n        cachedStats: {},\n        active: true,\n    };\n}\nexport default normalizeSegmentationInput;\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport normalizeSegmentationInput from './helpers/normalizeSegmentationInput';\nexport function addSegmentations(segmentationInputArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationInputArray.forEach((segmentationInput) => {\n        const segmentation = normalizeSegmentationInput(segmentationInput);\n        segmentationStateManager.addSegmentation(segmentation);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentation.segmentationId);\n        }\n    });\n}\nexport default addSegmentations;\n","import { addColorLUT as _addColorLUT } from '../addColorLUT';\nimport { getColorLUT as _getColorLUT } from '../getColorLUT';\nimport { getSegmentationRepresentations } from '../getSegmentationRepresentation';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction addColorLUT(colorLUT, colorLUTIndex) {\n    if (!colorLUT) {\n        throw new Error('addColorLUT: colorLUT is required');\n    }\n    return _addColorLUT(colorLUT, colorLUTIndex);\n}\nfunction setColorLUT(viewportId, segmentationId, colorLUTsIndex) {\n    if (!_getColorLUT(colorLUTsIndex)) {\n        throw new Error(`setColorLUT: could not find colorLUT with index ${colorLUTsIndex}`);\n    }\n    const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n    if (!segmentationRepresentations) {\n        throw new Error(`viewport specific state for viewport ${viewportId} does not exist`);\n    }\n    segmentationRepresentations.forEach((segmentationRepresentation) => {\n        segmentationRepresentation.colorLUTIndex = colorLUTsIndex;\n    });\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nfunction getSegmentIndexColor(viewportId, segmentationId, segmentIndex) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n    });\n    if (!representations || representations.length === 0) {\n        return null;\n    }\n    const representation = representations[0];\n    const { colorLUTIndex } = representation;\n    const colorLUT = _getColorLUT(colorLUTIndex);\n    let colorValue = colorLUT[segmentIndex];\n    if (!colorValue) {\n        if (typeof segmentIndex !== 'number') {\n            throw new Error(`Can't create colour for LUT index ${segmentIndex}`);\n        }\n        colorValue = colorLUT[segmentIndex] = [0, 0, 0, 0];\n    }\n    return colorValue;\n}\nfunction setSegmentIndexColor(viewportId, segmentationId, segmentIndex, color) {\n    const colorReference = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n    for (let i = 0; i < color.length; i++) {\n        colorReference[i] = color[i];\n    }\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nexport { getSegmentIndexColor, addColorLUT, setColorLUT, setSegmentIndexColor };\n","import { triggerEvent, eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport { setSegmentationDirty } from '../../../utilities/segmentation/utilities';\nexport function triggerSegmentationDataModified(segmentationId, modifiedSlicesToUse) {\n    const eventDetail = {\n        segmentationId,\n        modifiedSlicesToUse,\n    };\n    setSegmentationDirty(segmentationId);\n    triggerEvent(eventTarget, Events.SEGMENTATION_DATA_MODIFIED, eventDetail);\n}\n","import { getSegmentation } from './getSegmentation';\nexport function getActiveSegmentIndex(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation) {\n        const activeSegmentIndex = Object.keys(segmentation.segments).find((segmentIndex) => segmentation.segments[segmentIndex].active);\n        return activeSegmentIndex ? Number(activeSegmentIndex) : undefined;\n    }\n    return undefined;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getActiveSegmentation(viewportId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getActiveSegmentation(viewportId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentations(viewportId, specifier = {}) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n}\nexport function getSegmentationRepresentation(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    if (!specifier.segmentationId || !specifier.type) {\n        throw new Error('getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them');\n    }\n    const representations = segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n    return representations?.[0];\n}\nexport function getSegmentationRepresentationsBySegmentationId(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationsBySegmentationId(segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentationVisibility(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationVisibility(viewportId, specifier);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    return state.segmentations;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportIdsWithSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportSegRepresentations = state.viewportSegRepresentations;\n    const viewportIdsWithSegmentation = Object.entries(viewportSegRepresentations)\n        .filter(([, viewportSegmentations]) => viewportSegmentations.some((segRep) => segRep.segmentationId === segmentationId))\n        .map(([viewportId]) => viewportId);\n    return viewportIdsWithSegmentation;\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportSegmentations(viewportId, type) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportRepresentations = state.viewportSegRepresentations[viewportId];\n    const segmentations = viewportRepresentations.map((representation) => {\n        if (type && representation.type === type) {\n            return getSegmentation(representation.segmentationId);\n        }\n        return getSegmentation(representation.segmentationId);\n    });\n    const filteredSegmentations = segmentations.filter((segmentation) => segmentation !== undefined);\n    return filteredSegmentations;\n}\n","import { internalComputeVolumeLabelmapFromStack } from '../SegmentationStateManager';\nexport async function computeVolumeLabelmapFromStack(args) {\n    return internalComputeVolumeLabelmapFromStack(args);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nexport function updateSegmentations(segmentationUpdateArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationUpdateArray.forEach((segmentationUpdate) => {\n        segmentationStateManager.updateSegmentation(segmentationUpdate.segmentationId, segmentationUpdate.payload);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentationUpdate.segmentationId);\n        }\n    });\n}\n","import { getSegmentationRepresentation, getSegmentationRepresentations, } from '../getSegmentationRepresentation';\nimport { setSegmentationRepresentationVisibility as _setSegmentationRepresentationVisibility } from '../setSegmentationRepresentationVisibility';\nimport { getSegmentationRepresentationVisibility as _getSegmentationRepresentationVisibility } from '../getSegmentationRepresentationVisibility';\nimport { triggerSegmentationRenderBySegmentationId } from '../SegmentationRenderingEngine';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction setSegmentationRepresentationVisibility(viewportId, specifier, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        _setSegmentationRepresentationVisibility(viewportId, {\n            segmentationId: representation.segmentationId,\n            type: representation.type,\n        }, visibility);\n    });\n}\nfunction getSegmentationRepresentationVisibility(viewportId, specifier) {\n    return _getSegmentationRepresentationVisibility(viewportId, specifier);\n}\nfunction setSegmentIndexVisibility(viewportId, specifier, segmentIndex, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        representation.segments[segmentIndex].visible = visibility;\n    });\n    triggerSegmentationRenderBySegmentationId(specifier.segmentationId);\n    triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId);\n}\nfunction getSegmentIndexVisibility(viewportId, specifier, segmentIndex) {\n    const hiddenSegments = getHiddenSegmentIndices(viewportId, specifier);\n    return !hiddenSegments.has(segmentIndex);\n}\nfunction getHiddenSegmentIndices(viewportId, specifier) {\n    const representation = getSegmentationRepresentation(viewportId, specifier);\n    if (!representation) {\n        return new Set();\n    }\n    const segmentsHidden = Object.entries(representation.segments).reduce((acc, [segmentIndex, segment]) => {\n        if (!segment.visible) {\n            acc.add(Number(segmentIndex));\n        }\n        return acc;\n    }, new Set());\n    return segmentsHidden;\n}\nexport { setSegmentationRepresentationVisibility, getSegmentationRepresentationVisibility, setSegmentIndexVisibility, getSegmentIndexVisibility, getHiddenSegmentIndices, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setSegmentationRepresentationVisibility(viewportId, specifier, visible);\n}\n","import { getSegmentations } from '../getSegmentations';\nimport { getViewportSegmentations } from '../getViewportSegmentations';\nimport { triggerSegmentationRender } from '../SegmentationRenderingEngine';\nimport { segmentationStyle } from '../SegmentationStyle';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction getStyle(specifier) {\n    return segmentationStyle.getStyle(specifier);\n}\nfunction setStyle(specifier, style) {\n    segmentationStyle.setStyle(specifier, style);\n    if (!specifier.viewportId && !specifier.segmentationId) {\n        const segmentations = getSegmentations();\n        segmentations.forEach((segmentation) => {\n            triggerSegmentationRender(segmentation.segmentationId);\n        });\n    }\n    triggerSegmentationRepresentationModified(specifier.viewportId, specifier.segmentationId, specifier.type);\n}\nfunction setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n    segmentationStyle.setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations);\n    triggerSegmentationRender(viewportId);\n    const segmentations = getViewportSegmentations(viewportId);\n    segmentations.forEach((segmentation) => {\n        triggerSegmentationRepresentationModified(viewportId, segmentation.segmentationId);\n    });\n}\nfunction getRenderInactiveSegmentations(viewportId) {\n    return segmentationStyle.getRenderInactiveSegmentations(viewportId);\n}\nfunction resetToGlobalStyle() {\n    segmentationStyle.resetToGlobalStyle();\n    triggerSegmentationRender();\n}\nfunction hasCustomStyle(specifier) {\n    return segmentationStyle.hasCustomStyle(specifier);\n}\nexport { getStyle, setStyle, setRenderInactiveSegmentations, getRenderInactiveSegmentations, resetToGlobalStyle, hasCustomStyle, };\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../getSegmentation';\nimport { triggerSegmentationDataModified } from '../triggerSegmentationEvents';\nexport function clearSegmentValue(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation.representationData.Labelmap) {\n        const { representationData } = segmentation;\n        const labelmapData = representationData.Labelmap;\n        if ('imageIds' in labelmapData || 'volumeId' in labelmapData) {\n            const items = 'imageIds' in labelmapData\n                ? labelmapData.imageIds.map((imageId) => cache.getImage(imageId))\n                : [cache.getVolume(labelmapData.volumeId)];\n            items.forEach((item) => {\n                if (!item) {\n                    return;\n                }\n                const { voxelManager } = item;\n                voxelManager.forEach(({ value, index }) => {\n                    if (value === segmentIndex) {\n                        voxelManager.setAtIndex(index, 0);\n                    }\n                });\n            });\n        }\n        triggerSegmentationDataModified(segmentationId);\n    }\n    else {\n        throw new Error('Invalid segmentation type, only labelmap is supported right now');\n    }\n}\n","import { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentation } from './getSegmentation';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { setActiveSegmentIndex } from './segmentIndex';\nimport { updateSegmentations } from './updateSegmentations';\nexport function removeSegment(segmentationId, segmentIndex, options = {\n    setNextSegmentAsActive: true,\n}) {\n    clearSegmentValue(segmentationId, segmentIndex);\n    const isThisSegmentActive = getActiveSegmentIndex(segmentationId) === segmentIndex;\n    const segmentation = getSegmentation(segmentationId);\n    const { segments } = segmentation;\n    delete segments[segmentIndex];\n    const updatedSegments = {\n        ...segments,\n    };\n    updateSegmentations([\n        {\n            segmentationId,\n            payload: {\n                segments: updatedSegments,\n            },\n        },\n    ]);\n    if (isThisSegmentActive && options.setNextSegmentAsActive) {\n        const segmentIndices = Object.keys(segments)\n            .map(Number)\n            .sort((a, b) => a - b);\n        const currentIndex = segmentIndices.indexOf(segmentIndex);\n        const nextSegmentIndex = segmentIndices[currentIndex + 1];\n        const previousSegmentIndex = segmentIndices[currentIndex - 1];\n        if (nextSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, nextSegmentIndex);\n        }\n        else if (previousSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, previousSegmentIndex);\n        }\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            delete representation.segments[segmentIndex];\n        });\n    });\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getLabelmapImageIds(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentation = getSegmentation(segmentationId);\n    return segmentationStateManager.getLabelmapImageIds(segmentation.representationData);\n}\n","import { removeContourRepresentation, removeLabelmapRepresentation, removeSegmentationRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, } from './addSegmentationRepresentationsToViewport';\nimport { addSegmentations } from './addSegmentations';\nimport { updateSegmentations } from './updateSegmentations';\nimport * as activeSegmentation from './activeSegmentation';\nimport * as segmentLocking from './segmentLocking';\nimport * as state from './segmentationState';\nimport * as config from './config';\nimport * as segmentIndex from './segmentIndex';\nimport * as triggerSegmentationEvents from './triggerSegmentationEvents';\nimport { convertStackToVolumeLabelmap } from './helpers/convertStackToVolumeLabelmap';\nimport { computeVolumeLabelmapFromStack } from './helpers/computeVolumeLabelmapFromStack';\nimport * as polySegManager from './polySeg';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { convertVolumeToStackLabelmap } from './helpers/computeStackLabelmapFromVolume';\nimport { removeSegment } from './removeSegment';\nimport { getLabelmapImageIds } from './getLabelmapImageIds';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nconst helpers = {\n    clearSegmentValue,\n    convertStackToVolumeLabelmap,\n    computeVolumeLabelmapFromStack,\n    convertVolumeToStackLabelmap,\n};\nexport { removeSegmentationRepresentation, removeContourRepresentation, removeLabelmapRepresentation, removeSurfaceRepresentation, removeAllSegmentations, removeSegmentation, removeSegmentationRepresentations, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, removeAllSegmentationRepresentations, addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addSegmentations, updateSegmentations, state, activeSegmentation, segmentLocking, config, segmentIndex, triggerSegmentationEvents, helpers, polySegManager as polySeg, removeSegment, getLabelmapImageIds, };\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeContourData } from './contourComputationStrategies';\nexport function computeAndAddContourRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Contour, () => computeContourData(segmentationId, options), () => undefined);\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeLabelmapData } from './labelmapComputationStrategies';\nimport { defaultSegmentationStateManager } from '../../SegmentationStateManager';\nimport { triggerSegmentationDataModified } from '../../triggerSegmentationEvents';\nexport async function computeAndAddLabelmapRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Labelmap, () => computeLabelmapData(segmentationId, options), () => null, () => {\n        defaultSegmentationStateManager.processLabelmapRepresentationAddition(options.viewport.id, segmentationId);\n        setTimeout(() => {\n            triggerSegmentationDataModified(segmentationId);\n        }, 0);\n    });\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeSurfaceData } from './surfaceComputationStrategies';\nimport { updateSurfaceData } from './updateSurfaceData';\nexport function computeAndAddSurfaceRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Surface, () => computeSurfaceData(segmentationId, options), () => updateSurfaceData(segmentationId));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getViewportIdsWithSegmentation } from '../../getViewportIdsWithSegmentation';\nimport { getSegmentation } from '../../getSegmentation';\nimport { triggerSegmentationModified } from '../../triggerSegmentationEvents';\nimport { getSegmentationRepresentation } from '../../getSegmentationRepresentation';\nimport { SegmentationRepresentations } from '../../../../enums';\nimport { computeSurfaceFromLabelmapSegmentation } from './surfaceComputationStrategies';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nexport async function updateSurfaceData(segmentationId) {\n    const surfacesObj = await computeSurfaceFromLabelmapSegmentation(segmentationId);\n    if (!surfacesObj) {\n        return;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    const indices = getUniqueSegmentIndices(segmentationId);\n    if (!indices.length) {\n        const geometryIds = segmentation.representationData.Surface.geometryIds;\n        geometryIds.forEach((geometryId) => {\n            const geometry = cache.getGeometry(geometryId);\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        });\n        triggerSegmentationModified(segmentationId);\n        return;\n    }\n    const promises = surfacesObj.map(({ data, segmentIndex }) => {\n        const geometryId = `segmentation_${segmentationId}_surface_${segmentIndex}`;\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry) {\n            const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n            return viewportIds.map((viewportId) => {\n                const surfaceRepresentation = getSegmentationRepresentation(viewportId, {\n                    segmentationId,\n                    type: SegmentationRepresentations.Surface,\n                });\n                return [surfaceRepresentation].map((surfaceRepresentation) => {\n                    segmentation.representationData.Surface.geometryIds.set(segmentIndex, geometryId);\n                    return createAndCacheSurfacesFromRaw(segmentationId, [{ segmentIndex, data }], {\n                        segmentationId: surfaceRepresentation.segmentationId,\n                    });\n                });\n            });\n        }\n        else if (indices.includes(segmentIndex)) {\n            const surface = geometry.data;\n            surface.points = data.points;\n            surface.polys = data.polys;\n        }\n        else {\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        }\n    });\n    await Promise.all(promises);\n    triggerSegmentationModified(segmentationId);\n}\n","import { Enums, geometryLoader } from '@cornerstonejs/core';\nimport { getSegmentIndexColor } from '../../config/segmentationColor';\nimport { getSegmentation } from '../../getSegmentation';\nexport async function createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const geometryIds = new Map();\n    const promises = Object.keys(rawSurfacesData).map(async (index) => {\n        const rawSurfaceData = rawSurfacesData[index];\n        const segmentIndex = rawSurfaceData.segmentIndex;\n        const color = getSegmentIndexColor(options.viewport.id, segmentation.segmentationId, segmentIndex).slice(0, 3);\n        if (!color) {\n            throw new Error('No color found for segment index, unable to create surface');\n        }\n        const closedSurface = {\n            id: `segmentation_${segmentation.segmentationId}_surface_${segmentIndex}`,\n            color,\n            frameOfReferenceUID: 'test-frameOfReferenceUID',\n            points: rawSurfaceData.data.points,\n            polys: rawSurfaceData.data.polys,\n            segmentIndex,\n        };\n        const geometryId = closedSurface.id;\n        geometryIds.set(segmentIndex, geometryId);\n        return geometryLoader.createAndCacheGeometry(geometryId, {\n            type: Enums.GeometryType.SURFACE,\n            geometryData: closedSurface,\n        });\n    });\n    await Promise.all(promises);\n    return {\n        geometryIds,\n    };\n}\n","import { Enums, eventTarget, triggerEvent, getWebWorkerManager, } from '@cornerstonejs/core';\nimport { getAnnotation } from '../../../annotation/annotationState';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_CONTOUR_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertContourToSurface(contourRepresentationData, segmentIndex) {\n    const { annotationUIDsMap } = contourRepresentationData;\n    const polylines = [];\n    const numPointsArray = [];\n    const annotationUIDs = annotationUIDsMap.get(segmentIndex);\n    for (const annotationUID of annotationUIDs) {\n        const annotation = getAnnotation(annotationUID);\n        const { polyline } = annotation.data\n            .contour;\n        numPointsArray.push(polyline.length);\n        polyline.forEach((polyline) => polylines.push(...polyline));\n    }\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertContourToSurface', {\n        polylines,\n        numPointsArray,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { cache, eventTarget, getWebWorkerManager, triggerEvent, Enums, } from '@cornerstonejs/core';\nimport { computeVolumeLabelmapFromStack } from '../../helpers/computeVolumeLabelmapFromStack';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_LABELMAP_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertLabelmapToSurface(labelmapRepresentationData, segmentIndex) {\n    let volumeId;\n    if (labelmapRepresentationData.volumeId) {\n        volumeId = labelmapRepresentationData\n            .volumeId;\n    }\n    else {\n        const { imageIds } = labelmapRepresentationData;\n        ({ volumeId } = await computeVolumeLabelmapFromStack({\n            imageIds,\n        }));\n    }\n    const volume = cache.getVolume(volumeId);\n    const scalarData = volume.voxelManager.getCompleteScalarDataArray();\n    const { dimensions, spacing, origin, direction } = volume;\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertLabelmapToSurface', {\n        scalarData,\n        dimensions,\n        spacing,\n        origin,\n        direction,\n        segmentIndex,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getSegmentation } from '../../getSegmentation';\nimport { convertContourToSurface } from './convertContourToSurface';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nimport { convertLabelmapToSurface } from './convertLabelmapToSurface';\nexport async function computeSurfaceData(segmentationId, options = {}) {\n    const segmentIndices = options.segmentIndices?.length\n        ? options.segmentIndices\n        : getUniqueSegmentIndices(segmentationId);\n    let rawSurfacesData;\n    const segmentation = getSegmentation(segmentationId);\n    const representationData = segmentation.representationData;\n    try {\n        if (representationData.Contour) {\n            rawSurfacesData = await computeSurfaceFromContourSegmentation(segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n        else if (representationData.Labelmap) {\n            rawSurfacesData = await computeSurfaceFromLabelmapSegmentation(segmentation.segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n    }\n    catch (error) {\n        console.error(error);\n        throw error;\n    }\n    if (!rawSurfacesData) {\n        throw new Error('Not enough data to convert to surface, currently only support converting volume labelmap to surface if available');\n    }\n    const surfacesData = await createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options);\n    return surfacesData;\n}\nasync function computeSurfaceFromLabelmapSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation?.representationData?.Labelmap) {\n        console.warn('Only support surface update from labelmaps');\n        return;\n    }\n    const labelmapRepresentationData = segmentation.representationData.Labelmap;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map((index) => {\n        const surface = convertLabelmapToSurface(labelmapRepresentationData, index);\n        return surface;\n    });\n    const surfaces = await Promise.allSettled(promises);\n    const errors = surfaces.filter((p) => p.status === 'rejected');\n    if (errors.length > 0) {\n        console.error(errors);\n        throw new Error('Failed to convert labelmap to surface');\n    }\n    const rawSurfacesData = surfaces\n        .map((surface, index) => {\n        if (surface.status === 'fulfilled') {\n            return { segmentIndex: segmentIndices[index], data: surface.value };\n        }\n    })\n        .filter(Boolean);\n    return rawSurfacesData;\n}\nasync function computeSurfaceFromContourSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const contourRepresentationData = segmentation.representationData.Contour;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map(async (index) => {\n        const surface = await convertContourToSurface(contourRepresentationData, index);\n        return { segmentIndex: index, data: surface };\n    });\n    const surfaces = await Promise.all(promises);\n    return surfaces;\n}\nexport { computeSurfaceFromContourSegmentation, computeSurfaceFromLabelmapSegmentation, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { getSegmentation } from '../getSegmentation';\nimport { validate as validateLabelmap } from '../../../tools/displayTools/Labelmap/validateLabelmap';\nconst conversionPaths = new Map([\n    [\n        SegmentationRepresentations.Labelmap,\n        new Set([\n            SegmentationRepresentations.Surface,\n            SegmentationRepresentations.Contour,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Contour,\n        new Set([\n            SegmentationRepresentations.Labelmap,\n            SegmentationRepresentations.Surface,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Surface,\n        new Set([SegmentationRepresentations.Labelmap]),\n    ],\n]);\nfunction canComputeRequestedRepresentation(segmentationId, type) {\n    const { representationData } = getSegmentation(segmentationId);\n    const existingRepresentationTypes = getExistingRepresentationTypes(representationData);\n    return existingRepresentationTypes.some((existingRepresentationType) => canConvertFromTo(existingRepresentationType, type));\n}\nfunction getExistingRepresentationTypes(representationData) {\n    const supportedTypes = [];\n    Object.keys(representationData).forEach((representationType) => {\n        const representationTypeData = representationData[representationType];\n        let validateFn;\n        switch (representationType) {\n            case SegmentationRepresentations.Labelmap:\n                validateFn = validateLabelmap;\n                break;\n        }\n        if (validateFn) {\n            try {\n                validateFn(representationTypeData);\n                supportedTypes.push(representationType);\n            }\n            catch (error) {\n                console.warn(`Validation failed for labelmap of type ${representationType}`);\n            }\n        }\n        else {\n            supportedTypes.push(representationType);\n        }\n    });\n    return supportedTypes;\n}\nasync function canConvertFromTo(fromRepresentationType, toRepresentationType) {\n    return (conversionPaths.get(fromRepresentationType)?.has(toRepresentationType) ||\n        false);\n}\nexport { canComputeRequestedRepresentation };\n","import { eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport addRepresentationData from '../internalAddRepresentationData';\nimport { triggerSegmentationModified } from '../triggerSegmentationEvents';\nimport debounce from '../../../utilities/debounce';\nimport { registerPolySegWorker } from './registerPolySegWorker';\nconst computedRepresentations = new Map();\nasync function computeAndAddRepresentation(segmentationId, type, computeFunction, updateFunction, onComputationComplete) {\n    registerPolySegWorker();\n    const data = await computeFunction();\n    addRepresentationData({\n        segmentationId,\n        type,\n        data,\n    });\n    onComputationComplete?.();\n    if (!computedRepresentations.has(segmentationId)) {\n        computedRepresentations.set(segmentationId, []);\n    }\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations.includes(type)) {\n        representations.push(type);\n    }\n    subscribeToSegmentationChanges(updateFunction);\n    triggerSegmentationModified(segmentationId);\n    return data;\n}\nfunction subscribeToSegmentationChanges(updateFunction) {\n    const debouncedUpdateFunction = (event) => {\n        _debouncedSegmentationModified(event, updateFunction);\n    };\n    updateFunction._debouncedUpdateFunction = debouncedUpdateFunction;\n    eventTarget.removeEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n    eventTarget.addEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n}\nconst _debouncedSegmentationModified = debounce((event, updateFunction) => {\n    const segmentationId = event.detail.segmentationId;\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations || !representations.length) {\n        return;\n    }\n    updateFunction(segmentationId);\n    if (representations.length) {\n        triggerSegmentationModified(segmentationId);\n    }\n}, 300);\nexport { computeAndAddRepresentation };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationRemoved } from './triggerSegmentationEvents';\nimport { removeSegmentationRepresentations } from './removeSegmentationRepresentations';\nexport function removeSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const viewportsWithSegmentation = segmentationStateManager\n        .getAllViewportSegmentationRepresentations()\n        .filter(({ representations }) => representations.some((rep) => rep.segmentationId === segmentationId))\n        .map(({ viewportId }) => viewportId);\n    viewportsWithSegmentation.forEach((viewportId) => {\n        removeSegmentationRepresentations(viewportId, { segmentationId });\n    });\n    segmentationStateManager.removeSegmentation(segmentationId);\n    triggerSegmentationRemoved(segmentationId);\n}\nexport function removeAllSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentations = segmentationStateManager.getState().segmentations;\n    segmentations.forEach((segmentation) => {\n        removeSegmentation(segmentation.segmentationId);\n    });\n    segmentationStateManager.resetState();\n}\n","import SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { surfaceDisplay } from '../../tools/displayTools/Surface';\nfunction removeSegmentationRepresentation(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction _removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    const { segmentationId, type } = specifier;\n    _removeRepresentationObject(viewportId, segmentationId, type, immediate);\n    return defaultSegmentationStateManager.removeSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n}\nfunction removeAllSegmentationRepresentations() {\n    const state = defaultSegmentationStateManager.getAllViewportSegmentationRepresentations();\n    state.forEach(({ viewportId, representations }) => {\n        representations.forEach(({ segmentationId, type }) => {\n            removeSegmentationRepresentation(viewportId, {\n                segmentationId,\n                type,\n            });\n        });\n    });\n    defaultSegmentationStateManager.resetState();\n}\nfunction removeLabelmapRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    }, immediate);\n}\nfunction removeContourRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Contour,\n    }, immediate);\n}\nfunction removeSurfaceRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Surface,\n    }, immediate);\n}\nfunction _removeRepresentationObject(viewportId, segmentationId, type, immediate) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n    representations.forEach((representation) => {\n        if (representation.type === SegmentationRepresentations.Labelmap) {\n            labelmapDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Contour) {\n            contourDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Surface) {\n            surfaceDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n    });\n    const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n    if (viewport) {\n        viewport.render();\n    }\n}\nexport { removeSegmentationRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, };\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nimport { invalidateBrushCursor } from '../../utilities/segmentation/invalidateBrushCursor';\nimport { getSegmentation } from './getSegmentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nfunction setActiveSegmentIndex(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (typeof segmentIndex === 'string') {\n        console.warn('segmentIndex is a string, converting to number');\n        segmentIndex = Number(segmentIndex);\n    }\n    Object.values(segmentation.segments).forEach((segment) => {\n        segment.active = false;\n    });\n    if (!segmentation.segments[segmentIndex]) {\n        segmentation.segments[segmentIndex] = {\n            segmentIndex,\n            label: '',\n            locked: false,\n            cachedStats: {},\n            active: false,\n        };\n    }\n    if (segmentation.segments[segmentIndex].active !== true) {\n        segmentation.segments[segmentIndex].active = true;\n        triggerSegmentationModified(segmentationId);\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            if (!representation.segments[segmentIndex]) {\n                representation.segments[segmentIndex] = {\n                    visible: true,\n                };\n            }\n        });\n    });\n    viewportIds.forEach((viewportId) => {\n        const toolGroup = getToolGroupForViewport(viewportId);\n        invalidateBrushCursor(toolGroup.id);\n    });\n}\nexport { setActiveSegmentIndex, getActiveSegmentIndex };\n","import { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nfunction isSegmentIndexLocked(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    return segments[segmentIndex].locked;\n}\nfunction setSegmentIndexLocked(segmentationId, segmentIndex, locked = true) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    segments[segmentIndex].locked = locked;\n    triggerSegmentationModified(segmentationId);\n}\nfunction getLockedSegmentIndices(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    const lockedSegmentIndices = Object.keys(segments).filter((segmentIndex) => segments[segmentIndex].locked);\n    return lockedSegmentIndices.map((segmentIndex) => parseInt(segmentIndex));\n}\nexport { isSegmentIndexLocked, setSegmentIndexLocked, getLockedSegmentIndices };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function removeColorLUT(colorLUTIndex) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.removeColorLUT(colorLUTIndex);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getStackSegmentationImageIdsForViewport(viewportId, segmentationId);\n}\n","import { getSegmentation } from './getSegmentation';\nimport { getSegmentations } from './getSegmentations';\nimport { addSegmentations } from './addSegmentations';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nimport { removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addColorLUT } from './addColorLUT';\nimport { getColorLUT } from './getColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { removeColorLUT } from './removeColorLUT';\nimport { getViewportSegmentations } from './getViewportSegmentations';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { getCurrentLabelmapImageIdForViewport } from './getCurrentLabelmapImageIdForViewport';\nimport { updateLabelmapSegmentationImageReferences } from './updateLabelmapSegmentationImageReferences';\nimport { getStackSegmentationImageIdsForViewport } from './getStackSegmentationImageIdsForViewport';\nimport { getSegmentationRepresentation, getSegmentationRepresentations, getSegmentationRepresentationsBySegmentationId, } from './getSegmentationRepresentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nfunction destroy() {\n    defaultSegmentationStateManager.resetState();\n}\nexport { getColorLUT, getCurrentLabelmapImageIdForViewport, getNextColorLUTIndex, getSegmentation, getSegmentations, getStackSegmentationImageIdsForViewport, getViewportIdsWithSegmentation, getSegmentationRepresentation, getSegmentationRepresentations, removeColorLUT, getViewportSegmentations, removeSegmentation, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, removeAllSegmentations, addColorLUT, addSegmentations, updateLabelmapSegmentationImageReferences, getSegmentationRepresentationsBySegmentationId, destroy, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { state } from '../state';\nfunction getToolGroupForViewport(viewportId, renderingEngineId) {\n    if (!renderingEngineId) {\n        renderingEngineId = getRenderingEngines().find((re) => re.getViewports().find((vp) => vp.id === viewportId))?.id;\n    }\n    const toolGroupFilteredByIds = state.toolGroups.filter((tg) => tg.viewportsInfo.some((vp) => vp.renderingEngineId === renderingEngineId &&\n        (!vp.viewportId || vp.viewportId === viewportId)));\n    if (!toolGroupFilteredByIds.length) {\n        return;\n    }\n    if (toolGroupFilteredByIds.length > 1) {\n        throw new Error(`Multiple tool groups found for renderingEngineId: ${renderingEngineId} and viewportId: ${viewportId}. You should only\n      have one tool group per viewport in a renderingEngine.`);\n    }\n    return toolGroupFilteredByIds[0];\n}\nexport default getToolGroupForViewport;\n","import { state } from '../state';\nfunction getToolGroup(toolGroupId) {\n    return state.toolGroups.find((s) => s.id === toolGroupId);\n}\nexport default getToolGroup;\n","import { MouseBindings, ToolModes, Events } from '../../enums';\nimport get from 'lodash.get';\nimport { triggerEvent, eventTarget, getRenderingEngine, getRenderingEngines, getEnabledElementByIds, Settings, } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { state } from '../state';\nimport { MouseCursor, SVGMouseCursor } from '../../cursors';\nimport { initElementCursor } from '../../cursors/elementCursor';\nimport getToolGroup from './getToolGroup';\nconst { Active, Passive, Enabled, Disabled } = ToolModes;\nconst PRIMARY_BINDINGS = [{ mouseButton: MouseBindings.Primary }];\nexport default class ToolGroup {\n    constructor(id) {\n        this.viewportsInfo = [];\n        this.toolOptions = {};\n        this.currentActivePrimaryToolName = null;\n        this.prevActivePrimaryToolName = null;\n        this.restoreToolOptions = {};\n        this._toolInstances = {};\n        this.id = id;\n    }\n    getViewportIds() {\n        return this.viewportsInfo.map(({ viewportId }) => viewportId);\n    }\n    getViewportsInfo() {\n        return this.viewportsInfo.slice();\n    }\n    getToolInstance(toolInstanceName) {\n        const toolInstance = this._toolInstances[toolInstanceName];\n        if (!toolInstance) {\n            console.warn(`'${toolInstanceName}' is not registered with this toolGroup (${this.id}).`);\n            return;\n        }\n        return toolInstance;\n    }\n    getToolInstances() {\n        return this._toolInstances;\n    }\n    hasTool(toolName) {\n        return !!this._toolInstances[toolName];\n    }\n    addTool(toolName, configuration = {}) {\n        const toolDefinition = state.tools[toolName];\n        const hasToolName = typeof toolName !== 'undefined' && toolName !== '';\n        const localToolInstance = this.toolOptions[toolName];\n        if (!hasToolName) {\n            console.warn('Tool with configuration did not produce a toolName: ', configuration);\n            return;\n        }\n        if (!toolDefinition) {\n            console.warn(`'${toolName}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);\n            return;\n        }\n        if (localToolInstance) {\n            console.warn(`'${toolName}' is already registered for ToolGroup ${this.id}.`);\n            return;\n        }\n        const { toolClass: ToolClass } = toolDefinition;\n        const toolProps = {\n            name: toolName,\n            toolGroupId: this.id,\n            configuration,\n        };\n        const instantiatedTool = new ToolClass(toolProps);\n        this._toolInstances[toolName] = instantiatedTool;\n    }\n    addToolInstance(toolName, parentClassName, configuration = {}) {\n        let ToolClassToUse = state.tools[toolName]\n            ?.toolClass;\n        if (!ToolClassToUse) {\n            const ParentClass = state.tools[parentClassName]\n                .toolClass;\n            class ToolInstance extends ParentClass {\n            }\n            ToolInstance.toolName = toolName;\n            ToolClassToUse = ToolInstance;\n            state.tools[toolName] = {\n                toolClass: ToolInstance,\n            };\n        }\n        this.addTool(ToolClassToUse.toolName, configuration);\n    }\n    addViewport(viewportId, renderingEngineId) {\n        if (typeof viewportId !== 'string') {\n            throw new Error('viewportId must be defined and be a string');\n        }\n        const renderingEngineUIDToUse = this._findRenderingEngine(viewportId, renderingEngineId);\n        if (!this.viewportsInfo.some(({ viewportId: vpId }) => vpId === viewportId)) {\n            this.viewportsInfo.push({\n                viewportId,\n                renderingEngineId: renderingEngineUIDToUse,\n            });\n        }\n        const toolName = this.getActivePrimaryMouseButtonTool();\n        const runtimeSettings = Settings.getRuntimeSettings();\n        if (runtimeSettings.get('useCursors')) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId: renderingEngineUIDToUse,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_ADDED, eventDetail);\n    }\n    removeViewports(renderingEngineId, viewportId) {\n        const indices = [];\n        this.viewportsInfo.forEach((vpInfo, index) => {\n            let match = false;\n            if (vpInfo.renderingEngineId === renderingEngineId) {\n                match = true;\n                if (viewportId && vpInfo.viewportId !== viewportId) {\n                    match = false;\n                }\n            }\n            if (match) {\n                indices.push(index);\n            }\n        });\n        if (indices.length) {\n            for (let i = indices.length - 1; i >= 0; i--) {\n                this.viewportsInfo.splice(indices[i], 1);\n            }\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_REMOVED, eventDetail);\n    }\n    setActiveStrategy(toolName, strategyName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool configuration.`);\n            return;\n        }\n        toolInstance.setActiveStrategy(strategyName);\n    }\n    setToolMode(toolName, mode, options = {}) {\n        if (!toolName) {\n            console.warn('setToolMode: toolName must be defined');\n            return;\n        }\n        if (mode === ToolModes.Active) {\n            this.setToolActive(toolName, options || this.restoreToolOptions[toolName]);\n            return;\n        }\n        if (mode === ToolModes.Passive) {\n            this.setToolPassive(toolName);\n            return;\n        }\n        if (mode === ToolModes.Enabled) {\n            this.setToolEnabled(toolName);\n            return;\n        }\n        if (mode === ToolModes.Disabled) {\n            this.setToolDisabled(toolName);\n            return;\n        }\n        console.warn('setToolMode: mode must be defined');\n    }\n    setToolActive(toolName, toolBindingsOptions = {}) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        if (!toolInstance) {\n            console.warn(`'${toolName}' instance ${toolInstance} is not registered with this toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevBindings = this.toolOptions[toolName]\n            ? this.toolOptions[toolName].bindings\n            : [];\n        const newBindings = toolBindingsOptions.bindings\n            ? toolBindingsOptions.bindings\n            : [];\n        const bindingsToUse = [...prevBindings, ...newBindings].reduce((unique, binding) => {\n            const TouchBinding = binding.numTouchPoints !== undefined;\n            const MouseBinding = binding.mouseButton !== undefined;\n            if (!unique.some((obj) => hasSameBinding(obj, binding)) &&\n                (TouchBinding || MouseBinding)) {\n                unique.push(binding);\n            }\n            return unique;\n        }, []);\n        const toolOptions = {\n            bindings: bindingsToUse,\n            mode: Active,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        this._toolInstances[toolName].mode = Active;\n        const runtimeSettings = Settings.getRuntimeSettings();\n        const useCursor = runtimeSettings.get('useCursors');\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions) && useCursor) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        else {\n            const activeToolIdentifier = this.getActivePrimaryMouseButtonTool();\n            if (!activeToolIdentifier && useCursor) {\n                const cursor = MouseCursor.getDefinedCursor('default');\n                this._setCursorForViewports(cursor);\n            }\n        }\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions)) {\n            if (this.prevActivePrimaryToolName === null) {\n                this.prevActivePrimaryToolName = toolName;\n            }\n            else {\n                this.prevActivePrimaryToolName = this.currentActivePrimaryToolName;\n            }\n            this.currentActivePrimaryToolName = toolName;\n        }\n        if (typeof toolInstance.onSetToolActive === 'function') {\n            toolInstance.onSetToolActive();\n        }\n        this._renderViewports();\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_ACTIVATED, eventDetail);\n        this._triggerToolModeChangedEvent(toolName, Active, toolBindingsOptions);\n    }\n    setToolPassive(toolName, options) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevToolOptions = this.getToolOptions(toolName);\n        const toolOptions = Object.assign({\n            bindings: prevToolOptions ? prevToolOptions.bindings : [],\n        }, prevToolOptions, {\n            mode: Passive,\n        });\n        const matchBindings = Array.isArray(options?.removeAllBindings)\n            ? options.removeAllBindings\n            : this.getDefaultPrimaryBindings();\n        toolOptions.bindings = toolOptions.bindings.filter((binding) => options?.removeAllBindings !== true &&\n            !matchBindings.some((matchBinding) => hasSameBinding(binding, matchBinding)));\n        let mode = Passive;\n        if (toolOptions.bindings.length !== 0) {\n            mode = Active;\n            toolOptions.mode = mode;\n        }\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = mode;\n        if (typeof toolInstance.onSetToolPassive === 'function') {\n            toolInstance.onSetToolPassive();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Passive);\n    }\n    setToolEnabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Enabled,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Enabled;\n        if (typeof toolInstance.onSetToolEnabled === 'function') {\n            toolInstance.onSetToolEnabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Enabled);\n    }\n    setToolDisabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Disabled,\n        };\n        this.restoreToolOptions[toolName] = this.toolOptions[toolName];\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Disabled;\n        if (typeof toolInstance.onSetToolDisabled === 'function') {\n            toolInstance.onSetToolDisabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Disabled);\n    }\n    getToolOptions(toolName) {\n        const toolOptionsForTool = this.toolOptions[toolName];\n        if (toolOptionsForTool === undefined) {\n            return;\n        }\n        return toolOptionsForTool;\n    }\n    getActivePrimaryMouseButtonTool() {\n        return Object.keys(this.toolOptions).find((toolName) => {\n            const toolOptions = this.toolOptions[toolName];\n            return (toolOptions.mode === Active &&\n                this._hasMousePrimaryButtonBinding(toolOptions));\n        });\n    }\n    setViewportsCursorByToolName(toolName, strategyName) {\n        const cursor = this._getCursor(toolName, strategyName);\n        this._setCursorForViewports(cursor);\n    }\n    _getCursor(toolName, strategyName) {\n        let cursorName;\n        let cursor;\n        if (strategyName) {\n            cursorName = `${toolName}.${strategyName}`;\n            cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n            if (cursor) {\n                return cursor;\n            }\n        }\n        cursorName = `${toolName}`;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        cursorName = toolName;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        return MouseCursor.getDefinedCursor('default');\n    }\n    _setCursorForViewports(cursor) {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            initElementCursor(viewport.element, cursor);\n        });\n    }\n    setToolConfiguration(toolName, configuration, overwrite) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return false;\n        }\n        let _configuration;\n        if (overwrite) {\n            _configuration = configuration;\n        }\n        else {\n            _configuration = Object.assign(toolInstance.configuration, configuration);\n        }\n        toolInstance.configuration = _configuration;\n        if (typeof toolInstance.onSetToolConfiguration === 'function') {\n            toolInstance.onSetToolConfiguration();\n        }\n        this._renderViewports();\n        return true;\n    }\n    getDefaultMousePrimary() {\n        return MouseBindings.Primary;\n    }\n    getDefaultPrimaryBindings() {\n        return PRIMARY_BINDINGS;\n    }\n    getToolConfiguration(toolName, configurationPath) {\n        if (this._toolInstances[toolName] === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return;\n        }\n        const _configuration = get(this._toolInstances[toolName].configuration, configurationPath) ||\n            this._toolInstances[toolName].configuration;\n        return utilities.deepClone(_configuration);\n    }\n    getPrevActivePrimaryToolName() {\n        return this.prevActivePrimaryToolName;\n    }\n    setActivePrimaryTool(toolName) {\n        const activeToolName = this.getCurrentActivePrimaryToolName();\n        this.setToolDisabled(activeToolName);\n        this.setToolActive(toolName, {\n            bindings: [{ mouseButton: MouseBindings.Primary }],\n        });\n    }\n    getCurrentActivePrimaryToolName() {\n        return this.currentActivePrimaryToolName;\n    }\n    clone(newToolGroupId, fnToolFilter = null) {\n        let toolGroup = getToolGroup(newToolGroupId);\n        if (toolGroup) {\n            console.debug(`ToolGroup ${newToolGroupId} already exists`);\n            return toolGroup;\n        }\n        toolGroup = new ToolGroup(newToolGroupId);\n        state.toolGroups.push(toolGroup);\n        fnToolFilter = fnToolFilter ?? (() => true);\n        Object.keys(this._toolInstances)\n            .filter(fnToolFilter)\n            .forEach((toolName) => {\n            const sourceToolInstance = this._toolInstances[toolName];\n            const sourceToolOptions = this.toolOptions[toolName];\n            const sourceToolMode = sourceToolInstance.mode;\n            toolGroup.addTool(toolName);\n            toolGroup.setToolMode(toolName, sourceToolMode, {\n                bindings: sourceToolOptions.bindings ?? [],\n            });\n        });\n        return toolGroup;\n    }\n    _hasMousePrimaryButtonBinding(toolOptions) {\n        const primaryBindings = this.getDefaultPrimaryBindings();\n        return toolOptions?.bindings?.some((binding) => primaryBindings.some((primary) => hasSameBinding(binding, primary)));\n    }\n    _renderViewports() {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            getRenderingEngine(renderingEngineId).renderViewport(viewportId);\n        });\n    }\n    _triggerToolModeChangedEvent(toolName, mode, toolBindingsOptions) {\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            mode,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_MODE_CHANGED, eventDetail);\n    }\n    _findRenderingEngine(viewportId, renderingEngineId) {\n        const renderingEngines = getRenderingEngines();\n        if (renderingEngines?.length === 0) {\n            throw new Error('No rendering engines found.');\n        }\n        if (renderingEngineId) {\n            return renderingEngineId;\n        }\n        const matchingEngines = renderingEngines.filter((engine) => engine.getViewport(viewportId));\n        if (matchingEngines.length === 0) {\n            if (renderingEngines.length === 1) {\n                return renderingEngines[0].id;\n            }\n            throw new Error('No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        if (matchingEngines.length > 1) {\n            throw new Error('Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        return matchingEngines[0].id;\n    }\n}\nfunction hasSameBinding(binding1, binding2) {\n    if (binding1.mouseButton !== binding2.mouseButton) {\n        return false;\n    }\n    if (binding1.numTouchPoints !== binding2.numTouchPoints) {\n        return false;\n    }\n    return binding1.modifierKey === binding2.modifierKey;\n}\n","import { state } from '../state';\nimport ToolGroup from './ToolGroup';\nfunction createToolGroup(toolGroupId) {\n    const toolGroupWithIdExists = state.toolGroups.some((tg) => tg.id === toolGroupId);\n    if (toolGroupWithIdExists) {\n        console.warn(`'${toolGroupId}' already exists.`);\n        return;\n    }\n    const toolGroup = new ToolGroup(toolGroupId);\n    state.toolGroups.push(toolGroup);\n    return toolGroup;\n}\nexport default createToolGroup;\n","import { state } from '../state';\nfunction destroyToolGroup(toolGroupId) {\n    const toolGroupIndex = state.toolGroups.findIndex((tg) => tg.id === toolGroupId);\n    if (toolGroupIndex > -1) {\n        state.toolGroups.splice(toolGroupIndex, 1);\n    }\n}\nexport default destroyToolGroup;\n","import { state } from '../state';\nimport destroyToolGroup from './destroyToolGroup';\nfunction destroy() {\n    const toolGroups = [...state.toolGroups];\n    for (const toolGroup of toolGroups) {\n        destroyToolGroup(toolGroup.id);\n    }\n    state.toolGroups = [];\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getAllToolGroups() {\n    return state.toolGroups;\n}\nexport default getAllToolGroups;\n","import { state } from '../state';\nimport { ToolModes } from '../../enums';\nconst MODES = [ToolModes.Active, ToolModes.Passive, ToolModes.Enabled];\nfunction getToolGroupsWithToolName(toolName) {\n    return state.toolGroups.filter(({ toolOptions }) => {\n        const toolGroupToolNames = Object.keys(toolOptions);\n        for (let i = 0; i < toolGroupToolNames.length; i++) {\n            if (toolName !== toolGroupToolNames[i]) {\n                continue;\n            }\n            if (!toolOptions[toolName]) {\n                continue;\n            }\n            if (MODES.includes(toolOptions[toolName].mode)) {\n                return true;\n            }\n        }\n        return false;\n    });\n}\nexport default getToolGroupsWithToolName;\n","import { state } from './state';\nexport function addTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    const toolAlreadyAdded = state.tools[toolName] !== undefined;\n    if (!toolName) {\n        throw new Error(`No Tool Found for the ToolClass ${ToolClass.name}`);\n    }\n    state.tools[toolName] = {\n        toolClass: ToolClass,\n    };\n}\nexport function hasTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    return !!(toolName && state.tools[toolName]);\n}\nexport function hasToolByName(toolName) {\n    return !!(toolName && state.tools[toolName]);\n}\nexport function removeTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    if (!toolName) {\n        throw new Error(`No tool found for: ${ToolClass.name}`);\n    }\n    if (!state.tools[toolName] !== undefined) {\n        delete state.tools[toolName];\n    }\n    else {\n        throw new Error(`${toolName} cannot be removed because it has not been added`);\n    }\n}\nexport default addTool;\n","import svgNodeCache, { resetSvgNodeCache } from './svgNodeCache';\nconst defaultState = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nlet state = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nfunction resetCornerstoneToolsState() {\n    resetSvgNodeCache();\n    state = {\n        ...structuredClone({\n            ...defaultState,\n            svgNodeCache: {},\n        }),\n        svgNodeCache: {\n            ...defaultState.svgNodeCache,\n        },\n    };\n}\nexport { resetCornerstoneToolsState, state, state as default };\n","let svgNodeCache = {};\nexport function resetSvgNodeCache() {\n    svgNodeCache = {};\n}\nexport default svgNodeCache;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawLine as drawLineSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as lineSegment from '../../utilities/math/line';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nconst { transformWorldToIndex } = csUtils;\nclass BidirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            let canvasPoint1 = viewport.worldToCanvas(points[0]);\n            let canvasPoint2 = viewport.worldToCanvas(points[1]);\n            let line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            let distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            canvasPoint1 = viewport.worldToCanvas(points[2]);\n            canvasPoint2 = viewport.worldToCanvas(points[3]);\n            line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const data = annotation.data;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            hideElementCursor(element);\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            if (this.editData.handleIndex !== undefined) {\n                const { points } = data.handles;\n                const firstLineSegmentLength = vec3.distance(points[0], points[1]);\n                const secondLineSegmentLength = vec3.distance(points[2], points[3]);\n                if (secondLineSegmentLength > firstLineSegmentLength) {\n                    const longAxis = [[...points[2]], [...points[3]]];\n                    const shortAxisPoint0 = [...points[0]];\n                    const shortAxisPoint1 = [...points[1]];\n                    const longAxisVector = vec2.create();\n                    vec2.set(longAxisVector, longAxis[1][0] - longAxis[0][0], longAxis[1][1] - longAxis[1][0]);\n                    const counterClockWisePerpendicularToLongAxis = vec2.create();\n                    vec2.set(counterClockWisePerpendicularToLongAxis, -longAxisVector[1], longAxisVector[0]);\n                    const currentShortAxisVector = vec2.create();\n                    vec2.set(currentShortAxisVector, shortAxisPoint1[0] - shortAxisPoint0[0], shortAxisPoint1[1] - shortAxisPoint0[0]);\n                    let shortAxis;\n                    if (vec2.dot(currentShortAxisVector, counterClockWisePerpendicularToLongAxis) > 0) {\n                        shortAxis = [shortAxisPoint0, shortAxisPoint1];\n                    }\n                    else {\n                        shortAxis = [shortAxisPoint1, shortAxisPoint0];\n                    }\n                    data.handles.points = [\n                        longAxis[0],\n                        longAxis[1],\n                        shortAxis[0],\n                        shortAxis[1],\n                    ];\n                }\n            }\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { worldToCanvas } = viewport;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            data.handles.points[handleIndex] = [...worldPos];\n            const canvasCoordPoints = data.handles.points.map(worldToCanvas);\n            const canvasCoords = {\n                longLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[0][0],\n                        y: canvasCoordPoints[0][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[1][0],\n                        y: canvasCoordPoints[1][1],\n                    },\n                },\n                shortLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[2][0],\n                        y: canvasCoordPoints[2][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[3][0],\n                        y: canvasCoordPoints[3][1],\n                    },\n                },\n            };\n            const dist = vec2.distance(canvasCoordPoints[0], canvasCoordPoints[1]);\n            const shortAxisDistFromCenter = dist / 3;\n            const dx = canvasCoords.longLineSegment.start.x - canvasCoords.longLineSegment.end.x;\n            const dy = canvasCoords.longLineSegment.start.y - canvasCoords.longLineSegment.end.y;\n            const length = Math.sqrt(dx * dx + dy * dy);\n            const vectorX = dx / length;\n            const vectorY = dy / length;\n            const xMid = (canvasCoords.longLineSegment.start.x +\n                canvasCoords.longLineSegment.end.x) /\n                2;\n            const yMid = (canvasCoords.longLineSegment.start.y +\n                canvasCoords.longLineSegment.end.y) /\n                2;\n            const startX = xMid + shortAxisDistFromCenter * vectorY;\n            const startY = yMid - shortAxisDistFromCenter * vectorX;\n            const endX = xMid - shortAxisDistFromCenter * vectorY;\n            const endY = yMid + shortAxisDistFromCenter * vectorX;\n            data.handles.points[2] = viewport.canvasToWorld([startX, startY]);\n            data.handles.points[3] = viewport.canvasToWorld([endX, endY]);\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData.hasMoved = true;\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragModifyHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { annotation, handleIndex: movingHandleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            const canvasCoordHandlesCurrent = [\n                viewport.worldToCanvas(data.handles.points[0]),\n                viewport.worldToCanvas(data.handles.points[1]),\n                viewport.worldToCanvas(data.handles.points[2]),\n                viewport.worldToCanvas(data.handles.points[3]),\n            ];\n            const firstLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[0][0],\n                    y: canvasCoordHandlesCurrent[0][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[1][0],\n                    y: canvasCoordHandlesCurrent[1][1],\n                },\n            };\n            const secondLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[2][0],\n                    y: canvasCoordHandlesCurrent[2][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[3][0],\n                    y: canvasCoordHandlesCurrent[3][1],\n                },\n            };\n            const proposedPoint = [...worldPos];\n            const proposedCanvasCoord = viewport.worldToCanvas(proposedPoint);\n            if (movingHandleIndex === 0 || movingHandleIndex === 1) {\n                const fixedHandleIndex = movingHandleIndex === 0 ? 1 : 0;\n                const fixedHandleCanvasCoord = canvasCoordHandlesCurrent[fixedHandleIndex];\n                const fixedHandleToProposedCoordVec = vec2.set(vec2.create(), proposedCanvasCoord[0] - fixedHandleCanvasCoord[0], proposedCanvasCoord[1] - fixedHandleCanvasCoord[1]);\n                const fixedHandleToOldCoordVec = vec2.set(vec2.create(), canvasCoordHandlesCurrent[movingHandleIndex][0] -\n                    fixedHandleCanvasCoord[0], canvasCoordHandlesCurrent[movingHandleIndex][1] -\n                    fixedHandleCanvasCoord[1]);\n                vec2.normalize(fixedHandleToProposedCoordVec, fixedHandleToProposedCoordVec);\n                vec2.normalize(fixedHandleToOldCoordVec, fixedHandleToOldCoordVec);\n                const proposedFirstLineSegment = {\n                    start: {\n                        x: fixedHandleCanvasCoord[0],\n                        y: fixedHandleCanvasCoord[1],\n                    },\n                    end: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                };\n                if (this._movingLongAxisWouldPutItThroughShortAxis(proposedFirstLineSegment, secondLineSegment)) {\n                    return;\n                }\n                const centerOfRotation = fixedHandleCanvasCoord;\n                const angle = this._getSignedAngle(fixedHandleToOldCoordVec, fixedHandleToProposedCoordVec);\n                let firstPointX = canvasCoordHandlesCurrent[2][0];\n                let firstPointY = canvasCoordHandlesCurrent[2][1];\n                let secondPointX = canvasCoordHandlesCurrent[3][0];\n                let secondPointY = canvasCoordHandlesCurrent[3][1];\n                firstPointX -= centerOfRotation[0];\n                firstPointY -= centerOfRotation[1];\n                secondPointX -= centerOfRotation[0];\n                secondPointY -= centerOfRotation[1];\n                const rotatedFirstPoint = firstPointX * Math.cos(angle) - firstPointY * Math.sin(angle);\n                const rotatedFirstPointY = firstPointX * Math.sin(angle) + firstPointY * Math.cos(angle);\n                const rotatedSecondPoint = secondPointX * Math.cos(angle) - secondPointY * Math.sin(angle);\n                const rotatedSecondPointY = secondPointX * Math.sin(angle) + secondPointY * Math.cos(angle);\n                firstPointX = rotatedFirstPoint + centerOfRotation[0];\n                firstPointY = rotatedFirstPointY + centerOfRotation[1];\n                secondPointX = rotatedSecondPoint + centerOfRotation[0];\n                secondPointY = rotatedSecondPointY + centerOfRotation[1];\n                const newFirstPoint = viewport.canvasToWorld([firstPointX, firstPointY]);\n                const newSecondPoint = viewport.canvasToWorld([\n                    secondPointX,\n                    secondPointY,\n                ]);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n                data.handles.points[2] = newFirstPoint;\n                data.handles.points[3] = newSecondPoint;\n            }\n            else {\n                const translateHandleIndex = movingHandleIndex === 2 ? 3 : 2;\n                const canvasCoordsCurrent = {\n                    longLineSegment: {\n                        start: firstLineSegment.start,\n                        end: firstLineSegment.end,\n                    },\n                    shortLineSegment: {\n                        start: secondLineSegment.start,\n                        end: secondLineSegment.end,\n                    },\n                };\n                const longLineSegmentVec = vec2.subtract(vec2.create(), [\n                    canvasCoordsCurrent.longLineSegment.end.x,\n                    canvasCoordsCurrent.longLineSegment.end.y,\n                ], [\n                    canvasCoordsCurrent.longLineSegment.start.x,\n                    canvasCoordsCurrent.longLineSegment.start.y,\n                ]);\n                const longLineSegmentVecNormalized = vec2.normalize(vec2.create(), longLineSegmentVec);\n                const proposedToCurrentVec = vec2.subtract(vec2.create(), [proposedCanvasCoord[0], proposedCanvasCoord[1]], [\n                    canvasCoordHandlesCurrent[movingHandleIndex][0],\n                    canvasCoordHandlesCurrent[movingHandleIndex][1],\n                ]);\n                const movementLength = vec2.length(proposedToCurrentVec);\n                const angle = this._getSignedAngle(longLineSegmentVecNormalized, proposedToCurrentVec);\n                const movementAlongLineSegmentLength = Math.cos(angle) * movementLength;\n                const newTranslatedPoint = vec2.scaleAndAdd(vec2.create(), [\n                    canvasCoordHandlesCurrent[translateHandleIndex][0],\n                    canvasCoordHandlesCurrent[translateHandleIndex][1],\n                ], longLineSegmentVecNormalized, movementAlongLineSegmentLength);\n                if (this._movingLongAxisWouldPutItThroughShortAxis({\n                    start: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                    end: {\n                        x: newTranslatedPoint[0],\n                        y: newTranslatedPoint[1],\n                    },\n                }, {\n                    start: {\n                        x: canvasCoordsCurrent.longLineSegment.start.x,\n                        y: canvasCoordsCurrent.longLineSegment.start.y,\n                    },\n                    end: {\n                        x: canvasCoordsCurrent.longLineSegment.end.x,\n                        y: canvasCoordsCurrent.longLineSegment.end.y,\n                    },\n                })) {\n                    return;\n                }\n                const intersectionPoint = lineSegment.intersectLine([proposedCanvasCoord[0], proposedCanvasCoord[1]], [newTranslatedPoint[0], newTranslatedPoint[1]], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n                if (!intersectionPoint) {\n                    return;\n                }\n                data.handles.points[translateHandleIndex] = viewport.canvasToWorld(newTranslatedPoint);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = true;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        width: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId1 = `${annotationUID}-line-1`;\n                const dataId2 = `${annotationUID}-line-2`;\n                const lineUID = '0';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId1);\n                const secondLineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, secondLineUID, canvasCoordinates[2], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId2);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._movingLongAxisWouldPutItThroughShortAxis = (firstLineSegment, secondLineSegment) => {\n            const vectorInSecondLineDirection = vec2.create();\n            vec2.set(vectorInSecondLineDirection, secondLineSegment.end.x - secondLineSegment.start.x, secondLineSegment.end.y - secondLineSegment.start.y);\n            vec2.normalize(vectorInSecondLineDirection, vectorInSecondLineDirection);\n            const extendedSecondLineSegment = {\n                start: {\n                    x: secondLineSegment.start.x - vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.start.y - vectorInSecondLineDirection[1] * 10,\n                },\n                end: {\n                    x: secondLineSegment.end.x + vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.end.y + vectorInSecondLineDirection[1] * 10,\n                },\n            };\n            const proposedIntersectionPoint = lineSegment.intersectLine([extendedSecondLineSegment.start.x, extendedSecondLineSegment.start.y], [extendedSecondLineSegment.end.x, extendedSecondLineSegment.end.y], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n            const wouldPutThroughShortAxis = !proposedIntersectionPoint;\n            return wouldPutThroughShortAxis;\n        };\n        this._calculateCachedStats = (annotation, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { element } = enabledElement.viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const worldPos3 = data.handles.points[2];\n            const worldPos4 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, dimensions } = image;\n                const index1 = transformWorldToIndex(imageData, worldPos1);\n                const index2 = transformWorldToIndex(imageData, worldPos2);\n                const index3 = transformWorldToIndex(imageData, worldPos3);\n                const index4 = transformWorldToIndex(imageData, worldPos4);\n                const handles1 = [index1, index2];\n                const handles2 = [index3, index4];\n                const { scale: scale1, unit: units1 } = getCalibratedLengthUnitsAndScale(image, handles1);\n                const { scale: scale2, unit: units2 } = getCalibratedLengthUnitsAndScale(image, handles2);\n                const dist1 = this._calculateLength(worldPos1, worldPos2) / scale1;\n                const dist2 = this._calculateLength(worldPos3, worldPos4) / scale2;\n                const length = dist1 > dist2 ? dist1 : dist2;\n                const width = dist1 > dist2 ? dist2 : dist1;\n                const unit = dist1 > dist2 ? units1 : units2;\n                const widthUnit = dist1 > dist2 ? units2 : units1;\n                this._isInsideVolume(index1, index2, index3, index4, dimensions)\n                    ? (this.isHandleOutsideImage = false)\n                    : (this.isHandleOutsideImage = true);\n                cachedStats[targetId] = {\n                    length,\n                    width,\n                    unit,\n                    widthUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, index3, index4, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions) &&\n                csUtils.indexWithinDimensions(index3, dimensions) &&\n                csUtils.indexWithinDimensions(index4, dimensions));\n        };\n        this._getSignedAngle = (vector1, vector2) => {\n            return Math.atan2(vector1[0] * vector2[1] - vector1[1] * vector2[0], vector1[0] * vector2[0] + vector1[1] * vector2[1]);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const worldPos = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        this.isDrawing = true;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const annotation = {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...viewport.getViewReference({ points: [worldPos] }),\n            },\n            data: {\n                handles: {\n                    points: [\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                    ],\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n        };\n        addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex: 1,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n        };\n        this._activateDraw(element);\n        hideElementCursor(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const { cachedStats, label } = data;\n    const { length, width, unit } = cachedStats[targetId];\n    const textLines = [];\n    if (label) {\n        textLines.push(label);\n    }\n    if (length === undefined) {\n        return textLines;\n    }\n    textLines.push(`L: ${csUtils.roundNumber(length)} ${unit || unit}`, `W: ${csUtils.roundNumber(width)} ${unit}`);\n    return textLines;\n}\nBidirectionalTool.toolName = 'Bidirectional';\nexport default BidirectionalTool;\n","import { utilities } from '@cornerstonejs/core';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport PlanarFreehandROITool from './PlanarFreehandROITool';\nclass PlanarFreehandContourSegmentationTool extends PlanarFreehandROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n                allowOpenContours: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n    renderAnnotationInstance(renderContext) {\n        const annotation = renderContext.annotation;\n        const { invalidated } = annotation;\n        const renderResult = super.renderAnnotationInstance(renderContext);\n        if (invalidated) {\n            const { segmentationId } = annotation.data.segmentation;\n            triggerSegmentationDataModified(segmentationId);\n        }\n        return renderResult;\n    }\n}\nPlanarFreehandContourSegmentationTool.toolName =\n    'PlanarFreehandContourSegmentationTool';\nexport default PlanarFreehandContourSegmentationTool;\n","import { CONSTANTS, getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport * as math from '../../utilities/math';\nimport { polyline } from '../../utilities/math';\nimport { filterAnnotationsForDisplay } from '../../utilities/planar';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport registerDrawLoop from './planarFreehandROITool/drawLoop';\nimport registerEditLoopCommon from './planarFreehandROITool/editLoopCommon';\nimport registerClosedContourEditLoop from './planarFreehandROITool/closedContourEditLoop';\nimport registerOpenContourEditLoop from './planarFreehandROITool/openContourEditLoop';\nimport registerOpenContourEndEditLoop from './planarFreehandROITool/openContourEndEditLoop';\nimport registerRenderMethods from './planarFreehandROITool/renderMethods';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { drawLinkedTextBox } from '../../drawingSvg';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getLineSegmentIntersectionsCoordinates } from '../../utilities/math/polyline';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport calculatePerimeter from '../../utilities/contours/calculatePerimeter';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { KeyboardBindings, ChangeTypes } from '../../enums';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { pointCanProjectOnLine } = polyline;\nconst { EPSILON } = CONSTANTS;\nconst PARALLEL_THRESHOLD = 1 - EPSILON;\nclass PlanarFreehandROITool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            alwaysRenderOpenContourHandles: {\n                enabled: false,\n                radius: 2,\n            },\n            allowOpenContours: true,\n            closeContourProximity: 10,\n            checkCanvasEditFallbackProximity: 6,\n            makeClockWise: true,\n            subPixelResolution: 4,\n            smoothing: {\n                smoothOnAdd: false,\n                smoothOnEdit: false,\n                knotsRatioPercentageOnAdd: 40,\n                knotsRatioPercentageOnEdit: 40,\n            },\n            interpolation: {\n                enabled: false,\n                onInterpolationComplete: null,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            displayOnePointAsCrosshairs: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isEditingClosed = false;\n        this.isEditingOpen = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const annotation = this.createAnnotation(evt);\n            this.addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateDraw(evt, annotation, viewportIdsToRender);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateOpenContourEndEdit(evt, annotation, viewportIdsToRender, handle);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            if (annotation.data.contour.closed) {\n                this.activateClosedContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            else {\n                this.activateOpenContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { polyline: points } = annotation.data.contour;\n            let previousPoint = viewport.worldToCanvas(points[0]);\n            for (let i = 1; i < points.length; i++) {\n                const p1 = previousPoint;\n                const p2 = viewport.worldToCanvas(points[i]);\n                const canProject = pointCanProjectOnLine(canvasCoords, p1, p2, proximity);\n                if (canProject) {\n                    return true;\n                }\n                previousPoint = p2;\n            }\n            if (!annotation.data.contour.closed) {\n                return false;\n            }\n            const pStart = viewport.worldToCanvas(points[0]);\n            const pEnd = viewport.worldToCanvas(points[points.length - 1]);\n            return pointCanProjectOnLine(canvasCoords, pStart, pEnd, proximity);\n        };\n        this.cancel = (element) => {\n            const isDrawing = this.isDrawing;\n            const isEditingOpen = this.isEditingOpen;\n            const isEditingClosed = this.isEditingClosed;\n            if (isDrawing) {\n                this.cancelDrawing(element);\n            }\n            else if (isEditingOpen) {\n                this.cancelOpenContourEdit(element);\n            }\n            else if (isEditingClosed) {\n                this.cancelClosedContourEdit(element);\n            }\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { cachedStats } = data;\n            const { polyline: points, closed } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const modalityUnitOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n                const calibratedScale = getCalibratedLengthUnitsAndScale(image, () => {\n                    const polyline = data.contour.polyline;\n                    const numPoints = polyline.length;\n                    const projectedPolyline = new Array(numPoints);\n                    for (let i = 0; i < numPoints; i++) {\n                        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n                    }\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(projectedPolyline);\n                    const topLeftBBWorld = viewport.canvasToWorld([canvasMinX, canvasMinY]);\n                    const topLeftBBIndex = csUtils.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = csUtils.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                if (closed) {\n                    this.updateClosedCachedStats({\n                        targetId,\n                        viewport,\n                        canvasCoordinates,\n                        points,\n                        imageData,\n                        metadata,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n                else {\n                    this.updateOpenCachedStats({\n                        metadata,\n                        canvasCoordinates,\n                        targetId,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n            }\n            triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.StatsUpdated);\n            annotation.invalidated = false;\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, enabledElement, svgDrawingHelper) => {\n            const { data } = annotation;\n            const targetId = this.getTargetId(viewport);\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n            if (!options.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = '1';\n            const boundingBox = drawLinkedTextBox(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        registerDrawLoop(this);\n        registerEditLoopCommon(this);\n        registerClosedContourEditLoop(this);\n        registerOpenContourEditLoop(this);\n        registerOpenContourEndEditLoop(this);\n        registerRenderMethods(this);\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let annotationsToDisplay;\n        if (viewport instanceof VolumeViewport) {\n            const camera = viewport.getCamera();\n            const { spacingInNormalDirection } = csUtils.getTargetVolumeAndSpacingInNormalDir(viewport, camera);\n            annotationsToDisplay = this.filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection);\n        }\n        else {\n            annotationsToDisplay = filterAnnotationsForDisplay(viewport, annotations);\n        }\n        return annotationsToDisplay;\n    }\n    filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection) {\n        const { viewPlaneNormal } = camera;\n        const annotationsWithParallelNormals = annotations.filter((td) => {\n            const annotationViewPlaneNormal = td.metadata.viewPlaneNormal;\n            const isParallel = Math.abs(vec3.dot(viewPlaneNormal, annotationViewPlaneNormal)) >\n                PARALLEL_THRESHOLD;\n            return annotationViewPlaneNormal && isParallel;\n        });\n        if (!annotationsWithParallelNormals.length) {\n            return [];\n        }\n        const halfSpacingInNormalDirection = spacingInNormalDirection / 2;\n        const { focalPoint } = camera;\n        const annotationsWithinSlice = [];\n        for (const annotation of annotationsWithParallelNormals) {\n            const data = annotation.data;\n            const point = data.contour.polyline[0];\n            if (!annotation.isVisible) {\n                continue;\n            }\n            const dir = vec3.create();\n            vec3.sub(dir, focalPoint, point);\n            const dot = vec3.dot(dir, viewPlaneNormal);\n            if (Math.abs(dot) < halfSpacingInNormalDirection) {\n                annotationsWithinSlice.push(annotation);\n            }\n        }\n        return annotationsWithinSlice;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const worldPos = evt.detail.currentPoints.world;\n        const contourAnnotation = super.createAnnotation(evt);\n        const onInterpolationComplete = (annotation) => {\n            annotation.data.handles.points.length = 0;\n        };\n        const annotation = csUtils.deepMerge(contourAnnotation, {\n            data: {\n                contour: {\n                    polyline: [[...worldPos]],\n                },\n                label: '',\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n        return annotation;\n    }\n    getAnnotationStyle(context) {\n        return super.getAnnotationStyle(context);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        let renderStatus = false;\n        const { viewport, renderingEngine } = enabledElement;\n        const isDrawing = this.isDrawing;\n        const isEditingOpen = this.isEditingOpen;\n        const isEditingClosed = this.isEditingClosed;\n        if (!(isDrawing || isEditingOpen || isEditingClosed)) {\n            if (this.configuration.displayOnePointAsCrosshairs &&\n                annotation.data.contour.polyline.length === 1) {\n                this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n            }\n            else {\n                this.renderContour(enabledElement, svgDrawingHelper, annotation);\n            }\n        }\n        else {\n            const activeAnnotationUID = this.commonData.annotation.annotationUID;\n            if (annotation.annotationUID === activeAnnotationUID) {\n                if (isDrawing) {\n                    this.renderContourBeingDrawn(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingClosed) {\n                    this.renderClosedContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingOpen) {\n                    this.renderOpenContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);\n                }\n            }\n            else {\n                if (this.configuration.displayOnePointAsCrosshairs &&\n                    annotation.data.contour.polyline.length === 1) {\n                    this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    this.renderContour(enabledElement, svgDrawingHelper, annotation);\n                }\n            }\n            renderStatus = true;\n        }\n        if (!this.configuration.calculateStats) {\n            return;\n        }\n        this._calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement);\n        this._renderStats(annotation, viewport, enabledElement, svgDrawingHelper);\n        return renderStatus;\n    }\n    _calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement) {\n        const activeAnnotationUID = this.commonData?.annotation.annotationUID;\n        if (annotation.annotationUID === activeAnnotationUID &&\n            !this.commonData?.movingTextBox) {\n            return;\n        }\n        if (!this.commonData?.movingTextBox) {\n            const { data } = annotation;\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].areaUnit == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    area: null,\n                    max: null,\n                    mean: null,\n                    stdDev: null,\n                    areaUnit: null,\n                };\n                this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n        }\n    }\n    updateClosedCachedStats({ viewport, points, imageData, metadata, cachedStats, targetId, modalityUnit, canvasCoordinates, calibratedScale, }) {\n        const { scale, areaUnit, units } = calibratedScale;\n        const { voxelManager } = viewport.getImageData();\n        const canvasPoint = canvasCoordinates[0];\n        const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n        const deltaXPoint = viewport.canvasToWorld([\n            canvasPoint[0] + 1,\n            canvasPoint[1],\n        ]);\n        const deltaYPoint = viewport.canvasToWorld([\n            canvasPoint[0],\n            canvasPoint[1] + 1,\n        ]);\n        const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n        const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n        const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[0]);\n        worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n        worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n        worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n        let iMin = worldPosIndex[0];\n        let iMax = worldPosIndex[0];\n        let jMin = worldPosIndex[1];\n        let jMax = worldPosIndex[1];\n        let kMin = worldPosIndex[2];\n        let kMax = worldPosIndex[2];\n        for (let j = 1; j < points.length; j++) {\n            const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[j]);\n            worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n            worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n            worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n            iMin = Math.min(iMin, worldPosIndex[0]);\n            iMax = Math.max(iMax, worldPosIndex[0]);\n            jMin = Math.min(jMin, worldPosIndex[1]);\n            jMax = Math.max(jMax, worldPosIndex[1]);\n            kMin = Math.min(kMin, worldPosIndex[2]);\n            kMax = Math.max(kMax, worldPosIndex[2]);\n        }\n        const worldPosIndex2 = csUtils.transformWorldToIndex(imageData, points[1]);\n        worldPosIndex2[0] = Math.floor(worldPosIndex2[0]);\n        worldPosIndex2[1] = Math.floor(worldPosIndex2[1]);\n        worldPosIndex2[2] = Math.floor(worldPosIndex2[2]);\n        let area = polyline.getArea(canvasCoordinates) / scale / scale;\n        area *= deltaInX * deltaInY;\n        const iDelta = 0.01 * (iMax - iMin);\n        const jDelta = 0.01 * (jMax - jMin);\n        const kDelta = 0.01 * (kMax - kMin);\n        iMin = Math.floor(iMin - iDelta);\n        iMax = Math.ceil(iMax + iDelta);\n        jMin = Math.floor(jMin - jDelta);\n        jMax = Math.ceil(jMax + jDelta);\n        kMin = Math.floor(kMin - kDelta);\n        kMax = Math.ceil(kMax + kDelta);\n        const boundsIJK = [\n            [iMin, iMax],\n            [jMin, jMax],\n            [kMin, kMax],\n        ];\n        const worldPosEnd = imageData.indexToWorld([iMax, jMax, kMax]);\n        const canvasPosEnd = viewport.worldToCanvas(worldPosEnd);\n        let curRow = 0;\n        let intersections = [];\n        let intersectionCounter = 0;\n        const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n            imageData,\n            isInObject: (pointLPS, _pointIJK) => {\n                let result = true;\n                const point = viewport.worldToCanvas(pointLPS);\n                if (point[1] != curRow) {\n                    intersectionCounter = 0;\n                    curRow = point[1];\n                    intersections = getLineSegmentIntersectionsCoordinates(canvasCoordinates, point, [canvasPosEnd[0], point[1]]);\n                    intersections.sort((function (index) {\n                        return function (a, b) {\n                            return a[index] === b[index]\n                                ? 0\n                                : a[index] < b[index]\n                                    ? -1\n                                    : 1;\n                        };\n                    })(0));\n                }\n                if (intersections.length && point[0] > intersections[0][0]) {\n                    intersections.shift();\n                    intersectionCounter++;\n                }\n                if (intersectionCounter % 2 === 0) {\n                    result = false;\n                }\n                return result;\n            },\n            boundsIJK,\n            returnPoints: this.configuration.storePointData,\n        });\n        const stats = this.configuration.statsCalculator.getStatistics();\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            area,\n            perimeter: calculatePerimeter(canvasCoordinates, closed) / scale,\n            mean: stats.mean?.value,\n            max: stats.max?.value,\n            stdDev: stats.stdDev?.value,\n            statsArray: stats.array,\n            pointsInShape: pointsInShape,\n            areaUnit,\n            modalityUnit,\n            unit: units,\n        };\n    }\n    updateOpenCachedStats({ targetId, metadata, canvasCoordinates, cachedStats, modalityUnit, calibratedScale, }) {\n        const { scale, units } = calibratedScale;\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            length: calculatePerimeter(canvasCoordinates, false) / scale,\n            modalityUnit,\n            getPixelValueUnitunit: units,\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, length, perimeter, max, isEmptyArea, unit, areaUnit, modalityUnit, } = cachedVolumeStats || {};\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (Number.isFinite(max)) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    if (perimeter) {\n        textLines.push(`Perimeter: ${csUtils.roundNumber(perimeter)} ${unit}`);\n    }\n    if (length) {\n        textLines.push(`${csUtils.roundNumber(length)} ${unit}`);\n    }\n    return textLines;\n}\nPlanarFreehandROITool.toolName = 'PlanarFreehandROI';\nexport default PlanarFreehandROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawRectByCoordinates as drawRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { viewPlaneNormal, viewUp } = viewport.getCamera();\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const area = Math.abs(worldWidth * worldHeight) / (scale * scale);\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        stdDev: stats.stdDev?.value,\n                        max: stats.max?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        areaUnit,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROITool.toolName = 'RectangleROI';\nexport default RectangleROITool;\n","import { utilities, getEnabledElement, StackViewport, cache, VideoViewport, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport BaseTool from './BaseTool';\nimport { getAnnotationManager } from '../../stateManagement/annotation/annotationState';\nimport triggerAnnotationRender from '../../utilities/triggerAnnotationRender';\nimport filterAnnotationsForDisplay from '../../utilities/planar/filterAnnotationsForDisplay';\nimport { getStyleProperty } from '../../stateManagement/annotation/config/helpers';\nimport { getState } from '../../stateManagement/annotation/config';\nclass AnnotationDisplayTool extends BaseTool {\n    constructor() {\n        super(...arguments);\n        this.onImageSpacingCalibrated = (evt) => {\n            const { element, imageId } = evt.detail;\n            const imageURI = utilities.imageIdToURI(imageId);\n            const annotationManager = getAnnotationManager();\n            const framesOfReference = annotationManager.getFramesOfReference();\n            framesOfReference.forEach((frameOfReference) => {\n                const frameOfReferenceSpecificAnnotations = annotationManager.getAnnotations(frameOfReference);\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[this.getToolName()];\n                if (!toolSpecificAnnotations || !toolSpecificAnnotations.length) {\n                    return;\n                }\n                toolSpecificAnnotations.forEach((annotation) => {\n                    if (!annotation.metadata?.referencedImageId) {\n                        return;\n                    }\n                    const referencedImageURI = utilities.imageIdToURI(annotation.metadata.referencedImageId);\n                    if (referencedImageURI === imageURI) {\n                        annotation.invalidated = true;\n                        annotation.data.cachedStats = {};\n                    }\n                });\n                triggerAnnotationRender(element);\n            });\n        };\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        return filterAnnotationsForDisplay(viewport, annotations);\n    }\n    getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId = targetId.split(/^[a-zA-Z]+:/)[1];\n        if (viewport instanceof BaseVolumeViewport) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const imageVolume = cache.getVolume(volumeId);\n            referencedImageId = utilities.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n        }\n        return referencedImageId;\n    }\n    getStyle(property, specifications, annotation) {\n        return getStyleProperty(property, specifications, getState(annotation), this.mode);\n    }\n}\nAnnotationDisplayTool.toolName = 'AnnotationDisplayTool';\nexport default AnnotationDisplayTool;\n","import { utilities, BaseVolumeViewport } from '@cornerstonejs/core';\nimport ToolModes from '../../enums/ToolModes';\nclass BaseTool {\n    constructor(toolProps, defaultToolProps) {\n        const initialProps = utilities.deepMerge(defaultToolProps, toolProps);\n        const { configuration = {}, supportedInteractionTypes, toolGroupId, } = initialProps;\n        if (!configuration.strategies) {\n            configuration.strategies = {};\n            configuration.defaultStrategy = undefined;\n            configuration.activeStrategy = undefined;\n            configuration.strategyOptions = {};\n        }\n        this.toolGroupId = toolGroupId;\n        this.supportedInteractionTypes = supportedInteractionTypes || [];\n        this.configuration = Object.assign({}, configuration);\n        this.mode = ToolModes.Disabled;\n    }\n    getToolName() {\n        return this.constructor.toolName;\n    }\n    applyActiveStrategy(enabledElement, operationData) {\n        const { strategies, activeStrategy } = this.configuration;\n        return strategies[activeStrategy]?.call(this, enabledElement, operationData);\n    }\n    applyActiveStrategyCallback(enabledElement, operationData, callbackType) {\n        const { strategies, activeStrategy } = this.configuration;\n        if (!strategies[activeStrategy]) {\n            throw new Error(`applyActiveStrategyCallback: active strategy ${activeStrategy} not found, check tool configuration or spellings`);\n        }\n        return strategies[activeStrategy][callbackType]?.call(this, enabledElement, operationData);\n    }\n    setConfiguration(newConfiguration) {\n        this.configuration = utilities.deepMerge(this.configuration, newConfiguration);\n    }\n    setActiveStrategy(strategyName) {\n        this.setConfiguration({ activeStrategy: strategyName });\n    }\n    getTargetImageData(targetId) {\n        if (targetId.startsWith('imageId:')) {\n            const imageId = targetId.split('imageId:')[1];\n            const imageURI = utilities.imageIdToURI(imageId);\n            let viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            viewports = viewports.filter((viewport) => {\n                return viewport.getCurrentImageId() === imageId;\n            });\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('volumeId:')) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const viewports = utilities.getViewportsWithVolumeId(volumeId);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('videoId:')) {\n            const imageURI = utilities.imageIdToURI(targetId);\n            const viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else {\n            throw new Error('getTargetIdImage: targetId must start with \"imageId:\" or \"volumeId:\"');\n        }\n    }\n    getTargetId(viewport) {\n        const targetId = viewport.getViewReferenceId?.();\n        if (targetId) {\n            return targetId;\n        }\n        throw new Error('getTargetId: viewport must have a getViewReferenceId method');\n    }\n}\nBaseTool.toolName = 'BaseTool';\nexport default BaseTool;\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport { handleContourSegmentation } from './contourHandler/handleContourSegmentation';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddContourRepresentation } from '../../../stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation';\nimport removeContourFromElement from './removeContourFromElement';\nlet polySegConversionInProgress = false;\nconst processedViewportSegmentations = new Map();\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    if (!renderImmediate) {\n        return;\n    }\n    removeContourFromElement(viewportId, segmentationId);\n    viewport.render();\n}\nasync function render(viewport, contourRepresentation) {\n    const { segmentationId } = contourRepresentation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let contourData = segmentation.representationData[Representations.Contour];\n    if (!contourData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Contour) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        contourData = await computeAndAddContourRepresentation(segmentationId, {\n            viewport,\n        });\n        polySegConversionInProgress = false;\n    }\n    if (!contourData) {\n        return;\n    }\n    if (!contourData.geometryIds?.length) {\n        return;\n    }\n    handleContourSegmentation(viewport, contourData.geometryIds, contourData.annotationUIDsMap, contourRepresentation);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\n","import { getEnabledElementByViewportId, VolumeViewport, } from '@cornerstonejs/core';\nimport addLabelmapToElement from './addLabelmapToElement';\nimport removeLabelmapFromElement from './removeLabelmapFromElement';\nimport { getActiveSegmentation } from '../../../stateManagement/segmentation/activeSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { getCurrentLabelmapImageIdForViewport } from '../../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddLabelmapRepresentation } from '../../../stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation';\nimport { segmentationStyle } from '../../../stateManagement/segmentation/SegmentationStyle';\nimport SegmentationRepresentations from '../../../enums/SegmentationRepresentations';\nimport { internalGetHiddenSegmentIndices } from '../../../stateManagement/segmentation/helpers/internalGetHiddenSegmentIndices';\nimport { getActiveSegmentIndex } from '../../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst MAX_NUMBER_COLORS = 255;\nconst labelMapConfigCache = new Map();\nlet polySegConversionInProgress = false;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    labelMapConfigCache.forEach((value, key) => {\n        if (key.includes(segmentationId)) {\n            labelMapConfigCache.delete(key);\n        }\n    });\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeLabelmapFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        console.warn('No segmentation found for segmentationId: ', segmentationId);\n        return;\n    }\n    let labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    let labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    if (!labelmapData &&\n        canComputeRequestedRepresentation(segmentationId, SegmentationRepresentations.Labelmap) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        labelmapData = await computeAndAddLabelmapRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!labelmapData) {\n            throw new Error(`No labelmap data found for segmentationId ${segmentationId}.`);\n        }\n        polySegConversionInProgress = false;\n    }\n    if (!labelmapData) {\n        return;\n    }\n    if (viewport instanceof VolumeViewport) {\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    else {\n        const labelmapImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n        if (!labelmapImageId) {\n            return;\n        }\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    if (!labelmapActorEntry) {\n        return;\n    }\n    _setLabelmapColorAndOpacity(viewport.id, labelmapActorEntry, representation);\n}\nfunction _setLabelmapColorAndOpacity(viewportId, labelmapActorEntry, segmentationRepresentation) {\n    const { segmentationId } = segmentationRepresentation;\n    const { cfun, ofun } = segmentationRepresentation.config;\n    const { colorLUTIndex } = segmentationRepresentation;\n    const activeSegmentation = getActiveSegmentation(viewportId);\n    const isActiveLabelmap = activeSegmentation?.segmentationId === segmentationId;\n    const labelmapStyle = segmentationStyle.getStyle({\n        viewportId,\n        type: SegmentationRepresentations.Labelmap,\n        segmentationId,\n    });\n    const renderInactiveSegmentations = segmentationStyle.getRenderInactiveSegmentations(viewportId);\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const numColors = Math.min(256, colorLUT.length);\n    const { outlineWidth, renderOutline, outlineOpacity, activeSegmentOutlineWidthDelta, } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap);\n    const segmentsHidden = internalGetHiddenSegmentIndices(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    });\n    for (let i = 0; i < numColors; i++) {\n        const segmentIndex = i;\n        const segmentColor = colorLUT[segmentIndex];\n        const perSegmentStyle = segmentationStyle.getStyle({\n            viewportId,\n            type: SegmentationRepresentations.Labelmap,\n            segmentationId,\n            segmentIndex,\n        });\n        const segmentSpecificLabelmapConfig = perSegmentStyle;\n        const { fillAlpha, outlineWidth, renderFill, renderOutline } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap, segmentSpecificLabelmapConfig);\n        const { forceOpacityUpdate, forceColorUpdate } = _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            segmentColor,\n            outlineWidth,\n            segmentsHidden: segmentsHidden,\n            cfun,\n            ofun,\n        });\n        if (forceColorUpdate) {\n            cfun.addRGBPoint(segmentIndex, segmentColor[0] / MAX_NUMBER_COLORS, segmentColor[1] / MAX_NUMBER_COLORS, segmentColor[2] / MAX_NUMBER_COLORS);\n        }\n        if (forceOpacityUpdate) {\n            if (renderFill) {\n                const segmentOpacity = segmentsHidden.has(segmentIndex)\n                    ? 0\n                    : (segmentColor[3] / 255) * fillAlpha;\n                ofun.removePoint(segmentIndex);\n                ofun.addPointLong(segmentIndex, segmentOpacity, 0.5, 1.0);\n            }\n            else {\n                ofun.addPointLong(segmentIndex, 0.01, 0.5, 1.0);\n            }\n        }\n    }\n    const labelmapActor = labelmapActorEntry.actor;\n    labelmapActor.getProperty().setRGBTransferFunction(0, cfun);\n    ofun.setClamping(false);\n    labelmapActor.getProperty().setScalarOpacity(0, ofun);\n    labelmapActor.getProperty().setInterpolationTypeToNearest();\n    if (renderOutline) {\n        labelmapActor.getProperty().setUseLabelOutline(renderOutline);\n        labelmapActor.getProperty().setLabelOutlineOpacity(outlineOpacity);\n        const activeSegmentIndex = getActiveSegmentIndex(segmentationRepresentation.segmentationId);\n        const outlineWidths = new Array(numColors - 1);\n        for (let i = 1; i < numColors; i++) {\n            const isHidden = segmentsHidden.has(i);\n            if (isHidden) {\n                outlineWidths[i - 1] = 0;\n                continue;\n            }\n            outlineWidths[i - 1] =\n                i === activeSegmentIndex\n                    ? outlineWidth + activeSegmentOutlineWidthDelta\n                    : outlineWidth;\n        }\n        labelmapActor.getProperty().setLabelOutlineThickness(outlineWidths);\n    }\n    else {\n        labelmapActor\n            .getProperty()\n            .setLabelOutlineThickness(new Array(numColors - 1).fill(0));\n    }\n    const visible = isActiveLabelmap || renderInactiveSegmentations;\n    labelmapActor.setVisibility(visible);\n}\nfunction _getLabelmapConfig(labelmapConfig, isActiveLabelmap, segmentsLabelmapConfig) {\n    const segmentLabelmapConfig = segmentsLabelmapConfig || {};\n    const configToUse = {\n        ...labelmapConfig,\n        ...segmentLabelmapConfig,\n    };\n    const fillAlpha = isActiveLabelmap\n        ? configToUse.fillAlpha\n        : configToUse.fillAlphaInactive;\n    const outlineWidth = isActiveLabelmap\n        ? configToUse.outlineWidth\n        : configToUse.outlineWidthInactive;\n    const renderFill = isActiveLabelmap\n        ? configToUse.renderFill\n        : configToUse.renderFillInactive;\n    const renderOutline = isActiveLabelmap\n        ? configToUse.renderOutline\n        : configToUse.renderOutlineInactive;\n    const outlineOpacity = isActiveLabelmap\n        ? configToUse.outlineOpacity\n        : configToUse.outlineOpacityInactive;\n    const activeSegmentOutlineWidthDelta = configToUse.activeSegmentOutlineWidthDelta;\n    return {\n        fillAlpha,\n        outlineWidth,\n        renderFill,\n        renderOutline,\n        outlineOpacity,\n        activeSegmentOutlineWidthDelta,\n    };\n}\nfunction _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, { fillAlpha, renderFill, renderOutline, segmentColor, outlineWidth, segmentsHidden, cfun, ofun, }) {\n    const cacheUID = `${viewportId}-${segmentationId}-${segmentIndex}`;\n    const oldConfig = labelMapConfigCache.get(cacheUID);\n    if (!oldConfig) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n        return {\n            forceOpacityUpdate: true,\n            forceColorUpdate: true,\n        };\n    }\n    const { fillAlpha: oldFillAlpha, renderFill: oldRenderFill, renderOutline: oldRenderOutline, outlineWidth: oldOutlineWidth, segmentColor: oldSegmentColor, segmentsHidden: oldSegmentsHidden, cfunMTime: oldCfunMTime, ofunMTime: oldOfunMTime, } = oldConfig;\n    const forceColorUpdate = oldSegmentColor[0] !== segmentColor[0] ||\n        oldSegmentColor[1] !== segmentColor[1] ||\n        oldSegmentColor[2] !== segmentColor[2];\n    const forceOpacityUpdate = oldSegmentColor[3] !== segmentColor[3] ||\n        oldFillAlpha !== fillAlpha ||\n        oldRenderFill !== renderFill ||\n        oldRenderOutline !== renderOutline ||\n        oldOutlineWidth !== outlineWidth ||\n        oldSegmentsHidden !== segmentsHidden;\n    if (forceOpacityUpdate || forceColorUpdate) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n    }\n    return {\n        forceOpacityUpdate,\n        forceColorUpdate,\n    };\n}\nasync function _addLabelmapToViewport(viewport, labelmapData, segmentationId) {\n    await addLabelmapToElement(viewport.element, labelmapData, segmentationId);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { cache, getEnabledElementByViewportId, Enums, } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport removeSurfaceFromElement from './removeSurfaceFromElement';\nimport addOrUpdateSurfaceToElement from './addOrUpdateSurfaceToElement';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddSurfaceRepresentation } from '../../../stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation';\nconst { ViewportType } = Enums;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeSurfaceFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let SurfaceData = segmentation.representationData[Representations.Surface];\n    if (!SurfaceData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Surface)) {\n        SurfaceData = await computeAndAddSurfaceRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!SurfaceData) {\n            throw new Error(`No Surface data found for segmentationId ${segmentationId}.`);\n        }\n    }\n    const { geometryIds } = SurfaceData;\n    if (!geometryIds?.size) {\n        console.warn(`No Surfaces found for segmentationId ${segmentationId}. Skipping render.`);\n    }\n    const { colorLUTIndex } = representation;\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const surfaces = [];\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry?.data) {\n            console.warn(`No Surfaces found for geometryId ${geometryId}. Skipping render.`);\n            return;\n        }\n        const segmentIndex = geometry.data.segmentIndex;\n        const surface = geometry.data;\n        const color = colorLUT[segmentIndex];\n        surface.color = color.slice(0, 3);\n        surfaces.push(surface);\n        addOrUpdateSurfaceToElement(viewport.element, surface, segmentationId);\n    });\n    viewport.render();\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { utilities as csUtils, cache, getEnabledElement, StackViewport, eventTarget, Enums, BaseVolumeViewport, volumeLoader, } from '@cornerstonejs/core';\nimport { vec3, vec2 } from 'gl-matrix';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere, thresholdInsideSphere, } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { thresholdInsideCircle, fillInsideCircle, } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events, ToolModes, SegmentationRepresentations, StrategyCallbacks, } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nimport { getLockedSegmentIndices } from '../../stateManagement/segmentation/segmentLocking';\nimport { getActiveSegmentIndex } from '../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getSegmentIndexColor } from '../../stateManagement/segmentation/config/segmentationColor';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/getActiveSegmentation';\nclass BrushTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE_CIRCLE: fillInsideCircle,\n                ERASE_INSIDE_CIRCLE: eraseInsideCircle,\n                FILL_INSIDE_SPHERE: fillInsideSphere,\n                ERASE_INSIDE_SPHERE: eraseInsideSphere,\n                THRESHOLD_INSIDE_CIRCLE: thresholdInsideCircle,\n                THRESHOLD_INSIDE_SPHERE: thresholdInsideSphere,\n            },\n            strategySpecificConfiguration: {\n                THRESHOLD: {\n                    threshold: [-150, -70],\n                },\n            },\n            defaultStrategy: 'FILL_INSIDE_CIRCLE',\n            activeStrategy: 'FILL_INSIDE_CIRCLE',\n            thresholdVolumeId: null,\n            brushSize: 25,\n            preview: {\n                enabled: false,\n                previewColors: {},\n                previewTimeMs: 250,\n                previewMoveDistance: 8,\n                dragMoveDistance: 4,\n                dragTimeMs: 500,\n            },\n            actions: {\n                [StrategyCallbacks.AcceptPreview]: {\n                    method: StrategyCallbacks.AcceptPreview,\n                    bindings: [\n                        {\n                            key: 'Enter',\n                        },\n                    ],\n                },\n                [StrategyCallbacks.RejectPreview]: {\n                    method: StrategyCallbacks.RejectPreview,\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._previewData = {\n            preview: null,\n            element: null,\n            timerStart: 0,\n            timer: null,\n            startPoint: [NaN, NaN],\n            isDrag: false,\n        };\n        this.onSetToolPassive = (evt) => {\n            this.disableCursor();\n        };\n        this.onSetToolEnabled = () => {\n            this.disableCursor();\n        };\n        this.onSetToolDisabled = (evt) => {\n            this.disableCursor();\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this._editData = this.createEditData(element);\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            this._previewData.isDrag = false;\n            this._previewData.timerStart = Date.now();\n            const hoverData = this._hoverData || this.createHoverData(element);\n            triggerAnnotationRenderForViewportUIDs(hoverData.viewportIdsToRender);\n            const operationData = this.getOperationData(element);\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionStart);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.updateCursor(evt);\n                if (!this.configuration.preview.enabled) {\n                    return;\n                }\n                const { previewTimeMs, previewMoveDistance, dragMoveDistance } = this.configuration.preview;\n                const { currentPoints, element } = evt.detail;\n                const { canvas } = currentPoints;\n                const { preview, startPoint, timer, timerStart, isDrag } = this._previewData;\n                const delta = vec2.distance(canvas, startPoint);\n                const time = Date.now() - timerStart;\n                if (delta > previewMoveDistance ||\n                    (time > previewTimeMs && delta > dragMoveDistance)) {\n                    if (timer) {\n                        window.clearTimeout(timer);\n                        this._previewData.timer = null;\n                    }\n                    if (preview && !isDrag) {\n                        this.rejectPreview(element);\n                    }\n                }\n                if (!this._previewData.timer) {\n                    const timer = window.setTimeout(this.previewCallback, 250);\n                    Object.assign(this._previewData, {\n                        timerStart: Date.now(),\n                        timer,\n                        startPoint: canvas,\n                        element,\n                    });\n                }\n            }\n        };\n        this.previewCallback = () => {\n            this._previewData.timer = null;\n            if (this._previewData.preview) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategyCallback(getEnabledElement(this._previewData.element), this.getOperationData(this._previewData.element), StrategyCallbacks.Preview);\n        };\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this.updateCursor(evt);\n            const { viewportIdsToRender } = this._hoverData;\n            triggerAnnotationRenderForViewportUIDs(viewportIdsToRender);\n            const delta = vec2.distance(currentPoints.canvas, this._previewData.startPoint);\n            const { dragTimeMs, dragMoveDistance } = this.configuration.preview;\n            if (!this._previewData.isDrag &&\n                this._previewData.preview &&\n                Date.now() - this._previewData.timerStart < dragTimeMs &&\n                delta < dragMoveDistance) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategy(enabledElement, this.getOperationData(element));\n            this._previewData.element = element;\n            this._previewData.timerStart = Date.now() + dragTimeMs;\n            this._previewData.isDrag = true;\n            this._previewData.startPoint = currentPoints.canvas;\n        };\n        this._endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const operationData = this.getOperationData(element);\n            if (!this._previewData.preview && !this._previewData.isDrag) {\n                this.applyActiveStrategy(enabledElement, operationData);\n            }\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.updateCursor(evt);\n            this._editData = null;\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionEnd);\n            if (!this._previewData.isDrag) {\n                this.acceptPreview(element);\n            }\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    disableCursor() {\n        this._hoverData = undefined;\n        this.rejectPreview();\n    }\n    createEditData(element) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                detail: {\n                    type: 'Segmentation',\n                    message: 'No active segmentation detected, create a segmentation representation before using the brush tool',\n                },\n                cancelable: true,\n            });\n            eventTarget.dispatchEvent(event);\n            return null;\n        }\n        const { segmentationId } = activeSegmentation;\n        const segmentsLocked = getLockedSegmentIndices(segmentationId);\n        const { representationData } = getSegmentation(segmentationId);\n        if (viewport instanceof BaseVolumeViewport) {\n            const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n            const actors = viewport.getActors();\n            const isStackViewport = viewport instanceof StackViewport;\n            if (isStackViewport) {\n                const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                    detail: {\n                        type: 'Segmentation',\n                        message: 'Cannot perform brush operation on the selected viewport',\n                    },\n                    cancelable: true,\n                });\n                eventTarget.dispatchEvent(event);\n                return null;\n            }\n            const volumes = actors.map((actorEntry) => cache.getVolume(actorEntry.referencedId));\n            const segmentationVolume = cache.getVolume(volumeId);\n            const referencedVolumeIdToThreshold = volumes.find((volume) => csUtils.isEqual(volume.dimensions, segmentationVolume.dimensions))?.volumeId || volumes[0]?.volumeId;\n            return {\n                volumeId,\n                referencedVolumeId: this.configuration.thresholdVolumeId ?? referencedVolumeIdToThreshold,\n                segmentsLocked,\n            };\n        }\n        else {\n            const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n            if (!segmentationImageId) {\n                return;\n            }\n            if (this.configuration.activeStrategy.includes('SPHERE')) {\n                const referencedImageIds = viewport.getImageIds();\n                const isValidVolumeForSphere = csUtils.isValidVolume(referencedImageIds);\n                if (!isValidVolumeForSphere) {\n                    throw new Error('Volume is not reconstructable for sphere manipulation');\n                }\n                const volumeId = `${segmentationId}_${viewport.id}`;\n                const volume = cache.getVolume(volumeId);\n                if (volume) {\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n                else {\n                    const labelmapImageIds = getStackSegmentationImageIdsForViewport(viewport.id, segmentationId);\n                    if (!labelmapImageIds || labelmapImageIds.length === 1) {\n                        return {\n                            imageId: segmentationImageId,\n                            segmentsLocked,\n                        };\n                    }\n                    const volume = volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, labelmapImageIds);\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n            }\n            else {\n                return {\n                    imageId: segmentationImageId,\n                    segmentsLocked,\n                };\n            }\n        }\n    }\n    createHoverData(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const viewportIdsToRender = [viewport.id];\n        const { segmentIndex, segmentationId, segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        const brushCursor = {\n            metadata: {\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                referencedImageId: '',\n                toolName: this.getToolName(),\n                segmentColor,\n            },\n            data: {},\n        };\n        return {\n            brushCursor,\n            centerCanvas,\n            segmentIndex,\n            viewport,\n            segmentationId,\n            segmentColor,\n            viewportIdsToRender,\n        };\n    }\n    getActiveSegmentationData(viewport) {\n        const viewportId = viewport.id;\n        const activeRepresentation = getActiveSegmentation(viewportId);\n        if (!activeRepresentation) {\n            return;\n        }\n        const { segmentationId } = activeRepresentation;\n        const segmentIndex = getActiveSegmentIndex(segmentationId);\n        if (!segmentIndex) {\n            return;\n        }\n        const segmentColor = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n        return {\n            segmentIndex,\n            segmentationId,\n            segmentColor,\n        };\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const { element } = eventData;\n        const { currentPoints } = eventData;\n        const centerCanvas = currentPoints.canvas;\n        this._hoverData = this.createHoverData(element, centerCanvas);\n        this._calculateCursor(element, centerCanvas);\n        if (!this._hoverData) {\n            return;\n        }\n        triggerAnnotationRenderForViewportUIDs(this._hoverData.viewportIdsToRender);\n    }\n    getOperationData(element) {\n        const editData = this._editData || this.createEditData(element);\n        const { segmentIndex, segmentationId, brushCursor } = this._hoverData || this.createHoverData(element);\n        const { data, metadata = {} } = brushCursor || {};\n        const { viewPlaneNormal, viewUp } = metadata;\n        const operationData = {\n            ...editData,\n            points: data?.handles?.points,\n            segmentIndex,\n            previewColors: this.configuration.preview.enabled\n                ? this.configuration.preview.previewColors\n                : null,\n            viewPlaneNormal,\n            toolGroupId: this.toolGroupId,\n            segmentationId,\n            viewUp,\n            strategySpecificConfiguration: this.configuration.strategySpecificConfiguration,\n            preview: this._previewData?.preview,\n        };\n        return operationData;\n    }\n    _calculateCursor(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvasToWorld } = viewport;\n        const camera = viewport.getCamera();\n        const { brushSize } = this.configuration;\n        const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n        const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n        const viewRight = vec3.create();\n        vec3.cross(viewRight, viewUp, viewPlaneNormal);\n        const centerCursorInWorld = canvasToWorld([\n            centerCanvas[0],\n            centerCanvas[1],\n        ]);\n        const bottomCursorInWorld = vec3.create();\n        const topCursorInWorld = vec3.create();\n        const leftCursorInWorld = vec3.create();\n        const rightCursorInWorld = vec3.create();\n        for (let i = 0; i <= 2; i++) {\n            bottomCursorInWorld[i] = centerCursorInWorld[i] - viewUp[i] * brushSize;\n            topCursorInWorld[i] = centerCursorInWorld[i] + viewUp[i] * brushSize;\n            leftCursorInWorld[i] = centerCursorInWorld[i] - viewRight[i] * brushSize;\n            rightCursorInWorld[i] = centerCursorInWorld[i] + viewRight[i] * brushSize;\n        }\n        if (!this._hoverData) {\n            return;\n        }\n        const { brushCursor } = this._hoverData;\n        const { data } = brushCursor;\n        if (data.handles === undefined) {\n            data.handles = {};\n        }\n        data.handles.points = [\n            bottomCursorInWorld,\n            topCursorInWorld,\n            leftCursorInWorld,\n            rightCursorInWorld,\n        ];\n        const activeStrategy = this.configuration.activeStrategy;\n        const strategy = this.configuration.strategies[activeStrategy];\n        if (typeof strategy.computeInnerCircleRadius === 'function') {\n            strategy.computeInnerCircleRadius({\n                configuration: this.configuration,\n                viewport,\n            });\n        }\n        data.invalidated = false;\n    }\n    rejectPreview(element = this._previewData.element) {\n        if (!element || !this._previewData.preview) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.RejectPreview);\n        this._previewData.preview = null;\n        this._previewData.isDrag = false;\n    }\n    acceptPreview(element = this._previewData.element) {\n        if (!element) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.AcceptPreview);\n        this._previewData.isDrag = false;\n        this._previewData.preview = null;\n    }\n    invalidateBrushCursor() {\n        if (this._hoverData === undefined) {\n            return;\n        }\n        const { data } = this._hoverData.brushCursor;\n        const { viewport } = this._hoverData;\n        data.invalidated = true;\n        const { segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        this._hoverData.brushCursor.metadata.segmentColor = segmentColor;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this._hoverData) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const viewportIdsToRender = this._hoverData.viewportIdsToRender;\n        if (!viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const brushCursor = this._hoverData.brushCursor;\n        if (brushCursor.data.invalidated === true) {\n            const { centerCanvas } = this._hoverData;\n            const { element } = viewport;\n            this._calculateCursor(element, centerCanvas);\n        }\n        const toolMetadata = brushCursor.metadata;\n        if (!toolMetadata) {\n            return;\n        }\n        const annotationUID = toolMetadata.brushCursorUID;\n        const data = brushCursor.data;\n        const { points } = data.handles;\n        const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n        const bottom = canvasCoordinates[0];\n        const top = canvasCoordinates[1];\n        const center = [\n            Math.floor((bottom[0] + top[0]) / 2),\n            Math.floor((bottom[1] + top[1]) / 2),\n        ];\n        const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n        const color = `rgb(${toolMetadata.segmentColor?.slice(0, 3) || [0, 0, 0]})`;\n        if (!viewport.getRenderingEngine()) {\n            console.warn('Rendering Engine has been destroyed');\n            return;\n        }\n        const circleUID = '0';\n        drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n            color,\n        });\n        const activeStrategy = this.configuration.activeStrategy;\n        const { dynamicRadiusInCanvas } = this.configuration\n            .strategySpecificConfiguration[activeStrategy] || {\n            dynamicRadiusInCanvas: 0,\n        };\n        if (dynamicRadiusInCanvas) {\n            const circleUID1 = '1';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID1, center, dynamicRadiusInCanvas, {\n                color,\n            });\n        }\n    }\n}\nBrushTool.toolName = 'Brush';\nexport default BrushTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport throttle from '../../utilities/throttle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROIStartEndThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            computePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                    spacingInNormal,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        projectionPointsImageIds: [referencedImageId],\n                        statistics: [],\n                    },\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let startCoord = startCoordinate;\n                let endCoord = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    startCoord = this._getCoordinateForViewplaneNormal(startCoord, viewplaneNormal);\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    endCoord = this._getCoordinateForViewplaneNormal(endCoord, viewplaneNormal);\n                    data.endCoordinate = endCoord;\n                    data.endCoordinate = endCoord;\n                }\n                const roundedStartCoord = csUtils.roundToPrecision(startCoord);\n                const roundedEndCoord = csUtils.roundToPrecision(endCoord);\n                const coord = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCoord = csUtils.roundToPrecision(coord);\n                if (roundedCoord < Math.min(roundedStartCoord, roundedEndCoord) ||\n                    roundedCoord > Math.max(roundedStartCoord, roundedEndCoord)) {\n                    continue;\n                }\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                let firstOrLastSlice = false;\n                if (roundedCoord === roundedStartCoord ||\n                    roundedCoord === roundedEndCoord) {\n                    firstOrLastSlice = true;\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    firstOrLastSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineDashToUse = lineDash;\n                if (!firstOrLastSlice) {\n                    lineDashToUse = 2;\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth,\n                });\n                renderStatus = true;\n                if (this.configuration.showTextBox &&\n                    this.configuration.calculatePointsInsideVolume) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    if (!data.handles.textBox.hasMoved) {\n                        const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(points.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[3];\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.habdles);\n        const area = Math.abs(worldWidth * worldHeight) /\n            (measureInfo.scale * measureInfo.scale);\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const projectionPoint = projectionPoints[i][0];\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, projectionPoint);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                this.isHandleOutsideImage = false;\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, viewPlaneNormal) {\n        const startPos = worldPos;\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagate * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROIStartEndThresholdTool.toolName = 'RectangleROIStartEndThreshold';\nexport default RectangleROIStartEndThresholdTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nclass RectangleROIThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const targetId = this.getTargetId(viewport);\n            let referencedImageId, volumeId;\n            if (viewport instanceof StackViewport) {\n                referencedImageId = targetId.split('imageId:')[1];\n            }\n            else {\n                volumeId = csUtils.getVolumeId(targetId);\n                const imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: null,\n                            worldBoundingBox: null,\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    segmentationId: null,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                triggerAnnotationModified(annotation, element);\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n}\nRectangleROIThresholdTool.toolName = 'RectangleROIThreshold';\nexport default RectangleROIThresholdTool;\n","export var ContourWindingDirection;\n(function (ContourWindingDirection) {\n    ContourWindingDirection[ContourWindingDirection[\"CounterClockwise\"] = -1] = \"CounterClockwise\";\n    ContourWindingDirection[ContourWindingDirection[\"Unknown\"] = 0] = \"Unknown\";\n    ContourWindingDirection[ContourWindingDirection[\"Clockwise\"] = 1] = \"Clockwise\";\n})(ContourWindingDirection || (ContourWindingDirection = {}));\n","import { getEnabledElements, utilities as csUtils } from '@cornerstonejs/core';\nconst { isEqual } = csUtils;\nexport default function getViewportsForAnnotation(annotation) {\n    const { metadata } = annotation;\n    return getEnabledElements()\n        .filter((enabledElement) => {\n        if (enabledElement.FrameOfReferenceUID === metadata.FrameOfReferenceUID) {\n            const viewport = enabledElement.viewport;\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            return (isEqual(viewPlaneNormal, metadata.viewPlaneNormal) &&\n                (!metadata.viewUp || isEqual(viewUp, metadata.viewUp)));\n        }\n        return;\n    })\n        .map((enabledElement) => enabledElement.viewport);\n}\n","import { utilities, triggerEvent } from '@cornerstonejs/core';\nimport { getAnnotationNearPoint, getAnnotationNearPointOnEnabledElement, } from './getAnnotationNearPoint';\nimport debounce from './debounce';\nimport throttle from './throttle';\nimport isObject from './isObject';\nimport calibrateImageSpacing from './calibrateImageSpacing';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, } from './getCalibratedUnits';\nimport triggerAnnotationRenderForViewportIds from './triggerAnnotationRenderForViewportIds';\nimport triggerAnnotationRenderForToolGroupIds from './triggerAnnotationRenderForToolGroupIds';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nimport { getSphereBoundsInfo } from './getSphereBoundsInfo';\nimport { pointToString } from './pointToString';\nimport annotationFrameRange from './annotationFrameRange';\nimport getViewportForAnnotation from './getViewportForAnnotation';\nimport { annotationHydration, getClosestImageIdForStackViewport, } from './annotationHydration';\nimport * as contours from './contours';\nimport * as segmentation from './segmentation';\nimport * as drawing from './drawing';\nimport * as math from './math';\nimport * as planar from './planar';\nimport * as viewportFilters from './viewportFilters';\nimport * as orientation from './orientation';\nimport * as cine from './cine';\nimport * as boundingBox from './boundingBox';\nimport * as planarFreehandROITool from './planarFreehandROITool';\nimport * as rectangleROITool from './rectangleROITool';\nimport { stackPrefetch, stackContextPrefetch } from './stackPrefetch';\nimport * as viewport from './viewport';\nimport * as touch from './touch';\nimport * as dynamicVolume from './dynamicVolume';\nimport * as polyDataUtils from './polyData/utils';\nimport * as voi from './voi';\nimport * as contourSegmentation from './contourSegmentation';\nimport { pointInSurroundingSphereCallback } from './pointInSurroundingSphereCallback';\nconst roundNumber = utilities.roundNumber;\nexport { math, planar, viewportFilters, drawing, debounce, dynamicVolume, throttle, orientation, isObject, touch, triggerEvent, calibrateImageSpacing, getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, segmentation, contours, triggerAnnotationRenderForViewportIds, triggerAnnotationRenderForToolGroupIds, triggerAnnotationRender, getSphereBoundsInfo, getAnnotationNearPoint, getViewportForAnnotation, getAnnotationNearPointOnEnabledElement, viewport, cine, boundingBox, rectangleROITool, planarFreehandROITool, stackPrefetch, stackContextPrefetch, roundNumber, pointToString, polyDataUtils, voi, annotationFrameRange, contourSegmentation, annotationHydration, getClosestImageIdForStackViewport, pointInSurroundingSphereCallback, };\n","export default function findClosestPoint(sourcePoints, targetPoint) {\n    let minPoint = [0, 0];\n    let minDistance = Number.MAX_SAFE_INTEGER;\n    sourcePoints.forEach(function (sourcePoint) {\n        const distance = _distanceBetween(targetPoint, sourcePoint);\n        if (distance < minDistance) {\n            minDistance = distance;\n            minPoint = [...sourcePoint];\n        }\n    });\n    return minPoint;\n}\nfunction _distanceBetween(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getCachedSegmentIndices, setCachedSegmentIndices } from './utilities';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nfunction getUniqueSegmentIndices(segmentationId) {\n    const cachedResult = getCachedSegmentIndices(segmentationId);\n    if (cachedResult) {\n        return cachedResult;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation found for segmentationId ${segmentationId}`);\n    }\n    let indices;\n    if (segmentation.representationData.Labelmap) {\n        indices = handleLabelmapSegmentation(segmentation, segmentationId);\n    }\n    else if (segmentation.representationData.Contour) {\n        indices = handleContourSegmentation(segmentation);\n    }\n    else if (segmentation.representationData.Surface) {\n        indices = handleSurfaceSegmentation(segmentation);\n    }\n    else {\n        throw new Error(`Unsupported segmentation type: ${segmentation.representationData}`);\n    }\n    setCachedSegmentIndices(segmentationId, indices);\n    return indices;\n}\nfunction handleLabelmapSegmentation(segmentation, segmentationId) {\n    const labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    const keySet = new Set();\n    if (labelmapData.imageIds) {\n        addImageSegmentIndices(keySet, labelmapData.imageIds);\n    }\n    else {\n        addVolumeSegmentIndices(keySet, segmentationId);\n    }\n    return Array.from(keySet)\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nfunction addVolumeSegmentIndices(keySet, segmentationId) {\n    const volume = cache.getVolume(segmentationId);\n    volume.voxelManager.forEach(({ value }) => {\n        if (value !== 0) {\n            keySet.add(value);\n        }\n    });\n}\nfunction addImageSegmentIndices(keySet, imageIds) {\n    imageIds.forEach((segmentationImageId) => {\n        const image = cache.getImage(segmentationImageId);\n        const scalarData = image.voxelManager.getScalarData();\n        scalarData.forEach((segmentIndex) => {\n            if (segmentIndex !== 0) {\n                keySet.add(segmentIndex);\n            }\n        });\n    });\n}\nfunction handleContourSegmentation(segmentation) {\n    const { annotationUIDsMap, geometryIds } = segmentation.representationData.Contour || {};\n    if (!geometryIds) {\n        throw new Error(`No geometryIds found for segmentationId ${segmentation.segmentationId}`);\n    }\n    const indices = new Set([...annotationUIDsMap.keys()]);\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        indices.add(geometry.data.segmentIndex);\n    });\n    return Array.from(indices).sort((a, b) => a - b);\n}\nfunction handleSurfaceSegmentation(segmentation) {\n    const geometryIds = segmentation.representationData.Surface?.geometryIds ?? [];\n    return Array.from(geometryIds.keys())\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nexport { getUniqueSegmentIndices };\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function invalidateBrushCursor(toolGroupId) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    brushBasedToolInstances.forEach((tool) => {\n        tool.invalidateBrushCursor();\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    const viewportsInfoArray = Object.keys(viewportsInfo).map((key) => viewportsInfo[key]);\n    if (!viewportsInfoArray.length) {\n        return;\n    }\n    const viewportIds = toolGroup.getViewportIds();\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nconst equalsCheck = (a, b) => {\n    return JSON.stringify(a) === JSON.stringify(b);\n};\nexport function getVoxelOverlap(imageData, dimensions, voxelSpacing, voxelCenter) {\n    const halfSpacingX = voxelSpacing[0] / 2;\n    const halfSpacingY = voxelSpacing[1] / 2;\n    const halfSpacingZ = voxelSpacing[2] / 2;\n    const voxelCornersIJK = new Array(8);\n    voxelCornersIJK[0] = csUtils.transformWorldToIndex(imageData, [\n        voxelCenter[0] - halfSpacingX,\n        voxelCenter[1] - halfSpacingY,\n        voxelCenter[2] - halfSpacingZ,\n    ]);\n    const offsets = [\n        [1, -1, -1],\n        [-1, 1, -1],\n        [1, 1, -1],\n        [-1, -1, 1],\n        [1, -1, 1],\n        [-1, 1, 1],\n        [1, 1, 1],\n    ];\n    for (let i = 0; i < 7; i++) {\n        const [xOff, yOff, zOff] = offsets[i];\n        voxelCornersIJK[i + 1] = csUtils.transformWorldToIndex(imageData, [\n            voxelCenter[0] + xOff * halfSpacingX,\n            voxelCenter[1] + yOff * halfSpacingY,\n            voxelCenter[2] + zOff * halfSpacingZ,\n        ]);\n    }\n    return getBoundingBoxAroundShapeIJK(voxelCornersIJK, dimensions);\n}\nexport function processVolumes(segmentationVolume, thresholdVolumeInformation) {\n    const { spacing: segmentationSpacing } = segmentationVolume;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    const volumeInfoList = [];\n    let baseVolumeIdx = 0;\n    for (let i = 0; i < thresholdVolumeInformation.length; i++) {\n        const { imageData, spacing, dimensions, voxelManager } = thresholdVolumeInformation[i].volume;\n        const volumeSize = thresholdVolumeInformation[i].volume.voxelManager.getScalarDataLength();\n        if (volumeSize === scalarDataLength &&\n            equalsCheck(spacing, segmentationSpacing)) {\n            baseVolumeIdx = i;\n        }\n        const lower = thresholdVolumeInformation[i].lower;\n        const upper = thresholdVolumeInformation[i].upper;\n        volumeInfoList.push({\n            imageData,\n            lower,\n            upper,\n            spacing,\n            dimensions,\n            volumeSize,\n            voxelManager,\n        });\n    }\n    return {\n        volumeInfoList,\n        baseVolumeIdx,\n    };\n}\nconst segmentIndicesCache = new Map();\nexport const setSegmentationDirty = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = true;\n    }\n};\nexport const setSegmentationClean = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = false;\n    }\n};\nexport const getCachedSegmentIndices = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached && !cached.isDirty) {\n        return cached.indices;\n    }\n    return null;\n};\nexport const setCachedSegmentIndices = (segmentationId, indices) => {\n    segmentIndicesCache.set(segmentationId, { indices, isDirty: false });\n};\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nexport function triggerAnnotationRenderForViewportIds(viewportIdsToRender) {\n    if (!viewportIdsToRender.length) {\n        return;\n    }\n    viewportIdsToRender.forEach((viewportId) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const { viewport } = enabledElement;\n        if (!viewport) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const element = viewport.element;\n        triggerAnnotationRender(element);\n    });\n}\nexport default triggerAnnotationRenderForViewportIds;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z' })\n  );\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z' })\n  );\n};","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\n/**\n * Converts a Uint8Array to a String.\n * @param {Uint8Array} array that should be converted\n * @param {Number} offset array offset in case only subset of array items should\n                   be extracted (default: 0)\n * @param {Number} limit maximum number of array items that should be extracted\n                   (defaults to length of array)\n * @returns {String}\n */\nfunction uint8ArrayToString(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var limit = arguments.length > 2 ? arguments[2] : undefined;\n  var itemLimit = limit || arr.length - offset;\n  var str = '';\n  for (var i = offset; i < offset + itemLimit; i++) {\n    str += String.fromCharCode(arr[i]);\n  }\n  return str;\n}\n\n/**\n * Converts a String to a Uint8Array.\n * @param {String} str string that should be converted\n * @returns {Uint8Array}\n */\nfunction stringToUint8Array(str) {\n  var arr = new Uint8Array(str.length);\n  for (var i = 0, j = str.length; i < j; i++) {\n    arr[i] = str.charCodeAt(i);\n  }\n  return arr;\n}\n\n/**\n * Identifies the boundary in a multipart/related message header.\n * @param {String} header message header\n * @returns {String} boundary\n */\nfunction identifyBoundary(header) {\n  var parts = header.split('\\r\\n');\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i].substr(0, 2) === '--') {\n      return parts[i];\n    }\n  }\n  return null;\n}\n\n/**\n * Checks whether a given token is contained by a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be present\n * @param {Number} offset offset in message content from where search should start\n * @returns {Boolean} whether message contains token at offset\n */\nfunction containsToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  if (offset + token.length > message.length) {\n    return false;\n  }\n  var index = offset;\n  for (var i = 0; i < token.length; i++) {\n    if (token[i] !== message[index]) {\n      return false;\n    }\n    index += 1;\n  }\n  return true;\n}\n\n/**\n * Finds a given token in a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be found\n * @param {String} offset message body offset from where search should start\n * @returns {Boolean} whether message has a part at given offset or not\n */\nfunction findToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var maxSearchLength = arguments.length > 3 ? arguments[3] : undefined;\n  var searchLength = message.length;\n  if (maxSearchLength) {\n    searchLength = Math.min(offset + maxSearchLength, message.length);\n  }\n  for (var i = offset; i < searchLength; i++) {\n    // If the first value of the message matches\n    // the first value of the token, check if\n    // this is the full token.\n    if (message[i] === token[0]) {\n      if (containsToken(message, token, i)) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Create a random GUID\n *\n * @return {string}\n */\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n  return \"\".concat(s4() + s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4()).concat(s4()).concat(s4());\n}\n\n/**\n * @typedef {Object} MultipartEncodedData\n * @property {ArrayBuffer} data The encoded Multipart Data\n * @property {String} boundary The boundary used to divide pieces of the encoded data\n */\n\n/**\n * Encode one or more DICOM datasets into a single body so it can be\n * sent using the Multipart Content-Type.\n *\n * @param {ArrayBuffer[]} datasets Array containing each file to be encoded in the\n                          multipart body, passed as ArrayBuffers.\n * @param {String} [boundary] Optional string to define a boundary between each part\n                              of the multipart body. If this is not specified, a random\n                              GUID will be generated.\n * @return {MultipartEncodedData} The Multipart encoded data returned as an Object. This\n                                  contains both the data itself, and the boundary string\n                                  used to divide it.\n */\nfunction multipartEncode(datasets) {\n  var boundary = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : guid();\n  var contentType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'application/dicom';\n  var contentTypeString = \"Content-Type: \".concat(contentType);\n  var header = \"\\r\\n--\".concat(boundary, \"\\r\\n\").concat(contentTypeString, \"\\r\\n\\r\\n\");\n  var footer = \"\\r\\n--\".concat(boundary, \"--\");\n  var headerArray = stringToUint8Array(header);\n  var footerArray = stringToUint8Array(footer);\n  var headerLength = headerArray.length;\n  var footerLength = footerArray.length;\n  var length = 0;\n\n  // Calculate the total length for the final array\n  var contentArrays = datasets.map(function (datasetBuffer) {\n    var contentArray = new Uint8Array(datasetBuffer);\n    var contentLength = contentArray.length;\n    length += headerLength + contentLength + footerLength;\n    return contentArray;\n  });\n\n  // Allocate the array\n  var multipartArray = new Uint8Array(length);\n\n  // Set the initial header\n  multipartArray.set(headerArray, 0);\n\n  // Write each dataset into the multipart array\n  var position = 0;\n  contentArrays.forEach(function (contentArray) {\n    multipartArray.set(headerArray, position);\n    multipartArray.set(contentArray, position + headerLength);\n    position += headerLength + contentArray.length;\n  });\n  multipartArray.set(footerArray, position);\n  return {\n    data: multipartArray.buffer,\n    boundary: boundary\n  };\n}\n\n/**\n * Decode a Multipart encoded ArrayBuffer and return the components as an Array.\n *\n * @param {ArrayBuffer} response Data encoded as a 'multipart/related' message\n * @returns {Array} The content\n */\nfunction multipartDecode(response) {\n  // Use the raw data if it is provided in an appropriate format\n  var message = ArrayBuffer.isView(response) ? response : new Uint8Array(response);\n\n  /* Set a maximum length to search for the header boundaries, otherwise\n       findToken can run for a long time\n    */\n  var maxSearchLength = 1000;\n\n  // First look for the multipart mime header\n  var separator = stringToUint8Array('\\r\\n\\r\\n');\n  var headerIndex = findToken(message, separator, 0, maxSearchLength);\n  if (headerIndex === -1) {\n    throw new Error('Response message has no multipart mime header');\n  }\n  var header = uint8ArrayToString(message, 0, headerIndex);\n  var boundaryString = identifyBoundary(header);\n  if (!boundaryString) {\n    throw new Error('Header of response message does not specify boundary');\n  }\n  var boundary = stringToUint8Array(boundaryString);\n  var boundaryLength = boundary.length;\n  var components = [];\n  var offset = boundaryLength;\n\n  // Loop until we cannot find any more boundaries\n  var boundaryIndex;\n  while (boundaryIndex !== -1) {\n    // Search for the next boundary in the message, starting\n    // from the current offset position\n    boundaryIndex = findToken(message, boundary, offset);\n\n    // If no further boundaries are found, stop here.\n    if (boundaryIndex === -1) {\n      break;\n    }\n    var headerTokenIndex = findToken(message, separator, offset, maxSearchLength);\n    if (headerTokenIndex === -1) {\n      throw new Error('Response message part has no mime header');\n    }\n    offset = headerTokenIndex + separator.length;\n\n    // Extract data from response message, excluding \"\\r\\n\"\n    var spacingLength = 2;\n    var data = response.slice(offset, boundaryIndex - spacingLength);\n\n    // Add the data to the array of results\n    components.push(data);\n\n    // Move the offset to the end of the current section,\n    // plus the identified boundary\n    offset = boundaryIndex + boundaryLength;\n  }\n  return components;\n}\n\nfunction isObject(obj) {\n  return _typeof(obj) === 'object' && obj !== null;\n}\nfunction isEmptyObject(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\nfunction areValidRequestHooks(requestHooks) {\n  var isValid = Array.isArray(requestHooks) && requestHooks.every(function (requestHook) {\n    return typeof requestHook === 'function' && requestHook.length === 2;\n  });\n  if (!isValid) {\n    console.warn('Request hooks should have the following signature: ' + 'function requestHook(request, metadata) { return request; }');\n  }\n  return isValid;\n}\nvar getFirstResult = function getFirstResult(result) {\n  return result[0];\n};\nvar MEDIATYPES = {\n  DICOM: 'application/dicom',\n  DICOM_JSON: 'application/dicom+json',\n  OCTET_STREAM: 'application/octet-stream',\n  PDF: 'application/pdf',\n  JPEG: 'image/jpeg',\n  PNG: 'image/png'\n};\n\n/**\n * debugLog is a function that can be called with console.log arguments, and will\n * be conditionally displayed, only when debug logging is enabled.\n */\nvar debugLog = function debugLog() {};\n\n/**\n * @typedef { import(\"../types/types\").InstanceMetadata } InstanceMetadata\n */\n\n/**\n * A callback with the request instance and metadata information\n * of the currently request being executed that should necessarily\n * return the given request optionally modified.\n * @typedef {function} RequestHook\n * @param {XMLHttpRequest} request - The original XMLHttpRequest instance.\n * @param {object} metadata - The metadata used by the request.\n */\n\n/**\n * Class for interacting with DICOMweb RESTful services.\n */\nvar DICOMwebClient = /*#__PURE__*/function () {\n  /**\n   * @constructor\n   * @param {Object} options\n   * @param {String} options.url - URL of the DICOMweb RESTful Service endpoint\n   * @param {String=} options.qidoURLPrefix - URL path prefix for QIDO-RS\n   * @param {String=} options.wadoURLPrefix - URL path prefix for WADO-RS\n   * @param {String=} options.stowURLPrefix - URL path prefix for STOW-RS\n   * @param {String=} options.username - Username\n   * @param {String=} options.password - Password\n   * @param {Object=} options.headers - HTTP headers\n   * @param {Array.<RequestHook>=} options.requestHooks - Request hooks.\n   * @param {Object=} options.verbose - print to console request warnings and errors, default true\n   * @param {Object=} options.debug - print to the console debug level information/status updates.\n   * @param {boolean|String} options.singlepart - retrieve singlepart for the named types.\n   * The available types are:  bulkdata, video, image.  true means all.\n   */\n  function DICOMwebClient(options) {\n    _classCallCheck(this, DICOMwebClient);\n    this.baseURL = options.url;\n    if (!this.baseURL) {\n      console.error('no DICOMweb base url provided - calls that require a URL will fail');\n    }\n    if ('username' in options) {\n      this.username = options.username;\n      if (!('password' in options)) {\n        console.error('no password provided to authenticate with DICOMweb service');\n      }\n      this.password = options.password;\n    }\n    if ('qidoURLPrefix' in options) {\n      debugLog(\"use URL prefix for QIDO-RS: \".concat(options.qidoURLPrefix));\n      this.qidoURL = \"\".concat(this.baseURL, \"/\").concat(options.qidoURLPrefix);\n    } else {\n      this.qidoURL = this.baseURL;\n    }\n    if ('wadoURLPrefix' in options) {\n      debugLog(\"use URL prefix for WADO-RS: \".concat(options.wadoURLPrefix));\n      this.wadoURL = \"\".concat(this.baseURL, \"/\").concat(options.wadoURLPrefix);\n    } else {\n      this.wadoURL = this.baseURL;\n    }\n    if ('stowURLPrefix' in options) {\n      debugLog(\"use URL prefix for STOW-RS: \".concat(options.stowURLPrefix));\n      this.stowURL = \"\".concat(this.baseURL, \"/\").concat(options.stowURLPrefix);\n    } else {\n      this.stowURL = this.baseURL;\n    }\n    if (options.singlepart) {\n      debugLog('use singlepart', options.singlepart);\n      this.singlepart = options.singlepart === true ? 'bulkdata,video,image' : options.singlepart;\n    } else {\n      this.singlepart = '';\n    }\n    if ('requestHooks' in options) {\n      this.requestHooks = options.requestHooks;\n    }\n\n    // Headers to pass to requests.\n    this.headers = options.headers || {};\n\n    // Optional error interceptor callback to handle any failed request.\n    this.errorInterceptor = options.errorInterceptor || function () {\n      return undefined;\n    };\n\n    // Verbose - print to console request warnings and errors, default true\n    this.verbose = options.verbose !== false;\n    this.setDebug(options.debug);\n  }\n\n  /**\n   * Allows setting the debug log information. \n   * Note this is different from verbose in that verbose is whether to include warning/error information, defaulting to true\n   * \n   * @param {boolean} debugLevel \n   * @param {function} debugLogFunction to call with the debug output arguments. \n   */\n  _createClass(DICOMwebClient, [{\n    key: \"setDebug\",\n    value: function setDebug() {\n      var debugLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var debugLogFunction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.debugLevel = !!debugLevel;\n      debugLog = debugLogFunction || debugLevel ? console.log : function () {};\n    }\n    /**\n     * Gets debug flag\n     * \n     * @returns true if debug logging is enabled\n     */\n  }, {\n    key: \"getDebug\",\n    value: function getDebug() {\n      return this.debugLevel;\n    }\n    /**\n     * Sets verbose flag.\n     *\n     * @param {Boolean} verbose\n     */\n  }, {\n    key: \"setVerbose\",\n    value: function setVerbose(verbose) {\n      this.verbose = verbose;\n    }\n    /**\n     * Gets verbose flag.\n     *\n     * @return {Boolean} verbose\n     */\n  }, {\n    key: \"getVerbose\",\n    value: function getVerbose() {\n      return this.verbose;\n    }\n  }, {\n    key: \"_httpRequest\",\n    /**\n     * Performs an HTTP request.\n     *\n     * @param {String} url\n     * @param {String} method\n     * @param {Object} headers\n     * @param {Object} options\n     * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @return {*}\n     * @private\n     */\n    value: function _httpRequest(url, method) {\n      var _this = this;\n      var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var errorInterceptor = this.errorInterceptor,\n        requestHooks = this.requestHooks;\n      return new Promise(function (resolve, reject) {\n        var request = options.request ? options.request : new XMLHttpRequest();\n        request.open(method, url, true);\n        if ('responseType' in options) {\n          request.responseType = options.responseType;\n        }\n        if (_typeof(headers) === 'object') {\n          Object.keys(headers).forEach(function (key) {\n            request.setRequestHeader(key, headers[key]);\n          });\n        }\n\n        // now add custom headers from the user\n        // (e.g. access tokens)\n        var userHeaders = _this.headers;\n        Object.keys(userHeaders).forEach(function (key) {\n          request.setRequestHeader(key, userHeaders[key]);\n        });\n\n        // Event triggered when upload starts\n        request.onloadstart = function onloadstart() {\n          debugLog('upload started: ', url);\n        };\n\n        // Event triggered when upload ends\n        request.onloadend = function onloadend() {\n          debugLog('upload finished');\n        };\n\n        // Handle response message\n        request.onreadystatechange = function () {\n          if (request.readyState === 4) {\n            if (request.status === 200) {\n              var contentType = request.getResponseHeader('Content-Type');\n              // Automatically distinguishes between multipart and singlepart in an array buffer, and\n              // converts them into a consistent type.\n              if (contentType && contentType.indexOf('multipart') !== -1) {\n                resolve(multipartDecode(request.response));\n              } else if (request.responseType === 'arraybuffer') {\n                resolve([request.response]);\n              } else {\n                resolve(request.response);\n              }\n            } else if (request.status === 202) {\n              if (_this.verbose) {\n                console.warn('some resources already existed: ', request);\n              }\n              resolve(request.response);\n            } else if (request.status === 204) {\n              if (_this.verbose) {\n                console.warn('empty response for request: ', request);\n              }\n              resolve([]);\n            } else {\n              var error = new Error('request failed');\n              error.request = request;\n              error.response = request.response;\n              error.status = request.status;\n              if (_this.verbose) {\n                console.error('request failed: ', request);\n                console.error(error);\n                console.error(error.response);\n              }\n              errorInterceptor(error);\n              reject(error);\n            }\n          }\n        };\n\n        // Event triggered while download progresses\n        if ('progressCallback' in options) {\n          if (typeof options.progressCallback === 'function') {\n            request.onprogress = options.progressCallback;\n          }\n        }\n        if (requestHooks && areValidRequestHooks(requestHooks)) {\n          var combinedHeaders = Object.assign({}, headers, _this.headers);\n          var metadata = {\n            method: method,\n            url: url,\n            headers: combinedHeaders\n          };\n          var pipeRequestHooks = function pipeRequestHooks(functions) {\n            return function (args) {\n              return functions.reduce(function (props, fn) {\n                return fn(props, metadata);\n              }, args);\n            };\n          };\n          var pipedRequest = pipeRequestHooks(requestHooks);\n          request = pipedRequest(request);\n        }\n\n        // Add withCredentials to request if needed\n        if ('withCredentials' in options) {\n          if (options.withCredentials) {\n            request.withCredentials = true;\n          }\n        }\n        if ('data' in options) {\n          request.send(options.data);\n        } else {\n          request.send();\n        }\n      });\n    }\n    /**\n     * Performs an HTTP GET request.\n     *\n     * @param {String} url\n     * @param {Object} headers\n     * @param {Object} responseType\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGet\",\n    value: function _httpGet(url, headers, responseType, progressCallback, withCredentials) {\n      return this._httpRequest(url, 'get', headers, {\n        responseType: responseType,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials\n      });\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/json\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationJson\",\n    value: function _httpGetApplicationJson(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.DICOM_JSON\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/pdf\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationPdf\",\n    value: function _httpGetApplicationPdf(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.PDF\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with an image\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetImage\",\n    value: function _httpGetImage(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['image/', 'image/*', 'image/jpeg', 'image/jp2', 'image/gif', 'image/png'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a text\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetText\",\n    value: function _httpGetText(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['text/', 'text/*', 'text/html', 'text/plain', 'text/rtf', 'text/xml'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a video\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetVideo\",\n    value: function _httpGetVideo(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['video/', 'video/*', 'video/mpeg', 'video/mp4', 'video/H265'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Asserts that a given media type is valid.\n     *\n     * @params {String} mediaType media type\n     */\n  }, {\n    key: \"_httpGetMultipartImage\",\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with an image media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n    value: function _httpGetMultipartImage(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['image/jpeg', 'image/gif', 'image/png', 'image/jp2'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with a video media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartVideo\",\n    value: function _httpGetMultipartVideo(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['video/', 'video/*', 'video/mpeg2', 'video/mp4', 'video/H265'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.4.100': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.101': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.102': ['video/mp4'],\n          '1.2.840.10008.1.2.4.103': ['video/mp4'],\n          '1.2.840.10008.1.2.4.104': ['video/mp4'],\n          '1.2.840.10008.1.2.4.105': ['video/mp4'],\n          '1.2.840.10008.1.2.4.106': ['video/mp4']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/dicom media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationDicom\",\n    value: function _httpGetMultipartApplicationDicom(url, mediaTypes, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/dicom';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': [defaultMediaType],\n        '1.2.840.10008.1.2.5': [defaultMediaType],\n        '1.2.840.10008.1.2.4.50': [defaultMediaType],\n        '1.2.840.10008.1.2.4.51': [defaultMediaType],\n        '1.2.840.10008.1.2.4.57': [defaultMediaType],\n        '1.2.840.10008.1.2.4.70': [defaultMediaType],\n        '1.2.840.10008.1.2.4.80': [defaultMediaType],\n        '1.2.840.10008.1.2.4.81': [defaultMediaType],\n        '1.2.840.10008.1.2.4.90': [defaultMediaType],\n        '1.2.840.10008.1.2.4.91': [defaultMediaType],\n        '1.2.840.10008.1.2.4.92': [defaultMediaType],\n        '1.2.840.10008.1.2.4.93': [defaultMediaType],\n        '1.2.840.10008.1.2.4.100': [defaultMediaType],\n        '1.2.840.10008.1.2.4.101': [defaultMediaType],\n        '1.2.840.10008.1.2.4.102': [defaultMediaType],\n        '1.2.840.10008.1.2.4.103': [defaultMediaType],\n        '1.2.840.10008.1.2.4.104': [defaultMediaType],\n        '1.2.840.10008.1.2.4.105': [defaultMediaType],\n        '1.2.840.10008.1.2.4.106': [defaultMediaType]\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/octet-stream, OR any of the equivalencies for that (eg\n     * application/pdf etc)\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationOctetStream\",\n    value: function _httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/octet-stream';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': _toConsumableArray(Object.values(MEDIATYPES))\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP POST request.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @param {Function} progressCallback\n     * @param {XMLHttpRequest} request - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPost\",\n    value: function _httpPost(url, headers, data, progressCallback, withCredentials, request) {\n      return this._httpRequest(url, 'post', headers, {\n        data: data,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials,\n        request: request\n      });\n    }\n    /**\n     * Performs an HTTP POST request with content-type application/dicom+json.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPostApplicationJson\",\n    value: function _httpPostApplicationJson(url, data, progressCallback, withCredentials) {\n      var headers = {\n        'Content-Type': MEDIATYPES.DICOM_JSON\n      };\n      return this._httpPost(url, headers, data, progressCallback, withCredentials);\n    }\n    /**\n     * Parses media type and extracts its type and subtype.\n     *\n     * @param {String} mediaType - HTTP media type (e.g. image/jpeg)\n     * @private\n     * @returns {String[]} Media type and subtype\n     */\n  }, {\n    key: \"searchForStudies\",\n    /**\n     * Searches for DICOM studies.\n     *\n     * @param {Object} options\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @return {Object[]} Study representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2)\n     */\n    value: function searchForStudies() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      debugLog('search for studies');\n      var withCredentials = false;\n      var url = \"\".concat(this.qidoURL, \"/studies\");\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the study\n     */\n  }, {\n    key: \"retrieveStudyMetadata\",\n    value: function retrieveStudyMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of study metadata');\n      }\n      debugLog(\"retrieve metadata of study \".concat(options.studyInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM series.\n     *\n     * @param {Object} options\n     * @param {Object} [options.studyInstanceUID] - Study Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Series representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2a)\n     */\n  }, {\n    key: \"searchForSeries\",\n    value: function searchForSeries() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      if ('studyInstanceUID' in options) {\n        debugLog(\"search series of study \".concat(options.studyInstanceUID));\n        url += \"/studies/\".concat(options.studyInstanceUID);\n      }\n      url += '/series';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the series\n     */\n  }, {\n    key: \"retrieveSeriesMetadata\",\n    value: function retrieveSeriesMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of series metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of series metadata');\n      }\n      debugLog(\"retrieve metadata of series \".concat(options.seriesInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {String} [options.seriesInstanceUID] - Series Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Instance representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2b)\n     */\n  }, {\n    key: \"searchForInstances\",\n    value: function searchForInstances() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      var withCredentials = false;\n      if ('studyInstanceUID' in options) {\n        url += \"/studies/\".concat(options.studyInstanceUID);\n        if ('seriesInstanceUID' in options) {\n          debugLog(\"search for instances of series \".concat(options.seriesInstanceUID));\n          url += \"/series/\".concat(options.seriesInstanceUID);\n        } else {\n          debugLog(\"search for instances of study \".concat(options.studyInstanceUID));\n        }\n      } else {\n        debugLog('search for instances');\n      }\n      url += '/instances';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /** Returns a WADO-URI URL for an instance\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {String} WADO-URI URL\n     */\n  }, {\n    key: \"buildInstanceWadoURIUrl\",\n    value: function buildInstanceWadoURIUrl(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required.');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required.');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required.');\n      }\n      var contentType = options.contentType || MEDIATYPES.DICOM;\n      var transferSyntax = options.transferSyntax || '*';\n      var params = [];\n      params.push('requestType=WADO');\n      params.push(\"studyUID=\".concat(options.studyInstanceUID));\n      params.push(\"seriesUID=\".concat(options.seriesInstanceUID));\n      params.push(\"objectUID=\".concat(options.sopInstanceUID));\n      params.push(\"contentType=\".concat(contentType));\n      params.push(\"transferSyntax=\".concat(transferSyntax));\n      var paramString = params.join('&');\n      return \"\".concat(this.wadoURL, \"?\").concat(paramString);\n    }\n    /**\n     * Retrieves metadata for a DICOM Instance.\n     *\n     * @param {Object} options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<InstanceMetadata>} metadata elements in DICOM JSON format\n     */\n  }, {\n    key: \"retrieveInstanceMetadata\",\n    value: function retrieveInstanceMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance metadata');\n      }\n      debugLog(\"retrieve metadata of instance \".concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves frames for a DICOM Instance.\n     * @param {Object} options options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @returns {Array} frame items as byte arrays of the pixel data element\n     */\n  }, {\n    key: \"retrieveInstanceFrames\",\n    value: function retrieveInstanceFrames(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of instance frames');\n      }\n      debugLog(\"retrieve frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString());\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationOctetStream(url, false, false, false, progressCallback, withCredentials);\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length > 1) {\n        /**\n         * Enable request of frames that are stored either compressed\n         * (image/* media type) or uncompressed (application/octet-stream\n         * media type).\n         */\n        var supportedMediaTypes = {\n          '1.2.840.10008.1.2.1': ['application/octet-stream'],\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx'],\n          '1.2.840.10008.1.2.4.201': ['image/jhc'],\n          '1.2.840.10008.1.2.4.202': ['image/jhc']\n        };\n        var headers = {\n          Accept: DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes)\n        };\n        return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('application')) {\n        return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetMultipartImage(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetMultipartVideo(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of frames.\"));\n    }\n    /**\n    * Element in mediaTypes parameter\n    * @typedef {Object} MediaType\n    * @param {String} [MediaType.mediaType] - ie 'image/jpeg', 'image/png'...\n    */\n    /**\n     * Retrieves an individual, server-side rendered DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Promise<ArrayBuffer>} Rendered DICOM Instance\n     */\n  }, {\n    key: \"retrieveInstanceRendered\",\n    value: function retrieveInstanceRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('text')) {\n        return this._httpGetText(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType === MEDIATYPES.PDF) {\n        return this._httpGetApplicationPdf(url, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves a thumbnail of an DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer} Thumbnail\n     */\n  }, {\n    key: \"retrieveInstanceThumbnail\",\n    value: function retrieveInstanceThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves rendered frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesRendered\",\n    value: function retrieveInstanceFramesRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      debugLog(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, false, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves thumbnail of frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesThumbnail\",\n    value: function retrieveInstanceFramesThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      console.debug(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<ArrayBuffer>} DICOM Part 10 file as Arraybuffer\n     */\n  }, {\n    key: \"retrieveInstance\",\n    value: function retrieveInstance(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti = options.withCredentials,\n        withCredentials = _options$withCredenti === void 0 ? false : _options$withCredenti;\n      var _options$progressCall = options.progressCallback,\n        progressCallback = _options$progressCall === void 0 ? false : _options$progressCall;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of instance.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {Function} options.progressCallback\n     * @returns {Promise<ArrayBuffer[]>} DICOM Instances\n     */\n  }, {\n    key: \"retrieveSeries\",\n    value: function retrieveSeries(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of series.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {ArrayBuffer[]} DICOM Instances\n     */\n  }, {\n    key: \"retrieveStudy\",\n    value: function retrieveStudy(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti2 = options.withCredentials,\n        withCredentials = _options$withCredenti2 === void 0 ? false : _options$withCredenti2;\n      var _options$progressCall2 = options.progressCallback,\n        progressCallback = _options$progressCall2 === void 0 ? false : _options$progressCall2;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of study.\"));\n    }\n    /**\n     * Retrieves and parses BulkData from a BulkDataURI location.\n     * Decodes the multipart encoded data and returns the resulting data\n     * as an ArrayBuffer.\n     *\n     * See http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.5.5.html\n     *\n     * @param {Object} options\n     * @param {string} options.BulkDataURI to retrieve\n     * @param {Array}  options.mediaTypes to use to fetch the URI\n     * @param {string} options.byteRange to request a sub-range (only valid on single part)\n     * @returns {Promise<Array>} Bulkdata parts\n     */\n  }, {\n    key: \"retrieveBulkData\",\n    value: function retrieveBulkData(options) {\n      if (!('BulkDataURI' in options)) {\n        throw new Error('BulkDataURI is required.');\n      }\n      var url = options.BulkDataURI;\n      var mediaTypes = options.mediaTypes,\n        byteRange = options.byteRange;\n      var _options$withCredenti3 = options.withCredentials,\n        withCredentials = _options$withCredenti3 === void 0 ? false : _options$withCredenti3;\n      var _options$progressCall3 = options.progressCallback,\n        progressCallback = _options$progressCall3 === void 0 ? false : _options$progressCall3;\n      if (this.singlepart.indexOf('bulkdata') !== -1) {\n        return this._httpGet(url, options.headers, 'arraybuffer', null, withCredentials);\n      }\n      if (mediaTypes) {\n        try {\n          var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n          if (commonMediaType === 'image/') {\n            return this._httpGetMultipartImage(url, mediaTypes, byteRange, false, false, progressCallback, withCredentials);\n          }\n        } catch (e) {\n          // No-op - this happens sometimes if trying to fetch the specific desired type but want to fallback to octet-stream\n        }\n      }\n\n      // Just use the media types provided\n      return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, false, progressCallback, withCredentials);\n    }\n    /**\n     * Stores DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {ArrayBuffer[]} options.datasets - DICOM Instances in PS3.10 format\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @returns {Promise} Response message\n     */\n  }, {\n    key: \"storeInstances\",\n    value: function storeInstances(options) {\n      if (!('datasets' in options)) {\n        throw new Error('datasets are required for storing');\n      }\n      var url = \"\".concat(this.stowURL, \"/studies\");\n      if ('studyInstanceUID' in options) {\n        url += \"/\".concat(options.studyInstanceUID);\n      }\n      var _multipartEncode = multipartEncode(options.datasets),\n        data = _multipartEncode.data,\n        boundary = _multipartEncode.boundary;\n      var headers = {\n        'Content-Type': \"multipart/related; type=\\\"application/dicom\\\"; boundary=\\\"\".concat(boundary, \"\\\"\")\n      };\n      var _options$withCredenti4 = options.withCredentials,\n        withCredentials = _options$withCredenti4 === void 0 ? false : _options$withCredenti4;\n      return this._httpPost(url, headers, data, options.progressCallback, withCredentials, options.request);\n    }\n  }], [{\n    key: \"_parseQueryParameters\",\n    value: function _parseQueryParameters() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var queryString = '?';\n      Object.keys(params).forEach(function (key, index) {\n        if (index !== 0) {\n          queryString += '&';\n        }\n        queryString += \"\".concat(key, \"=\").concat(encodeURIComponent(params[key]));\n      });\n      return queryString;\n    }\n  }, {\n    key: \"_assertMediaTypeIsValid\",\n    value: function _assertMediaTypeIsValid(mediaType) {\n      if (!mediaType) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var sepIndex = mediaType.indexOf('/');\n      if (sepIndex === -1) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var mediaTypeType = mediaType.slice(0, sepIndex);\n      var types = ['application', 'image', 'text', 'video'];\n      if (!types.includes(mediaTypeType)) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      if (mediaType.slice(sepIndex + 1).includes('/')) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n    }\n  }, {\n    key: \"_parseMediaType\",\n    value: function _parseMediaType(mediaType) {\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      return mediaType.split('/');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET request messages.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_buildAcceptHeaderFieldValue\",\n    value: function _buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      var fieldValueParts = mediaTypes.map(function (item) {\n        var mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        if (!supportedMediaTypes.includes(mediaType)) {\n          throw new Error(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n        }\n        return mediaType;\n      });\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET multipart request\n     * messages.  Will throw an exception if no media types are found which are acceptable,\n     * but will only log a verbose level message when types are specified which are\n     * not acceptable.  This allows requesting several types with having to know\n     * whether they are all acceptable or not.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @private\n     */\n  }, {\n    key: \"_buildMultipartAcceptHeaderFieldValue\",\n    value: function _buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      var _this2 = this;\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      if (!Array.isArray(supportedMediaTypes) && !isObject(supportedMediaTypes)) {\n        throw new Error('Supported media types must be provided as an Array or an Object');\n      }\n      var fieldValueParts = [];\n      mediaTypes.forEach(function (item) {\n        var transferSyntaxUID = item.transferSyntaxUID,\n          mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        var fieldValue = \"multipart/related; type=\\\"\".concat(mediaType, \"\\\"\");\n        if (isObject(supportedMediaTypes)) {\n          // SupportedMediaTypes is a lookup table that maps Transfer Syntax UID\n          // to one or more Media Types\n          if (!Object.values(supportedMediaTypes).flat(1).includes(mediaType)) {\n            if (!mediaType.endsWith('/*') || !mediaType.endsWith('/')) {\n              debugLog(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n              return;\n            }\n          }\n          if (transferSyntaxUID) {\n            if (transferSyntaxUID !== '*') {\n              if (!Object.keys(supportedMediaTypes).includes(transferSyntaxUID)) {\n                throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n              }\n              var expectedMediaTypes = supportedMediaTypes[transferSyntaxUID];\n              if (!expectedMediaTypes.includes(mediaType)) {\n                var actualType = DICOMwebClient._parseMediaType(mediaType)[0];\n                expectedMediaTypes.map(function (expectedMediaType) {\n                  var expectedType = DICOMwebClient._parseMediaType(expectedMediaType)[0];\n                  var haveSameType = actualType === expectedType;\n                  if (haveSameType && (mediaType.endsWith('/*') || mediaType.endsWith('/'))) {\n                    return;\n                  }\n                  throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n                });\n              }\n            }\n            fieldValue += \"; transfer-syntax=\".concat(transferSyntaxUID);\n          }\n        } else if (Array.isArray(supportedMediaTypes) && !supportedMediaTypes.includes(mediaType)) {\n          if (_this2.verbose) {\n            console.warn(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n          }\n          return;\n        }\n        fieldValueParts.push(fieldValue);\n      });\n      if (!fieldValueParts.length) {\n        throw new Error(\"No acceptable media types found among \".concat(JSON.stringify(mediaTypes)));\n      }\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds a range header field value for HTTP GET request messages.\n     *\n     * @param {Array} byteRange - Start and end of byte range\n     * @returns {String} Range header field value\n     * @private\n     */\n  }, {\n    key: \"_buildRangeHeaderFieldValue\",\n    value: function _buildRangeHeaderFieldValue() {\n      var byteRange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      if (byteRange.length === 1) {\n        return \"bytes=\".concat(byteRange[0], \"-\");\n      }\n      if (byteRange.length === 2) {\n        return \"bytes=\".concat(byteRange[0], \"-\").concat(byteRange[1]);\n      }\n      return 'bytes=0-';\n    }\n    /**\n     * Gets types that are shared among acceptable media types.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Types that are shared among acceptable media types\n     */\n  }, {\n    key: \"_getSharedMediaTypes\",\n    value: function _getSharedMediaTypes(mediaTypes) {\n      var types = new Set();\n      if (!mediaTypes || !mediaTypes.length) {\n        return types;\n      }\n      mediaTypes.forEach(function (item) {\n        var mediaType = item.mediaType;\n        var type = DICOMwebClient._parseMediaType(mediaType)[0];\n        types.add(\"\".concat(type, \"/\"));\n      });\n      return Array.from(types);\n    }\n    /**\n     * Gets common base type of acceptable media types and asserts that only\n     one type is specified. For example, ``(\"image/jpeg\", \"image/jp2\")``\n     will pass, but ``(\"image/jpeg\", \"video/mpeg2\")`` will raise an\n     exception.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Common media type, eg `image/` for the above example.\n     */\n  }, {\n    key: \"_getCommonMediaType\",\n    value: function _getCommonMediaType(mediaTypes) {\n      if (!mediaTypes || !mediaTypes.length) {\n        throw new Error('No acceptable media types provided');\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length === 0) {\n        throw new Error('No common acceptable media type could be identified.');\n      } else if (sharedMediaTypes.length > 1) {\n        throw new Error('Acceptable media types must have the same type.');\n      }\n      return sharedMediaTypes[0];\n    }\n  }]);\n  return DICOMwebClient;\n}();\n\nfunction findSubstring(str, before, after) {\n  var beforeIndex = str.lastIndexOf(before) + before.length;\n  if (beforeIndex < before.length) {\n    return null;\n  }\n  if (after !== undefined) {\n    var afterIndex = str.lastIndexOf(after);\n    if (afterIndex < 0) {\n      return null;\n    }\n    return str.substring(beforeIndex, afterIndex);\n  }\n  return str.substring(beforeIndex);\n}\nfunction getStudyInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'studies/', '/series');\n  if (!uid) {\n    uid = findSubstring(uri, 'studies/');\n  }\n  if (!uid) {\n    console.debug(\"Study Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSeriesInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'series/', '/instances');\n  if (!uid) {\n    uid = findSubstring(uri, 'series/');\n  }\n  if (!uid) {\n    console.debug(\"Series Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSOPInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, '/instances/', '/frames');\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/', '/metadata');\n  }\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/');\n  }\n  if (!uid) {\n    console.debug(\"SOP Instance UID could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getFrameNumbersFromUri(uri) {\n  var numbers = findSubstring(uri, '/frames/', '/rendered');\n  if (!numbers) {\n    numbers = findSubstring(uri, '/frames/');\n  }\n  if (numbers === undefined) {\n    console.debug(\"Frame Numbers could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return numbers.split(',');\n}\n\nvar version = '0.5.2';\n\nvar api = {\n  DICOMwebClient: DICOMwebClient\n};\nvar utils = {\n  getStudyInstanceUIDFromUri: getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri: getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri: getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri: getFrameNumbersFromUri\n};\n\nexport { api, utils, version };\n//# sourceMappingURL=dicomweb-client.es.js.map\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys'),\n    keysIn = require('./keysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = cloneDeep;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseForOwn = require('./_baseForOwn'),\n    castFunction = require('./_castFunction');\n\n/**\n * Iterates over own enumerable string keyed properties of an object and\n * invokes `iteratee` for each property. The iteratee is invoked with three\n * arguments: (value, key, object). Iteratee functions may exit iteration\n * early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 0.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns `object`.\n * @see _.forOwnRight\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.forOwn(new Foo, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forOwn(object, iteratee) {\n  return object && baseForOwn(object, castFunction(iteratee));\n}\n\nmodule.exports = forOwn;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nmodule.exports = isString;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var checkboardCache = {};\n\nexport var render = function render(c1, c2, size, serverCanvas) {\n  if (typeof document === 'undefined' && !serverCanvas) {\n    return null;\n  }\n  var canvas = serverCanvas ? new serverCanvas() : document.createElement('canvas');\n  canvas.width = size * 2;\n  canvas.height = size * 2;\n  var ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return null;\n  } // If no context can be found, return early.\n  ctx.fillStyle = c1;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = c2;\n  ctx.fillRect(0, 0, size, size);\n  ctx.translate(size, size);\n  ctx.fillRect(0, 0, size, size);\n  return canvas.toDataURL();\n};\n\nexport var get = function get(c1, c2, size, serverCanvas) {\n  var key = c1 + '-' + c2 + '-' + size + (serverCanvas ? '-server' : '');\n\n  if (checkboardCache[key]) {\n    return checkboardCache[key];\n  }\n\n  var checkboard = render(c1, c2, size, serverCanvas);\n  checkboardCache[key] = checkboard;\n  return checkboard;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React, { isValidElement } from 'react';\nimport reactCSS from 'reactcss';\nimport * as checkboard from '../../helpers/checkboard';\n\nexport var Checkboard = function Checkboard(_ref) {\n  var white = _ref.white,\n      grey = _ref.grey,\n      size = _ref.size,\n      renderers = _ref.renderers,\n      borderRadius = _ref.borderRadius,\n      boxShadow = _ref.boxShadow,\n      children = _ref.children;\n\n  var styles = reactCSS({\n    'default': {\n      grid: {\n        borderRadius: borderRadius,\n        boxShadow: boxShadow,\n        absolute: '0px 0px 0px 0px',\n        background: 'url(' + checkboard.get(white, grey, size, renderers.canvas) + ') center left'\n      }\n    }\n  });\n  return isValidElement(children) ? React.cloneElement(children, _extends({}, children.props, { style: _extends({}, children.props.style, styles.grid) })) : React.createElement('div', { style: styles.grid });\n};\n\nCheckboard.defaultProps = {\n  size: 8,\n  white: 'transparent',\n  grey: 'rgba(0,0,0,.08)',\n  renderers: {}\n};\n\nexport default Checkboard;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as alpha from '../../helpers/alpha';\n\nimport Checkboard from './Checkboard';\n\nexport var Alpha = function (_ref) {\n  _inherits(Alpha, _ref);\n\n  function Alpha() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Alpha);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Alpha.__proto__ || Object.getPrototypeOf(Alpha)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = alpha.calculateChange(e, _this.props.hsl, _this.props.direction, _this.props.a, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleChange);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Alpha, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var rgb = this.props.rgb;\n      var styles = reactCSS({\n        'default': {\n          alpha: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          checkboard: {\n            absolute: '0px 0px 0px 0px',\n            overflow: 'hidden',\n            borderRadius: this.props.radius\n          },\n          gradient: {\n            absolute: '0px 0px 0px 0px',\n            background: 'linear-gradient(to right, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          container: {\n            position: 'relative',\n            height: '100%',\n            margin: '0 3px'\n          },\n          pointer: {\n            position: 'absolute',\n            left: rgb.a * 100 + '%'\n          },\n          slider: {\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            marginTop: '1px',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          gradient: {\n            background: 'linear-gradient(to bottom, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)'\n          },\n          pointer: {\n            left: 0,\n            top: rgb.a * 100 + '%'\n          }\n        },\n        'overwrite': _extends({}, this.props.style)\n      }, {\n        vertical: this.props.direction === 'vertical',\n        overwrite: true\n      });\n\n      return React.createElement(\n        'div',\n        { style: styles.alpha },\n        React.createElement(\n          'div',\n          { style: styles.checkboard },\n          React.createElement(Checkboard, { renderers: this.props.renderers })\n        ),\n        React.createElement('div', { style: styles.gradient }),\n        React.createElement(\n          'div',\n          {\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Alpha;\n}(PureComponent || Component);\n\nexport default Alpha;","export var calculateChange = function calculateChange(e, hsl, direction, initialA, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var a = void 0;\n    if (top < 0) {\n      a = 0;\n    } else if (top > containerHeight) {\n      a = 1;\n    } else {\n      a = Math.round(top * 100 / containerHeight) / 100;\n    }\n\n    if (hsl.a !== a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: a,\n        source: 'rgb'\n      };\n    }\n  } else {\n    var _a = void 0;\n    if (left < 0) {\n      _a = 0;\n    } else if (left > containerWidth) {\n      _a = 1;\n    } else {\n      _a = Math.round(left * 100 / containerWidth) / 100;\n    }\n\n    if (initialA !== _a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: _a,\n        source: 'rgb'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\n\nvar DEFAULT_ARROW_OFFSET = 1;\n\nvar UP_KEY_CODE = 38;\nvar DOWN_KEY_CODE = 40;\nvar VALID_KEY_CODES = [UP_KEY_CODE, DOWN_KEY_CODE];\nvar isValidKeyCode = function isValidKeyCode(keyCode) {\n  return VALID_KEY_CODES.indexOf(keyCode) > -1;\n};\nvar getNumberValue = function getNumberValue(value) {\n  return Number(String(value).replace(/%/g, ''));\n};\n\nvar idCounter = 1;\n\nexport var EditableInput = function (_ref) {\n  _inherits(EditableInput, _ref);\n\n  function EditableInput(props) {\n    _classCallCheck(this, EditableInput);\n\n    var _this = _possibleConstructorReturn(this, (EditableInput.__proto__ || Object.getPrototypeOf(EditableInput)).call(this));\n\n    _this.handleBlur = function () {\n      if (_this.state.blurValue) {\n        _this.setState({ value: _this.state.blurValue, blurValue: null });\n      }\n    };\n\n    _this.handleChange = function (e) {\n      _this.setUpdatedValue(e.target.value, e);\n    };\n\n    _this.handleKeyDown = function (e) {\n      // In case `e.target.value` is a percentage remove the `%` character\n      // and update accordingly with a percentage\n      // https://github.com/casesandberg/react-color/issues/383\n      var value = getNumberValue(e.target.value);\n      if (!isNaN(value) && isValidKeyCode(e.keyCode)) {\n        var offset = _this.getArrowOffset();\n        var updatedValue = e.keyCode === UP_KEY_CODE ? value + offset : value - offset;\n\n        _this.setUpdatedValue(updatedValue, e);\n      }\n    };\n\n    _this.handleDrag = function (e) {\n      if (_this.props.dragLabel) {\n        var newValue = Math.round(_this.props.value + e.movementX);\n        if (newValue >= 0 && newValue <= _this.props.dragMax) {\n          _this.props.onChange && _this.props.onChange(_this.getValueObjectWithLabel(newValue), e);\n        }\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      if (_this.props.dragLabel) {\n        e.preventDefault();\n        _this.handleDrag(e);\n        window.addEventListener('mousemove', _this.handleDrag);\n        window.addEventListener('mouseup', _this.handleMouseUp);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleDrag);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.state = {\n      value: String(props.value).toUpperCase(),\n      blurValue: String(props.value).toUpperCase()\n    };\n\n    _this.inputId = 'rc-editable-input-' + idCounter++;\n    return _this;\n  }\n\n  _createClass(EditableInput, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.value !== this.state.value && (prevProps.value !== this.props.value || prevState.value !== this.state.value)) {\n        if (this.input === document.activeElement) {\n          this.setState({ blurValue: String(this.props.value).toUpperCase() });\n        } else {\n          this.setState({ value: String(this.props.value).toUpperCase(), blurValue: !this.state.blurValue && String(this.props.value).toUpperCase() });\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getValueObjectWithLabel',\n    value: function getValueObjectWithLabel(value) {\n      return _defineProperty({}, this.props.label, value);\n    }\n  }, {\n    key: 'getArrowOffset',\n    value: function getArrowOffset() {\n      return this.props.arrowOffset || DEFAULT_ARROW_OFFSET;\n    }\n  }, {\n    key: 'setUpdatedValue',\n    value: function setUpdatedValue(value, e) {\n      var onChangeValue = this.props.label ? this.getValueObjectWithLabel(value) : value;\n      this.props.onChange && this.props.onChange(onChangeValue, e);\n\n      this.setState({ value: value });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            position: 'relative'\n          }\n        },\n        'user-override': {\n          wrap: this.props.style && this.props.style.wrap ? this.props.style.wrap : {},\n          input: this.props.style && this.props.style.input ? this.props.style.input : {},\n          label: this.props.style && this.props.style.label ? this.props.style.label : {}\n        },\n        'dragLabel-true': {\n          label: {\n            cursor: 'ew-resize'\n          }\n        }\n      }, {\n        'user-override': true\n      }, this.props);\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap },\n        React.createElement('input', {\n          id: this.inputId,\n          style: styles.input,\n          ref: function ref(input) {\n            return _this2.input = input;\n          },\n          value: this.state.value,\n          onKeyDown: this.handleKeyDown,\n          onChange: this.handleChange,\n          onBlur: this.handleBlur,\n          placeholder: this.props.placeholder,\n          spellCheck: 'false'\n        }),\n        this.props.label && !this.props.hideLabel ? React.createElement(\n          'label',\n          {\n            htmlFor: this.inputId,\n            style: styles.label,\n            onMouseDown: this.handleMouseDown\n          },\n          this.props.label\n        ) : null\n      );\n    }\n  }]);\n\n  return EditableInput;\n}(PureComponent || Component);\n\nexport default EditableInput;","export var calculateChange = function calculateChange(e, direction, hsl, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var h = void 0;\n    if (top < 0) {\n      h = 359;\n    } else if (top > containerHeight) {\n      h = 0;\n    } else {\n      var percent = -(top * 100 / containerHeight) + 100;\n      h = 360 * percent / 100;\n    }\n\n    if (hsl.h !== h) {\n      return {\n        h: h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  } else {\n    var _h = void 0;\n    if (left < 0) {\n      _h = 0;\n    } else if (left > containerWidth) {\n      _h = 359;\n    } else {\n      var _percent = left * 100 / containerWidth;\n      _h = 360 * _percent / 100;\n    }\n\n    if (hsl.h !== _h) {\n      return {\n        h: _h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as hue from '../../helpers/hue';\n\nexport var Hue = function (_ref) {\n  _inherits(Hue, _ref);\n\n  function Hue() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Hue);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Hue.__proto__ || Object.getPrototypeOf(Hue)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = hue.calculateChange(e, _this.props.direction, _this.props.hsl, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Hue, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      window.removeEventListener('mousemove', this.handleChange);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props$direction = this.props.direction,\n          direction = _props$direction === undefined ? 'horizontal' : _props$direction;\n\n\n      var styles = reactCSS({\n        'default': {\n          hue: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius,\n            boxShadow: this.props.shadow\n          },\n          container: {\n            padding: '0 2px',\n            position: 'relative',\n            height: '100%',\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            left: this.props.hsl.h * 100 / 360 + '%'\n          },\n          slider: {\n            marginTop: '1px',\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          pointer: {\n            left: '0px',\n            top: -(this.props.hsl.h * 100 / 360) + 100 + '%'\n          }\n        }\n      }, { vertical: direction === 'vertical' });\n\n      return React.createElement(\n        'div',\n        { style: styles.hue },\n        React.createElement(\n          'div',\n          {\n            className: 'hue-' + direction,\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'style',\n            null,\n            '\\n            .hue-horizontal {\\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n\\n            .hue-vertical {\\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n          '\n          ),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Hue;\n}(PureComponent || Component);\n\nexport default Hue;","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignMergeValue;\n","import createBaseFor from './_createBaseFor.js';\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nexport default baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nexport default createBaseFor;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n","import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nexport default safeGet;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nexport default toPlainObject;\n","import assignMergeValue from './_assignMergeValue.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\nimport copyArray from './_copyArray.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\nimport isBuffer from './isBuffer.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isPlainObject from './isPlainObject.js';\nimport isTypedArray from './isTypedArray.js';\nimport safeGet from './_safeGet.js';\nimport toPlainObject from './toPlainObject.js';\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nexport default baseMergeDeep;\n","import Stack from './_Stack.js';\nimport assignMergeValue from './_assignMergeValue.js';\nimport baseFor from './_baseFor.js';\nimport baseMergeDeep from './_baseMergeDeep.js';\nimport isObject from './isObject.js';\nimport keysIn from './keysIn.js';\nimport safeGet from './_safeGet.js';\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nexport default baseMerge;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import eq from './eq.js';\nimport isArrayLike from './isArrayLike.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nexport default isIterateeCall;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nexport default merge;\n","import baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nexport default createAssigner;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nexport var Raised = function Raised(_ref) {\n  var zDepth = _ref.zDepth,\n      radius = _ref.radius,\n      background = _ref.background,\n      children = _ref.children,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles;\n\n  var styles = reactCSS(merge({\n    'default': {\n      wrap: {\n        position: 'relative',\n        display: 'inline-block'\n      },\n      content: {\n        position: 'relative'\n      },\n      bg: {\n        absolute: '0px 0px 0px 0px',\n        boxShadow: '0 ' + zDepth + 'px ' + zDepth * 4 + 'px rgba(0,0,0,.24)',\n        borderRadius: radius,\n        background: background\n      }\n    },\n    'zDepth-0': {\n      bg: {\n        boxShadow: 'none'\n      }\n    },\n\n    'zDepth-1': {\n      bg: {\n        boxShadow: '0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)'\n      }\n    },\n    'zDepth-2': {\n      bg: {\n        boxShadow: '0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)'\n      }\n    },\n    'zDepth-3': {\n      bg: {\n        boxShadow: '0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)'\n      }\n    },\n    'zDepth-4': {\n      bg: {\n        boxShadow: '0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)'\n      }\n    },\n    'zDepth-5': {\n      bg: {\n        boxShadow: '0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)'\n      }\n    },\n    'square': {\n      bg: {\n        borderRadius: '0'\n      }\n    },\n    'circle': {\n      bg: {\n        borderRadius: '50%'\n      }\n    }\n  }, passedStyles), { 'zDepth-1': zDepth === 1 });\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap },\n    React.createElement('div', { style: styles.bg }),\n    React.createElement(\n      'div',\n      { style: styles.content },\n      children\n    )\n  );\n};\n\nRaised.propTypes = {\n  background: PropTypes.string,\n  zDepth: PropTypes.oneOf([0, 1, 2, 3, 4, 5]),\n  radius: PropTypes.number,\n  styles: PropTypes.object\n};\n\nRaised.defaultProps = {\n  background: '#fff',\n  zDepth: 1,\n  radius: 2,\n  styles: {}\n};\n\nexport default Raised;","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","export var calculateChange = function calculateChange(e, hsl, container) {\n  var _container$getBoundin = container.getBoundingClientRect(),\n      containerWidth = _container$getBoundin.width,\n      containerHeight = _container$getBoundin.height;\n\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  var saturation = left / containerWidth;\n  var bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n    source: 'hsv'\n  };\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport throttle from 'lodash-es/throttle';\nimport * as saturation from '../../helpers/saturation';\n\nexport var Saturation = function (_ref) {\n  _inherits(Saturation, _ref);\n\n  function Saturation(props) {\n    _classCallCheck(this, Saturation);\n\n    var _this = _possibleConstructorReturn(this, (Saturation.__proto__ || Object.getPrototypeOf(Saturation)).call(this, props));\n\n    _this.handleChange = function (e) {\n      typeof _this.props.onChange === 'function' && _this.throttle(_this.props.onChange, saturation.calculateChange(e, _this.props.hsl, _this.container), e);\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      var renderWindow = _this.getContainerRenderWindow();\n      renderWindow.addEventListener('mousemove', _this.handleChange);\n      renderWindow.addEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.throttle = throttle(function (fn, data, e) {\n      fn(data, e);\n    }, 50);\n    return _this;\n  }\n\n  _createClass(Saturation, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.throttle.cancel();\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getContainerRenderWindow',\n    value: function getContainerRenderWindow() {\n      var container = this.container;\n\n      var renderWindow = window;\n      while (!renderWindow.document.contains(container) && renderWindow.parent !== renderWindow) {\n        renderWindow = renderWindow.parent;\n      }\n      return renderWindow;\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      var renderWindow = this.getContainerRenderWindow();\n      renderWindow.removeEventListener('mousemove', this.handleChange);\n      renderWindow.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _ref2 = this.props.style || {},\n          color = _ref2.color,\n          white = _ref2.white,\n          black = _ref2.black,\n          pointer = _ref2.pointer,\n          circle = _ref2.circle;\n\n      var styles = reactCSS({\n        'default': {\n          color: {\n            absolute: '0px 0px 0px 0px',\n            background: 'hsl(' + this.props.hsl.h + ',100%, 50%)',\n            borderRadius: this.props.radius\n          },\n          white: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          black: {\n            absolute: '0px 0px 0px 0px',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            top: -(this.props.hsv.v * 100) + 100 + '%',\n            left: this.props.hsv.s * 100 + '%',\n            cursor: 'default'\n          },\n          circle: {\n            width: '4px',\n            height: '4px',\n            boxShadow: '0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\\n            0 0 1px 2px rgba(0,0,0,.4)',\n            borderRadius: '50%',\n            cursor: 'hand',\n            transform: 'translate(-2px, -2px)'\n          }\n        },\n        'custom': {\n          color: color,\n          white: white,\n          black: black,\n          pointer: pointer,\n          circle: circle\n        }\n      }, { 'custom': !!this.props.style });\n\n      return React.createElement(\n        'div',\n        {\n          style: styles.color,\n          ref: function ref(container) {\n            return _this2.container = container;\n          },\n          onMouseDown: this.handleMouseDown,\n          onTouchMove: this.handleChange,\n          onTouchStart: this.handleChange\n        },\n        React.createElement(\n          'style',\n          null,\n          '\\n          .saturation-white {\\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\\n          }\\n          .saturation-black {\\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\\n          }\\n        '\n        ),\n        React.createElement(\n          'div',\n          { style: styles.white, className: 'saturation-white' },\n          React.createElement('div', { style: styles.black, className: 'saturation-black' }),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.circle })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Saturation;\n}(PureComponent || Component);\n\nexport default Saturation;","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseForOwn from './_baseForOwn.js';\nimport createBaseEach from './_createBaseEach.js';\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nexport default baseEach;\n","import isArrayLike from './isArrayLike.js';\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nexport default createBaseEach;\n","import baseFor from './_baseFor.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nexport default baseForOwn;\n","import identity from './identity.js';\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nexport default castFunction;\n","import arrayEach from './_arrayEach.js';\nimport baseEach from './_baseEach.js';\nimport castFunction from './_castFunction.js';\nimport isArray from './isArray.js';\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nexport default forEach;\n","// This file is autogenerated. It's used to publish ESM to npm.\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\nvar trimLeft = /^\\s+/;\nvar trimRight = /\\s+$/;\nfunction tinycolor(color, opts) {\n  color = color ? color : \"\";\n  opts = opts || {};\n\n  // If input is already a tinycolor, return itself\n  if (color instanceof tinycolor) {\n    return color;\n  }\n  // If we are called as a function, call using new instead\n  if (!(this instanceof tinycolor)) {\n    return new tinycolor(color, opts);\n  }\n  var rgb = inputToRGB(color);\n  this._originalInput = color, this._r = rgb.r, this._g = rgb.g, this._b = rgb.b, this._a = rgb.a, this._roundA = Math.round(100 * this._a) / 100, this._format = opts.format || rgb.format;\n  this._gradientType = opts.gradientType;\n\n  // Don't let the range of [0,255] come back in [0,1].\n  // Potentially lose a little bit of precision here, but will fix issues where\n  // .5 gets interpreted as half of the total, instead of half of 1\n  // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n  if (this._r < 1) this._r = Math.round(this._r);\n  if (this._g < 1) this._g = Math.round(this._g);\n  if (this._b < 1) this._b = Math.round(this._b);\n  this._ok = rgb.ok;\n}\ntinycolor.prototype = {\n  isDark: function isDark() {\n    return this.getBrightness() < 128;\n  },\n  isLight: function isLight() {\n    return !this.isDark();\n  },\n  isValid: function isValid() {\n    return this._ok;\n  },\n  getOriginalInput: function getOriginalInput() {\n    return this._originalInput;\n  },\n  getFormat: function getFormat() {\n    return this._format;\n  },\n  getAlpha: function getAlpha() {\n    return this._a;\n  },\n  getBrightness: function getBrightness() {\n    //http://www.w3.org/TR/AERT#color-contrast\n    var rgb = this.toRgb();\n    return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n  },\n  getLuminance: function getLuminance() {\n    //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n    var rgb = this.toRgb();\n    var RsRGB, GsRGB, BsRGB, R, G, B;\n    RsRGB = rgb.r / 255;\n    GsRGB = rgb.g / 255;\n    BsRGB = rgb.b / 255;\n    if (RsRGB <= 0.03928) R = RsRGB / 12.92;else R = Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n    if (GsRGB <= 0.03928) G = GsRGB / 12.92;else G = Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n    if (BsRGB <= 0.03928) B = BsRGB / 12.92;else B = Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n    return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n  },\n  setAlpha: function setAlpha(value) {\n    this._a = boundAlpha(value);\n    this._roundA = Math.round(100 * this._a) / 100;\n    return this;\n  },\n  toHsv: function toHsv() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    return {\n      h: hsv.h * 360,\n      s: hsv.s,\n      v: hsv.v,\n      a: this._a\n    };\n  },\n  toHsvString: function toHsvString() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    var h = Math.round(hsv.h * 360),\n      s = Math.round(hsv.s * 100),\n      v = Math.round(hsv.v * 100);\n    return this._a == 1 ? \"hsv(\" + h + \", \" + s + \"%, \" + v + \"%)\" : \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \" + this._roundA + \")\";\n  },\n  toHsl: function toHsl() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    return {\n      h: hsl.h * 360,\n      s: hsl.s,\n      l: hsl.l,\n      a: this._a\n    };\n  },\n  toHslString: function toHslString() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    var h = Math.round(hsl.h * 360),\n      s = Math.round(hsl.s * 100),\n      l = Math.round(hsl.l * 100);\n    return this._a == 1 ? \"hsl(\" + h + \", \" + s + \"%, \" + l + \"%)\" : \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \" + this._roundA + \")\";\n  },\n  toHex: function toHex(allow3Char) {\n    return rgbToHex(this._r, this._g, this._b, allow3Char);\n  },\n  toHexString: function toHexString(allow3Char) {\n    return \"#\" + this.toHex(allow3Char);\n  },\n  toHex8: function toHex8(allow4Char) {\n    return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n  },\n  toHex8String: function toHex8String(allow4Char) {\n    return \"#\" + this.toHex8(allow4Char);\n  },\n  toRgb: function toRgb() {\n    return {\n      r: Math.round(this._r),\n      g: Math.round(this._g),\n      b: Math.round(this._b),\n      a: this._a\n    };\n  },\n  toRgbString: function toRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \")\" : \"rgba(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \", \" + this._roundA + \")\";\n  },\n  toPercentageRgb: function toPercentageRgb() {\n    return {\n      r: Math.round(bound01(this._r, 255) * 100) + \"%\",\n      g: Math.round(bound01(this._g, 255) * 100) + \"%\",\n      b: Math.round(bound01(this._b, 255) * 100) + \"%\",\n      a: this._a\n    };\n  },\n  toPercentageRgbString: function toPercentageRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%)\" : \"rgba(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n  },\n  toName: function toName() {\n    if (this._a === 0) {\n      return \"transparent\";\n    }\n    if (this._a < 1) {\n      return false;\n    }\n    return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n  },\n  toFilter: function toFilter(secondColor) {\n    var hex8String = \"#\" + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n    var secondHex8String = hex8String;\n    var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n    if (secondColor) {\n      var s = tinycolor(secondColor);\n      secondHex8String = \"#\" + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n    }\n    return \"progid:DXImageTransform.Microsoft.gradient(\" + gradientType + \"startColorstr=\" + hex8String + \",endColorstr=\" + secondHex8String + \")\";\n  },\n  toString: function toString(format) {\n    var formatSet = !!format;\n    format = format || this._format;\n    var formattedString = false;\n    var hasAlpha = this._a < 1 && this._a >= 0;\n    var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n    if (needsAlphaFormat) {\n      // Special case for \"transparent\", all other non-alpha formats\n      // will return rgba when there is transparency.\n      if (format === \"name\" && this._a === 0) {\n        return this.toName();\n      }\n      return this.toRgbString();\n    }\n    if (format === \"rgb\") {\n      formattedString = this.toRgbString();\n    }\n    if (format === \"prgb\") {\n      formattedString = this.toPercentageRgbString();\n    }\n    if (format === \"hex\" || format === \"hex6\") {\n      formattedString = this.toHexString();\n    }\n    if (format === \"hex3\") {\n      formattedString = this.toHexString(true);\n    }\n    if (format === \"hex4\") {\n      formattedString = this.toHex8String(true);\n    }\n    if (format === \"hex8\") {\n      formattedString = this.toHex8String();\n    }\n    if (format === \"name\") {\n      formattedString = this.toName();\n    }\n    if (format === \"hsl\") {\n      formattedString = this.toHslString();\n    }\n    if (format === \"hsv\") {\n      formattedString = this.toHsvString();\n    }\n    return formattedString || this.toHexString();\n  },\n  clone: function clone() {\n    return tinycolor(this.toString());\n  },\n  _applyModification: function _applyModification(fn, args) {\n    var color = fn.apply(null, [this].concat([].slice.call(args)));\n    this._r = color._r;\n    this._g = color._g;\n    this._b = color._b;\n    this.setAlpha(color._a);\n    return this;\n  },\n  lighten: function lighten() {\n    return this._applyModification(_lighten, arguments);\n  },\n  brighten: function brighten() {\n    return this._applyModification(_brighten, arguments);\n  },\n  darken: function darken() {\n    return this._applyModification(_darken, arguments);\n  },\n  desaturate: function desaturate() {\n    return this._applyModification(_desaturate, arguments);\n  },\n  saturate: function saturate() {\n    return this._applyModification(_saturate, arguments);\n  },\n  greyscale: function greyscale() {\n    return this._applyModification(_greyscale, arguments);\n  },\n  spin: function spin() {\n    return this._applyModification(_spin, arguments);\n  },\n  _applyCombination: function _applyCombination(fn, args) {\n    return fn.apply(null, [this].concat([].slice.call(args)));\n  },\n  analogous: function analogous() {\n    return this._applyCombination(_analogous, arguments);\n  },\n  complement: function complement() {\n    return this._applyCombination(_complement, arguments);\n  },\n  monochromatic: function monochromatic() {\n    return this._applyCombination(_monochromatic, arguments);\n  },\n  splitcomplement: function splitcomplement() {\n    return this._applyCombination(_splitcomplement, arguments);\n  },\n  // Disabled until https://github.com/bgrins/TinyColor/issues/254\n  // polyad: function (number) {\n  //   return this._applyCombination(polyad, [number]);\n  // },\n  triad: function triad() {\n    return this._applyCombination(polyad, [3]);\n  },\n  tetrad: function tetrad() {\n    return this._applyCombination(polyad, [4]);\n  }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function (color, opts) {\n  if (_typeof(color) == \"object\") {\n    var newColor = {};\n    for (var i in color) {\n      if (color.hasOwnProperty(i)) {\n        if (i === \"a\") {\n          newColor[i] = color[i];\n        } else {\n          newColor[i] = convertToPercentage(color[i]);\n        }\n      }\n    }\n    color = newColor;\n  }\n  return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n  var rgb = {\n    r: 0,\n    g: 0,\n    b: 0\n  };\n  var a = 1;\n  var s = null;\n  var v = null;\n  var l = null;\n  var ok = false;\n  var format = false;\n  if (typeof color == \"string\") {\n    color = stringInputToObject(color);\n  }\n  if (_typeof(color) == \"object\") {\n    if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n      rgb = rgbToRgb(color.r, color.g, color.b);\n      ok = true;\n      format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n      s = convertToPercentage(color.s);\n      v = convertToPercentage(color.v);\n      rgb = hsvToRgb(color.h, s, v);\n      ok = true;\n      format = \"hsv\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n      s = convertToPercentage(color.s);\n      l = convertToPercentage(color.l);\n      rgb = hslToRgb(color.h, s, l);\n      ok = true;\n      format = \"hsl\";\n    }\n    if (color.hasOwnProperty(\"a\")) {\n      a = color.a;\n    }\n  }\n  a = boundAlpha(a);\n  return {\n    ok: ok,\n    format: color.format || format,\n    r: Math.min(255, Math.max(rgb.r, 0)),\n    g: Math.min(255, Math.max(rgb.g, 0)),\n    b: Math.min(255, Math.max(rgb.b, 0)),\n    a: a\n  };\n}\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b) {\n  return {\n    r: bound01(r, 255) * 255,\n    g: bound01(g, 255) * 255,\n    b: bound01(b, 255) * 255\n  };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    l = (max + min) / 2;\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n  h = bound01(h, 360);\n  s = bound01(s, 100);\n  l = bound01(l, 100);\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    v = max;\n  var d = max - min;\n  s = max === 0 ? 0 : d / max;\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    v: v\n  };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hsvToRgb(h, s, v) {\n  h = bound01(h, 360) * 6;\n  s = bound01(s, 100);\n  v = bound01(v, 100);\n  var i = Math.floor(h),\n    f = h - i,\n    p = v * (1 - s),\n    q = v * (1 - f * s),\n    t = v * (1 - (1 - f) * s),\n    mod = i % 6,\n    r = [v, q, p, p, t, v][mod],\n    g = [t, v, v, q, p, p][mod],\n    b = [p, p, t, v, v, q][mod];\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n\n  // Return a 3 character hex if possible\n  if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16)), pad2(convertDecimalToHex(a))];\n\n  // Return a 4 character hex if possible\n  if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n  var hex = [pad2(convertDecimalToHex(a)), pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n  return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n  if (!color1 || !color2) return false;\n  return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\ntinycolor.random = function () {\n  return tinycolor.fromRatio({\n    r: Math.random(),\n    g: Math.random(),\n    b: Math.random()\n  });\n};\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction _desaturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s -= amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _saturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s += amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _greyscale(color) {\n  return tinycolor(color).desaturate(100);\n}\nfunction _lighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l += amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\nfunction _brighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var rgb = tinycolor(color).toRgb();\n  rgb.r = Math.max(0, Math.min(255, rgb.r - Math.round(255 * -(amount / 100))));\n  rgb.g = Math.max(0, Math.min(255, rgb.g - Math.round(255 * -(amount / 100))));\n  rgb.b = Math.max(0, Math.min(255, rgb.b - Math.round(255 * -(amount / 100))));\n  return tinycolor(rgb);\n}\nfunction _darken(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l -= amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction _spin(color, amount) {\n  var hsl = tinycolor(color).toHsl();\n  var hue = (hsl.h + amount) % 360;\n  hsl.h = hue < 0 ? 360 + hue : hue;\n  return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction _complement(color) {\n  var hsl = tinycolor(color).toHsl();\n  hsl.h = (hsl.h + 180) % 360;\n  return tinycolor(hsl);\n}\nfunction polyad(color, number) {\n  if (isNaN(number) || number <= 0) {\n    throw new Error(\"Argument to polyad must be a positive number\");\n  }\n  var hsl = tinycolor(color).toHsl();\n  var result = [tinycolor(color)];\n  var step = 360 / number;\n  for (var i = 1; i < number; i++) {\n    result.push(tinycolor({\n      h: (hsl.h + i * step) % 360,\n      s: hsl.s,\n      l: hsl.l\n    }));\n  }\n  return result;\n}\nfunction _splitcomplement(color) {\n  var hsl = tinycolor(color).toHsl();\n  var h = hsl.h;\n  return [tinycolor(color), tinycolor({\n    h: (h + 72) % 360,\n    s: hsl.s,\n    l: hsl.l\n  }), tinycolor({\n    h: (h + 216) % 360,\n    s: hsl.s,\n    l: hsl.l\n  })];\n}\nfunction _analogous(color, results, slices) {\n  results = results || 6;\n  slices = slices || 30;\n  var hsl = tinycolor(color).toHsl();\n  var part = 360 / slices;\n  var ret = [tinycolor(color)];\n  for (hsl.h = (hsl.h - (part * results >> 1) + 720) % 360; --results;) {\n    hsl.h = (hsl.h + part) % 360;\n    ret.push(tinycolor(hsl));\n  }\n  return ret;\n}\nfunction _monochromatic(color, results) {\n  results = results || 6;\n  var hsv = tinycolor(color).toHsv();\n  var h = hsv.h,\n    s = hsv.s,\n    v = hsv.v;\n  var ret = [];\n  var modification = 1 / results;\n  while (results--) {\n    ret.push(tinycolor({\n      h: h,\n      s: s,\n      v: v\n    }));\n    v = (v + modification) % 1;\n  }\n  return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function (color1, color2, amount) {\n  amount = amount === 0 ? 0 : amount || 50;\n  var rgb1 = tinycolor(color1).toRgb();\n  var rgb2 = tinycolor(color2).toRgb();\n  var p = amount / 100;\n  var rgba = {\n    r: (rgb2.r - rgb1.r) * p + rgb1.r,\n    g: (rgb2.g - rgb1.g) * p + rgb1.g,\n    b: (rgb2.b - rgb1.b) * p + rgb1.b,\n    a: (rgb2.a - rgb1.a) * p + rgb1.a\n  };\n  return tinycolor(rgba);\n};\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function (color1, color2) {\n  var c1 = tinycolor(color1);\n  var c2 = tinycolor(color2);\n  return (Math.max(c1.getLuminance(), c2.getLuminance()) + 0.05) / (Math.min(c1.getLuminance(), c2.getLuminance()) + 0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function (color1, color2, wcag2) {\n  var readability = tinycolor.readability(color1, color2);\n  var wcag2Parms, out;\n  out = false;\n  wcag2Parms = validateWCAG2Parms(wcag2);\n  switch (wcag2Parms.level + wcag2Parms.size) {\n    case \"AAsmall\":\n    case \"AAAlarge\":\n      out = readability >= 4.5;\n      break;\n    case \"AAlarge\":\n      out = readability >= 3;\n      break;\n    case \"AAAsmall\":\n      out = readability >= 7;\n      break;\n  }\n  return out;\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function (baseColor, colorList, args) {\n  var bestColor = null;\n  var bestScore = 0;\n  var readability;\n  var includeFallbackColors, level, size;\n  args = args || {};\n  includeFallbackColors = args.includeFallbackColors;\n  level = args.level;\n  size = args.size;\n  for (var i = 0; i < colorList.length; i++) {\n    readability = tinycolor.readability(baseColor, colorList[i]);\n    if (readability > bestScore) {\n      bestScore = readability;\n      bestColor = tinycolor(colorList[i]);\n    }\n  }\n  if (tinycolor.isReadable(baseColor, bestColor, {\n    level: level,\n    size: size\n  }) || !includeFallbackColors) {\n    return bestColor;\n  } else {\n    args.includeFallbackColors = false;\n    return tinycolor.mostReadable(baseColor, [\"#fff\", \"#000\"], args);\n  }\n};\n\n// Big List of Colors\n// ------------------\n// <https://www.w3.org/TR/css-color-4/#named-colors>\nvar names = tinycolor.names = {\n  aliceblue: \"f0f8ff\",\n  antiquewhite: \"faebd7\",\n  aqua: \"0ff\",\n  aquamarine: \"7fffd4\",\n  azure: \"f0ffff\",\n  beige: \"f5f5dc\",\n  bisque: \"ffe4c4\",\n  black: \"000\",\n  blanchedalmond: \"ffebcd\",\n  blue: \"00f\",\n  blueviolet: \"8a2be2\",\n  brown: \"a52a2a\",\n  burlywood: \"deb887\",\n  burntsienna: \"ea7e5d\",\n  cadetblue: \"5f9ea0\",\n  chartreuse: \"7fff00\",\n  chocolate: \"d2691e\",\n  coral: \"ff7f50\",\n  cornflowerblue: \"6495ed\",\n  cornsilk: \"fff8dc\",\n  crimson: \"dc143c\",\n  cyan: \"0ff\",\n  darkblue: \"00008b\",\n  darkcyan: \"008b8b\",\n  darkgoldenrod: \"b8860b\",\n  darkgray: \"a9a9a9\",\n  darkgreen: \"006400\",\n  darkgrey: \"a9a9a9\",\n  darkkhaki: \"bdb76b\",\n  darkmagenta: \"8b008b\",\n  darkolivegreen: \"556b2f\",\n  darkorange: \"ff8c00\",\n  darkorchid: \"9932cc\",\n  darkred: \"8b0000\",\n  darksalmon: \"e9967a\",\n  darkseagreen: \"8fbc8f\",\n  darkslateblue: \"483d8b\",\n  darkslategray: \"2f4f4f\",\n  darkslategrey: \"2f4f4f\",\n  darkturquoise: \"00ced1\",\n  darkviolet: \"9400d3\",\n  deeppink: \"ff1493\",\n  deepskyblue: \"00bfff\",\n  dimgray: \"696969\",\n  dimgrey: \"696969\",\n  dodgerblue: \"1e90ff\",\n  firebrick: \"b22222\",\n  floralwhite: \"fffaf0\",\n  forestgreen: \"228b22\",\n  fuchsia: \"f0f\",\n  gainsboro: \"dcdcdc\",\n  ghostwhite: \"f8f8ff\",\n  gold: \"ffd700\",\n  goldenrod: \"daa520\",\n  gray: \"808080\",\n  green: \"008000\",\n  greenyellow: \"adff2f\",\n  grey: \"808080\",\n  honeydew: \"f0fff0\",\n  hotpink: \"ff69b4\",\n  indianred: \"cd5c5c\",\n  indigo: \"4b0082\",\n  ivory: \"fffff0\",\n  khaki: \"f0e68c\",\n  lavender: \"e6e6fa\",\n  lavenderblush: \"fff0f5\",\n  lawngreen: \"7cfc00\",\n  lemonchiffon: \"fffacd\",\n  lightblue: \"add8e6\",\n  lightcoral: \"f08080\",\n  lightcyan: \"e0ffff\",\n  lightgoldenrodyellow: \"fafad2\",\n  lightgray: \"d3d3d3\",\n  lightgreen: \"90ee90\",\n  lightgrey: \"d3d3d3\",\n  lightpink: \"ffb6c1\",\n  lightsalmon: \"ffa07a\",\n  lightseagreen: \"20b2aa\",\n  lightskyblue: \"87cefa\",\n  lightslategray: \"789\",\n  lightslategrey: \"789\",\n  lightsteelblue: \"b0c4de\",\n  lightyellow: \"ffffe0\",\n  lime: \"0f0\",\n  limegreen: \"32cd32\",\n  linen: \"faf0e6\",\n  magenta: \"f0f\",\n  maroon: \"800000\",\n  mediumaquamarine: \"66cdaa\",\n  mediumblue: \"0000cd\",\n  mediumorchid: \"ba55d3\",\n  mediumpurple: \"9370db\",\n  mediumseagreen: \"3cb371\",\n  mediumslateblue: \"7b68ee\",\n  mediumspringgreen: \"00fa9a\",\n  mediumturquoise: \"48d1cc\",\n  mediumvioletred: \"c71585\",\n  midnightblue: \"191970\",\n  mintcream: \"f5fffa\",\n  mistyrose: \"ffe4e1\",\n  moccasin: \"ffe4b5\",\n  navajowhite: \"ffdead\",\n  navy: \"000080\",\n  oldlace: \"fdf5e6\",\n  olive: \"808000\",\n  olivedrab: \"6b8e23\",\n  orange: \"ffa500\",\n  orangered: \"ff4500\",\n  orchid: \"da70d6\",\n  palegoldenrod: \"eee8aa\",\n  palegreen: \"98fb98\",\n  paleturquoise: \"afeeee\",\n  palevioletred: \"db7093\",\n  papayawhip: \"ffefd5\",\n  peachpuff: \"ffdab9\",\n  peru: \"cd853f\",\n  pink: \"ffc0cb\",\n  plum: \"dda0dd\",\n  powderblue: \"b0e0e6\",\n  purple: \"800080\",\n  rebeccapurple: \"663399\",\n  red: \"f00\",\n  rosybrown: \"bc8f8f\",\n  royalblue: \"4169e1\",\n  saddlebrown: \"8b4513\",\n  salmon: \"fa8072\",\n  sandybrown: \"f4a460\",\n  seagreen: \"2e8b57\",\n  seashell: \"fff5ee\",\n  sienna: \"a0522d\",\n  silver: \"c0c0c0\",\n  skyblue: \"87ceeb\",\n  slateblue: \"6a5acd\",\n  slategray: \"708090\",\n  slategrey: \"708090\",\n  snow: \"fffafa\",\n  springgreen: \"00ff7f\",\n  steelblue: \"4682b4\",\n  tan: \"d2b48c\",\n  teal: \"008080\",\n  thistle: \"d8bfd8\",\n  tomato: \"ff6347\",\n  turquoise: \"40e0d0\",\n  violet: \"ee82ee\",\n  wheat: \"f5deb3\",\n  white: \"fff\",\n  whitesmoke: \"f5f5f5\",\n  yellow: \"ff0\",\n  yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n  var flipped = {};\n  for (var i in o) {\n    if (o.hasOwnProperty(i)) {\n      flipped[o[i]] = i;\n    }\n  }\n  return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n  a = parseFloat(a);\n  if (isNaN(a) || a < 0 || a > 1) {\n    a = 1;\n  }\n  return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n  if (isOnePointZero(n)) n = \"100%\";\n  var processPercent = isPercentage(n);\n  n = Math.min(max, Math.max(0, parseFloat(n)));\n\n  // Automatically convert percentage into number\n  if (processPercent) {\n    n = parseInt(n * max, 10) / 100;\n  }\n\n  // Handle floating point rounding errors\n  if (Math.abs(n - max) < 0.000001) {\n    return 1;\n  }\n\n  // Convert into [0, 1] range if it isn't already\n  return n % max / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n  return Math.min(1, Math.max(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n  return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n  return typeof n == \"string\" && n.indexOf(\".\") != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n  return typeof n === \"string\" && n.indexOf(\"%\") != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n  return c.length == 1 ? \"0\" + c : \"\" + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n  if (n <= 1) {\n    n = n * 100 + \"%\";\n  }\n  return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n  return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n  return parseIntFromHex(h) / 255;\n}\nvar matchers = function () {\n  // <http://www.w3.org/TR/css3-values/#integers>\n  var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n  // <http://www.w3.org/TR/css3-values/#number-value>\n  var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n  // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n  var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n  // Actual matching.\n  // Parentheses and commas are optional, but not required.\n  // Whitespace can take the place of commas or opening paren\n  var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  return {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n    rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n    hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n    hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n    hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n    hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n  };\n}();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n  return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n  color = color.replace(trimLeft, \"\").replace(trimRight, \"\").toLowerCase();\n  var named = false;\n  if (names[color]) {\n    color = names[color];\n    named = true;\n  } else if (color == \"transparent\") {\n    return {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0,\n      format: \"name\"\n    };\n  }\n\n  // Try to match string input using regular expressions.\n  // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n  // Just return an object and let the conversion functions handle that.\n  // This way the result will be the same whether the tinycolor is initialized with string or object.\n  var match;\n  if (match = matchers.rgb.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3]\n    };\n  }\n  if (match = matchers.rgba.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsl.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3]\n    };\n  }\n  if (match = matchers.hsla.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsv.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3]\n    };\n  }\n  if (match = matchers.hsva.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hex8.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      a: convertHexToDecimal(match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex6.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  if (match = matchers.hex4.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      a: convertHexToDecimal(match[4] + \"\" + match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex3.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  return false;\n}\nfunction validateWCAG2Parms(parms) {\n  // return valid WCAG2 parms for isReadable.\n  // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n  var level, size;\n  parms = parms || {\n    level: \"AA\",\n    size: \"small\"\n  };\n  level = (parms.level || \"AA\").toUpperCase();\n  size = (parms.size || \"small\").toLowerCase();\n  if (level !== \"AA\" && level !== \"AAA\") {\n    level = \"AA\";\n  }\n  if (size !== \"small\" && size !== \"large\") {\n    size = \"small\";\n  }\n  return {\n    level: level,\n    size: size\n  };\n}\n\nexport { tinycolor as default };\n","import each from 'lodash-es/each';\nimport tinycolor from 'tinycolor2';\n\nexport var simpleCheckForValidColor = function simpleCheckForValidColor(data) {\n  var keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  var checked = 0;\n  var passed = 0;\n  each(keysToCheck, function (letter) {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        var percentPatt = /^\\d+%$/;\n        if (percentPatt.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport var toState = function toState(data, oldHue) {\n  var color = data.hex ? tinycolor(data.hex) : tinycolor(data);\n  var hsl = color.toHsl();\n  var hsv = color.toHsv();\n  var rgb = color.toRgb();\n  var hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  var transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl: hsl,\n    hex: transparent ? 'transparent' : '#' + hex,\n    rgb: rgb,\n    hsv: hsv,\n    oldHue: data.h || oldHue || hsl.h,\n    source: data.source\n  };\n};\n\nexport var isValidHex = function isValidHex(hex) {\n  if (hex === 'transparent') {\n    return true;\n  }\n  // disable hex4 and hex8\n  var lh = String(hex).charAt(0) === '#' ? 1 : 0;\n  return hex.length !== 4 + lh && hex.length < 7 + lh && tinycolor(hex).isValid();\n};\n\nexport var getContrastingColor = function getContrastingColor(data) {\n  if (!data) {\n    return '#fff';\n  }\n  var col = toState(data);\n  if (col.hex === 'transparent') {\n    return 'rgba(0,0,0,0.4)';\n  }\n  var yiq = (col.rgb.r * 299 + col.rgb.g * 587 + col.rgb.b * 114) / 1000;\n  return yiq >= 128 ? '#000' : '#fff';\n};\n\nexport var red = {\n  hsl: { a: 1, h: 0, l: 0.5, s: 1 },\n  hex: '#ff0000',\n  rgb: { r: 255, g: 0, b: 0, a: 1 },\n  hsv: { h: 0, s: 1, v: 1, a: 1 }\n};\n\nexport var isvalidColorString = function isvalidColorString(string, type) {\n  var stringWithoutDegree = string.replace('', '');\n  return tinycolor(type + ' (' + stringWithoutDegree + ')')._ok;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport debounce from 'lodash-es/debounce';\nimport * as color from '../../helpers/color';\n\nexport var ColorWrap = function ColorWrap(Picker) {\n  var ColorPicker = function (_ref) {\n    _inherits(ColorPicker, _ref);\n\n    function ColorPicker(props) {\n      _classCallCheck(this, ColorPicker);\n\n      var _this = _possibleConstructorReturn(this, (ColorPicker.__proto__ || Object.getPrototypeOf(ColorPicker)).call(this));\n\n      _this.handleChange = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.setState(colors);\n          _this.props.onChangeComplete && _this.debounce(_this.props.onChangeComplete, colors, event);\n          _this.props.onChange && _this.props.onChange(colors, event);\n        }\n      };\n\n      _this.handleSwatchHover = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.props.onSwatchHover && _this.props.onSwatchHover(colors, event);\n        }\n      };\n\n      _this.state = _extends({}, color.toState(props.color, 0));\n\n      _this.debounce = debounce(function (fn, data, event) {\n        fn(data, event);\n      }, 100);\n      return _this;\n    }\n\n    _createClass(ColorPicker, [{\n      key: 'render',\n      value: function render() {\n        var optionalEvents = {};\n        if (this.props.onSwatchHover) {\n          optionalEvents.onSwatchHover = this.handleSwatchHover;\n        }\n\n        return React.createElement(Picker, _extends({}, this.props, this.state, {\n          onChange: this.handleChange\n        }, optionalEvents));\n      }\n    }], [{\n      key: 'getDerivedStateFromProps',\n      value: function getDerivedStateFromProps(nextProps, state) {\n        return _extends({}, color.toState(nextProps.color, state.oldHue));\n      }\n    }]);\n\n    return ColorPicker;\n  }(PureComponent || Component);\n\n  ColorPicker.propTypes = _extends({}, Picker.propTypes);\n\n  ColorPicker.defaultProps = _extends({}, Picker.defaultProps, {\n    color: {\n      h: 250,\n      s: 0.50,\n      l: 0.20,\n      a: 1\n    }\n  });\n\n  return ColorPicker;\n};\n\nexport default ColorWrap;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable no-invalid-this */\nimport React from 'react';\n\nexport var handleFocus = function handleFocus(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n  return function (_React$Component) {\n    _inherits(Focus, _React$Component);\n\n    function Focus() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Focus);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Focus.__proto__ || Object.getPrototypeOf(Focus)).call.apply(_ref, [this].concat(args))), _this), _this.state = { focus: false }, _this.handleFocus = function () {\n        return _this.setState({ focus: true });\n      }, _this.handleBlur = function () {\n        return _this.setState({ focus: false });\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Focus, [{\n      key: 'render',\n      value: function render() {\n        return React.createElement(\n          Span,\n          { onFocus: this.handleFocus, onBlur: this.handleBlur },\n          React.createElement(Component, _extends({}, this.props, this.state))\n        );\n      }\n    }]);\n\n    return Focus;\n  }(React.Component);\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport { handleFocus } from '../../helpers/interaction';\n\nimport Checkboard from './Checkboard';\n\nvar ENTER = 13;\n\nexport var Swatch = function Swatch(_ref) {\n  var color = _ref.color,\n      style = _ref.style,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onHover = _ref.onHover,\n      _ref$title = _ref.title,\n      title = _ref$title === undefined ? color : _ref$title,\n      children = _ref.children,\n      focus = _ref.focus,\n      _ref$focusStyle = _ref.focusStyle,\n      focusStyle = _ref$focusStyle === undefined ? {} : _ref$focusStyle;\n\n  var transparent = color === 'transparent';\n  var styles = reactCSS({\n    default: {\n      swatch: _extends({\n        background: color,\n        height: '100%',\n        width: '100%',\n        cursor: 'pointer',\n        position: 'relative',\n        outline: 'none'\n      }, style, focus ? focusStyle : {})\n    }\n  });\n\n  var handleClick = function handleClick(e) {\n    return onClick(color, e);\n  };\n  var handleKeyDown = function handleKeyDown(e) {\n    return e.keyCode === ENTER && onClick(color, e);\n  };\n  var handleHover = function handleHover(e) {\n    return onHover(color, e);\n  };\n\n  var optionalEvents = {};\n  if (onHover) {\n    optionalEvents.onMouseOver = handleHover;\n  }\n\n  return React.createElement(\n    'div',\n    _extends({\n      style: styles.swatch,\n      onClick: handleClick,\n      title: title,\n      tabIndex: 0,\n      onKeyDown: handleKeyDown\n    }, optionalEvents),\n    children,\n    transparent && React.createElement(Checkboard, {\n      borderRadius: styles.swatch.borderRadius,\n      boxShadow: 'inset 0 0 0 1px rgba(0,0,0,0.1)'\n    })\n  );\n};\n\nexport default handleFocus(Swatch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var AlphaPointer = function AlphaPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default AlphaPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { ColorWrap, Alpha } from '../common';\nimport AlphaPointer from './AlphaPointer';\n\nexport var AlphaPicker = function AlphaPicker(_ref) {\n  var rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      direction = _ref.direction,\n      style = _ref.style,\n      renderers = _ref.renderers,\n      pointer = _ref.pointer,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      alpha: {\n        radius: '2px',\n        style: style\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'alpha-picker ' + className },\n    React.createElement(Alpha, _extends({}, styles.alpha, {\n      rgb: rgb,\n      hsl: hsl,\n      pointer: pointer,\n      renderers: renderers,\n      onChange: onChange,\n      direction: direction\n    }))\n  );\n};\n\nAlphaPicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: AlphaPointer\n};\n\nexport default ColorWrap(AlphaPicker);","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import baseEach from './_baseEach.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nexport default baseMap;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport isArray from './isArray.js';\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nexport default map;\n","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport { Swatch } from '../common';\n\nexport var BlockSwatches = function BlockSwatches(_ref) {\n  var colors = _ref.colors,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginRight: '-10px'\n      },\n      swatch: {\n        width: '22px',\n        height: '22px',\n        float: 'left',\n        marginRight: '10px',\n        marginBottom: '10px',\n        borderRadius: '4px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    map(colors, function (c) {\n      return React.createElement(Swatch, {\n        key: c,\n        color: c,\n        style: styles.swatch,\n        onClick: onClick,\n        onHover: onSwatchHover,\n        focusStyle: {\n          boxShadow: '0 0 4px ' + c\n        }\n      });\n    }),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default BlockSwatches;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Checkboard } from '../common';\nimport BlockSwatches from './BlockSwatches';\n\nexport var Block = function Block(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var transparent = hex === 'transparent';\n  var handleChange = function handleChange(hexCode, e) {\n    color.isValidHex(hexCode) && onChange({\n      hex: hexCode,\n      source: 'hex'\n    }, e);\n  };\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        boxShadow: '0 1px rgba(0,0,0,.1)',\n        borderRadius: '6px',\n        position: 'relative'\n      },\n      head: {\n        height: '110px',\n        background: hex,\n        borderRadius: '6px 6px 0 0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        position: 'relative'\n      },\n      body: {\n        padding: '10px'\n      },\n      label: {\n        fontSize: '18px',\n        color: color.getContrastingColor(hex),\n        position: 'relative'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 10px 10px 10px',\n        borderColor: 'transparent transparent ' + hex + ' transparent',\n        position: 'absolute',\n        top: '-10px',\n        left: '50%',\n        marginLeft: '-10px'\n      },\n      input: {\n        width: '100%',\n        fontSize: '12px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '22px',\n        boxShadow: 'inset 0 0 0 1px #ddd',\n        borderRadius: '4px',\n        padding: '0 7px',\n        boxSizing: 'border-box'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { 'hide-triangle': triangle === 'hide' });\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'block-picker ' + className },\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.head },\n      transparent && React.createElement(Checkboard, { borderRadius: '6px 6px 0 0' }),\n      React.createElement(\n        'div',\n        { style: styles.label },\n        hex\n      )\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(BlockSwatches, { colors: colors, onClick: handleChange, onSwatchHover: onSwatchHover }),\n      React.createElement(EditableInput, {\n        style: { input: styles.input },\n        value: hex,\n        onChange: handleChange\n      })\n    )\n  );\n};\n\nBlock.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['top', 'hide']),\n  styles: PropTypes.object\n};\n\nBlock.defaultProps = {\n  width: 170,\n  colors: ['#D9E3F0', '#F47373', '#697689', '#37D67A', '#2CCCE4', '#555555', '#dce775', '#ff8a65', '#ba68c8'],\n  triangle: 'top',\n  styles: {}\n};\n\nexport default ColorWrap(Block);","export var red = {\"50\":\"#ffebee\",\"100\":\"#ffcdd2\",\"200\":\"#ef9a9a\",\"300\":\"#e57373\",\"400\":\"#ef5350\",\"500\":\"#f44336\",\"600\":\"#e53935\",\"700\":\"#d32f2f\",\"800\":\"#c62828\",\"900\":\"#b71c1c\",\"a100\":\"#ff8a80\",\"a200\":\"#ff5252\",\"a400\":\"#ff1744\",\"a700\":\"#d50000\"};\nexport var pink = {\"50\":\"#fce4ec\",\"100\":\"#f8bbd0\",\"200\":\"#f48fb1\",\"300\":\"#f06292\",\"400\":\"#ec407a\",\"500\":\"#e91e63\",\"600\":\"#d81b60\",\"700\":\"#c2185b\",\"800\":\"#ad1457\",\"900\":\"#880e4f\",\"a100\":\"#ff80ab\",\"a200\":\"#ff4081\",\"a400\":\"#f50057\",\"a700\":\"#c51162\"};\nexport var purple = {\"50\":\"#f3e5f5\",\"100\":\"#e1bee7\",\"200\":\"#ce93d8\",\"300\":\"#ba68c8\",\"400\":\"#ab47bc\",\"500\":\"#9c27b0\",\"600\":\"#8e24aa\",\"700\":\"#7b1fa2\",\"800\":\"#6a1b9a\",\"900\":\"#4a148c\",\"a100\":\"#ea80fc\",\"a200\":\"#e040fb\",\"a400\":\"#d500f9\",\"a700\":\"#aa00ff\"};\nexport var deepPurple = {\"50\":\"#ede7f6\",\"100\":\"#d1c4e9\",\"200\":\"#b39ddb\",\"300\":\"#9575cd\",\"400\":\"#7e57c2\",\"500\":\"#673ab7\",\"600\":\"#5e35b1\",\"700\":\"#512da8\",\"800\":\"#4527a0\",\"900\":\"#311b92\",\"a100\":\"#b388ff\",\"a200\":\"#7c4dff\",\"a400\":\"#651fff\",\"a700\":\"#6200ea\"};\nexport var indigo = {\"50\":\"#e8eaf6\",\"100\":\"#c5cae9\",\"200\":\"#9fa8da\",\"300\":\"#7986cb\",\"400\":\"#5c6bc0\",\"500\":\"#3f51b5\",\"600\":\"#3949ab\",\"700\":\"#303f9f\",\"800\":\"#283593\",\"900\":\"#1a237e\",\"a100\":\"#8c9eff\",\"a200\":\"#536dfe\",\"a400\":\"#3d5afe\",\"a700\":\"#304ffe\"};\nexport var blue = {\"50\":\"#e3f2fd\",\"100\":\"#bbdefb\",\"200\":\"#90caf9\",\"300\":\"#64b5f6\",\"400\":\"#42a5f5\",\"500\":\"#2196f3\",\"600\":\"#1e88e5\",\"700\":\"#1976d2\",\"800\":\"#1565c0\",\"900\":\"#0d47a1\",\"a100\":\"#82b1ff\",\"a200\":\"#448aff\",\"a400\":\"#2979ff\",\"a700\":\"#2962ff\"};\nexport var lightBlue = {\"50\":\"#e1f5fe\",\"100\":\"#b3e5fc\",\"200\":\"#81d4fa\",\"300\":\"#4fc3f7\",\"400\":\"#29b6f6\",\"500\":\"#03a9f4\",\"600\":\"#039be5\",\"700\":\"#0288d1\",\"800\":\"#0277bd\",\"900\":\"#01579b\",\"a100\":\"#80d8ff\",\"a200\":\"#40c4ff\",\"a400\":\"#00b0ff\",\"a700\":\"#0091ea\"};\nexport var cyan = {\"50\":\"#e0f7fa\",\"100\":\"#b2ebf2\",\"200\":\"#80deea\",\"300\":\"#4dd0e1\",\"400\":\"#26c6da\",\"500\":\"#00bcd4\",\"600\":\"#00acc1\",\"700\":\"#0097a7\",\"800\":\"#00838f\",\"900\":\"#006064\",\"a100\":\"#84ffff\",\"a200\":\"#18ffff\",\"a400\":\"#00e5ff\",\"a700\":\"#00b8d4\"};\nexport var teal = {\"50\":\"#e0f2f1\",\"100\":\"#b2dfdb\",\"200\":\"#80cbc4\",\"300\":\"#4db6ac\",\"400\":\"#26a69a\",\"500\":\"#009688\",\"600\":\"#00897b\",\"700\":\"#00796b\",\"800\":\"#00695c\",\"900\":\"#004d40\",\"a100\":\"#a7ffeb\",\"a200\":\"#64ffda\",\"a400\":\"#1de9b6\",\"a700\":\"#00bfa5\"};\nexport var green = {\"50\":\"#e8f5e9\",\"100\":\"#c8e6c9\",\"200\":\"#a5d6a7\",\"300\":\"#81c784\",\"400\":\"#66bb6a\",\"500\":\"#4caf50\",\"600\":\"#43a047\",\"700\":\"#388e3c\",\"800\":\"#2e7d32\",\"900\":\"#1b5e20\",\"a100\":\"#b9f6ca\",\"a200\":\"#69f0ae\",\"a400\":\"#00e676\",\"a700\":\"#00c853\"};\nexport var lightGreen = {\"50\":\"#f1f8e9\",\"100\":\"#dcedc8\",\"200\":\"#c5e1a5\",\"300\":\"#aed581\",\"400\":\"#9ccc65\",\"500\":\"#8bc34a\",\"600\":\"#7cb342\",\"700\":\"#689f38\",\"800\":\"#558b2f\",\"900\":\"#33691e\",\"a100\":\"#ccff90\",\"a200\":\"#b2ff59\",\"a400\":\"#76ff03\",\"a700\":\"#64dd17\"};\nexport var lime = {\"50\":\"#f9fbe7\",\"100\":\"#f0f4c3\",\"200\":\"#e6ee9c\",\"300\":\"#dce775\",\"400\":\"#d4e157\",\"500\":\"#cddc39\",\"600\":\"#c0ca33\",\"700\":\"#afb42b\",\"800\":\"#9e9d24\",\"900\":\"#827717\",\"a100\":\"#f4ff81\",\"a200\":\"#eeff41\",\"a400\":\"#c6ff00\",\"a700\":\"#aeea00\"};\nexport var yellow = {\"50\":\"#fffde7\",\"100\":\"#fff9c4\",\"200\":\"#fff59d\",\"300\":\"#fff176\",\"400\":\"#ffee58\",\"500\":\"#ffeb3b\",\"600\":\"#fdd835\",\"700\":\"#fbc02d\",\"800\":\"#f9a825\",\"900\":\"#f57f17\",\"a100\":\"#ffff8d\",\"a200\":\"#ffff00\",\"a400\":\"#ffea00\",\"a700\":\"#ffd600\"};\nexport var amber = {\"50\":\"#fff8e1\",\"100\":\"#ffecb3\",\"200\":\"#ffe082\",\"300\":\"#ffd54f\",\"400\":\"#ffca28\",\"500\":\"#ffc107\",\"600\":\"#ffb300\",\"700\":\"#ffa000\",\"800\":\"#ff8f00\",\"900\":\"#ff6f00\",\"a100\":\"#ffe57f\",\"a200\":\"#ffd740\",\"a400\":\"#ffc400\",\"a700\":\"#ffab00\"};\nexport var orange = {\"50\":\"#fff3e0\",\"100\":\"#ffe0b2\",\"200\":\"#ffcc80\",\"300\":\"#ffb74d\",\"400\":\"#ffa726\",\"500\":\"#ff9800\",\"600\":\"#fb8c00\",\"700\":\"#f57c00\",\"800\":\"#ef6c00\",\"900\":\"#e65100\",\"a100\":\"#ffd180\",\"a200\":\"#ffab40\",\"a400\":\"#ff9100\",\"a700\":\"#ff6d00\"};\nexport var deepOrange = {\"50\":\"#fbe9e7\",\"100\":\"#ffccbc\",\"200\":\"#ffab91\",\"300\":\"#ff8a65\",\"400\":\"#ff7043\",\"500\":\"#ff5722\",\"600\":\"#f4511e\",\"700\":\"#e64a19\",\"800\":\"#d84315\",\"900\":\"#bf360c\",\"a100\":\"#ff9e80\",\"a200\":\"#ff6e40\",\"a400\":\"#ff3d00\",\"a700\":\"#dd2c00\"};\nexport var brown = {\"50\":\"#efebe9\",\"100\":\"#d7ccc8\",\"200\":\"#bcaaa4\",\"300\":\"#a1887f\",\"400\":\"#8d6e63\",\"500\":\"#795548\",\"600\":\"#6d4c41\",\"700\":\"#5d4037\",\"800\":\"#4e342e\",\"900\":\"#3e2723\"};\nexport var grey = {\"50\":\"#fafafa\",\"100\":\"#f5f5f5\",\"200\":\"#eeeeee\",\"300\":\"#e0e0e0\",\"400\":\"#bdbdbd\",\"500\":\"#9e9e9e\",\"600\":\"#757575\",\"700\":\"#616161\",\"800\":\"#424242\",\"900\":\"#212121\"};\nexport var blueGrey = {\"50\":\"#eceff1\",\"100\":\"#cfd8dc\",\"200\":\"#b0bec5\",\"300\":\"#90a4ae\",\"400\":\"#78909c\",\"500\":\"#607d8b\",\"600\":\"#546e7a\",\"700\":\"#455a64\",\"800\":\"#37474f\",\"900\":\"#263238\"};\nexport var darkText = {\"primary\":\"rgba(0, 0, 0, 0.87)\",\"secondary\":\"rgba(0, 0, 0, 0.54)\",\"disabled\":\"rgba(0, 0, 0, 0.38)\",\"dividers\":\"rgba(0, 0, 0, 0.12)\"};\nexport var lightText = {\"primary\":\"rgba(255, 255, 255, 1)\",\"secondary\":\"rgba(255, 255, 255, 0.7)\",\"disabled\":\"rgba(255, 255, 255, 0.5)\",\"dividers\":\"rgba(255, 255, 255, 0.12)\"};\nexport var darkIcons = {\"active\":\"rgba(0, 0, 0, 0.54)\",\"inactive\":\"rgba(0, 0, 0, 0.38)\"};\nexport var lightIcons = {\"active\":\"rgba(255, 255, 255, 1)\",\"inactive\":\"rgba(255, 255, 255, 0.5)\"};\nexport var white = \"#ffffff\";\nexport var black = \"#000000\";\n\nexport default {\n  red: red,\n  pink: pink,\n  purple: purple,\n  deepPurple: deepPurple,\n  indigo: indigo,\n  blue: blue,\n  lightBlue: lightBlue,\n  cyan: cyan,\n  teal: teal,\n  green: green,\n  lightGreen: lightGreen,\n  lime: lime,\n  yellow: yellow,\n  amber: amber,\n  orange: orange,\n  deepOrange: deepOrange,\n  brown: brown,\n  grey: grey,\n  blueGrey: blueGrey,\n  darkText: darkText,\n  lightText: lightText,\n  darkIcons: darkIcons,\n  lightIcons: lightIcons,\n  white: white,\n  black: black\n};\n","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var CircleSwatch = function CircleSwatch(_ref) {\n  var color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      hover = _ref.hover,\n      active = _ref.active,\n      circleSize = _ref.circleSize,\n      circleSpacing = _ref.circleSpacing;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: circleSize,\n        height: circleSize,\n        marginRight: circleSpacing,\n        marginBottom: circleSpacing,\n        transform: 'scale(1)',\n        transition: '100ms transform ease'\n      },\n      Swatch: {\n        borderRadius: '50%',\n        background: 'transparent',\n        boxShadow: 'inset 0 0 0 ' + (circleSize / 2 + 1) + 'px ' + color,\n        transition: '100ms box-shadow ease'\n      }\n    },\n    'hover': {\n      swatch: {\n        transform: 'scale(1.2)'\n      }\n    },\n    'active': {\n      Swatch: {\n        boxShadow: 'inset 0 0 0 3px ' + color\n      }\n    }\n  }, { hover: hover, active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      style: styles.Swatch,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: styles.Swatch.boxShadow + ', 0 0 5px ' + color }\n    })\n  );\n};\n\nCircleSwatch.defaultProps = {\n  circleSize: 28,\n  circleSpacing: 14\n};\n\nexport default handleHover(CircleSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap } from '../common';\nimport CircleSwatch from './CircleSwatch';\n\nexport var Circle = function Circle(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      circleSize = _ref.circleSize,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      circleSpacing = _ref.circleSpacing,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        display: 'flex',\n        flexWrap: 'wrap',\n        marginRight: -circleSpacing,\n        marginBottom: -circleSpacing\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(hexCode, e) {\n    return onChange({ hex: hexCode, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'circle-picker ' + className },\n    map(colors, function (c) {\n      return React.createElement(CircleSwatch, {\n        key: c,\n        color: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover,\n        active: hex === c.toLowerCase(),\n        circleSize: circleSize,\n        circleSpacing: circleSpacing\n      });\n    })\n  );\n};\n\nCircle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  circleSize: PropTypes.number,\n  circleSpacing: PropTypes.number,\n  styles: PropTypes.object\n};\n\nCircle.defaultProps = {\n  width: 252,\n  circleSize: 28,\n  circleSpacing: 14,\n  colors: [material.red['500'], material.pink['500'], material.purple['500'], material.deepPurple['500'], material.indigo['500'], material.blue['500'], material.lightBlue['500'], material.cyan['500'], material.teal['500'], material.green['500'], material.lightGreen['500'], material.lime['500'], material.yellow['500'], material.amber['500'], material.orange['500'], material.deepOrange['500'], material.brown['500'], material.blueGrey['500']],\n  styles: {}\n};\n\nexport default ColorWrap(Circle);","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable react/no-did-mount-set-state, no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport isUndefined from 'lodash-es/isUndefined';\n\nimport { EditableInput } from '../common';\nimport UnfoldMoreHorizontalIcon from '@icons/material/UnfoldMoreHorizontalIcon';\n\nexport var ChromeFields = function (_React$Component) {\n  _inherits(ChromeFields, _React$Component);\n\n  function ChromeFields(props) {\n    _classCallCheck(this, ChromeFields);\n\n    var _this = _possibleConstructorReturn(this, (ChromeFields.__proto__ || Object.getPrototypeOf(ChromeFields)).call(this));\n\n    _this.toggleViews = function () {\n      if (_this.state.view === 'hex') {\n        _this.setState({ view: 'rgb' });\n      } else if (_this.state.view === 'rgb') {\n        _this.setState({ view: 'hsl' });\n      } else if (_this.state.view === 'hsl') {\n        if (_this.props.hsl.a === 1) {\n          _this.setState({ view: 'hex' });\n        } else {\n          _this.setState({ view: 'rgb' });\n        }\n      }\n    };\n\n    _this.handleChange = function (data, e) {\n      if (data.hex) {\n        color.isValidHex(data.hex) && _this.props.onChange({\n          hex: data.hex,\n          source: 'hex'\n        }, e);\n      } else if (data.r || data.g || data.b) {\n        _this.props.onChange({\n          r: data.r || _this.props.rgb.r,\n          g: data.g || _this.props.rgb.g,\n          b: data.b || _this.props.rgb.b,\n          source: 'rgb'\n        }, e);\n      } else if (data.a) {\n        if (data.a < 0) {\n          data.a = 0;\n        } else if (data.a > 1) {\n          data.a = 1;\n        }\n\n        _this.props.onChange({\n          h: _this.props.hsl.h,\n          s: _this.props.hsl.s,\n          l: _this.props.hsl.l,\n          a: Math.round(data.a * 100) / 100,\n          source: 'rgb'\n        }, e);\n      } else if (data.h || data.s || data.l) {\n        // Remove any occurances of '%'.\n        if (typeof data.s === 'string' && data.s.includes('%')) {\n          data.s = data.s.replace('%', '');\n        }\n        if (typeof data.l === 'string' && data.l.includes('%')) {\n          data.l = data.l.replace('%', '');\n        }\n\n        // We store HSL as a unit interval so we need to override the 1 input to 0.01\n        if (data.s == 1) {\n          data.s = 0.01;\n        } else if (data.l == 1) {\n          data.l = 0.01;\n        }\n\n        _this.props.onChange({\n          h: data.h || _this.props.hsl.h,\n          s: Number(!isUndefined(data.s) ? data.s : _this.props.hsl.s),\n          l: Number(!isUndefined(data.l) ? data.l : _this.props.hsl.l),\n          source: 'hsl'\n        }, e);\n      }\n    };\n\n    _this.showHighlight = function (e) {\n      e.currentTarget.style.background = '#eee';\n    };\n\n    _this.hideHighlight = function (e) {\n      e.currentTarget.style.background = 'transparent';\n    };\n\n    if (props.hsl.a !== 1 && props.view === \"hex\") {\n      _this.state = {\n        view: \"rgb\"\n      };\n    } else {\n      _this.state = {\n        view: props.view\n      };\n    }\n    return _this;\n  }\n\n  _createClass(ChromeFields, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            paddingTop: '16px',\n            display: 'flex'\n          },\n          fields: {\n            flex: '1',\n            display: 'flex',\n            marginLeft: '-6px'\n          },\n          field: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          alpha: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          toggle: {\n            width: '32px',\n            textAlign: 'right',\n            position: 'relative'\n          },\n          icon: {\n            marginRight: '-4px',\n            marginTop: '12px',\n            cursor: 'pointer',\n            position: 'relative'\n          },\n          iconHighlight: {\n            position: 'absolute',\n            width: '24px',\n            height: '28px',\n            background: '#eee',\n            borderRadius: '4px',\n            top: '10px',\n            left: '12px',\n            display: 'none'\n          },\n          input: {\n            fontSize: '11px',\n            color: '#333',\n            width: '100%',\n            borderRadius: '2px',\n            border: 'none',\n            boxShadow: 'inset 0 0 0 1px #dadada',\n            height: '21px',\n            textAlign: 'center'\n          },\n          label: {\n            textTransform: 'uppercase',\n            fontSize: '11px',\n            lineHeight: '11px',\n            color: '#969696',\n            textAlign: 'center',\n            display: 'block',\n            marginTop: '12px'\n          },\n          svg: {\n            fill: '#333',\n            width: '24px',\n            height: '24px',\n            border: '1px transparent solid',\n            borderRadius: '5px'\n          }\n        },\n        'disableAlpha': {\n          alpha: {\n            display: 'none'\n          }\n        }\n      }, this.props, this.state);\n\n      var fields = void 0;\n      if (this.state.view === 'hex') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'hex', value: this.props.hex,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'rgb') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'r',\n              value: this.props.rgb.r,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'g',\n              value: this.props.rgb.g,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'b',\n              value: this.props.rgb.b,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.rgb.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'hsl') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'h',\n              value: Math.round(this.props.hsl.h),\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 's',\n              value: Math.round(this.props.hsl.s * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'l',\n              value: Math.round(this.props.hsl.l * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.hsl.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      }\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap, className: 'flexbox-fix' },\n        fields,\n        React.createElement(\n          'div',\n          { style: styles.toggle },\n          React.createElement(\n            'div',\n            { style: styles.icon, onClick: this.toggleViews, ref: function ref(icon) {\n                return _this2.icon = icon;\n              } },\n            React.createElement(UnfoldMoreHorizontalIcon, {\n              style: styles.svg,\n              onMouseOver: this.showHighlight,\n              onMouseEnter: this.showHighlight,\n              onMouseOut: this.hideHighlight\n            })\n          )\n        )\n      );\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, state) {\n      if (nextProps.hsl.a !== 1 && state.view === 'hex') {\n        return { view: 'rgb' };\n      }\n      return null;\n    }\n  }]);\n\n  return ChromeFields;\n}(React.Component);\n\nChromeFields.defaultProps = {\n  view: \"hex\"\n};\n\nexport default ChromeFields;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointer = function ChromePointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        transform: 'translate(-6px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointerCircle = function ChromePointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointerCircle;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport ChromeFields from './ChromeFields';\nimport ChromePointer from './ChromePointer';\nimport ChromePointerCircle from './ChromePointerCircle';\n\nexport var Chrome = function Chrome(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      disableAlpha = _ref.disableAlpha,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className,\n      defaultView = _ref.defaultView;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        borderRadius: '2px',\n        boxShadow: '0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)',\n        boxSizing: 'initial',\n        fontFamily: 'Menlo'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '55%',\n        position: 'relative',\n        borderRadius: '2px 2px 0 0',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '2px 2px 0 0'\n      },\n      body: {\n        padding: '16px 16px 12px'\n      },\n      controls: {\n        display: 'flex'\n      },\n      color: {\n        width: '32px'\n      },\n      swatch: {\n        marginTop: '6px',\n        width: '16px',\n        height: '16px',\n        borderRadius: '8px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      active: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '8px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.1)',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + rgb.a + ')',\n        zIndex: '2'\n      },\n      toggles: {\n        flex: '1'\n      },\n      hue: {\n        height: '10px',\n        position: 'relative',\n        marginBottom: '8px'\n      },\n      Hue: {\n        radius: '2px'\n      },\n      alpha: {\n        height: '10px',\n        position: 'relative'\n      },\n      Alpha: {\n        radius: '2px'\n      }\n    },\n    'disableAlpha': {\n      color: {\n        width: '22px'\n      },\n      alpha: {\n        display: 'none'\n      },\n      hue: {\n        marginBottom: '0px'\n      },\n      swatch: {\n        width: '10px',\n        height: '10px',\n        marginTop: '0px'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'chrome-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        pointer: ChromePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.color },\n          React.createElement(\n            'div',\n            { style: styles.swatch },\n            React.createElement('div', { style: styles.active }),\n            React.createElement(Checkboard, { renderers: renderers })\n          )\n        ),\n        React.createElement(\n          'div',\n          { style: styles.toggles },\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              style: styles.Hue,\n              hsl: hsl,\n              pointer: ChromePointer,\n              onChange: onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(Alpha, {\n              style: styles.Alpha,\n              rgb: rgb,\n              hsl: hsl,\n              pointer: ChromePointer,\n              renderers: renderers,\n              onChange: onChange\n            })\n          )\n        )\n      ),\n      React.createElement(ChromeFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        view: defaultView,\n        onChange: onChange,\n        disableAlpha: disableAlpha\n      })\n    )\n  );\n};\n\nChrome.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  disableAlpha: PropTypes.bool,\n  styles: PropTypes.object,\n  defaultView: PropTypes.oneOf([\"hex\", \"rgb\", \"hsl\"])\n};\n\nChrome.defaultProps = {\n  width: 225,\n  disableAlpha: false,\n  styles: {}\n};\n\nexport default ColorWrap(Chrome);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\n\nexport var CompactColor = function CompactColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        background: color,\n        width: '15px',\n        height: '15px',\n        float: 'left',\n        marginRight: '5px',\n        marginBottom: '5px',\n        position: 'relative',\n        cursor: 'pointer'\n      },\n      dot: {\n        absolute: '5px 5px 5px 5px',\n        background: colorUtils.getContrastingColor(color),\n        borderRadius: '50%',\n        opacity: '0'\n      }\n    },\n    'active': {\n      dot: {\n        opacity: '1'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      dot: {\n        background: '#000'\n      }\n    },\n    'transparent': {\n      dot: {\n        background: '#000'\n      }\n    }\n  }, { active: active, 'color-#FFFFFF': color === '#FFFFFF', 'transparent': color === 'transparent' });\n\n  return React.createElement(\n    Swatch,\n    {\n      style: styles.color,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement('div', { style: styles.dot })\n  );\n};\n\nexport default CompactColor;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { EditableInput } from '../common';\n\nexport var CompactFields = function CompactFields(_ref) {\n  var hex = _ref.hex,\n      rgb = _ref.rgb,\n      onChange = _ref.onChange;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingBottom: '6px',\n        paddingRight: '5px',\n        position: 'relative'\n      },\n      active: {\n        position: 'absolute',\n        top: '6px',\n        left: '5px',\n        height: '9px',\n        width: '9px',\n        background: hex\n      },\n      HEXwrap: {\n        flex: '6',\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '80%',\n        padding: '0px',\n        paddingLeft: '20%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      HEXlabel: {\n        display: 'none'\n      },\n      RGBwrap: {\n        flex: '3',\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '70%',\n        padding: '0px',\n        paddingLeft: '30%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '3px',\n        left: '0px',\n        lineHeight: '16px',\n        textTransform: 'uppercase',\n        fontSize: '12px',\n        color: '#999'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else {\n      onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement('div', { style: styles.active }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: 'hex',\n      value: hex,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    })\n  );\n};\n\nexport default CompactFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, Raised } from '../common';\nimport CompactColor from './CompactColor';\nimport CompactFields from './CompactFields';\n\nexport var Compact = function Compact(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      Compact: {\n        background: '#f6f6f6',\n        radius: '4px'\n      },\n      compact: {\n        paddingTop: '5px',\n        paddingLeft: '5px',\n        boxSizing: 'initial',\n        width: '240px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else {\n      onChange(data, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { style: styles.Compact, styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.compact, className: 'compact-picker ' + className },\n      React.createElement(\n        'div',\n        null,\n        map(colors, function (c) {\n          return React.createElement(CompactColor, {\n            key: c,\n            color: c,\n            active: c.toLowerCase() === hex,\n            onClick: handleChange,\n            onSwatchHover: onSwatchHover\n          });\n        }),\n        React.createElement('div', { style: styles.clear })\n      ),\n      React.createElement(CompactFields, { hex: hex, rgb: rgb, onChange: handleChange })\n    )\n  );\n};\n\nCompact.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nCompact.defaultProps = {\n  colors: ['#4D4D4D', '#999999', '#FFFFFF', '#F44E3B', '#FE9200', '#FCDC00', '#DBDF00', '#A4DD00', '#68CCCA', '#73D8FF', '#AEA1FF', '#FDA1FF', '#333333', '#808080', '#cccccc', '#D33115', '#E27300', '#FCC400', '#B0BC00', '#68BC00', '#16A5A5', '#009CE0', '#7B64FF', '#FA28FF', '#000000', '#666666', '#B3B3B3', '#9F0500', '#C45100', '#FB9E00', '#808900', '#194D33', '#0C797D', '#0062B1', '#653294', '#AB149E'],\n  styles: {}\n};\n\nexport default ColorWrap(Compact);","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var GithubSwatch = function GithubSwatch(_ref) {\n  var hover = _ref.hover,\n      color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var hoverSwatch = {\n    position: 'relative',\n    zIndex: '2',\n    outline: '2px solid #fff',\n    boxShadow: '0 0 5px 2px rgba(0,0,0,0.25)'\n  };\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: '25px',\n        height: '25px',\n        fontSize: '0'\n      }\n    },\n    'hover': {\n      swatch: hoverSwatch\n    }\n  }, { hover: hover });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: hoverSwatch\n    })\n  );\n};\n\nexport default handleHover(GithubSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap } from '../common';\nimport GithubSwatch from './GithubSwatch';\n\nexport var Github = function Github(_ref) {\n  var width = _ref.width,\n      colors = _ref.colors,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '1px solid rgba(0,0,0,0.2)',\n        boxShadow: '0 3px 12px rgba(0,0,0,0.15)',\n        borderRadius: '4px',\n        position: 'relative',\n        padding: '5px',\n        display: 'flex',\n        flexWrap: 'wrap'\n      },\n      triangle: {\n        position: 'absolute',\n        border: '7px solid transparent',\n        borderBottomColor: '#fff'\n      },\n      triangleShadow: {\n        position: 'absolute',\n        border: '8px solid transparent',\n        borderBottomColor: 'rgba(0,0,0,0.15)'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-14px',\n        left: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        left: '9px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-14px',\n        right: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        right: '9px'\n      }\n    },\n    'bottom-left-triangle': {\n      triangle: {\n        top: '35px',\n        left: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        left: '9px',\n        transform: 'rotate(180deg)'\n      }\n    },\n    'bottom-right-triangle': {\n      triangle: {\n        top: '35px',\n        right: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        right: '9px',\n        transform: 'rotate(180deg)'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right',\n    'bottom-left-triangle': triangle === 'bottom-left',\n    'bottom-right-triangle': triangle === 'bottom-right'\n  });\n\n  var handleChange = function handleChange(hex, e) {\n    return onChange({ hex: hex, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'github-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    map(colors, function (c) {\n      return React.createElement(GithubSwatch, {\n        color: c,\n        key: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nGithub.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right', 'bottom-left', 'bottom-right']),\n  styles: PropTypes.object\n};\n\nGithub.defaultProps = {\n  width: 200,\n  colors: ['#B80000', '#DB3E00', '#FCCB00', '#008B02', '#006B76', '#1273DE', '#004DCF', '#5300EB', '#EB9694', '#FAD0C3', '#FEF3BD', '#C1E1C5', '#BEDADC', '#C4DEF6', '#BED3F3', '#D4C4FB'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Github);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport HuePointer from './HuePointer';\n\nexport var HuePicker = function HuePicker(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      hsl = _ref.hsl,\n      direction = _ref.direction,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  // Overwrite to provide pure hue color\n  var handleChange = function handleChange(data) {\n    return onChange({ a: 1, h: data.h, l: 0.5, s: 1 });\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'hue-picker ' + className },\n    React.createElement(Hue, _extends({}, styles.hue, {\n      hsl: hsl,\n      pointer: pointer,\n      onChange: handleChange,\n      direction: direction\n    }))\n  );\n};\n\nHuePicker.propTypes = {\n  styles: PropTypes.object\n};\nHuePicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: HuePointer,\n  styles: {}\n};\n\nexport default ColorWrap(HuePicker);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Raised } from '../common';\n\nexport var Material = function Material(_ref) {\n  var onChange = _ref.onChange,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      material: {\n        width: '98px',\n        height: '98px',\n        padding: '16px',\n        fontFamily: 'Roboto'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '2px solid ' + hex,\n        outline: 'none',\n        height: '30px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      Hex: {\n        style: {}\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '1px solid #eee',\n        outline: 'none',\n        height: '30px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      split: {\n        display: 'flex',\n        marginRight: '-10px',\n        paddingTop: '11px'\n      },\n      third: {\n        flex: '1',\n        paddingRight: '10px'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.material, className: 'material-picker ' + className },\n      React.createElement(EditableInput, {\n        style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n        label: 'hex',\n        value: hex,\n        onChange: handleChange\n      }),\n      React.createElement(\n        'div',\n        { style: styles.split, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'r', value: rgb.r,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'g',\n            value: rgb.g,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'b',\n            value: rgb.b,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default ColorWrap(Material);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var PhotoshopPicker = function PhotoshopPicker(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsv = _ref.hsv,\n      hex = _ref.hex;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        paddingTop: '5px',\n        paddingBottom: '9px',\n        width: '80px',\n        position: 'relative'\n      },\n      divider: {\n        height: '5px'\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        marginLeft: '40%',\n        width: '40%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '5px',\n        fontSize: '13px',\n        paddingLeft: '3px',\n        marginRight: '10px'\n      },\n      RGBlabel: {\n        left: '0px',\n        top: '0px',\n        width: '34px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px',\n        position: 'absolute'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        marginLeft: '20%',\n        width: '80%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '6px',\n        fontSize: '13px',\n        paddingLeft: '3px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        width: '14px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px'\n      },\n      fieldSymbols: {\n        position: 'absolute',\n        top: '5px',\n        right: '-7px',\n        fontSize: '13px'\n      },\n      symbol: {\n        height: '20px',\n        lineHeight: '22px',\n        paddingBottom: '7px'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data['#']) {\n      color.isValidHex(data['#']) && onChange({\n        hex: data['#'],\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else if (data.h || data.s || data.v) {\n      onChange({\n        h: data.h || hsv.h,\n        s: data.s || hsv.s,\n        v: data.v || hsv.v,\n        source: 'hsv'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields },\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'h',\n      value: Math.round(hsv.h),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 's',\n      value: Math.round(hsv.s * 100),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'v',\n      value: Math.round(hsv.v * 100),\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: '#',\n      value: hex.replace('#', ''),\n      onChange: handleChange\n    }),\n    React.createElement(\n      'div',\n      { style: styles.fieldSymbols },\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '\\xB0'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      )\n    )\n  );\n};\n\nexport default PhotoshopPicker;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle(_ref) {\n  var hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    },\n    'black-outline': {\n      picker: {\n        boxShadow: 'inset 0 0 0 1px #000'\n      }\n    }\n  }, { 'black-outline': hsl.l > 0.5 });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      triangle: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '4px 0 4px 6px',\n        borderColor: 'transparent transparent transparent #fff',\n        position: 'absolute',\n        top: '1px',\n        left: '1px'\n      },\n      triangleBorder: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '5px 0 5px 8px',\n        borderColor: 'transparent transparent transparent #555'\n      },\n\n      left: {\n        Extend: 'triangleBorder',\n        transform: 'translate(-13px, -4px)'\n      },\n      leftInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      },\n\n      right: {\n        Extend: 'triangleBorder',\n        transform: 'translate(20px, -14px) rotate(180deg)'\n      },\n      rightInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.pointer },\n    React.createElement(\n      'div',\n      { style: styles.left },\n      React.createElement('div', { style: styles.leftInside })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.right },\n      React.createElement('div', { style: styles.rightInside })\n    )\n  );\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopButton = function PhotoshopButton(_ref) {\n  var onClick = _ref.onClick,\n      label = _ref.label,\n      children = _ref.children,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      button: {\n        backgroundImage: 'linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)',\n        border: '1px solid #878787',\n        borderRadius: '2px',\n        height: '20px',\n        boxShadow: '0 1px 0 0 #EAEAEA',\n        fontSize: '14px',\n        color: '#000',\n        lineHeight: '20px',\n        textAlign: 'center',\n        marginBottom: '10px',\n        cursor: 'pointer'\n      }\n    },\n    'active': {\n      button: {\n        boxShadow: '0 0 0 1px #878787'\n      }\n    }\n  }, { active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.button, onClick: onClick },\n    label || children\n  );\n};\n\nexport default PhotoshopButton;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPreviews = function PhotoshopPreviews(_ref) {\n  var rgb = _ref.rgb,\n      currentColor = _ref.currentColor;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        border: '1px solid #B3B3B3',\n        borderBottom: '1px solid #F0F0F0',\n        marginBottom: '2px',\n        marginTop: '1px'\n      },\n      new: {\n        height: '34px',\n        background: 'rgb(' + rgb.r + ',' + rgb.g + ', ' + rgb.b + ')',\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000'\n      },\n      current: {\n        height: '34px',\n        background: currentColor,\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000'\n      },\n      label: {\n        fontSize: '14px',\n        color: '#000',\n        textAlign: 'center'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    null,\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'new'\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement('div', { style: styles.new }),\n      React.createElement('div', { style: styles.current })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'current'\n    )\n  );\n};\n\nexport default PhotoshopPreviews;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport PhotoshopFields from './PhotoshopFields';\nimport PhotoshopPointerCircle from './PhotoshopPointerCircle';\nimport PhotoshopPointer from './PhotoshopPointer';\nimport PhotoshopButton from './PhotoshopButton';\nimport PhotoshopPreviews from './PhotoshopPreviews';\n\nexport var Photoshop = function (_React$Component) {\n  _inherits(Photoshop, _React$Component);\n\n  function Photoshop(props) {\n    _classCallCheck(this, Photoshop);\n\n    var _this = _possibleConstructorReturn(this, (Photoshop.__proto__ || Object.getPrototypeOf(Photoshop)).call(this));\n\n    _this.state = {\n      currentColor: props.hex\n    };\n    return _this;\n  }\n\n  _createClass(Photoshop, [{\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          _props$styles = _props.styles,\n          passedStyles = _props$styles === undefined ? {} : _props$styles,\n          _props$className = _props.className,\n          className = _props$className === undefined ? '' : _props$className;\n\n      var styles = reactCSS(merge({\n        'default': {\n          picker: {\n            background: '#DCDCDC',\n            borderRadius: '4px',\n            boxShadow: '0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)',\n            boxSizing: 'initial',\n            width: '513px'\n          },\n          head: {\n            backgroundImage: 'linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)',\n            borderBottom: '1px solid #B1B1B1',\n            boxShadow: 'inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)',\n            height: '23px',\n            lineHeight: '24px',\n            borderRadius: '4px 4px 0 0',\n            fontSize: '13px',\n            color: '#4D4D4D',\n            textAlign: 'center'\n          },\n          body: {\n            padding: '15px 15px 0',\n            display: 'flex'\n          },\n          saturation: {\n            width: '256px',\n            height: '256px',\n            position: 'relative',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0',\n            overflow: 'hidden'\n          },\n          hue: {\n            position: 'relative',\n            height: '256px',\n            width: '19px',\n            marginLeft: '10px',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0'\n          },\n          controls: {\n            width: '180px',\n            marginLeft: '10px'\n          },\n          top: {\n            display: 'flex'\n          },\n          previews: {\n            width: '60px'\n          },\n          actions: {\n            flex: '1',\n            marginLeft: '20px'\n          }\n        }\n      }, passedStyles));\n\n      return React.createElement(\n        'div',\n        { style: styles.picker, className: 'photoshop-picker ' + className },\n        React.createElement(\n          'div',\n          { style: styles.head },\n          this.props.header\n        ),\n        React.createElement(\n          'div',\n          { style: styles.body, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.saturation },\n            React.createElement(Saturation, {\n              hsl: this.props.hsl,\n              hsv: this.props.hsv,\n              pointer: PhotoshopPointerCircle,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              direction: 'vertical',\n              hsl: this.props.hsl,\n              pointer: PhotoshopPointer,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.controls },\n            React.createElement(\n              'div',\n              { style: styles.top, className: 'flexbox-fix' },\n              React.createElement(\n                'div',\n                { style: styles.previews },\n                React.createElement(PhotoshopPreviews, {\n                  rgb: this.props.rgb,\n                  currentColor: this.state.currentColor\n                })\n              ),\n              React.createElement(\n                'div',\n                { style: styles.actions },\n                React.createElement(PhotoshopButton, { label: 'OK', onClick: this.props.onAccept, active: true }),\n                React.createElement(PhotoshopButton, { label: 'Cancel', onClick: this.props.onCancel }),\n                React.createElement(PhotoshopFields, {\n                  onChange: this.props.onChange,\n                  rgb: this.props.rgb,\n                  hsv: this.props.hsv,\n                  hex: this.props.hex\n                })\n              )\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return Photoshop;\n}(React.Component);\n\nPhotoshop.propTypes = {\n  header: PropTypes.string,\n  styles: PropTypes.object\n};\n\nPhotoshop.defaultProps = {\n  header: 'Color Picker',\n  styles: {}\n};\n\nexport default ColorWrap(Photoshop);","/* eslint-disable no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var SketchFields = function SketchFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      disableAlpha = _ref.disableAlpha;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingTop: '4px'\n      },\n      single: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      alpha: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      double: {\n        flex: '2'\n      },\n      input: {\n        width: '80%',\n        padding: '4px 10% 3px',\n        border: 'none',\n        boxShadow: 'inset 0 0 0 1px #ccc',\n        fontSize: '11px'\n      },\n      label: {\n        display: 'block',\n        textAlign: 'center',\n        fontSize: '11px',\n        color: '#222',\n        paddingTop: '3px',\n        paddingBottom: '4px',\n        textTransform: 'capitalize'\n      }\n    },\n    'disableAlpha': {\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, { disableAlpha: disableAlpha });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        a: rgb.a,\n        source: 'rgb'\n      }, e);\n    } else if (data.a) {\n      if (data.a < 0) {\n        data.a = 0;\n      } else if (data.a > 100) {\n        data.a = 100;\n      }\n\n      data.a /= 100;\n      onChange({\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: data.a,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.double },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'hex',\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'r',\n        value: rgb.r,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'g',\n        value: rgb.g,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'b',\n        value: rgb.b,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.alpha },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'a',\n        value: Math.round(rgb.a * 100),\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '100'\n      })\n    )\n  );\n};\n\nexport default SketchFields;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var SketchPresetColors = function SketchPresetColors(_ref) {\n  var colors = _ref.colors,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      colors: {\n        margin: '0 -10px',\n        padding: '10px 0 0 10px',\n        borderTop: '1px solid #eee',\n        display: 'flex',\n        flexWrap: 'wrap',\n        position: 'relative'\n      },\n      swatchWrap: {\n        width: '16px',\n        height: '16px',\n        margin: '0 10px 10px 0'\n      },\n      swatch: {\n        borderRadius: '3px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15)'\n      }\n    },\n    'no-presets': {\n      colors: {\n        display: 'none'\n      }\n    }\n  }, {\n    'no-presets': !colors || !colors.length\n  });\n\n  var handleClick = function handleClick(hex, e) {\n    onClick({\n      hex: hex,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.colors, className: 'flexbox-fix' },\n    colors.map(function (colorObjOrString) {\n      var c = typeof colorObjOrString === 'string' ? { color: colorObjOrString } : colorObjOrString;\n      var key = '' + c.color + (c.title || '');\n      return React.createElement(\n        'div',\n        { key: key, style: styles.swatchWrap },\n        React.createElement(Swatch, _extends({}, c, {\n          style: styles.swatch,\n          onClick: handleClick,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px ' + c.color\n          }\n        }))\n      );\n    })\n  );\n};\n\nSketchPresetColors.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n    color: PropTypes.string,\n    title: PropTypes.string\n  })])).isRequired\n};\n\nexport default SketchPresetColors;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport SketchFields from './SketchFields';\nimport SketchPresetColors from './SketchPresetColors';\n\nexport var Sketch = function Sketch(_ref) {\n  var width = _ref.width,\n      rgb = _ref.rgb,\n      hex = _ref.hex,\n      hsv = _ref.hsv,\n      hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      disableAlpha = _ref.disableAlpha,\n      presetColors = _ref.presetColors,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': _extends({\n      picker: {\n        width: width,\n        padding: '10px 10px 0',\n        boxSizing: 'initial',\n        background: '#fff',\n        borderRadius: '4px',\n        boxShadow: '0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '75%',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '3px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      controls: {\n        display: 'flex'\n      },\n      sliders: {\n        padding: '4px 0',\n        flex: '1'\n      },\n      color: {\n        width: '24px',\n        height: '24px',\n        position: 'relative',\n        marginTop: '4px',\n        marginLeft: '4px',\n        borderRadius: '3px'\n      },\n      activeColor: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '2px',\n        background: 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + rgb.a + ')',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      hue: {\n        position: 'relative',\n        height: '10px',\n        overflow: 'hidden'\n      },\n      Hue: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n\n      alpha: {\n        position: 'relative',\n        height: '10px',\n        marginTop: '4px',\n        overflow: 'hidden'\n      },\n      Alpha: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      }\n    }, passedStyles),\n    'disableAlpha': {\n      color: {\n        height: '10px'\n      },\n      hue: {\n        height: '10px'\n      },\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'sketch-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.controls, className: 'flexbox-fix' },\n      React.createElement(\n        'div',\n        { style: styles.sliders },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            onChange: onChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.alpha },\n          React.createElement(Alpha, {\n            style: styles.Alpha,\n            rgb: rgb,\n            hsl: hsl,\n            renderers: renderers,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(\n        'div',\n        { style: styles.color },\n        React.createElement(Checkboard, null),\n        React.createElement('div', { style: styles.activeColor })\n      )\n    ),\n    React.createElement(SketchFields, {\n      rgb: rgb,\n      hsl: hsl,\n      hex: hex,\n      onChange: onChange,\n      disableAlpha: disableAlpha\n    }),\n    React.createElement(SketchPresetColors, {\n      colors: presetColors,\n      onClick: onChange,\n      onSwatchHover: onSwatchHover\n    })\n  );\n};\n\nSketch.propTypes = {\n  disableAlpha: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object\n};\n\nSketch.defaultProps = {\n  disableAlpha: false,\n  width: 200,\n  styles: {},\n  presetColors: ['#D0021B', '#F5A623', '#F8E71C', '#8B572A', '#7ED321', '#417505', '#BD10E0', '#9013FE', '#4A90E2', '#50E3C2', '#B8E986', '#000000', '#4A4A4A', '#9B9B9B', '#FFFFFF']\n};\n\nexport default ColorWrap(Sketch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderSwatch = function SliderSwatch(_ref) {\n  var hsl = _ref.hsl,\n      offset = _ref.offset,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      active = _ref.active,\n      first = _ref.first,\n      last = _ref.last;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        height: '12px',\n        background: 'hsl(' + hsl.h + ', 50%, ' + offset * 100 + '%)',\n        cursor: 'pointer'\n      }\n    },\n    'first': {\n      swatch: {\n        borderRadius: '2px 0 0 2px'\n      }\n    },\n    'last': {\n      swatch: {\n        borderRadius: '0 2px 2px 0'\n      }\n    },\n    'active': {\n      swatch: {\n        transform: 'scaleY(1.8)',\n        borderRadius: '3.6px/2px'\n      }\n    }\n  }, { active: active, first: first, last: last });\n\n  var handleClick = function handleClick(e) {\n    return onClick({\n      h: hsl.h,\n      s: 0.5,\n      l: offset,\n      source: 'hsl'\n    }, e);\n  };\n\n  return React.createElement('div', { style: styles.swatch, onClick: handleClick });\n};\n\nexport default SliderSwatch;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport SliderSwatch from './SliderSwatch';\n\nexport var SliderSwatches = function SliderSwatches(_ref) {\n  var onClick = _ref.onClick,\n      hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginTop: '20px'\n      },\n      swatch: {\n        boxSizing: 'border-box',\n        width: '20%',\n        paddingRight: '1px',\n        float: 'left'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  // Acceptible difference in floating point equality\n  var epsilon = 0.1;\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.80',\n        active: Math.abs(hsl.l - 0.80) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        first: true\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.65',\n        active: Math.abs(hsl.l - 0.65) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.50',\n        active: Math.abs(hsl.l - 0.50) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.35',\n        active: Math.abs(hsl.l - 0.35) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.20',\n        active: Math.abs(hsl.l - 0.20) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        last: true\n      })\n    ),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default SliderSwatches;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '14px',\n        height: '14px',\n        borderRadius: '6px',\n        transform: 'translate(-7px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport SliderSwatches from './SliderSwatches';\nimport SliderPointer from './SliderPointer';\n\nexport var Slider = function Slider(_ref) {\n  var hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      hue: {\n        height: '12px',\n        position: 'relative'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap || {}, className: 'slider-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.hue },\n      React.createElement(Hue, {\n        style: styles.Hue,\n        hsl: hsl,\n        pointer: pointer,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement(SliderSwatches, { hsl: hsl, onClick: onChange })\n    )\n  );\n};\n\nSlider.propTypes = {\n  styles: PropTypes.object\n};\nSlider.defaultProps = {\n  pointer: SliderPointer,\n  styles: {}\n};\n\nexport default ColorWrap(Slider);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\nimport CheckIcon from '@icons/material/CheckIcon';\n\nexport var SwatchesColor = function SwatchesColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      first = _ref.first,\n      last = _ref.last,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        width: '40px',\n        height: '24px',\n        cursor: 'pointer',\n        background: color,\n        marginBottom: '1px'\n      },\n      check: {\n        color: colorUtils.getContrastingColor(color),\n        marginLeft: '8px',\n        display: 'none'\n      }\n    },\n    'first': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '2px 2px 0 0'\n      }\n    },\n    'last': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '0 0 2px 2px'\n      }\n    },\n    'active': {\n      check: {\n        display: 'block'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      check: {\n        color: '#333'\n      }\n    },\n    'transparent': {\n      check: {\n        color: '#333'\n      }\n    }\n  }, {\n    first: first,\n    last: last,\n    active: active,\n    'color-#FFFFFF': color === '#FFFFFF',\n    'transparent': color === 'transparent'\n  });\n\n  return React.createElement(\n    Swatch,\n    {\n      color: color,\n      style: styles.color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement(\n      'div',\n      { style: styles.check },\n      React.createElement(CheckIcon, null)\n    )\n  );\n};\n\nexport default SwatchesColor;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport SwatchesColor from './SwatchesColor';\n\nexport var SwatchesGroup = function SwatchesGroup(_ref) {\n  var onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      group = _ref.group,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      group: {\n        paddingBottom: '10px',\n        width: '40px',\n        float: 'left',\n        marginRight: '10px'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.group },\n    map(group, function (color, i) {\n      return React.createElement(SwatchesColor, {\n        key: color,\n        color: color,\n        active: color.toLowerCase() === active,\n        first: i === 0,\n        last: i === group.length - 1,\n        onClick: onClick,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nexport default SwatchesGroup;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap, Raised } from '../common';\nimport SwatchesGroup from './SwatchesGroup';\n\nexport var Swatches = function Swatches(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        height: height\n      },\n      overflow: {\n        height: height,\n        overflowY: 'scroll'\n      },\n      body: {\n        padding: '16px 0 6px 16px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    return onChange({ hex: data, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'swatches-picker ' + className },\n    React.createElement(\n      Raised,\n      null,\n      React.createElement(\n        'div',\n        { style: styles.overflow },\n        React.createElement(\n          'div',\n          { style: styles.body },\n          map(colors, function (group) {\n            return React.createElement(SwatchesGroup, {\n              key: group.toString(),\n              group: group,\n              active: hex,\n              onClick: handleChange,\n              onSwatchHover: onSwatchHover\n            });\n          }),\n          React.createElement('div', { style: styles.clear })\n        )\n      )\n    )\n  );\n};\n\nSwatches.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  styles: PropTypes.object\n\n  /* eslint-disable max-len */\n};Swatches.defaultProps = {\n  width: 320,\n  height: 240,\n  colors: [[material.red['900'], material.red['700'], material.red['500'], material.red['300'], material.red['100']], [material.pink['900'], material.pink['700'], material.pink['500'], material.pink['300'], material.pink['100']], [material.purple['900'], material.purple['700'], material.purple['500'], material.purple['300'], material.purple['100']], [material.deepPurple['900'], material.deepPurple['700'], material.deepPurple['500'], material.deepPurple['300'], material.deepPurple['100']], [material.indigo['900'], material.indigo['700'], material.indigo['500'], material.indigo['300'], material.indigo['100']], [material.blue['900'], material.blue['700'], material.blue['500'], material.blue['300'], material.blue['100']], [material.lightBlue['900'], material.lightBlue['700'], material.lightBlue['500'], material.lightBlue['300'], material.lightBlue['100']], [material.cyan['900'], material.cyan['700'], material.cyan['500'], material.cyan['300'], material.cyan['100']], [material.teal['900'], material.teal['700'], material.teal['500'], material.teal['300'], material.teal['100']], ['#194D33', material.green['700'], material.green['500'], material.green['300'], material.green['100']], [material.lightGreen['900'], material.lightGreen['700'], material.lightGreen['500'], material.lightGreen['300'], material.lightGreen['100']], [material.lime['900'], material.lime['700'], material.lime['500'], material.lime['300'], material.lime['100']], [material.yellow['900'], material.yellow['700'], material.yellow['500'], material.yellow['300'], material.yellow['100']], [material.amber['900'], material.amber['700'], material.amber['500'], material.amber['300'], material.amber['100']], [material.orange['900'], material.orange['700'], material.orange['500'], material.orange['300'], material.orange['100']], [material.deepOrange['900'], material.deepOrange['700'], material.deepOrange['500'], material.deepOrange['300'], material.deepOrange['100']], [material.brown['900'], material.brown['700'], material.brown['500'], material.brown['300'], material.brown['100']], [material.blueGrey['900'], material.blueGrey['700'], material.blueGrey['500'], material.blueGrey['300'], material.blueGrey['100']], ['#000000', '#525252', '#969696', '#D9D9D9', '#FFFFFF']],\n  styles: {}\n};\n\nexport default ColorWrap(Swatches);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Swatch } from '../common';\n\nexport var Twitter = function Twitter(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '0 solid rgba(0,0,0,0.25)',\n        boxShadow: '0 1px 4px rgba(0,0,0,0.25)',\n        borderRadius: '4px',\n        position: 'relative'\n      },\n      body: {\n        padding: '15px 9px 9px 15px'\n      },\n      label: {\n        fontSize: '18px',\n        color: '#fff'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent #fff transparent',\n        position: 'absolute'\n      },\n      triangleShadow: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent rgba(0,0,0,.1) transparent',\n        position: 'absolute'\n      },\n      hash: {\n        background: '#F0F0F0',\n        height: '30px',\n        width: '30px',\n        borderRadius: '4px 0 0 4px',\n        float: 'left',\n        color: '#98A1A4',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      input: {\n        width: '100px',\n        fontSize: '14px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '28px',\n        boxShadow: 'inset 0 0 0 1px #F0F0F0',\n        boxSizing: 'content-box',\n        borderRadius: '0 4px 4px 0',\n        float: 'left',\n        paddingLeft: '8px'\n      },\n      swatch: {\n        width: '30px',\n        height: '30px',\n        float: 'left',\n        borderRadius: '4px',\n        margin: '0 6px 6px 0'\n      },\n      clear: {\n        clear: 'both'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-10px',\n        left: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        left: '12px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-10px',\n        right: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        right: '12px'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right'\n  });\n\n  var handleChange = function handleChange(hexcode, e) {\n    color.isValidHex(hexcode) && onChange({\n      hex: hexcode,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'twitter-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      map(colors, function (c, i) {\n        return React.createElement(Swatch, {\n          key: i,\n          color: c,\n          hex: c,\n          style: styles.swatch,\n          onClick: handleChange,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: '0 0 4px ' + c\n          }\n        });\n      }),\n      React.createElement(\n        'div',\n        { style: styles.hash },\n        '#'\n      ),\n      React.createElement(EditableInput, {\n        label: null,\n        style: { input: styles.input },\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      }),\n      React.createElement('div', { style: styles.clear })\n    )\n  );\n};\n\nTwitter.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right']),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nTwitter.defaultProps = {\n  width: 276,\n  colors: ['#FF6900', '#FCB900', '#7BDCB5', '#00D084', '#8ED1FC', '#0693E3', '#ABB8C3', '#EB144C', '#F78DA7', '#9900EF'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Twitter);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointerCircle = function GooglePointerCircle(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        border: '2px #fff solid',\n        transform: 'translate(-12px, -13px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', ' + Math.round(props.hsl.s * 100) + '%, ' + Math.round(props.hsl.l * 100) + '%)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointerCircle.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointerCircle.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointer = function GooglePointer(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        transform: 'translate(-10px, -7px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', 100%, 50%)',\n        border: '2px white solid'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointer.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointer.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport { EditableInput } from '../common';\n\nexport var GoogleFields = function GoogleFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      hsv = _ref.hsv;\n\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.rgb) {\n      var values = data.rgb.split(',');\n      color.isvalidColorString(data.rgb, 'rgb') && onChange({\n        r: values[0],\n        g: values[1],\n        b: values[2],\n        a: 1,\n        source: 'rgb'\n      }, e);\n    } else if (data.hsv) {\n      var _values = data.hsv.split(',');\n      if (color.isvalidColorString(data.hsv, 'hsv')) {\n        _values[2] = _values[2].replace('%', '');\n        _values[1] = _values[1].replace('%', '');\n        _values[0] = _values[0].replace('', '');\n        if (_values[1] == 1) {\n          _values[1] = 0.01;\n        } else if (_values[2] == 1) {\n          _values[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values[0]),\n          s: Number(_values[1]),\n          v: Number(_values[2]),\n          source: 'hsv'\n        }, e);\n      }\n    } else if (data.hsl) {\n      var _values2 = data.hsl.split(',');\n      if (color.isvalidColorString(data.hsl, 'hsl')) {\n        _values2[2] = _values2[2].replace('%', '');\n        _values2[1] = _values2[1].replace('%', '');\n        _values2[0] = _values2[0].replace('', '');\n        if (hsvValue[1] == 1) {\n          hsvValue[1] = 0.01;\n        } else if (hsvValue[2] == 1) {\n          hsvValue[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values2[0]),\n          s: Number(_values2[1]),\n          v: Number(_values2[2]),\n          source: 'hsl'\n        }, e);\n      }\n    }\n  };\n\n  var styles = reactCSS({\n    'default': {\n      wrap: {\n        display: 'flex',\n        height: '100px',\n        marginTop: '4px'\n      },\n      fields: {\n        width: '100%'\n      },\n      column: {\n        paddingTop: '10px',\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      double: {\n        padding: '0px 4.4px',\n        boxSizing: 'border-box'\n      },\n      input: {\n        width: '100%',\n        height: '38px',\n        boxSizing: 'border-box',\n        padding: '4px 10% 3px',\n        textAlign: 'center',\n        border: '1px solid #dadce0',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      input2: {\n        height: '38px',\n        width: '100%',\n        border: '1px solid #dadce0',\n        boxSizing: 'border-box',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        paddingLeft: '10px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label: {\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '35px',\n        top: '-6px',\n        left: '0',\n        right: '0',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label2: {\n        left: '10px',\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '32px',\n        top: '-6px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      single: {\n        flexGrow: '1',\n        margin: '0px 4.4px'\n      }\n    }\n  });\n\n  var rgbValue = rgb.r + ', ' + rgb.g + ', ' + rgb.b;\n  var hslValue = Math.round(hsl.h) + '\\xB0, ' + Math.round(hsl.s * 100) + '%, ' + Math.round(hsl.l * 100) + '%';\n  var hsvValue = Math.round(hsv.h) + '\\xB0, ' + Math.round(hsv.s * 100) + '%, ' + Math.round(hsv.v * 100) + '%';\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.fields },\n      React.createElement(\n        'div',\n        { style: styles.double },\n        React.createElement(EditableInput, {\n          style: { input: styles.input, label: styles.label },\n          label: 'hex',\n          value: hex,\n          onChange: handleChange\n        })\n      ),\n      React.createElement(\n        'div',\n        { style: styles.column },\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'rgb',\n            value: rgbValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsv',\n            value: hsvValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsl',\n            value: hslValue,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default GoogleFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport GooglePointerCircle from './GooglePointerCircle';\nimport GooglePointer from './GooglePointer';\nimport GoogleFields from './GoogleFields';\n\nexport var Google = function Google(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      header = _ref.header,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        border: '1px solid #dfe1e5',\n        boxSizing: 'initial',\n        display: 'flex',\n        flexWrap: 'wrap',\n        borderRadius: '8px 8px 0px 0px'\n      },\n      head: {\n        height: '57px',\n        width: '100%',\n        paddingTop: '16px',\n        paddingBottom: '16px',\n        paddingLeft: '16px',\n        fontSize: '20px',\n        boxSizing: 'border-box',\n        fontFamily: 'Roboto-Regular,HelveticaNeue,Arial,sans-serif'\n      },\n      saturation: {\n        width: '70%',\n        padding: '0px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      swatch: {\n        width: '30%',\n        height: '228px',\n        padding: '0px',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', 1)',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      body: {\n        margin: 'auto',\n        width: '95%'\n      },\n      controls: {\n        display: 'flex',\n        boxSizing: 'border-box',\n        height: '52px',\n        paddingTop: '22px'\n      },\n      color: {\n        width: '32px'\n      },\n      hue: {\n        height: '8px',\n        position: 'relative',\n        margin: '0px 16px 0px 16px',\n        width: '100%'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'google-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.head },\n      header\n    ),\n    React.createElement('div', { style: styles.swatch }),\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        hsl: hsl,\n        hsv: hsv,\n        pointer: GooglePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            radius: '4px',\n            pointer: GooglePointer,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(GoogleFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        hsv: hsv,\n        onChange: onChange\n      })\n    )\n  );\n};\n\nGoogle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object,\n  header: PropTypes.string\n\n};\n\nGoogle.defaultProps = {\n  width: 652,\n  styles: {},\n  header: 'Color picker'\n};\n\nexport default ColorWrap(Google);","import _extends from '@babel/runtime/helpers/esm/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport memoizeOne from 'memoize-one';\nimport { createElement, PureComponent } from 'react';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\n\n// Animation frame based implementation of setTimeout.\n// Inspired by Joe Lambert, https://gist.github.com/joelambert/1002116#file-requesttimeout-js\nvar hasNativePerformanceNow = typeof performance === 'object' && typeof performance.now === 'function';\nvar now = hasNativePerformanceNow ? function () {\n  return performance.now();\n} : function () {\n  return Date.now();\n};\nfunction cancelTimeout(timeoutID) {\n  cancelAnimationFrame(timeoutID.id);\n}\nfunction requestTimeout(callback, delay) {\n  var start = now();\n\n  function tick() {\n    if (now() - start >= delay) {\n      callback.call(null);\n    } else {\n      timeoutID.id = requestAnimationFrame(tick);\n    }\n  }\n\n  var timeoutID = {\n    id: requestAnimationFrame(tick)\n  };\n  return timeoutID;\n}\n\nvar size = -1; // This utility copied from \"dom-helpers\" package.\n\nfunction getScrollbarSize(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (size === -1 || recalculate) {\n    var div = document.createElement('div');\n    var style = div.style;\n    style.width = '50px';\n    style.height = '50px';\n    style.overflow = 'scroll';\n    document.body.appendChild(div);\n    size = div.offsetWidth - div.clientWidth;\n    document.body.removeChild(div);\n  }\n\n  return size;\n}\nvar cachedRTLResult = null; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n// Chrome does not seem to adhere; its scrollLeft values are positive (measured relative to the left).\n// Safari's elastic bounce makes detecting this even more complicated wrt potential false positives.\n// The safest way to check this is to intentionally set a negative offset,\n// and then verify that the subsequent \"scroll\" event matches the negative offset.\n// If it does not match, then we can assume a non-standard RTL scroll implementation.\n\nfunction getRTLOffsetType(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (cachedRTLResult === null || recalculate) {\n    var outerDiv = document.createElement('div');\n    var outerStyle = outerDiv.style;\n    outerStyle.width = '50px';\n    outerStyle.height = '50px';\n    outerStyle.overflow = 'scroll';\n    outerStyle.direction = 'rtl';\n    var innerDiv = document.createElement('div');\n    var innerStyle = innerDiv.style;\n    innerStyle.width = '100px';\n    innerStyle.height = '100px';\n    outerDiv.appendChild(innerDiv);\n    document.body.appendChild(outerDiv);\n\n    if (outerDiv.scrollLeft > 0) {\n      cachedRTLResult = 'positive-descending';\n    } else {\n      outerDiv.scrollLeft = 1;\n\n      if (outerDiv.scrollLeft === 0) {\n        cachedRTLResult = 'negative';\n      } else {\n        cachedRTLResult = 'positive-ascending';\n      }\n    }\n\n    document.body.removeChild(outerDiv);\n    return cachedRTLResult;\n  }\n\n  return cachedRTLResult;\n}\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL = 150;\n\nvar defaultItemKey = function defaultItemKey(_ref) {\n  var columnIndex = _ref.columnIndex,\n      data = _ref.data,\n      rowIndex = _ref.rowIndex;\n  return rowIndex + \":\" + columnIndex;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsOverscanCount = null;\nvar devWarningsOverscanRowsColumnsCount = null;\nvar devWarningsTagName = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsOverscanCount = /*#__PURE__*/new WeakSet();\n    devWarningsOverscanRowsColumnsCount = /*#__PURE__*/new WeakSet();\n    devWarningsTagName = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createGridComponent(_ref2) {\n  var _class;\n\n  var getColumnOffset = _ref2.getColumnOffset,\n      getColumnStartIndexForOffset = _ref2.getColumnStartIndexForOffset,\n      getColumnStopIndexForStartIndex = _ref2.getColumnStopIndexForStartIndex,\n      getColumnWidth = _ref2.getColumnWidth,\n      getEstimatedTotalHeight = _ref2.getEstimatedTotalHeight,\n      getEstimatedTotalWidth = _ref2.getEstimatedTotalWidth,\n      getOffsetForColumnAndAlignment = _ref2.getOffsetForColumnAndAlignment,\n      getOffsetForRowAndAlignment = _ref2.getOffsetForRowAndAlignment,\n      getRowHeight = _ref2.getRowHeight,\n      getRowOffset = _ref2.getRowOffset,\n      getRowStartIndexForOffset = _ref2.getRowStartIndexForOffset,\n      getRowStopIndexForStartIndex = _ref2.getRowStopIndexForStartIndex,\n      initInstanceProps = _ref2.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref2.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref2.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(Grid, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function Grid(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._resetIsScrollingTimeoutId = null;\n      _this._outerRef = void 0;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        horizontalScrollDirection: 'forward',\n        scrollLeft: typeof _this.props.initialScrollLeft === 'number' ? _this.props.initialScrollLeft : 0,\n        scrollTop: typeof _this.props.initialScrollTop === 'number' ? _this.props.initialScrollTop : 0,\n        scrollUpdateWasRequested: false,\n        verticalScrollDirection: 'forward'\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanColumnStartIndex, overscanColumnStopIndex, overscanRowStartIndex, overscanRowStopIndex, visibleColumnStartIndex, visibleColumnStopIndex, visibleRowStartIndex, visibleRowStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanColumnStartIndex: overscanColumnStartIndex,\n          overscanColumnStopIndex: overscanColumnStopIndex,\n          overscanRowStartIndex: overscanRowStartIndex,\n          overscanRowStopIndex: overscanRowStopIndex,\n          visibleColumnStartIndex: visibleColumnStartIndex,\n          visibleColumnStopIndex: visibleColumnStopIndex,\n          visibleRowStartIndex: visibleRowStartIndex,\n          visibleRowStopIndex: visibleRowStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollLeft, scrollTop, horizontalScrollDirection, verticalScrollDirection, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          horizontalScrollDirection: horizontalScrollDirection,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          verticalScrollDirection: verticalScrollDirection,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (rowIndex, columnIndex) {\n        var _this$props = _this.props,\n            columnWidth = _this$props.columnWidth,\n            direction = _this$props.direction,\n            rowHeight = _this$props.rowHeight;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && columnWidth, shouldResetStyleCacheOnItemSizeChange && direction, shouldResetStyleCacheOnItemSizeChange && rowHeight);\n\n        var key = rowIndex + \":\" + columnIndex;\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(key)) {\n          style = itemStyleCache[key];\n        } else {\n          var _offset = getColumnOffset(_this.props, columnIndex, _this._instanceProps);\n\n          var isRtl = direction === 'rtl';\n          itemStyleCache[key] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : _offset,\n            right: isRtl ? _offset : undefined,\n            top: getRowOffset(_this.props, rowIndex, _this._instanceProps),\n            height: getRowHeight(_this.props, rowIndex, _this._instanceProps),\n            width: getColumnWidth(_this.props, columnIndex, _this._instanceProps)\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScroll = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientHeight = _event$currentTarget.clientHeight,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollTop = _event$currentTarget.scrollTop,\n            scrollHeight = _event$currentTarget.scrollHeight,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n          // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n          // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n          // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n\n          var calculatedScrollLeft = scrollLeft;\n\n          if (direction === 'rtl') {\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                calculatedScrollLeft = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                calculatedScrollLeft = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          calculatedScrollLeft = Math.max(0, Math.min(calculatedScrollLeft, scrollWidth - clientWidth));\n          var calculatedScrollTop = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n            scrollLeft: calculatedScrollLeft,\n            scrollTop: calculatedScrollTop,\n            verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward',\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1);\n        });\n      };\n\n      return _this;\n    }\n\n    Grid.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = Grid.prototype;\n\n    _proto.scrollTo = function scrollTo(_ref3) {\n      var scrollLeft = _ref3.scrollLeft,\n          scrollTop = _ref3.scrollTop;\n\n      if (scrollLeft !== undefined) {\n        scrollLeft = Math.max(0, scrollLeft);\n      }\n\n      if (scrollTop !== undefined) {\n        scrollTop = Math.max(0, scrollTop);\n      }\n\n      this.setState(function (prevState) {\n        if (scrollLeft === undefined) {\n          scrollLeft = prevState.scrollLeft;\n        }\n\n        if (scrollTop === undefined) {\n          scrollTop = prevState.scrollTop;\n        }\n\n        if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n          return null;\n        }\n\n        return {\n          horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          scrollUpdateWasRequested: true,\n          verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward'\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(_ref4) {\n      var _ref4$align = _ref4.align,\n          align = _ref4$align === void 0 ? 'auto' : _ref4$align,\n          columnIndex = _ref4.columnIndex,\n          rowIndex = _ref4.rowIndex;\n      var _this$props2 = this.props,\n          columnCount = _this$props2.columnCount,\n          height = _this$props2.height,\n          rowCount = _this$props2.rowCount,\n          width = _this$props2.width;\n      var _this$state = this.state,\n          scrollLeft = _this$state.scrollLeft,\n          scrollTop = _this$state.scrollTop;\n      var scrollbarSize = getScrollbarSize();\n\n      if (columnIndex !== undefined) {\n        columnIndex = Math.max(0, Math.min(columnIndex, columnCount - 1));\n      }\n\n      if (rowIndex !== undefined) {\n        rowIndex = Math.max(0, Math.min(rowIndex, rowCount - 1));\n      }\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps); // The scrollbar size should be considered when scrolling an item into view,\n      // to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n\n      var horizontalScrollbarSize = estimatedTotalWidth > width ? scrollbarSize : 0;\n      var verticalScrollbarSize = estimatedTotalHeight > height ? scrollbarSize : 0;\n      this.scrollTo({\n        scrollLeft: columnIndex !== undefined ? getOffsetForColumnAndAlignment(this.props, columnIndex, align, scrollLeft, this._instanceProps, verticalScrollbarSize) : scrollLeft,\n        scrollTop: rowIndex !== undefined ? getOffsetForRowAndAlignment(this.props, rowIndex, align, scrollTop, this._instanceProps, horizontalScrollbarSize) : scrollTop\n      });\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          initialScrollLeft = _this$props3.initialScrollLeft,\n          initialScrollTop = _this$props3.initialScrollTop;\n\n      if (this._outerRef != null) {\n        var outerRef = this._outerRef;\n\n        if (typeof initialScrollLeft === 'number') {\n          outerRef.scrollLeft = initialScrollLeft;\n        }\n\n        if (typeof initialScrollTop === 'number') {\n          outerRef.scrollTop = initialScrollTop;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var direction = this.props.direction;\n      var _this$state2 = this.state,\n          scrollLeft = _this$state2.scrollLeft,\n          scrollTop = _this$state2.scrollTop,\n          scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n        // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n        // So we need to determine which browser behavior we're dealing with, and mimic it.\n        var outerRef = this._outerRef;\n\n        if (direction === 'rtl') {\n          switch (getRTLOffsetType()) {\n            case 'negative':\n              outerRef.scrollLeft = -scrollLeft;\n              break;\n\n            case 'positive-ascending':\n              outerRef.scrollLeft = scrollLeft;\n              break;\n\n            default:\n              var clientWidth = outerRef.clientWidth,\n                  scrollWidth = outerRef.scrollWidth;\n              outerRef.scrollLeft = scrollWidth - clientWidth - scrollLeft;\n              break;\n          }\n        } else {\n          outerRef.scrollLeft = Math.max(0, scrollLeft);\n        }\n\n        outerRef.scrollTop = Math.max(0, scrollTop);\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props4 = this.props,\n          children = _this$props4.children,\n          className = _this$props4.className,\n          columnCount = _this$props4.columnCount,\n          direction = _this$props4.direction,\n          height = _this$props4.height,\n          innerRef = _this$props4.innerRef,\n          innerElementType = _this$props4.innerElementType,\n          innerTagName = _this$props4.innerTagName,\n          itemData = _this$props4.itemData,\n          _this$props4$itemKey = _this$props4.itemKey,\n          itemKey = _this$props4$itemKey === void 0 ? defaultItemKey : _this$props4$itemKey,\n          outerElementType = _this$props4.outerElementType,\n          outerTagName = _this$props4.outerTagName,\n          rowCount = _this$props4.rowCount,\n          style = _this$props4.style,\n          useIsScrolling = _this$props4.useIsScrolling,\n          width = _this$props4.width;\n      var isScrolling = this.state.isScrolling;\n\n      var _this$_getHorizontalR = this._getHorizontalRangeToRender(),\n          columnStartIndex = _this$_getHorizontalR[0],\n          columnStopIndex = _this$_getHorizontalR[1];\n\n      var _this$_getVerticalRan = this._getVerticalRangeToRender(),\n          rowStartIndex = _this$_getVerticalRan[0],\n          rowStopIndex = _this$_getVerticalRan[1];\n\n      var items = [];\n\n      if (columnCount > 0 && rowCount) {\n        for (var _rowIndex = rowStartIndex; _rowIndex <= rowStopIndex; _rowIndex++) {\n          for (var _columnIndex = columnStartIndex; _columnIndex <= columnStopIndex; _columnIndex++) {\n            items.push(createElement(children, {\n              columnIndex: _columnIndex,\n              data: itemData,\n              isScrolling: useIsScrolling ? isScrolling : undefined,\n              key: itemKey({\n                columnIndex: _columnIndex,\n                data: itemData,\n                rowIndex: _rowIndex\n              }),\n              rowIndex: _rowIndex,\n              style: this._getItemStyle(_rowIndex, _columnIndex)\n            }));\n          }\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: this._onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: estimatedTotalHeight,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: estimatedTotalWidth\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      var _this$props5 = this.props,\n          columnCount = _this$props5.columnCount,\n          onItemsRendered = _this$props5.onItemsRendered,\n          onScroll = _this$props5.onScroll,\n          rowCount = _this$props5.rowCount;\n\n      if (typeof onItemsRendered === 'function') {\n        if (columnCount > 0 && rowCount > 0) {\n          var _this$_getHorizontalR2 = this._getHorizontalRangeToRender(),\n              _overscanColumnStartIndex = _this$_getHorizontalR2[0],\n              _overscanColumnStopIndex = _this$_getHorizontalR2[1],\n              _visibleColumnStartIndex = _this$_getHorizontalR2[2],\n              _visibleColumnStopIndex = _this$_getHorizontalR2[3];\n\n          var _this$_getVerticalRan2 = this._getVerticalRangeToRender(),\n              _overscanRowStartIndex = _this$_getVerticalRan2[0],\n              _overscanRowStopIndex = _this$_getVerticalRan2[1],\n              _visibleRowStartIndex = _this$_getVerticalRan2[2],\n              _visibleRowStopIndex = _this$_getVerticalRan2[3];\n\n          this._callOnItemsRendered(_overscanColumnStartIndex, _overscanColumnStopIndex, _overscanRowStartIndex, _overscanRowStopIndex, _visibleColumnStartIndex, _visibleColumnStopIndex, _visibleRowStartIndex, _visibleRowStopIndex);\n        }\n      }\n\n      if (typeof onScroll === 'function') {\n        var _this$state3 = this.state,\n            _horizontalScrollDirection = _this$state3.horizontalScrollDirection,\n            _scrollLeft = _this$state3.scrollLeft,\n            _scrollTop = _this$state3.scrollTop,\n            _scrollUpdateWasRequested = _this$state3.scrollUpdateWasRequested,\n            _verticalScrollDirection = _this$state3.verticalScrollDirection;\n\n        this._callOnScroll(_scrollLeft, _scrollTop, _horizontalScrollDirection, _verticalScrollDirection, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getHorizontalRangeToRender = function _getHorizontalRangeToRender() {\n      var _this$props6 = this.props,\n          columnCount = _this$props6.columnCount,\n          overscanColumnCount = _this$props6.overscanColumnCount,\n          overscanColumnsCount = _this$props6.overscanColumnsCount,\n          overscanCount = _this$props6.overscanCount,\n          rowCount = _this$props6.rowCount;\n      var _this$state4 = this.state,\n          horizontalScrollDirection = _this$state4.horizontalScrollDirection,\n          isScrolling = _this$state4.isScrolling,\n          scrollLeft = _this$state4.scrollLeft;\n      var overscanCountResolved = overscanColumnCount || overscanColumnsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getColumnStartIndexForOffset(this.props, scrollLeft, this._instanceProps);\n      var stopIndex = getColumnStopIndexForStartIndex(this.props, startIndex, scrollLeft, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || horizontalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || horizontalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(columnCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    _proto._getVerticalRangeToRender = function _getVerticalRangeToRender() {\n      var _this$props7 = this.props,\n          columnCount = _this$props7.columnCount,\n          overscanCount = _this$props7.overscanCount,\n          overscanRowCount = _this$props7.overscanRowCount,\n          overscanRowsCount = _this$props7.overscanRowsCount,\n          rowCount = _this$props7.rowCount;\n      var _this$state5 = this.state,\n          isScrolling = _this$state5.isScrolling,\n          verticalScrollDirection = _this$state5.verticalScrollDirection,\n          scrollTop = _this$state5.scrollTop;\n      var overscanCountResolved = overscanRowCount || overscanRowsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getRowStartIndexForOffset(this.props, scrollTop, this._instanceProps);\n      var stopIndex = getRowStopIndexForStartIndex(this.props, startIndex, scrollTop, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || verticalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || verticalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(rowCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return Grid;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    useIsScrolling: false\n  }, _class;\n}\n\nvar validateSharedProps = function validateSharedProps(_ref5, _ref6) {\n  var children = _ref5.children,\n      direction = _ref5.direction,\n      height = _ref5.height,\n      innerTagName = _ref5.innerTagName,\n      outerTagName = _ref5.outerTagName,\n      overscanColumnsCount = _ref5.overscanColumnsCount,\n      overscanCount = _ref5.overscanCount,\n      overscanRowsCount = _ref5.overscanRowsCount,\n      width = _ref5.width;\n  var instance = _ref6.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof overscanCount === 'number') {\n      if (devWarningsOverscanCount && !devWarningsOverscanCount.has(instance)) {\n        devWarningsOverscanCount.add(instance);\n        console.warn('The overscanCount prop has been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (typeof overscanColumnsCount === 'number' || typeof overscanRowsCount === 'number') {\n      if (devWarningsOverscanRowsColumnsCount && !devWarningsOverscanRowsColumnsCount.has(instance)) {\n        devWarningsOverscanRowsColumnsCount.add(instance);\n        console.warn('The overscanColumnsCount and overscanRowsCount props have been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName && !devWarningsTagName.has(instance)) {\n        devWarningsTagName.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    switch (direction) {\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    if (typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Grids must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    }\n\n    if (typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Grids must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE = 50;\n\nvar getEstimatedTotalHeight = function getEstimatedTotalHeight(_ref, _ref2) {\n  var rowCount = _ref.rowCount;\n  var rowMetadataMap = _ref2.rowMetadataMap,\n      estimatedRowHeight = _ref2.estimatedRowHeight,\n      lastMeasuredRowIndex = _ref2.lastMeasuredRowIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredRowIndex >= rowCount) {\n    lastMeasuredRowIndex = rowCount - 1;\n  }\n\n  if (lastMeasuredRowIndex >= 0) {\n    var itemMetadata = rowMetadataMap[lastMeasuredRowIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = rowCount - lastMeasuredRowIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedRowHeight;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getEstimatedTotalWidth = function getEstimatedTotalWidth(_ref3, _ref4) {\n  var columnCount = _ref3.columnCount;\n  var columnMetadataMap = _ref4.columnMetadataMap,\n      estimatedColumnWidth = _ref4.estimatedColumnWidth,\n      lastMeasuredColumnIndex = _ref4.lastMeasuredColumnIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredColumnIndex >= columnCount) {\n    lastMeasuredColumnIndex = columnCount - 1;\n  }\n\n  if (lastMeasuredColumnIndex >= 0) {\n    var itemMetadata = columnMetadataMap[lastMeasuredColumnIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = columnCount - lastMeasuredColumnIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedColumnWidth;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getItemMetadata = function getItemMetadata(itemType, props, index, instanceProps) {\n  var itemMetadataMap, itemSize, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    itemSize = props.columnWidth;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    itemSize = props.rowHeight;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    if (itemType === 'column') {\n      instanceProps.lastMeasuredColumnIndex = index;\n    } else {\n      instanceProps.lastMeasuredRowIndex = index;\n    }\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem = function findNearestItem(itemType, props, instanceProps, offset) {\n  var itemMetadataMap, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch(itemType, props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch(itemType, props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch = function findNearestItemBinarySearch(itemType, props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata(itemType, props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch = function findNearestItemExponentialSearch(itemType, props, instanceProps, index, offset) {\n  var itemCount = itemType === 'column' ? props.columnCount : props.rowCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata(itemType, props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch(itemType, props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getOffsetForIndexAndAlignment = function getOffsetForIndexAndAlignment(itemType, props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n  var size = itemType === 'column' ? props.width : props.height;\n  var itemMetadata = getItemMetadata(itemType, props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n  // To ensure it reflects actual measurements instead of just estimates.\n\n  var estimatedTotalSize = itemType === 'column' ? getEstimatedTotalWidth(props, instanceProps) : getEstimatedTotalHeight(props, instanceProps);\n  var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n  var minOffset = Math.max(0, itemMetadata.offset - size + scrollbarSize + itemMetadata.size);\n\n  if (align === 'smart') {\n    if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n      align = 'auto';\n    } else {\n      align = 'center';\n    }\n  }\n\n  switch (align) {\n    case 'start':\n      return maxOffset;\n\n    case 'end':\n      return minOffset;\n\n    case 'center':\n      return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n    case 'auto':\n    default:\n      if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n        return scrollOffset;\n      } else if (minOffset > maxOffset) {\n        // Because we only take into account the scrollbar size when calculating minOffset\n        // this value can be larger than maxOffset when at the end of the list\n        return minOffset;\n      } else if (scrollOffset < minOffset) {\n        return minOffset;\n      } else {\n        return maxOffset;\n      }\n\n  }\n};\n\nvar VariableSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(props, index, instanceProps) {\n    return getItemMetadata('column', props, index, instanceProps).offset;\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(props, scrollLeft, instanceProps) {\n    return findNearestItem('column', props, instanceProps, scrollLeft);\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(props, startIndex, scrollLeft, instanceProps) {\n    var columnCount = props.columnCount,\n        width = props.width;\n    var itemMetadata = getItemMetadata('column', props, startIndex, instanceProps);\n    var maxOffset = scrollLeft + width;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < columnCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('column', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  getColumnWidth: function getColumnWidth(props, index, instanceProps) {\n    return instanceProps.columnMetadataMap[index].size;\n  },\n  getEstimatedTotalHeight: getEstimatedTotalHeight,\n  getEstimatedTotalWidth: getEstimatedTotalWidth,\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('column', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('row', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getRowOffset: function getRowOffset(props, index, instanceProps) {\n    return getItemMetadata('row', props, index, instanceProps).offset;\n  },\n  getRowHeight: function getRowHeight(props, index, instanceProps) {\n    return instanceProps.rowMetadataMap[index].size;\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(props, scrollTop, instanceProps) {\n    return findNearestItem('row', props, instanceProps, scrollTop);\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(props, startIndex, scrollTop, instanceProps) {\n    var rowCount = props.rowCount,\n        height = props.height;\n    var itemMetadata = getItemMetadata('row', props, startIndex, instanceProps);\n    var maxOffset = scrollTop + height;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < rowCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('row', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref5 = props,\n        estimatedColumnWidth = _ref5.estimatedColumnWidth,\n        estimatedRowHeight = _ref5.estimatedRowHeight;\n    var instanceProps = {\n      columnMetadataMap: {},\n      estimatedColumnWidth: estimatedColumnWidth || DEFAULT_ESTIMATED_ITEM_SIZE,\n      estimatedRowHeight: estimatedRowHeight || DEFAULT_ESTIMATED_ITEM_SIZE,\n      lastMeasuredColumnIndex: -1,\n      lastMeasuredRowIndex: -1,\n      rowMetadataMap: {}\n    };\n\n    instance.resetAfterColumnIndex = function (columnIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        columnIndex: columnIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterRowIndex = function (rowIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        rowIndex: rowIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterIndices = function (_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex,\n          _ref6$shouldForceUpda = _ref6.shouldForceUpdate,\n          shouldForceUpdate = _ref6$shouldForceUpda === void 0 ? true : _ref6$shouldForceUpda;\n\n      if (typeof columnIndex === 'number') {\n        instanceProps.lastMeasuredColumnIndex = Math.min(instanceProps.lastMeasuredColumnIndex, columnIndex - 1);\n      }\n\n      if (typeof rowIndex === 'number') {\n        instanceProps.lastMeasuredRowIndex = Math.min(instanceProps.lastMeasuredRowIndex, rowIndex - 1);\n      } // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref7) {\n    var columnWidth = _ref7.columnWidth,\n        rowHeight = _ref7.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'function') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      } else if (typeof rowHeight !== 'function') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL$1 = 150;\n\nvar defaultItemKey$1 = function defaultItemKey(index, data) {\n  return index;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsDirection = null;\nvar devWarningsTagName$1 = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsDirection = /*#__PURE__*/new WeakSet();\n    devWarningsTagName$1 = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createListComponent(_ref) {\n  var _class;\n\n  var getItemOffset = _ref.getItemOffset,\n      getEstimatedTotalSize = _ref.getEstimatedTotalSize,\n      getItemSize = _ref.getItemSize,\n      getOffsetForIndexAndAlignment = _ref.getOffsetForIndexAndAlignment,\n      getStartIndexForOffset = _ref.getStartIndexForOffset,\n      getStopIndexForStartIndex = _ref.getStopIndexForStartIndex,\n      initInstanceProps = _ref.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(List, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function List(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._outerRef = void 0;\n      _this._resetIsScrollingTimeoutId = null;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        scrollDirection: 'forward',\n        scrollOffset: typeof _this.props.initialScrollOffset === 'number' ? _this.props.initialScrollOffset : 0,\n        scrollUpdateWasRequested: false\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanStartIndex, overscanStopIndex, visibleStartIndex, visibleStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanStartIndex: overscanStartIndex,\n          overscanStopIndex: overscanStopIndex,\n          visibleStartIndex: visibleStartIndex,\n          visibleStopIndex: visibleStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollDirection, scrollOffset, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          scrollDirection: scrollDirection,\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (index) {\n        var _this$props = _this.props,\n            direction = _this$props.direction,\n            itemSize = _this$props.itemSize,\n            layout = _this$props.layout;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && itemSize, shouldResetStyleCacheOnItemSizeChange && layout, shouldResetStyleCacheOnItemSizeChange && direction);\n\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(index)) {\n          style = itemStyleCache[index];\n        } else {\n          var _offset = getItemOffset(_this.props, index, _this._instanceProps);\n\n          var size = getItemSize(_this.props, index, _this._instanceProps); // TODO Deprecate direction \"horizontal\"\n\n          var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n          var isRtl = direction === 'rtl';\n          var offsetHorizontal = isHorizontal ? _offset : 0;\n          itemStyleCache[index] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : offsetHorizontal,\n            right: isRtl ? offsetHorizontal : undefined,\n            top: !isHorizontal ? _offset : 0,\n            height: !isHorizontal ? size : '100%',\n            width: isHorizontal ? size : '100%'\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScrollHorizontal = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollLeft) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction;\n          var scrollOffset = scrollLeft;\n\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n            // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                scrollOffset = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                scrollOffset = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          scrollOffset = Math.max(0, Math.min(scrollOffset, scrollWidth - clientWidth));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._onScrollVertical = function (event) {\n        var _event$currentTarget2 = event.currentTarget,\n            clientHeight = _event$currentTarget2.clientHeight,\n            scrollHeight = _event$currentTarget2.scrollHeight,\n            scrollTop = _event$currentTarget2.scrollTop;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          var scrollOffset = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL$1);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1, null);\n        });\n      };\n\n      return _this;\n    }\n\n    List.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps$1(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = List.prototype;\n\n    _proto.scrollTo = function scrollTo(scrollOffset) {\n      scrollOffset = Math.max(0, scrollOffset);\n      this.setState(function (prevState) {\n        if (prevState.scrollOffset === scrollOffset) {\n          return null;\n        }\n\n        return {\n          scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: true\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(index, align) {\n      if (align === void 0) {\n        align = 'auto';\n      }\n\n      var _this$props2 = this.props,\n          itemCount = _this$props2.itemCount,\n          layout = _this$props2.layout;\n      var scrollOffset = this.state.scrollOffset;\n      index = Math.max(0, Math.min(index, itemCount - 1)); // The scrollbar size should be considered when scrolling an item into view, to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n      // This is an edge case for lists; normally they only scroll in the dominant direction.\n\n      var scrollbarSize = 0;\n\n      if (this._outerRef) {\n        var outerRef = this._outerRef;\n\n        if (layout === 'vertical') {\n          scrollbarSize = outerRef.scrollWidth > outerRef.clientWidth ? getScrollbarSize() : 0;\n        } else {\n          scrollbarSize = outerRef.scrollHeight > outerRef.clientHeight ? getScrollbarSize() : 0;\n        }\n      }\n\n      this.scrollTo(getOffsetForIndexAndAlignment(this.props, index, align, scrollOffset, this._instanceProps, scrollbarSize));\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          direction = _this$props3.direction,\n          initialScrollOffset = _this$props3.initialScrollOffset,\n          layout = _this$props3.layout;\n\n      if (typeof initialScrollOffset === 'number' && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          outerRef.scrollLeft = initialScrollOffset;\n        } else {\n          outerRef.scrollTop = initialScrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var _this$props4 = this.props,\n          direction = _this$props4.direction,\n          layout = _this$props4.layout;\n      var _this$state = this.state,\n          scrollOffset = _this$state.scrollOffset,\n          scrollUpdateWasRequested = _this$state.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // So we need to determine which browser behavior we're dealing with, and mimic it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                outerRef.scrollLeft = -scrollOffset;\n                break;\n\n              case 'positive-ascending':\n                outerRef.scrollLeft = scrollOffset;\n                break;\n\n              default:\n                var clientWidth = outerRef.clientWidth,\n                    scrollWidth = outerRef.scrollWidth;\n                outerRef.scrollLeft = scrollWidth - clientWidth - scrollOffset;\n                break;\n            }\n          } else {\n            outerRef.scrollLeft = scrollOffset;\n          }\n        } else {\n          outerRef.scrollTop = scrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props5 = this.props,\n          children = _this$props5.children,\n          className = _this$props5.className,\n          direction = _this$props5.direction,\n          height = _this$props5.height,\n          innerRef = _this$props5.innerRef,\n          innerElementType = _this$props5.innerElementType,\n          innerTagName = _this$props5.innerTagName,\n          itemCount = _this$props5.itemCount,\n          itemData = _this$props5.itemData,\n          _this$props5$itemKey = _this$props5.itemKey,\n          itemKey = _this$props5$itemKey === void 0 ? defaultItemKey$1 : _this$props5$itemKey,\n          layout = _this$props5.layout,\n          outerElementType = _this$props5.outerElementType,\n          outerTagName = _this$props5.outerTagName,\n          style = _this$props5.style,\n          useIsScrolling = _this$props5.useIsScrolling,\n          width = _this$props5.width;\n      var isScrolling = this.state.isScrolling; // TODO Deprecate direction \"horizontal\"\n\n      var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n      var onScroll = isHorizontal ? this._onScrollHorizontal : this._onScrollVertical;\n\n      var _this$_getRangeToRend = this._getRangeToRender(),\n          startIndex = _this$_getRangeToRend[0],\n          stopIndex = _this$_getRangeToRend[1];\n\n      var items = [];\n\n      if (itemCount > 0) {\n        for (var _index = startIndex; _index <= stopIndex; _index++) {\n          items.push(createElement(children, {\n            data: itemData,\n            key: itemKey(_index, itemData),\n            index: _index,\n            isScrolling: useIsScrolling ? isScrolling : undefined,\n            style: this._getItemStyle(_index)\n          }));\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalSize = getEstimatedTotalSize(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: isHorizontal ? '100%' : estimatedTotalSize,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: isHorizontal ? estimatedTotalSize : '100%'\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      if (typeof this.props.onItemsRendered === 'function') {\n        var itemCount = this.props.itemCount;\n\n        if (itemCount > 0) {\n          var _this$_getRangeToRend2 = this._getRangeToRender(),\n              _overscanStartIndex = _this$_getRangeToRend2[0],\n              _overscanStopIndex = _this$_getRangeToRend2[1],\n              _visibleStartIndex = _this$_getRangeToRend2[2],\n              _visibleStopIndex = _this$_getRangeToRend2[3];\n\n          this._callOnItemsRendered(_overscanStartIndex, _overscanStopIndex, _visibleStartIndex, _visibleStopIndex);\n        }\n      }\n\n      if (typeof this.props.onScroll === 'function') {\n        var _this$state2 = this.state,\n            _scrollDirection = _this$state2.scrollDirection,\n            _scrollOffset = _this$state2.scrollOffset,\n            _scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n        this._callOnScroll(_scrollDirection, _scrollOffset, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getRangeToRender = function _getRangeToRender() {\n      var _this$props6 = this.props,\n          itemCount = _this$props6.itemCount,\n          overscanCount = _this$props6.overscanCount;\n      var _this$state3 = this.state,\n          isScrolling = _this$state3.isScrolling,\n          scrollDirection = _this$state3.scrollDirection,\n          scrollOffset = _this$state3.scrollOffset;\n\n      if (itemCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getStartIndexForOffset(this.props, scrollOffset, this._instanceProps);\n      var stopIndex = getStopIndexForStartIndex(this.props, startIndex, scrollOffset, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || scrollDirection === 'backward' ? Math.max(1, overscanCount) : 1;\n      var overscanForward = !isScrolling || scrollDirection === 'forward' ? Math.max(1, overscanCount) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(itemCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return List;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    layout: 'vertical',\n    overscanCount: 2,\n    useIsScrolling: false\n  }, _class;\n} // NOTE: I considered further wrapping individual items with a pure ListItem component.\n// This would avoid ever calling the render function for the same index more than once,\n// But it would also add the overhead of a lot of components/fibers.\n// I assume people already do this (render function returning a class component),\n// So my doing it would just unnecessarily double the wrappers.\n\nvar validateSharedProps$1 = function validateSharedProps(_ref2, _ref3) {\n  var children = _ref2.children,\n      direction = _ref2.direction,\n      height = _ref2.height,\n      layout = _ref2.layout,\n      innerTagName = _ref2.innerTagName,\n      outerTagName = _ref2.outerTagName,\n      width = _ref2.width;\n  var instance = _ref3.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName$1 && !devWarningsTagName$1.has(instance)) {\n        devWarningsTagName$1.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    } // TODO Deprecate direction \"horizontal\"\n\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n\n    switch (direction) {\n      case 'horizontal':\n      case 'vertical':\n        if (devWarningsDirection && !devWarningsDirection.has(instance)) {\n          devWarningsDirection.add(instance);\n          console.warn('The direction prop should be either \"ltr\" (default) or \"rtl\". ' + 'Please use the layout prop to specify \"vertical\" (default) or \"horizontal\" orientation.');\n        }\n\n        break;\n\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    switch (layout) {\n      case 'horizontal':\n      case 'vertical':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"layout\" prop has been specified. ' + 'Value should be either \"horizontal\" or \"vertical\". ' + (\"\\\"\" + layout + \"\\\" was specified.\"));\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    if (isHorizontal && typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Horizontal lists must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    } else if (!isHorizontal && typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Vertical lists must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE$1 = 50;\n\nvar getItemMetadata$1 = function getItemMetadata(props, index, instanceProps) {\n  var _ref = props,\n      itemSize = _ref.itemSize;\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    instanceProps.lastMeasuredIndex = index;\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem$1 = function findNearestItem(props, instanceProps, offset) {\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch$1(props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch$1(props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch$1 = function findNearestItemBinarySearch(props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata$1(props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch$1 = function findNearestItemExponentialSearch(props, instanceProps, index, offset) {\n  var itemCount = props.itemCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata$1(props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch$1(props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getEstimatedTotalSize = function getEstimatedTotalSize(_ref2, _ref3) {\n  var itemCount = _ref2.itemCount;\n  var itemMetadataMap = _ref3.itemMetadataMap,\n      estimatedItemSize = _ref3.estimatedItemSize,\n      lastMeasuredIndex = _ref3.lastMeasuredIndex;\n  var totalSizeOfMeasuredItems = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredIndex >= itemCount) {\n    lastMeasuredIndex = itemCount - 1;\n  }\n\n  if (lastMeasuredIndex >= 0) {\n    var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n    totalSizeOfMeasuredItems = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = itemCount - lastMeasuredIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedItemSize;\n  return totalSizeOfMeasuredItems + totalSizeOfUnmeasuredItems;\n};\n\nvar VariableSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(props, index, instanceProps) {\n    return getItemMetadata$1(props, index, instanceProps).offset;\n  },\n  getItemSize: function getItemSize(props, index, instanceProps) {\n    return instanceProps.itemMetadataMap[index].size;\n  },\n  getEstimatedTotalSize: getEstimatedTotalSize,\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = props.direction,\n        height = props.height,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n    // To ensure it reflects actual measurements instead of just estimates.\n\n    var estimatedTotalSize = getEstimatedTotalSize(props, instanceProps);\n    var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n    var minOffset = Math.max(0, itemMetadata.offset - size + itemMetadata.size + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(props, offset, instanceProps) {\n    return findNearestItem$1(props, instanceProps, offset);\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(props, startIndex, scrollOffset, instanceProps) {\n    var direction = props.direction,\n        height = props.height,\n        itemCount = props.itemCount,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, startIndex, instanceProps);\n    var maxOffset = scrollOffset + size;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < itemCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata$1(props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref4 = props,\n        estimatedItemSize = _ref4.estimatedItemSize;\n    var instanceProps = {\n      itemMetadataMap: {},\n      estimatedItemSize: estimatedItemSize || DEFAULT_ESTIMATED_ITEM_SIZE$1,\n      lastMeasuredIndex: -1\n    };\n\n    instance.resetAfterIndex = function (index, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instanceProps.lastMeasuredIndex = Math.min(instanceProps.lastMeasuredIndex, index - 1); // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref5) {\n    var itemSize = _ref5.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'function') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(_ref, index) {\n    var columnWidth = _ref.columnWidth;\n    return index * columnWidth;\n  },\n  getColumnWidth: function getColumnWidth(_ref2, index) {\n    var columnWidth = _ref2.columnWidth;\n    return columnWidth;\n  },\n  getRowOffset: function getRowOffset(_ref3, index) {\n    var rowHeight = _ref3.rowHeight;\n    return index * rowHeight;\n  },\n  getRowHeight: function getRowHeight(_ref4, index) {\n    var rowHeight = _ref4.rowHeight;\n    return rowHeight;\n  },\n  getEstimatedTotalHeight: function getEstimatedTotalHeight(_ref5) {\n    var rowCount = _ref5.rowCount,\n        rowHeight = _ref5.rowHeight;\n    return rowHeight * rowCount;\n  },\n  getEstimatedTotalWidth: function getEstimatedTotalWidth(_ref6) {\n    var columnCount = _ref6.columnCount,\n        columnWidth = _ref6.columnWidth;\n    return columnWidth * columnCount;\n  },\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(_ref7, columnIndex, align, scrollLeft, instanceProps, scrollbarSize) {\n    var columnCount = _ref7.columnCount,\n        columnWidth = _ref7.columnWidth,\n        width = _ref7.width;\n    var lastColumnOffset = Math.max(0, columnCount * columnWidth - width);\n    var maxOffset = Math.min(lastColumnOffset, columnIndex * columnWidth);\n    var minOffset = Math.max(0, columnIndex * columnWidth - width + scrollbarSize + columnWidth);\n\n    if (align === 'smart') {\n      if (scrollLeft >= minOffset - width && scrollLeft <= maxOffset + width) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(width / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastColumnOffset + Math.floor(width / 2)) {\n          return lastColumnOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollLeft >= minOffset && scrollLeft <= maxOffset) {\n          return scrollLeft;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollLeft < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(_ref8, rowIndex, align, scrollTop, instanceProps, scrollbarSize) {\n    var rowHeight = _ref8.rowHeight,\n        height = _ref8.height,\n        rowCount = _ref8.rowCount;\n    var lastRowOffset = Math.max(0, rowCount * rowHeight - height);\n    var maxOffset = Math.min(lastRowOffset, rowIndex * rowHeight);\n    var minOffset = Math.max(0, rowIndex * rowHeight - height + scrollbarSize + rowHeight);\n\n    if (align === 'smart') {\n      if (scrollTop >= minOffset - height && scrollTop <= maxOffset + height) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(height / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastRowOffset + Math.floor(height / 2)) {\n          return lastRowOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollTop >= minOffset && scrollTop <= maxOffset) {\n          return scrollTop;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollTop < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(_ref9, scrollLeft) {\n    var columnWidth = _ref9.columnWidth,\n        columnCount = _ref9.columnCount;\n    return Math.max(0, Math.min(columnCount - 1, Math.floor(scrollLeft / columnWidth)));\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(_ref10, startIndex, scrollLeft) {\n    var columnWidth = _ref10.columnWidth,\n        columnCount = _ref10.columnCount,\n        width = _ref10.width;\n    var left = startIndex * columnWidth;\n    var numVisibleColumns = Math.ceil((width + scrollLeft - left) / columnWidth);\n    return Math.max(0, Math.min(columnCount - 1, startIndex + numVisibleColumns - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(_ref11, scrollTop) {\n    var rowHeight = _ref11.rowHeight,\n        rowCount = _ref11.rowCount;\n    return Math.max(0, Math.min(rowCount - 1, Math.floor(scrollTop / rowHeight)));\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(_ref12, startIndex, scrollTop) {\n    var rowHeight = _ref12.rowHeight,\n        rowCount = _ref12.rowCount,\n        height = _ref12.height;\n    var top = startIndex * rowHeight;\n    var numVisibleRows = Math.ceil((height + scrollTop - top) / rowHeight);\n    return Math.max(0, Math.min(rowCount - 1, startIndex + numVisibleRows - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref13) {\n    var columnWidth = _ref13.columnWidth,\n        rowHeight = _ref13.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'number') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      }\n\n      if (typeof rowHeight !== 'number') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(_ref, index) {\n    var itemSize = _ref.itemSize;\n    return index * itemSize;\n  },\n  getItemSize: function getItemSize(_ref2, index) {\n    var itemSize = _ref2.itemSize;\n    return itemSize;\n  },\n  getEstimatedTotalSize: function getEstimatedTotalSize(_ref3) {\n    var itemCount = _ref3.itemCount,\n        itemSize = _ref3.itemSize;\n    return itemSize * itemCount;\n  },\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(_ref4, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = _ref4.direction,\n        height = _ref4.height,\n        itemCount = _ref4.itemCount,\n        itemSize = _ref4.itemSize,\n        layout = _ref4.layout,\n        width = _ref4.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var lastItemOffset = Math.max(0, itemCount * itemSize - size);\n    var maxOffset = Math.min(lastItemOffset, index * itemSize);\n    var minOffset = Math.max(0, index * itemSize - size + itemSize + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        {\n          // \"Centered\" offset is usually the average of the min and max.\n          // But near the edges of the list, this doesn't hold true.\n          var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n          if (middleOffset < Math.ceil(size / 2)) {\n            return 0; // near the beginning\n          } else if (middleOffset > lastItemOffset + Math.floor(size / 2)) {\n            return lastItemOffset; // near the end\n          } else {\n            return middleOffset;\n          }\n        }\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(_ref5, offset) {\n    var itemCount = _ref5.itemCount,\n        itemSize = _ref5.itemSize;\n    return Math.max(0, Math.min(itemCount - 1, Math.floor(offset / itemSize)));\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(_ref6, startIndex, scrollOffset) {\n    var direction = _ref6.direction,\n        height = _ref6.height,\n        itemCount = _ref6.itemCount,\n        itemSize = _ref6.itemSize,\n        layout = _ref6.layout,\n        width = _ref6.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var offset = startIndex * itemSize;\n    var size = isHorizontal ? width : height;\n    var numVisibleItems = Math.ceil((size + scrollOffset - offset) / itemSize);\n    return Math.max(0, Math.min(itemCount - 1, startIndex + numVisibleItems - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref7) {\n    var itemSize = _ref7.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'number') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\n// Pulled from react-compat\n// https://github.com/developit/preact-compat/blob/7c5de00e7c85e2ffd011bf3af02899b63f699d3a/src/index.js#L349\nfunction shallowDiffers(prev, next) {\n  for (var attribute in prev) {\n    if (!(attribute in next)) {\n      return true;\n    }\n  }\n\n  for (var _attribute in next) {\n    if (prev[_attribute] !== next[_attribute]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar _excluded = [\"style\"],\n    _excluded2 = [\"style\"];\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-api.html#reactmemo\n\nfunction areEqual(prevProps, nextProps) {\n  var prevStyle = prevProps.style,\n      prevRest = _objectWithoutPropertiesLoose(prevProps, _excluded);\n\n  var nextStyle = nextProps.style,\n      nextRest = _objectWithoutPropertiesLoose(nextProps, _excluded2);\n\n  return !shallowDiffers(prevStyle, nextStyle) && !shallowDiffers(prevRest, nextRest);\n}\n\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-component.html#shouldcomponentupdate\n\nfunction shouldComponentUpdate(nextProps, nextState) {\n  return !areEqual(this.props, nextProps) || shallowDiffers(this.state, nextState);\n}\n\nexport { FixedSizeGrid, FixedSizeList, VariableSizeGrid, VariableSizeList, areEqual, shouldComponentUpdate };\n//# sourceMappingURL=index.esm.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoprefix = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar transforms = {\n  borderRadius: function borderRadius(value) {\n    return {\n      msBorderRadius: value,\n      MozBorderRadius: value,\n      OBorderRadius: value,\n      WebkitBorderRadius: value,\n      borderRadius: value\n    };\n  },\n  boxShadow: function boxShadow(value) {\n    return {\n      msBoxShadow: value,\n      MozBoxShadow: value,\n      OBoxShadow: value,\n      WebkitBoxShadow: value,\n      boxShadow: value\n    };\n  },\n  userSelect: function userSelect(value) {\n    return {\n      WebkitTouchCallout: value,\n      KhtmlUserSelect: value,\n      MozUserSelect: value,\n      msUserSelect: value,\n      WebkitUserSelect: value,\n      userSelect: value\n    };\n  },\n\n  flex: function flex(value) {\n    return {\n      WebkitBoxFlex: value,\n      MozBoxFlex: value,\n      WebkitFlex: value,\n      msFlex: value,\n      flex: value\n    };\n  },\n  flexBasis: function flexBasis(value) {\n    return {\n      WebkitFlexBasis: value,\n      flexBasis: value\n    };\n  },\n  justifyContent: function justifyContent(value) {\n    return {\n      WebkitJustifyContent: value,\n      justifyContent: value\n    };\n  },\n\n  transition: function transition(value) {\n    return {\n      msTransition: value,\n      MozTransition: value,\n      OTransition: value,\n      WebkitTransition: value,\n      transition: value\n    };\n  },\n\n  transform: function transform(value) {\n    return {\n      msTransform: value,\n      MozTransform: value,\n      OTransform: value,\n      WebkitTransform: value,\n      transform: value\n    };\n  },\n  absolute: function absolute(value) {\n    var direction = value && value.split(' ');\n    return {\n      position: 'absolute',\n      top: direction && direction[0],\n      right: direction && direction[1],\n      bottom: direction && direction[2],\n      left: direction && direction[3]\n    };\n  },\n  extend: function extend(name, otherElementStyles) {\n    var otherStyle = otherElementStyles[name];\n    if (otherStyle) {\n      return otherStyle;\n    }\n    return {\n      'extend': name\n    };\n  }\n};\n\nvar autoprefix = exports.autoprefix = function autoprefix(elements) {\n  var prefixed = {};\n  (0, _forOwn3.default)(elements, function (styles, element) {\n    var expanded = {};\n    (0, _forOwn3.default)(styles, function (value, key) {\n      var transform = transforms[key];\n      if (transform) {\n        expanded = _extends({}, expanded, transform(value));\n      } else {\n        expanded[key] = value;\n      }\n    });\n    prefixed[element] = expanded;\n  });\n  return prefixed;\n};\n\nexports.default = autoprefix;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.active = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar active = exports.active = function active(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Active, _React$Component);\n\n    function Active() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Active);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Active.__proto__ || Object.getPrototypeOf(Active)).call.apply(_ref, [this].concat(args))), _this), _this.state = { active: false }, _this.handleMouseDown = function () {\n        return _this.setState({ active: true });\n      }, _this.handleMouseUp = function () {\n        return _this.setState({ active: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseDown: _this.handleMouseDown, onMouseUp: _this.handleMouseUp },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Active;\n  }(_react2.default.Component);\n};\n\nexports.default = active;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hover = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar hover = exports.hover = function hover(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Hover, _React$Component);\n\n    function Hover() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Hover);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Hover.__proto__ || Object.getPrototypeOf(Hover)).call.apply(_ref, [this].concat(args))), _this), _this.state = { hover: false }, _this.handleMouseOver = function () {\n        return _this.setState({ hover: true });\n      }, _this.handleMouseOut = function () {\n        return _this.setState({ hover: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseOver: _this.handleMouseOver, onMouseOut: _this.handleMouseOut },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Hover;\n  }(_react2.default.Component);\n};\n\nexports.default = hover;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flattenNames = undefined;\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _isPlainObject2 = require('lodash/isPlainObject');\n\nvar _isPlainObject3 = _interopRequireDefault(_isPlainObject2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar flattenNames = exports.flattenNames = function flattenNames() {\n  var things = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  var names = [];\n\n  (0, _map3.default)(things, function (thing) {\n    if (Array.isArray(thing)) {\n      flattenNames(thing).map(function (name) {\n        return names.push(name);\n      });\n    } else if ((0, _isPlainObject3.default)(thing)) {\n      (0, _forOwn3.default)(thing, function (value, key) {\n        value === true && names.push(key);\n        names.push(key + '-' + value);\n      });\n    } else if ((0, _isString3.default)(thing)) {\n      names.push(thing);\n    }\n  });\n\n  return names;\n};\n\nexports.default = flattenNames;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactCSS = exports.loop = exports.handleActive = exports.handleHover = exports.hover = undefined;\n\nvar _flattenNames = require('./flattenNames');\n\nvar _flattenNames2 = _interopRequireDefault(_flattenNames);\n\nvar _mergeClasses = require('./mergeClasses');\n\nvar _mergeClasses2 = _interopRequireDefault(_mergeClasses);\n\nvar _autoprefix = require('./autoprefix');\n\nvar _autoprefix2 = _interopRequireDefault(_autoprefix);\n\nvar _hover2 = require('./components/hover');\n\nvar _hover3 = _interopRequireDefault(_hover2);\n\nvar _active = require('./components/active');\n\nvar _active2 = _interopRequireDefault(_active);\n\nvar _loop2 = require('./loop');\n\nvar _loop3 = _interopRequireDefault(_loop2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.hover = _hover3.default;\nexports.handleHover = _hover3.default;\nexports.handleActive = _active2.default;\nexports.loop = _loop3.default;\nvar ReactCSS = exports.ReactCSS = function ReactCSS(classes) {\n  for (var _len = arguments.length, activations = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    activations[_key - 1] = arguments[_key];\n  }\n\n  var activeNames = (0, _flattenNames2.default)(activations);\n  var merged = (0, _mergeClasses2.default)(classes, activeNames);\n  return (0, _autoprefix2.default)(merged);\n};\n\nexports.default = ReactCSS;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar loopable = function loopable(i, length) {\n  var props = {};\n  var setProp = function setProp(name) {\n    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    props[name] = value;\n  };\n\n  i === 0 && setProp('first-child');\n  i === length - 1 && setProp('last-child');\n  (i === 0 || i % 2 === 0) && setProp('even');\n  Math.abs(i % 2) === 1 && setProp('odd');\n  setProp('nth-child', i);\n\n  return props;\n};\n\nexports.default = loopable;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mergeClasses = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _cloneDeep2 = require('lodash/cloneDeep');\n\nvar _cloneDeep3 = _interopRequireDefault(_cloneDeep2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mergeClasses = exports.mergeClasses = function mergeClasses(classes) {\n  var activeNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  var styles = classes.default && (0, _cloneDeep3.default)(classes.default) || {};\n  activeNames.map(function (name) {\n    var toMerge = classes[name];\n    if (toMerge) {\n      (0, _forOwn3.default)(toMerge, function (value, key) {\n        if (!styles[key]) {\n          styles[key] = {};\n        }\n\n        styles[key] = _extends({}, styles[key], toMerge[key]);\n      });\n    }\n\n    return name;\n  });\n  return styles;\n};\n\nexports.default = mergeClasses;","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n"],"names":["FullDateInterface","constructor","date","this","fullDate","getTimeInSec","dateString","substring","timeString","yyyy","parseInt","mm","length","undefined","dd","isNaN","Error","dateJS","Date","HH","MM","SS","fractionalStr","FFFFFF","Math","pow","timeInSec","getTime","getTimeInMicroSec","combineDateTime","time","hours","padStart","minutes","seconds","month","day","fractionalSeconds","padEnd","year","parseDA","d","m","y","daysInMonth","parseTM","hh","ss","ffffff","dateTimeToFullDateInterface","dateTime","calculateDecayCorrection","instances","RadionuclideTotalDose","RadionuclideHalfLife","RadiopharmaceuticalStartDateTime","RadiopharmaceuticalStartTime","SeriesDate","scanTimes","SeriesTime","GEPrivatePostInjectionDateTime","results","Array","seriesDateTime","earliestAcquisitionDateTime","timeError","forEach","instance","AcquisitionDate","AcquisitionTime","acquisitionDateTime","fill","calculateScanTimes","startTime","input","calculateStartTime","map","_","index","decayTimeInSec","deepEquals","a","b","isArray","every","val","calculateSUVScalingFactors","CorrectedImage","Units","PhilipsPETPrivateGroup","PatientWeight","PatientSex","PatientSize","includes","DecayCorrection","decayCorrectionArray","weightInGrams","value","hasValidSUVScaleFactor","_instance$PhilipsPETP","_instance$PhilipsPETP2","_instance$PhilipsPETP3","SUVScaleFactor","hasValidActivityConcentrationScaleFactor","_instance$PhilipsPETP4","_instance$PhilipsPETP5","_instance$PhilipsPETP6","ActivityConcentrationScaleFactor","JSON","stringify","suvbsaFactor","suvlbmFactor","suvlbmJenmaFactor","console","warn","inputs","calculateSUVbsaScalingFactor","suvlbmInputs","LBM","weightSizeFactor","calculateSUVlbmScalingFactor","bodyMassIndex","calculateSUVlbmJanmahasatianScalingFactor","result","factors","suvbw","suvbsa","suvlbm","suvlbmJanma","DEFINED_CURSORS","Symbol","STANDARD_CURSORS","Set","MouseCursor","name","fallback","getName","addFallbackStyleProperty","style","getStyleProperty","getDefinedCursor","definedCursors","getDefinedCursors","mouseCursor","get","has","set","setDefinedCursor","cursor","context","symbol","Map","Object","defineProperty","standardCursorNames","values","ELEMENT_CURSORS_MAP","initElementCursor","element","_getElementCursors","_setElementCursor","cursors","resetElementCursor","hideElementCursor","WeakMap","ImageMouseCursor","url","x","super","getUniqueInstanceName","Number","prefix","utilities","BASE","iconContent","iconSize","viewBox","mousePoint","mousePointerGroupString","SEGMENTATION_CURSOR_BOUNDARIES","MINUS_RECT","PLUS_RECT","SCISSOR_ICON","RECTANGLE_ICON","CIRCLE_ICON","CursorSVG","Angle","extend","ArrowAnnotate","Bidirectional","CobbAngle","CircleROI","EllipticalROI","FreehandROI","FreehandROISculptor","Length","Height","Probe","RectangleROI","TextMarker","Crosshairs","Eraser","Magnify","Pan","Rotate","StackScroll","WindowLevelRegion","WindowLevel","Zoom","SegmentationFreeHandEraseInside","SegmentationFreeHandFillInside","SegmentationFreeHandEraseOutside","SegmentationFreeHandFillOutside","SegmentationRectangleEraseInside","RectangleScissor","CircleScissor","base","assign","create","registerCursor","toolName","svgCursorNames","keys","STATE","AnnotationStyleStates","Highlighted","MODE","ToolModes","Active","SVGMouseCursor","pointer","color","urn","type","getCursorURN","descriptor","getDefinedSVGCursorDescriptor","options","blob","svgString","createSVGIconWithPointer","createSVGIcon","Blob","createSVGIconBlob","URL","createObjectURL","createSVGIconUrl","createSVGMouseCursor","format","template","dictionary","dict","defined","prototype","hasOwnProperty","bind","replace","match","key","svgSize","max","cursorName","log","setElementCursor","CursorNames","VIEWPORT_ELEMENT","getSvgNode","canvasHash","cacheKey","state","svgNodeCache","domRef","appendNode","svgLayerElement","svgNode","touched","appendChild","setNodeTouched","clearUntouched","cacheEntry","removeChild","enabledElement","getEnabledElement","viewportId","renderingEngineId","viewportElement","internalDivElement","querySelector","svgLayer","_getSvgLayer","svgNodeCacheForCanvas","fn","svgDrawingHelper","attributes","currentValue","getAttribute","newValue","removeAttribute","setAttribute","annotationUID","circleUID","center","radius","dataId","width","lineWidth","lineDash","fillOpacity","strokeOpacity","strokeWidth","svgNodeHash","_getHash","existingCircleElement","cx","cy","r","stroke","newCircleElement","document","createElementNS","ellipseUID","canvasCoordinates","existingEllipse","bottom","top","left","right","w","hypot","h","angle","atan2","PI","rx","ry","transform","svgEllipseElement","corner1","corner2","handleGroupUID","handle","uniqueIndex","handleRadius","opacity","side","parseFloat","height","existingHandleElement","newHandleElement","handlePoints","i","drawLine","lineUID","start","end","shadow","existingLine","dropShadowStyle","id","x1","y1","x2","y2","newLine","drawHeight","heightUID","midX","endfirstLine","endsecondLine","firstLine","secondLine","threeLine","drawPolyline","polylineUID","points","fillColor","closePath","existingPolyLine","pointsAttribute","point","toFixed","firstPoint","newPolyLine","drawPath","pathUID","pointsArrays","existingNode","numArrays","numPoints","j","newNode","_createTextSpan","text","textSpanElement","textContent","_drawTextBackground","group","getBBox","insertBefore","firstChild","bBox","textUID","textLines","position","padding","fontFamily","fontSize","background","textGroupBoundingBox","svgns","existingTextGroup","textElement","textSpans","from","children","textSpan","textGroupAttributes","textGroup","noSelectStyle","combinedStyle","_createTextElement","_drawTextGroup","centerX","centerY","linkUID","annotationAnchorPoints","refPoint","boundingBox","findClosestPoint","boundingBoxPoints","halfWidth","halfHeight","_boundingBoxPoints","textBoxUID","textBoxPosition","textBox","mergedOptions","centering","canvasBoundingBox","drawRectByCoordinates","rectangleUID","_width","existingRect","topLeft","topRight","bottomLeft","bottomRight","leftEdgeCenter","svgRectElement","drawRect","drawArrow","arrowUID","cos","sin","drawRedactionRect","tlhc","min","abs","DEFAULT_CONTOUR_SEG_TOOL_NAME","async","contourSegmentationCompletedListener","evt","sourceAnnotation","detail","annotation","isContourSegmentationAnnotation","viewport","viewports","viewportWithToolRegistered","find","isFreehandContourSegToolRegisteredForViewport","getViewport","contourSegmentationAnnotations","sourceAnnotationUID","getAllAnnotations","filter","targetAnnotation","areSameSegment","isReferenceViewable","metadata","getValidContourSegmentationAnnotations","sourcePolyline","convertContourPolylineToCanvasSpace","data","contour","polyline","targetAnnotationInfo","sourceAABB","targetPolyline","targetAABB","aabbIntersect","lineSegmentsIntersect","isContourHole","findIntersectingContour","contourHoleProcessingEnabled","createPolylineHole","sourceStartPoint","mergePolylines","contourHolesData","getChildAnnotations","holeAnnotation","getContourHolesData","unassignedContourHolesSet","reassignedContourHolesMap","assignHoleToPolyline","parentPolyline","holeData","holes","push","delete","newPolylines","mergedPolyline","newPolyline","contourHolesDataArray","contourHoleData","clearParentAnnotation","handles","segmentation","removeAnnotation","startPoint","canvasToWorld","endPoint","newAnnotation","originalToolName","cachedStats","closed","spline","highlighted","invalidated","isLocked","isVisible","interpolationUID","interpolationCompleted","targetWindingDirection","Clockwise","addAnnotation","addContourSegmentationAnnotation","addChildAnnotation","updatedTtoolNames","viewportIdsToRender","getViewportIdsWithToolToRender","Promise","resolve","window","requestAnimationFrame","updateViewports","combinePolylines","silent","toolGroup","getToolGroupForViewport","errorMessage","hasTool","getToolOptions","projectedPolyline","worldToCanvas","windingDirection","holeWindingDirection","removeContourSegmentationAnnotation","holeContour","holePolyline","updatedToolNames","disable","removeEventListener","mouseDoubleClickListener","mouseDownListener","mouseMoveListener","capture","enable","addEventListener","preventGhostClick","touchStartListener","passive","wheelListener","segmentationId","modifiedSlicesToUse","representationData","viewportIds","hasVolumeViewport","some","getEnabledElementByViewportId","VolumeViewport","hasStackViewport","StackViewport","hasBothStackAndVolume","segmentationVolume","cache","getVolume","volumeId","imageData","vtkOpenGLTexture","slicesToUpdate","numSlices","getDimensions","setUpdatedFrame","modified","performVolumeLabelmapUpdate","SegmentationRepresentations","Labelmap","representations","representation","actorEntry","segImageData","actor","getMapper","getInputData","currentSegmentationImageId","segmentationImage","getImage","performStackLabelmapUpdate","getSegmentation","_imageChangeEventListener","eventData","getEnabledElementByIds","getSegmentationRepresentation","labelmapRepresentations","actors","getActors","updateLabelmapSegmentationImageReferences","labelmapActors","getCurrentLabelmapImageIdForViewport","referencedId","removeActors","uid","currentImageId","getCurrentImageId","derivedImageId","derivedImage","segmentationActorInput","dimensions","spacing","direction","getImageDataMetadata","currentImage","imageId","origin","currentOrigin","originToUse","voxelManager","getConstructor","newPixelData","getScalarData","scalarArray","numberOfComponents","setDimensions","setSpacing","setDirection","setOrigin","getPointData","setScalars","addImages","representationUID","callback","imageActor","setInputData","segmentationImageData","setDerivedImage","render","Enums","IMAGE_RENDERED","BaseVolumeViewport","STACK_NEW_IMAGE","annotationCompletedListener","contourSegmentationCompleted","removed","getRenderingEngines","renderingEngine","getViewports","vp","triggerAnnotationRenderForViewportIds","t","annotationRemovedListener","onImageRendered","triggerAnnotationRender","Events","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DOWN_ACTIVATE","MOUSE_DOUBLE_CLICK","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_WHEEL","KEY_DOWN","KEY_UP","Passive","Enabled","onCameraModified","getToolsWithModesForMouseEvent","tool","CAMERA_MODIFIED","onImageSpacingCalibrated","IMAGE_SPACING_CALIBRATED","TOUCH_START","TOUCH_START_ACTIVATE","TOUCH_DRAG","TOUCH_END","TOUCH_TAP","TOUCH_PRESS","eventTarget","ANNOTATION_COMPLETED","InterpolationManager","handleAnnotationCompleted","ANNOTATION_MODIFIED","handleAnnotationUpdate","ANNOTATION_REMOVED","handleAnnotationDelete","onCameraReset","onResetCamera","CAMERA_RESET","addEnabledElement","svgLayerId","classList","add","pointerEvents","defs","feOffset","feColorMatrix","feBlend","_createSvgAnnotationLayer","viewportUid","renderingEngineUid","dataset","elementHash","_setSvgNodeCache","addViewportElement","imageRenderedEventDispatcher","cameraModifiedEventDispatcher","imageSpacingCalibratedEventDispatcher","cameraResetEventDispatcher","enabledElements","synchronizersFilteredByIds","synchronizers","synchronizer","notDisabled","isDisabled","hasSourceViewport","hasTargetViewport","_removeViewportFromSynchronizers","sync","remove","_removeViewportFromToolGroup","removeViewports","_removeEnabledElement","foundElementIndex","findIndex","el","splice","elementDisabledEvt","_resetSvgNodeCache","internalViewportNode","_removeSvgNode","removeViewportElement","cancelActiveManipulations","tools","toolsWithData","cancel","_getViewportIndex","arr","ar","_containsViewport","synchronizerId","eventName","eventHandler","_viewportOptions","_onEvent","_ignoreFiredEvents","_targetViewports","_eventSource","currentTarget","_sourceViewports","s","fireEvent","_enabled","_eventName","_eventHandler","_options","eventSource","_auxiliaryEvents","auxiliaryEvents","_hasSourceElements","setOptions","setEnabled","enabled","getOptions","viewportInfo","addTarget","addSource","getRenderingEngine","source","_updateDisableHandlers","getSourceViewports","getTargetViewports","destroy","removeSource","removeTarget","getViewportElement","sourceViewport","sourceEvent","promises","targetViewport","ex","allSettled","then","vp1","vp2","unique","vps","concat","u","_getUniqueViewports","_remove","disableHandler","elementDisabledEvent","getEventSource","ELEMENT_DISABLED","pop","synchronizerIndex","csToolsInitialized","init","defaultConfiguration","_removeCornerstoneEventListeners","elementEnabledEvent","ELEMENT_ENABLED","annotationInterpolationEventDispatcher","_addCornerstoneEventListeners","_removeCornerstoneToolsEventListeners","ANNOTATION_SELECTION_CHANGE","SEGMENTATION_MODIFIED","SEGMENTATION_DATA_MODIFIED","SEGMENTATION_REPRESENTATION_MODIFIED","SEGMENTATION_REPRESENTATION_ADDED","ToolGroupManager","annotationManager","getAnnotationManager","segmentationStateManager","restoreAnnotations","resetState","cameraSyncCallback","synchronizerInstance","cameraModifiedEvent","camera","tViewport","setCamera","createCameraPositionSynchronizer","synchronizerName","presentationViewSyncCallback","_synchronizerInstance","_sourceEvent","presentationView","getViewPresentation","setViewPresentation","createPresentationViewSynchronizer","viewPresentation","voiSyncCallback","modifiedEvent","eventDetail","range","invertStateChanged","invert","colormap","tProperties","voiRange","syncInvertState","syncColormap","_actors","size","setProperties","createVOISynchronizer","VOI_MODIFIED","COLORMAP_MODIFIED","zoomPanSyncCallback","sViewport","syncZoom","srcZoom","getZoom","setZoom","syncPan","srcPan","getPan","setPan","createZoomPanSynchronizer","getSpatialRegistration","targetId","sourceId","imageSliceSyncCallback","disabled","imageId1","sourceImagePositionPatient","metaData","imagePositionPatient","targetImageIds","getImageIds","viewport1","viewport2","viewPlaneNormal","viewPlaneNormal1","getCamera","viewPlaneNormal2","dotProducts","areViewportsCoplanar","registrationMatrixMat4","getFrameOfReferenceUID","useInitialPosition","targetImagePositionPatientWithRegistrationMatrix","closestImageIdIndex2","targetPoint","reduce","closestImageIdIndex","distance","Infinity","imageIndexToSet","getCurrentImageIdIndex","imageIndex","VOLUME_NEW_IMAGE","createImageSliceSynchronizer","slabThicknessSyncCallback","slabThickness","getSlabThickness","setSlabThickness","createStackImageSynchronizer","PanTool","toolProps","defaultToolProps","supportedInteractionTypes","touchDragCallback","_dragCallback","mouseDragCallback","deltaPoints","deltaPointsWorld","world","focalPoint","updatedPosition","updatedFocalPoint","TrackballRotateTool","configuration","rotateIncrementDegrees","_resizeObservers","_hasResolutionChanged","preMouseDownCallback","mapper","getDefaultActor","originalSampleDistance","getSampleDistance","setSampleDistance","cleanUp","once","_getViewportsInfo","getToolGroup","toolGroupId","viewportsInfo","onSetToolActive","subscribeToElementResize","resizeObserver","ResizeObserver","resetCamera","observe","_viewportAddedListener","TOOLGROUP_VIEWPORT_ADDED","onSetToolDisabled","disconnect","rotateCamera","centerWorld","axis","vtkCamera","getVtkActiveCamera","viewUp","getViewUp","getFocalPoint","getPosition","newPosition","newFocalPoint","newViewUp","Float32Array","currentPoints","lastPoints","currentPointsCanvas","canvas","lastPointsCanvas","clientWidth","clientHeight","normalizedPosition","normalizedPreviousPosition","radsq","op","oe","opsq","oesq","lop","sqrt","loe","nop","noe","dot","angleX","acos","sign","upVec","atV","rightV","forwardV","angleY","WindowLevelTool","_getImageDynamicRangeFromMiddleSlice","scalarData","middleSliceIndex","floor","frameLength","bytesPerVoxel","TypedArrayConstructor","Uint8Array","Uint16Array","Int16Array","frame","buffer","_getMinMax","lower","upper","modality","newRange","viewportsContainingVolumeUID","isPreScaled","properties","getProperties","getVolumeId","volume","Modality","scaling","preScale","scaled","getImageData","scalingParameters","getPTScaledNewRange","deltaPointsCanvas","getNewRange","multiplier","_getMultiplierFromDynamicRange","wwDelta","wcDelta","windowWidth","windowCenter","imageDynamicRange","imageVolume","calculatedDynamicRange","getMiddleSliceData","acc","pixel","BitsStored","metadataDynamicRange","_getImageDynamicRangeFromViewport","ratio","round","getRange","imageDataRange","getScalars","getData","voxel","WindowLevelRegionTool","minWindowWidth","addNewAnnotation","worldPos","isDrawing","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getToolName","editData","_activateDraw","preventDefault","_endCallback","_deactivateDraw","applyWindowLevelRegion","bottomLeftCanvas","topRightCanvas","bottomRightCanvas","topLeftCanvas","bottomRightWorld","topLeftWorld","isInteractingWithTool","renderAnnotation","renderStatus","annotations","filterInteractableAnnotationsForElement","styleSpecifier","p","getAnnotationStyle","windowLevel","startCanvas","endCanvas","pixelLuminanceData","minMaxMean","minPixelValue","maxPixelValue","mean","isPointNearTool","toolSelectedCallback","handleSelectedCallback","_activateModify","_deactivateModify","StackScrollTool","debounceIfNotLoaded","loop","deltaY","mouseWheelCallback","_scroll","_scrollDrag","deltaPointY","pixelsPerImage","_getPixelPerImage","imageIdIndexOffset","delta","debounceLoading","wheel","scrollSlabs","numberOfSlices","getNumberOfSlices","offsetHeight","PlanarRotateTool","setAngle","startPoints","currentPointWorld","startPointWorld","centerCanvas","angleBetweenLines","v1","v2","cross","rotAngle","rotMat","rotatedViewUp","rotation","ZoomTool","zoomToCenter","minZoomScale","maxZoomScale","pinchToZoom","pan","initialMousePosWorld","dirVec","preTouchStartCallback","_dragParallelProjection","pinch","deltaDistance","parallelScale","k","parallelScaleToSet","focalPointToSet","positionToSet","distanceToCanvasCenter","scale","cappedParallelScale","thresholdExceeded","_dragPerspectiveProjection","zoomScale","directionOfProjection","tmp","_pinchCallback","currentPointsList","parallelProjection","_panCallback","MIPJumpToClickTool","targetViewportIds","mouseClickCallback","maxIntensity","brightestPoint","getPointInLineOfSightWithCriteria","intensity","indexOf","foundToolGroup","jumpToWorld","RENDERING_DEFAULTS","CONSTANTS","defaultReferenceLineColor","defaultReferenceLineControllable","defaultReferenceLineDraggableRotatable","defaultReferenceLineSlabThicknessControlsOn","OPERATION","CrosshairsTool","viewportIndicators","viewportIndicatorsConfig","autoPan","panSize","referenceLinesCenterGapRadius","filterActorUIDsToSetSlabThickness","slabThicknessBlendMode","MAXIMUM_INTENSITY_BLEND","mobile","toolCenter","initializeViewport","_getAnnotations","cameraPosition","cameraFocalPoint","rotationPoints","slabThicknessPoints","activeOperation","activeViewportIds","normal","resetCrosshairs","resetPan","resetZoom","resetToCenter","resetRotation","suppressEvents","resetSlabThickness","_computeToolCenter","computeToolCenter","firstViewport","secondViewport","thirdViewport","normal1","point1","normal2","point2","normal3","point3","firstPlane","secondPlane","thirdPlane","jumpWorld","_jump","filteredAnnotations","viewportIdArray","otherViewport","viewportControllable","_getReferenceLineControllable","viewportDraggableRotatable","_getReferenceLineDraggableRotatable","canvasCoords","proximity","_pointNearTool","interactionType","viewportAnnotation","currentCamera","oldCameraPosition","deltaCameraPosition","oldCameraFocalPoint","deltaCameraFocalPoint","isRotation","cameraModifiedInPlane","getViewportIds","_autoPanViewportIfNecessary","mouseMoveCallback","filteredToolAnnotations","imageNeedsUpdate","isAnnotationLocked","previousActiveOperation","previousActiveViewportIds","near","getHandleNearImagePoint","_areViewportIdArraysEqual","viewportUIDSpecificCrosshairs","canvasDiagonalLength","canvasMinDimensionLength","crosshairCenterCanvas","otherViewportAnnotations","_filterAnnotationsByUniqueViewportOrientations","referenceLines","canvasBox","otherCamera","otherViewportControllable","otherViewportDraggableRotatable","otherViewportSlabThicknessControlsOn","_getReferenceLineSlabThicknessControlsOn","otherCanvasDiagonalLength","otherCanvasCenter","otherViewportCenterWorld","pointWorld0","pointWorld1","pointCanvas0","otherViewportCenterCanvas","canvasUnitVectorFromCenter","canvasVectorFromCenterLong","canvasVectorFromCenterMid","canvasVectorFromCenterShort","canvasVectorFromCenterStart","centerGap","refLinePointOne","refLinePointTwo","refLinePointThree","refLinePointFour","refLinesCenter","liangBarksyClip","rotHandleOne","rotHandleTwo","stHandlesCenterCanvas","stHandlesCenterWorld","worldUnitVectorFromCenter","matrix","buildFromDegree","rotate","worldUnitOrthoVectorFromCenter","slabThicknessValue","worldOrthoVectorFromCenter","worldVerticalRefPoint","canvasVerticalRefPoint","canvasOrthoVectorFromCenter","stLinePointOne","stLinePointTwo","stLinePointThree","stLinePointFour","stHandleOne","stHandleTwo","stHandleThree","stHandleFour","newRtpoints","newStpoints","viewportColor","_getReferenceLineColor","line","lineIndex","viewportSlabThicknessControlsOn","selectedViewportId","lineActive","rotHandlesActive","rotationHandles","rotHandleWorldOne","rotHandleWorldTwo","slabThicknessHandlesActive","slabThicknessHandles","slabThicknessHandleWorldOne","slabThicknessHandleWorldTwo","slabThicknessHandleWorldThree","slabThicknessHandleWorldFour","handleUID","drawHandles","referenceColorCoordinates","xOffset","yOffset","circleRadius","drawCircle","getAnnotations","toolGroupAnnotations","_onNewVolume","viewportIdArrayOne","viewportIdArrayTwo","itemFound","_getAnnotationsForViewportsWithDifferentCameras","viewportsWithDifferentCameras","cameraOfTarget","_filterViewportWithSameOrientation","referenceAnnotation","linkedViewportAnnotations","otherViewportsAnnotationsWithSameCameraDirection","otherViewPlaneNormal","otherLinkedViewportAnnotationsFromSameScene","otherViewportsAnnotationsWithUniqueCameras","cameraFound","jj","cameraOfStocked","otherNonLinkedViewportAnnotationsFromSameScene","_checkIfViewportsRenderingSameScene","volumeIds","getAllVolumeIds","otherVolumeIds","viewportsAnnotationsToUpdate","sameScene","_applyDeltaShiftToSelectedViewportCameras","dir1","dir2","finalPointCanvas","originalPointCanvas","_isClockWise","rotationAxis","buildFromRadian","translate","otherViewportsIds","renderViewports","referenceAnnotations","viewportsIds","dotProd","projectedDelta","mod","currentPoint","currentCenter","otherViewportRotationPoints","dotProdDirection","projectedDirection","normalizedProjectedDirection","normalizedProjectedDelta","MINIMUM_SLAB_THICKNESS","_pointNearReferenceLine","getToolInstance","lineViewport","lineSegment1","distanceToPoint1","lineSegment2","distanceToPoint2","getReferenceLineColor","getReferenceLineControllable","getReferenceLineDraggableRotatable","getReferenceLineSlabThicknessControlsOn","_unsubscribeToViewportNewVolumeSet","_subscribeToViewportNewVolumeSet","onSetToolPassive","onSetToolEnabled","_getRotationHandleNearImagePoint","_getSlabThicknessHandleNearImagePoint","VOLUME_VIEWPORT_NEW_VOLUME","toolCenterCanvas","visiblePointCanvas","visiblePointWorld","actorUIDs","blendModeToUse","COMPOSITE","setBlendMode","c","_applyDeltaShiftToViewportCamera","annotationCanvasCoordinate","stPointLineCanvas1","stPointLineCanvas2","stPointLineCanvas1Start","stPointLineCanvas2Start","MAGNIFY_VIEWPORT_ID","MagnifyTool","magnifySize","magnifyWidth","magnifyHeight","_hasBeenRemoved","_getReferencedImageId","_createMagnificationViewport","viewportProperties","canvasPos","magnifyToolElement","magnifyElement","createElement","display","viewportInput","STACK","enableElement","magnifyViewport","setStack","_dragEndCallback","disableElement","getTargetId","split","csEvents","isSegmentation","AdvancedMagnifyToolActions","PARALLEL_THRESHOLD","AdvancedMagnifyTool","Actions","magnifyingGlass","zoomFactor","zoomFactorList","actions","showZoomFactorsList","method","bindings","mouseButton","MouseBindings","Secondary","modifierKey","KeyboardBindings","Shift","config","canvasHandlePoints","_getCanvasHandlePoints","magnifyViewportId","sourceViewportId","isCanvasAnnotation","activeHandleIndex","magnifyViewportManager","createViewport","sourceEnabledElement","annotationPoints","canvasDelta","len","dispose","canvasTop","canvasBottom","canvasLeft","radiusPoint","handleIndex","_dragDrawCallback","hasMoved","_dragModifyCallback","_dragHandle","canvasCenter","currentCanvasPoints","newRadius","newCanvasHandlePoints","getStyle","activeHandleCanvasCoords","isAnnotationVisible","update","canvasCenterPos","canvasRadius","AdvancedMagnifyViewportManager","getInstance","canvasPoint","currentZoomFactor","dropdown","_getZoomFactorsListDropdown","newZoomFactor","parentElement","focus","onChangeCallback","stopPropagation","keyCode","which","toLowerCase","option","label","title","defaultSelected","sourceElement","AdvancedMagnifyViewport","_addSourceElementEventListener","_magnifyViewportsMap","magnifyViewportInfo","_annotationRemovedCallback","destroyViewport","_newStackImageCallback","magnifyViewportsMapEntries","_getMagnifyViewportsMapEntriesBySourceViewportId","stackActorReInitialized","_reset","_newVolumeImageCallback","currentViewPlaneNormal","worldImagePlanePoint","vecHandleToImagePlane","worldDist","worldDelta","_initialize","_singleton","_removeEventListeners","_destroyViewports","magnifyViewportMapEntry","_removeSourceElementEventListener","newEnabledElement","_addEventListeners","newStackHandler","VIEWPORT_NEW_IMAGE_SET","newVolumeHandler","_enabledElement","_sourceToolGroup","_magnifyToolGroup","_isViewportReady","_radius","_resized","_canAutoPan","_viewportId","_sourceEnabledElement","_autoPan","visible","_browserMouseDownCallback","_browserMouseUpCallback","_handleToolModeChanged","_mouseDragCallback","_resizeViewportAsync","debounce","_resizeViewport","_syncViewports","parentNode","magnifyToolGroup","mode","toolBindingsOptions","setToolActive","setToolPassive","setToolEnabled","Disabled","setToolDisabled","_inheritBorderRadius","borderRadius","_createViewportNode","overflow","boxSizing","_convertZoomFactorToParallelScale","offsetWidth","_isStackViewport","_isVolumeViewport","_cloneToolGroups","sourceActors","magnifyToolGroupId","sourceToolGroup","clone","toolInstance","addViewport","addSegmentationRepresentations","_cloneStack","imageIds","_cloneVolumes","volumeInputArray","setVolumes","_cloneViewport","sourceViewportOptions","defaultOptions","toolGroups","_cancelMouseEventCallback","target","closest","canvasCurrent","magnifyRadius","dist","distanceToPoint","maxDist","panDist","canvasDeltaPos","newCanvasPosition","currentWorldPos","newWorldPos","worldDeltaPos","autoPanCallbackData","currentPosition","_addBrowserEventListeners","_removeBrowserEventListeners","TOOL_MODE_CHANGED","sourceCanvas","_syncViewportsCameras","_syncStackViewports","setImageIdIndex","sourceProperties","resize","EPSILON","ReferenceLines","AnnotationDisplayTool","A","enforceSameFrameOfReference","showFullDimension","_init","filterViewportsWithToolEnabled","sourceViewportCanvasCornersInWorld","onSetToolConfiguration","sourceViewPlaneNormal","isParallel","targetViewportPlane","pointSet1","pointSet2","pointSetToUse","topBottomVec","topRightVec","newNormal","isPerpendicular","lineStartWorld","lineEndWorld","handleFullDimension","vec1","vec2","targetImage","getTargetImageData","topLeftImageCoord","topRightImageCoord","bottomRightImageCoord","bottomLeftImageCoord","indexToWorld","lineStartImageCoord","lineEndImageCoord","intersectInfiniteLines","isInBound","err","line1Start","line1End","line2Start","line2End","x3","y3","x4","y4","a1","b1","c1","a2","b2","c2","OverlayGridTool","sourceImageIds","imagePlaneModule","frameOfReferenceUID","pointSets","calculateImageIdPointSets","viewportData","rows","columns","rowCosines","columnCosines","rowPixelSpacing","columnPixelSpacing","imageIdNormal","getImageIdNormal","targetData","initializeViewportData","pointSetsToUse","lineStartsWorld","lineEndsWorld","imageOrientationPatient","rowCosineVec","colCosineVec","SegmentationIntersectionTool","actorsWorldPointsMap","calculateSurfaceSegmentationIntersectionsForViewport","calculateSurfaceSegmentationIntersections","actorEntries","cacheId","getCacheId","clippingFilter","actorWorldPointMap","polyLineIdx","worldPointsSet","canvasPoints","polyLineUID","actorWorldPointsMap","polyData","getOutputData","polyDataUtils","colorArray","colorComponentToString","component","componentString","toString","colorToString","getProperty","getColor","pointToString","ReferenceCursors","preventHandleOutsideImage","displayThreshold","positionSync","disableCursor","isHandleOutsideImage","_elementWithCursor","_currentCursorWorldPosition","_currentCanvasPosition","_disableCursorEnabled","getActiveAnnotation","createInitialAnnotation","updateAnnotationPosition","worldPosition","worldBoundingBox","previousCamera","oldFocalPoint","cameraNormal","dotProduct","isElementWithCursor","updateViewportImage","lineWidthBase","e","crosshairUIDs","centerSpace","lineLength","plane","currentMousePosition","closestIndex","currentDistance","normalizedViewPlane","scaledPlaneNormal","renderViewport","viewportsWithAnnotations","ScaleOverlayTool","scaleLocation","viewportCanvasCornersInWorld","thisAnnotation","computeScaleSize","worldWidthViewport","worldHeightViewport","location","scaleSizes","currentScaleSize","scaleSize","computeEndScaleTicks","locationTickOffset","endTick1","endTick2","computeInnerScaleTicks","leftTick","rightTick","canvasScaleSize","tickIds","tickUIDs","tickCoordinates","numberSmallTicks","tickSpacing","locationOffset","computeWorldScaleCoordinates","pointSet","worldCoordinates","midpointLocation","midpoint","offset","computeCanvasScaleCoordinates","canvasSize","vscaleBounds","hscaleBounds","scaleCanvasCoordinates","worldDistanceOnCanvas","computeScaleBounds","horizontalReduction","verticalReduction","hReduction","vReduction","locationBounds","canvasBounds","devicePixelRatio","scaleTicks","scaleId","leftTickId","rightTickId","locationTextOffest","textCanvasCoordinates","textBoxLines","_getTextLines","drawTextBox","scaleSizeDisplayValue","scaleSizeUnits","SculptorTool","minSpacing","referencedToolNames","toolShape","referencedToolName","registeredShapes","isActive","commonData","activeAnnotationUID","isEditingOpenContour","canvasLocation","configureToolSize","selectFreehandTool","activateModify","updateCursor","endCallback","deactivateModify","activeAnnotation","filterSculptableAnnotationsForElement","calculateStats","dragCallback","sculpt","registerShapes","CircleSculptCursor","shapeName","setToolShape","shapeClass","shape","cursorShape","selectedShape","sculptData","mouseCanvasPoint","maxSpacing","getMaxSpacing","pushedHandles","pushHandles","first","insertNewHandles","interpolatePointsWithinMaxSpacing","indicesToInsertAfter","nextHandleIndex","contourIndex","currentCanvasPoint","nextCanvasPoint","updateToolSize","sculptableAnnotations","findNewHandleIndices","newIndexModifier","insertIndex","insertHandleRadially","last","previousIndex","nextIndex","handleData","getInsertPosition","closestAnnotationUID","getClosestFreehandToolOnElement","toolIndex","distanceFromTool","distancePointToContour","Default","renderShape","DIRECTIONS","VolumeRotateTool","cz","ax","ay","az","transformWorldToIndex","LengthTool","getTextLines","defaultGetTextLines","getViewReference","movingTextBox","canvasPoint1","canvasPoint2","worldPosDelta","unit","_throttledCalculateCachedStats","_calculateCachedStats","getLinkedTextBoxStyle","visibility","canvasTextBoxCoords","getTextBoxCoordsCanvas","drawLinkedTextBox","throttle","trailing","hydrate","autoGenerated","_calculateLength","pos1","pos2","dx","dy","dz","worldPos1","worldPos2","targetIds","image","index1","index2","_isInsideVolume","cachedVolumeStats","HeightTool","_calculateHeight","outside","ProbeTool","eventDispatchDetail","startsWith","getStackViewports","referencedImageURI","hasImageURI","currentImageURI","pixelUnitsOptions","isViewportPreScaled","isSuvScaled","ijk","modalityUnit","getAtIJKPoint","imageURI","calibratedResults","hasEnhancedRegionValues","units","getPixelValueUnits","DragProbeTool","postMouseDownCallback","postTouchStartCallback","EllipticalROITool","storePointData","centerPointRadius","statsCalculator","BasicStatsCalculator","initialRotation","getRotation","canvasCorners","getCanvasEllipseCorners","minorEllipse","majorEllipse","pointInMinorEllipse","_pointInEllipseCanvas","canvasWidth","canvasHeight","originalHandleCanvas","pointsCanvas","dX","dY","bottomCanvas","topCanvas","leftCanvas","rightCanvas","dYCanvas","newHalfCanvasWidth","canvasRight","dXCanvas","newHalfCanvasHeight","areaUnit","area","stdDev","centerPoint","_getCanvasEllipseCenter","pos1Index","post2Index","boundsIJK","ellipseObj","xRadius","yRadius","zRadius","worldWidth","worldHeight","getWorldWidthAndHeightFromTwoPoints","isEmptyArea","pointsInShape","statsCallback","isInObject","pointLPS","pointInEllipse","fast","returnPoints","stats","getStatistics","statsArray","array","ellipse","normalized","ellipseCanvasPoints","areaLine","CircleROITool","canvasEnd","radiusUnit","perimeter","pos2Index","aspect","radiusLine","ETDRSGridTool","degrees","diameters","diametersCanvas","diameter","worldMeasureToCanvas","degreesRad","angleRadians","degree","measurement","p1","p2","p1Canvas","p2Canvas","DEFAULT_SPLINE_CONFIG","resolution","controlPointAdditionDistance","controlPointDeletionDistance","showControlPointsConnectors","controlPointAdditionEnabled","controlPointDeletionEnabled","SplineTypesEnum","SplineToolActions","SplineROITool","ContourSegmentationBaseTool","SplineTypes","contourHoleAdditionModifierKey","decimate","epsilon","Cardinal","Class","CardinalSpline","CatmullRom","CatmullRomSpline","Linear","LinearSpline","BSpline","drawPreviewEnabled","lastControlPointDeletionKeys","AddControlPoint","Primary","DeleteControlPoint","Ctrl","fireChangeOnUpdate","isPointNearCurve","changeType","ChangeTypes","Completed","HandlesUpdated","_keyDownCallback","controlPointIndex","_deleteControlPointByIndex","_mouseMoveCallback","lastCanvasPoint","_mouseDownCallback","doubleClick","worldPoint","closeContour","addNewPoint","closestControlPoint","getClosestControlPointWithinDistance","moveAnnotation","triggerAnnotationCompleted","eventType","triggerEvent","triggerAnnotationModified","StatsUpdated","triggerChangeEvent","_renderStats","textboxStyle","addControlPointCallback","splineType","splineConfig","_getSplineConfig","closestPointInfo","getClosestPoint","addControlPointAtU","uValue","deleteControlPointCallback","originalWorldPoint","deltaXPoint","deltaYPoint","deltaInX","deltaInY","maxX","canvasMaxX","maxY","canvasMaxY","minX","canvasMinX","minY","canvasMinY","math","getAABB","topLeftBBWorld","topLeftBBIndex","bottomRightBBWorld","getArea","getMouseModifier","event","createAnnotation","cancelAnnotation","isContourSegmentationTool","renderAnnotationInstance","renderContext","annotationStyle","controlPoints","locked","annotationLocked","childAnnotations","it","childAnnotationUIDs","join","_isSplineROIAnnotation","splinePolylineCanvas","_updateSplineInstance","getPolylinePoints","updateContourPolyline","updateWindingDirection","numControlPoints","previewPolylinePoints","getPreviewPolylinePoints","controlPointsConnectors","textbox","createInterpolatedSplineControl","increment","contourAnnotation","createSpline","onInterpolationComplete","interpolation","splineConfigs","setControlPoints","fixedResolution","fixedScale","splineInstance","SplineClass","splinePolylineWorld","SplineContourSegmentationTool","LivewireContourTool","snapHandleNearby","nearestEdge","showInterpolationPolyline","undo","proximitySquared","lineSegment","distanceToPointSquared","clearAnnotation","clearEditData","worldToSlice","sliceToWorld","worldPosOriginal","currentPath","getControlPoints","closestHandlePoint","distSquared","worldControlPoint","canvasControlPoint","snapPoint","scissors","findMinNearby","pathPoints","findPathToPoint","addPoints","prependPath","confirmedPath","lastPoint","getLastPoint","addControlPoint","startSearch","updateAnnotation","imgWidth","imgHeight","slicePoint","editHandle","getCalibratedLengthUnitsAndScale","setupBaseEditData","nextPos","viewportImageData","vtkImageData","sliceImageData","sliceToIndexMatrix","indexToSliceMatrix","ijkPoint","startPos","LivewireScissors","createInstanceFromRawPixelData","scissorsNext","currentPathNext","addPoint","confirmedPathNext","numHandles","previousHandle","nextHandle","findHandlePolylineIndex","slice","slicePos","pathPointsLeft","pathPointsRight","reverse","appendPath","contourSegmentationAnnotation","canvasHandles","livewirePath","pointArray","imagePoints","LivewireContourSegmentationTool","updateInterpolatedAnnotation","interpolationSources","originalPolyline","queueMicrotask","count","repeatInterpolation","originalPoints","handleSmoothing","hIndex","testPoint","minPoint","acceptedPath","path","InterpolationUpdated","rendered","polylineCanvasPoints","ArrowAnnotateTool","getTextCallback","changeTextCallback","arrowFirst","touchTapCallback","taps","doubleClickCallback","clickedAnnotation","_doneChangingTextCallback","stopImmediatePropagation","updatedText","doneChangingTextCallback","prompt","AngleTool","angleStartedNotYetCompleted","line1","canvasPoint3","line2","worldPos3","String","fromCharCode","CobbAngleTool","showArcLines","distanceToLines","isNearFirstLine","isNearSecondLine","_mouseUpCallback","arc1Angle","arc2Angle","arc1Start","arc1End","arc2Start","arc2End","mid1","midPoint","mid2","arc1TextBoxUID","arc1TextLine","arch1TextPosCanvas","arc2TextBoxUID","arc2TextLine","arch2TextPosCanvas","point4","canvasPoint4","getArcsStartEndPoints","linkLine","arc1Side","arc2Side","midLinkLine","linkLineLength","midFirstLine","midSecondLine","directionVectorStartArc1","magnitudeStartArc1","normalizedDirectionStartArc1","directionVectorEndArc1","magnitudeEndArc1","normalizedDirectionEndArc1","directionVectorStartArc2","magnitudeStartArc2","normalizedDirectionStartArc2","directionVectorEndArc2","magnitudeEndArc2","normalizedDirectionEndArc2","seg1","seg2","minDist","MAX_VALUE","UltrasoundDirectionalTool","displayBothAxesDistances","startedDrawing","xValues","yValues","isHorizontal","isUnitless","drawHandle","canvasDeltaY","canvasDeltaX","projectedPointCanvas","imageIndex1","imageIndex2","values1","units1","values2","units2","dist1","dist2","KeyImageTool","canvasPosition","AnnotationEraserTool","_deleteNearbyAnnotations","_toolInstances","annotationsToRemove","interactableAnnotations","setAnnotationSelected","RectangleScissorsTool","strategies","FILL_INSIDE","ERASE_INSIDE","defaultStrategy","activeStrategy","activeLabelmapSegmentation","activeSegmentation","segmentIndex","segmentsLocked","segmentLocking","segmentColor","labelmapData","referencedVolumeId","segmentationImageId","bottomLeftWorld","topRightWorld","operationData","applyActiveStrategy","toolMetadata","CircleScissorsTool","strategySpecificConfiguration","SphereScissorsTool","activeSegmentationRepresentation","CircleROIStartEndThresholdTool","numSlicesToPropagate","calculatePointsInsideVolume","showTextBox","spacingInNormal","startCoord","_getStartCoordinate","endCoord","_getEndCoordinate","startCoordinate","endCoordinate","pointsInVolume","projectionPoints","statistics","labelmapUID","_computeProjectionPoints","_computePointsInsideVolume","filterAnnotationsWithinSamePlane","viewplaneNormal","tempStartCoordinate","tempEndCoordinate","_getCoordinateForViewplaneNormal","roundedStartCoordinate","roundedEndCoordinate","cameraCoordinate","roundedCameraCoordinate","middleCoordinate","isMiddleSlice","_getIndexOfCoordinatesForViewplaneNormal","lineWidthToUse","lineDashToUse","_calculateCachedStatsTool","startIJK","endIJK","handlesToStart","startWorld","indexToWorldVec3","endWorld","newProjectionPoints","newPoint","pointsInsideVolume","measureInfo","modalityUnitOptions","worldPos1Index","worldProjectionPointIndex","indexOfProjection","worldPos2Index","numSlicesToPropagateFromStart","numSlicesToPropagateToEnd","endPos","viewplaneNormalAbs","pos","PaintFillTool","getDirection","fixedDimension","getFixedDimension","floodFillGetter","getLabelValue","getScalarDataPositionFromPlane","inPlaneSeedPoint","fixedDimensionValue","generateHelpers","clickedLabelValue","floodFillResult","floodFill","flooded","scalarDataIndex","setAtIndex","framesModified","getFramesModified","triggerSegmentationDataModified","boundaries","minJ","maxJ","seedIndex3D","z","getAtIJK","generateFloodFillGetter","generateGetScalarDataPositionFromPlane","toIndex","getScalarDataPosition","xDirection","yDirection","zDirection","absoluteOfViewPlaneNormal","absoluteOfXDirection","isEqual","absoluteOfYDirection","absoluteOfZDirection","OverlayMarkerType","OrientationMarkerTool","CUBE","AXIS","VTPFILE","OVERLAY_MARKER_TYPES","orientationWidget","viewportCorner","Corners","BOTTOM_RIGHT","viewportSize","minPixelSize","maxPixelSize","overlayMarkerType","ANNOTATED_CUBE","overlayConfiguration","faceProperties","xPlus","faceColor","faceRotation","xMinus","yPlus","fontColor","yMinus","zPlus","zMinus","defaultStyle","fontStyle","fontSizeScale","res","edgeThickness","edgeColor","AXES","CUSTOM","polyDataURL","initViewports","_subscribeToViewportEvents","cleanUpData","orientationMarker","orientationMarkers","updateViewport","updatingOrientationMarker","unsubscribe","unobserve","setTimeout","offscreenMultiRenderWindow","getRenderWindow","widget","getWidget","isDeleted","addAxisActorInViewport","getRenderer","removeActor","createAnnotationCube","createCustomActor","renderer","renderWindow","interactor","getInteractor","parentRenderer","setViewportCorner","setViewportSize","setMinPixelSize","setMaxPixelSize","updateMarkerOrientation","addWidget","response","fetch","arrayBuffer","vtpReader","parseAsArrayBuffer","shallowCopy","setActiveScalars","setColorModeToDirectScalars","setMapper","rotateZ","setDefaultStyle","setXPlusFaceProperty","setXMinusFaceProperty","setYPlusFaceProperty","setYMinusFaceProperty","setZPlusFaceProperty","setZMinusFaceProperty","createAnnotatedCubeActor","axes","annotatedCube","methodName","charAt","toUpperCase","SegmentSelectTool","SelectMode","Inside","Border","hoverTimeout","searchRadius","hoverTimer","clearTimeout","_setActiveSegment","getActiveSegmentation","_setActiveSegmentForType","hoveredSegmentIndex","getSegmentIndexAtWorldPoint","getSegmentIndexAtLabelmapBorder","Contour","getHoveredContourSegmentationAnnotation","Surface","setActiveSegmentIndex","v","triggerSegmentationModified","VideoRedactionTool","toolConfiguration","active","viewportUIDsToRender","toolDataCanvasCoordinate","rect","_getRectangleImageCoordinates","rectangle","point0","viewportUID","renderingEngineUID","sceneUID","targetUIDs","targetUID","_getImageVolumeFromTargetUID","worldToIndexVec3","iMin","iMax","jMin","jMax","kMin","kMax","yMultiple","zMultiple","valueMinusMean","_getTargetVolumeUID","scene","volumeUID","volumeActors","getVolumeActors","coloneIndex","_getTargetStackUID","annotationRenderingEngine","_needsRender","_animationFrameSet","_animationFrameHandle","_renderFlaggedViewports","_throwIfDestroyed","elements","_viewportElements","_triggerRender","_render","_setViewportsToBeRenderedNextFrame","hasBeenDestroyed","_setAllViewportsToBeRenderedNextFrame","elementsEnabled","enabledTools","draw","anyRendered","ANNOTATION_RENDERED","cancelAnimationFrame","clear","FrameOfReferenceSpecificAnnotationManager","getGroupKey","annotationGroupSelector","_imageVolumeModifiedHandler","frameOfReferenceSpecificAnnotations","getFramesOfReference","groupKey","getAnnotation","frameOfReferenceAnnotations","toolSpecificAnnotations","getNumberOfAnnotations","total","preprocessingFn","groupAnnotations","toolAnnotations","removeAnnotations","removedAnnotations","annotationsForTool","saveAnnotations","structuredClone","flat","getNumberOfAllAnnotations","removeAllAnnotations","IMAGE_VOLUME_MODIFIED","setPreprocessingFn","defaultFrameOfReferenceSpecificAnnotationManager","globalLockedAnnotationUIDsSet","setAnnotationLocked","makeEventDetail","lockedAnnotationUIDsSet","added","g","lock","unlock","publish","unlockAllAnnotations","clearLockedAnnotationsSet","getAnnotationsLocked","getAnnotationsLockedCount","checkAndSetAnnotationLocked","freeze","item","ANNOTATION_LOCK_CHANGE","selectedAnnotationUIDs","selected","preserveSelected","clearSelectionSet","isSelected","selectAnnotation","deselectAnnotation","getAnnotationsSelected","getAnnotationsSelectedByToolName","isAnnotationSelected","getAnnotationsSelectedCount","selection","selectionSet","defaultManager","setAnnotationManager","resetAnnotationManager","manager","childUID","parentAnnotationUID","parentAnnotation","childUIDIndex","childAnnotation","parentUID","getParentAnnotation","childAnnotationUID","HTMLDivElement","annotationManagerUID","invalidateAnnotation","currAnnotation","checkAndSetAnnotationVisibility","globalHiddenAnnotationUIDsSet","setAnnotationVisibility","show","annotationUIDsSet","lastHidden","hide","showAllAnnotations","lastVisible","hidden","ANNOTATION_VISIBILITY_CHANGE","_initializeConfig","colorHighlighted","colorSelected","colorLocked","textBoxVisibility","textBoxFontFamily","textBoxFontSize","textBoxColor","textBoxColorHighlighted","textBoxColorSelected","textBoxColorLocked","textBoxBackground","textBoxLinkLineWidth","textBoxLinkLineDash","textBoxShadow","getAnnotationToolStyles","getViewportToolStyles","getToolGroupToolStyles","getDefaultToolStyles","default","setAnnotationStyles","styles","annotationSpecificStyles","setViewportToolStyles","viewportSpecificStyles","setToolGroupToolStyles","toolGroupSpecificStyles","setDefaultToolStyles","toolStyle","specifications","_getToolStyle","property","annotationToolStyles","viewportToolStyles","global","toolGroupToolStyles","globalStyles","toolStyles","alternatives","list","getHierarchalPropertyStyles","Selected","Locked","AutoGenerated","triggerAnnotationAddedForElement","ANNOTATION_ADDED","triggerAnnotationAddedForFOR","getToolGroupsWithToolName","viewportsToRender","triggerAnnotationRemoved","_triggerAnnotationCompleted","triggerContourAnnotationCompleted","AnnotationGroup","annotationUIDs","_isVisible","visibleFilter","unboundVisibleFilter","setVisible","baseEvent","findNearby","uids","renderers","planarContourToolName","triggerSegmentationRender","segmentationRenderingEngine","renderSegmentationsForViewport","triggerSegmentationRenderBySegmentationId","renderSegmentation","_getAllViewports","flatMap","_renderFlaggedSegmentations","_getViewportIdsForSegmentation","segmentationRepresentations","viewportRenderList","segmentationRenderList","_addPlanarFreeHandToolIfAbsent","error","segmentationDetails","status","onSegmentationRender","SEGMENTATION_RENDERED","addTool","initialDefaultState","colorLUT","segmentations","viewportSegRepresentations","internalComputeVolumeLabelmapFromStack","segmentationImageIds","volumeLoader","internalConvertStackToVolumeLabelmap","defaultSegmentationStateManager","getDefaultRenderingConfig","cfun","ofun","_stackLabelmapImageIdReferenceMap","getState","updateState","updater","newState","getColorLUT","lutIndex","getNextColorLUTIndex","updateSegmentation","payload","draftState","addSegmentation","newSegmentation","getLabelmapImageIds","removeSegmentation","filteredSegmentations","triggerSegmentationRemoved","addSegmentationRepresentation","renderingConfig","getSegmentationRepresentations","debug","setRenderInactiveSegmentations","addDefaultSegmentationRepresentation","addLabelmapRepresentation","triggerSegmentationRepresentationModified","segmentReps","segments","colorLUTIndex","_setActiveSegmentation","processLabelmapRepresentationAddition","volumeViewport","isBaseVolumeSegmentation","_updateLabelmapSegmentationReferences","labelmapImageIds","updateCallback","viewableLabelmapImageIdFound","labelmapImageId","asOverlay","stackViewport","_updateAllLabelmapSegmentationImageReferences","sliceIndex","withNavigation","getStackSegmentationImageIdsForViewport","associatedReferenceImageAndLabelmapImageIds","removeSegmentationRepresentationsInternal","specifier","removedRepresentations","currentRepresentations","activeRepresentationRemoved","shouldRemove","removeSegmentationRepresentations","triggerSegmentationRepresentationRemoved","remainingRepresentations","removeSegmentationRepresentation","suppressEvent","setActiveSegmentation","activeSegRep","segRep","viewportRepresentations","typeMatch","idMatch","getSegmentationRepresentationVisibility","viewportRepresentation","setSegmentationRepresentationVisibility","entries","segment","addColorLUT","removeColorLUT","_getStackIdForImageIds","getAllViewportSegmentationRepresentations","getSegmentationRepresentationsBySegmentationId","viewportReps","filteredReps","segmentationStyle","viewportsStyle","setStyle","currentStyles","updatedStyles","copyActiveToInactiveIfNotProvided","renderInactiveSegmentations","repConfig","perSegment","allSegments","ALL_SEGMENTATIONS_KEY","segConfig","processedStyles","labelmapStyles","renderOutlineInactive","renderOutline","outlineWidthInactive","outlineWidth","renderFillInactive","renderFill","fillAlphaInactive","fillAlpha","outlineOpacityInactive","outlineOpacity","contourStyles","outlineDashInactive","outlineDash","getDefaultStyle","allSegmentationsKey","getRenderInactiveSegmentations","clearSegmentationStyle","clearAllSegmentationStyles","clearViewportStyle","clearAllViewportStyles","resetToGlobalStyle","hasCustomStyle","indexToUse","colorLUTToUse","missingColorLUTs","getColorLUTIndex","colorLUTOrIndex","parse","segmentationInputArray","segmentationInput","representationInput","internalAddSegmentationRepresentation","addContourRepresentationToViewport","contourInputArray","addContourRepresentationToViewportMap","viewportInputMap","inputArray","addLabelmapRepresentationToViewport","labelmapInputArray","addLabelmapRepresentationToViewportMap","addSurfaceRepresentationToViewport","surfaceInputArray","addSurfaceRepresentationToViewportMap","inputData","contourData","geometryIds","annotationUIDsMap","normalizedSegments","segmentsConfig","surfaceData","geometryId","geometry","getGeometry","normalizeSurfaceSegments","normalizeSegments","addSegmentations","setColorLUT","colorLUTsIndex","segmentationRepresentation","getSegmentIndexColor","colorValue","setSegmentIndexColor","colorReference","getActiveSegmentIndex","activeSegmentIndex","getSegmentations","getViewportIdsWithSegmentation","viewportSegmentations","getViewportSegmentations","computeVolumeLabelmapFromStack","args","updateSegmentations","segmentationUpdateArray","segmentationUpdate","setSegmentIndexVisibility","getSegmentIndexVisibility","getHiddenSegmentIndices","clearSegmentValue","removeSegment","setNextSegmentAsActive","isThisSegmentActive","updatedSegments","segmentIndices","sort","currentIndex","nextSegmentIndex","previousSegmentIndex","helpers","convertStackToVolumeLabelmap","convertVolumeToStackLabelmap","computeAndAddContourRepresentation","computeAndAddLabelmapRepresentation","computeAndAddSurfaceRepresentation","computeAndAddRepresentation","surfacesObj","indices","getUniqueSegmentIndices","surface","polys","surfaceRepresentation","createAndCacheSurfacesFromRaw","all","updateSurfaceData","rawSurfacesData","rawSurfaceData","closedSurface","geometryLoader","SURFACE","geometryData","workerManager","getWebWorkerManager","triggerWorkerProgress","progress","WEB_WORKER_PROGRESS","WorkerTypes","POLYSEG_CONTOUR_TO_SURFACE","POLYSEG_LABELMAP_TO_SURFACE","computeSurfaceData","contourRepresentationData","polylines","numPointsArray","executeTask","callbacks","convertContourToSurface","computeSurfaceFromContourSegmentation","computeSurfaceFromLabelmapSegmentation","labelmapRepresentationData","getCompleteScalarDataArray","convertLabelmapToSurface","surfaces","errors","Boolean","conversionPaths","canComputeRequestedRepresentation","existingRepresentationTypes","supportedTypes","representationType","representationTypeData","validateFn","getExistingRepresentationTypes","existingRepresentationType","fromRepresentationType","toRepresentationType","canConvertFromTo","computedRepresentations","computeFunction","updateFunction","onComputationComplete","debouncedUpdateFunction","_debouncedSegmentationModified","_debouncedUpdateFunction","subscribeToSegmentationChanges","rep","removeAllSegmentations","immediate","_removeSegmentationRepresentations","labelmapDisplay","contourDisplay","removeRepresentation","surfaceDisplay","_removeRepresentationObject","removeAllSegmentationRepresentations","removeLabelmapRepresentation","removeContourRepresentation","removeSurfaceRepresentation","isSegmentIndexLocked","setSegmentIndexLocked","getLockedSegmentIndices","re","toolGroupFilteredByIds","tg","PRIMARY_BINDINGS","ToolGroup","toolOptions","currentActivePrimaryToolName","prevActivePrimaryToolName","restoreToolOptions","getViewportsInfo","toolInstanceName","getToolInstances","toolDefinition","hasToolName","localToolInstance","toolClass","ToolClass","instantiatedTool","addToolInstance","parentClassName","ToolClassToUse","ParentClass","ToolInstance","renderingEngineUIDToUse","_findRenderingEngine","vpId","getActivePrimaryMouseButtonTool","Settings","getRuntimeSettings","setViewportsCursorByToolName","vpInfo","TOOLGROUP_VIEWPORT_REMOVED","setActiveStrategy","strategyName","setToolMode","binding","TouchBinding","numTouchPoints","MouseBinding","obj","hasSameBinding","useCursor","_hasMousePrimaryButtonBinding","_setCursorForViewports","_renderViewports","TOOL_ACTIVATED","_triggerToolModeChangedEvent","prevToolOptions","matchBindings","removeAllBindings","getDefaultPrimaryBindings","matchBinding","toolOptionsForTool","_getCursor","setToolConfiguration","overwrite","_configuration","getDefaultMousePrimary","getToolConfiguration","configurationPath","getPrevActivePrimaryToolName","setActivePrimaryTool","activeToolName","getCurrentActivePrimaryToolName","newToolGroupId","fnToolFilter","sourceToolInstance","sourceToolOptions","sourceToolMode","primaryBindings","primary","renderingEngines","matchingEngines","engine","binding1","binding2","toolGroupIndex","MODES","toolGroupToolNames","hasToolByName","removeTool","defaultState","isMultiPartToolActive","resetCornerstoneToolsState","resetSvgNodeCache","BidirectionalTool","firstLineSegmentLength","longAxis","shortAxisPoint0","shortAxisPoint1","longAxisVector","counterClockWisePerpendicularToLongAxis","currentShortAxisVector","shortAxis","canvasCoordPoints","shortAxisDistFromCenter","vectorX","vectorY","xMid","yMid","startX","startY","endX","endY","_dragModifyHandle","movingHandleIndex","canvasCoordHandlesCurrent","firstLineSegment","secondLineSegment","proposedPoint","proposedCanvasCoord","fixedHandleCanvasCoord","fixedHandleToProposedCoordVec","fixedHandleToOldCoordVec","proposedFirstLineSegment","_movingLongAxisWouldPutItThroughShortAxis","centerOfRotation","_getSignedAngle","firstPointX","firstPointY","secondPointX","secondPointY","rotatedFirstPoint","rotatedFirstPointY","rotatedSecondPoint","rotatedSecondPointY","newFirstPoint","newSecondPoint","translateHandleIndex","canvasCoordsCurrent","longLineSegment","shortLineSegment","longLineSegmentVec","longLineSegmentVecNormalized","proposedToCurrentVec","movementLength","movementAlongLineSegmentLength","newTranslatedPoint","dataId1","dataId2","secondLineUID","vectorInSecondLineDirection","extendedSecondLineSegment","worldPos4","index3","index4","handles1","handles2","scale1","scale2","widthUnit","vector1","vector2","PlanarFreehandContourSegmentationTool","allowOpenContours","renderResult","pointCanProjectOnLine","PlanarFreehandROITool","alwaysRenderOpenContourHandles","closeContourProximity","checkCanvasEditFallbackProximity","makeClockWise","subPixelResolution","smoothing","smoothOnAdd","smoothOnEdit","knotsRatioPercentageOnAdd","knotsRatioPercentageOnEdit","displayOnePointAsCrosshairs","isEditingClosed","isEditingOpen","activateDraw","activateOpenContourEndEdit","activateClosedContourEdit","activateOpenContourEdit","previousPoint","pStart","pEnd","cancelDrawing","cancelOpenContourEdit","cancelClosedContourEdit","calibratedScale","updateClosedCachedStats","updateOpenCachedStats","annotationsToDisplay","spacingInNormalDirection","filterAnnotationsWithinSlice","filterAnnotationsForDisplay","annotationsWithParallelNormals","td","annotationViewPlaneNormal","halfSpacingInNormalDirection","annotationsWithinSlice","dir","renderContourBeingDrawn","renderClosedContourBeingEdited","renderOpenContourBeingEdited","renderPointContourWithMarker","renderContour","_calculateStatsIfActive","worldPosIndex","worldPosIndex2","iDelta","jDelta","kDelta","ceil","worldPosEnd","canvasPosEnd","curRow","intersections","intersectionCounter","_pointIJK","getLineSegmentIntersectionsCoordinates","shift","getPixelValueUnitunit","isFinite","RectangleROITool","arguments","frameOfReference","BaseTool","initialProps","strategyOptions","call","applyActiveStrategyCallback","callbackType","setConfiguration","newConfiguration","getViewReferenceId","polySegConversionInProgress","contourRepresentation","renderImmediate","MAX_NUMBER_COLORS","labelMapConfigCache","_getLabelmapConfig","labelmapConfig","isActiveLabelmap","segmentsLabelmapConfig","configToUse","activeSegmentOutlineWidthDelta","_needsTransferFunctionUpdate","segmentsHidden","cacheUID","oldConfig","cfunMTime","getMTime","ofunMTime","forceOpacityUpdate","forceColorUpdate","oldFillAlpha","oldRenderFill","oldRenderOutline","oldOutlineWidth","oldSegmentColor","oldSegmentsHidden","oldCfunMTime","oldOfunMTime","_addLabelmapToViewport","labelmapActorEntry","labelmapStyle","numColors","segmentSpecificLabelmapConfig","addRGBPoint","segmentOpacity","removePoint","addPointLong","labelmapActor","setRGBTransferFunction","setClamping","setScalarOpacity","setInterpolationTypeToNearest","setUseLabelOutline","setLabelOutlineOpacity","outlineWidths","setLabelOutlineThickness","setVisibility","_setLabelmapColorAndOpacity","ViewportType","SurfaceData","BrushTool","FILL_INSIDE_CIRCLE","ERASE_INSIDE_CIRCLE","FILL_INSIDE_SPHERE","ERASE_INSIDE_SPHERE","THRESHOLD_INSIDE_CIRCLE","THRESHOLD_INSIDE_SPHERE","THRESHOLD","threshold","thresholdVolumeId","brushSize","preview","previewColors","previewTimeMs","previewMoveDistance","dragMoveDistance","dragTimeMs","StrategyCallbacks","AcceptPreview","RejectPreview","_previewData","timerStart","timer","NaN","isDrag","_editData","createEditData","now","hoverData","_hoverData","createHoverData","getOperationData","OnInteractionStart","rejectPreview","previewCallback","Preview","OnInteractionEnd","acceptPreview","CustomEvent","ERROR_EVENT","message","cancelable","dispatchEvent","volumes","referencedVolumeIdToThreshold","referencedImageIds","override","getActiveSegmentationData","brushCursor","activeRepresentation","_calculateCursor","viewRight","centerCursorInWorld","bottomCursorInWorld","topCursorInWorld","leftCursorInWorld","rightCursorInWorld","strategy","computeInnerCircleRadius","invalidateBrushCursor","brushCursorUID","dynamicRadiusInCanvas","circleUID1","RectangleROIStartEndThresholdTool","computePointsInsideVolume","projectionPointsImageIds","roundedStartCoord","roundedEndCoord","coord","roundedCoord","firstOrLastSlice","habdles","projectionPoint","RectangleROIThresholdTool","ContourWindingDirection","getViewportsForAnnotation","getEnabledElements","roundNumber","sourcePoints","minDistance","MAX_SAFE_INTEGER","sourcePoint","_distanceBetween","cachedResult","keySet","addImageSegmentIndices","addVolumeSegmentIndices","handleLabelmapSegmentation","handleContourSegmentation","handleSurfaceSegmentation","equalsCheck","getVoxelOverlap","voxelSpacing","voxelCenter","halfSpacingX","halfSpacingY","halfSpacingZ","voxelCornersIJK","offsets","xOff","yOff","zOff","processVolumes","thresholdVolumeInformation","segmentationSpacing","scalarDataLength","getScalarDataLength","volumeInfoList","baseVolumeIdx","volumeSize","segmentIndicesCache","setSegmentationDirty","cached","isDirty","getCachedSegmentIndices","setCachedSegmentIndices","_extends","_react","_react2","__esModule","exports","_ref","_ref$fill","_ref$width","_ref$height","_ref$style","props","_objectWithoutProperties","_typeof","iterator","_defineProperties","enumerable","configurable","writable","arg","hint","prim","toPrimitive","TypeError","_toPrimitive","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","o","minLen","n","test","_unsupportedIterableToArray","_nonIterableSpread","arr2","stringToUint8Array","str","charCodeAt","containsToken","token","findToken","maxSearchLength","searchLength","multipartEncode","datasets","boundary","s4","random","guid","contentTypeString","header","footer","headerArray","footerArray","headerLength","footerLength","contentArrays","datasetBuffer","contentArray","contentLength","multipartArray","multipartDecode","ArrayBuffer","isView","separator","headerIndex","itemLimit","uint8ArrayToString","boundaryString","parts","substr","identifyBoundary","boundaryIndex","boundaryLength","components","headerTokenIndex","isObject","isEmptyObject","getFirstResult","MEDIATYPES","DICOM","DICOM_JSON","OCTET_STREAM","PDF","JPEG","PNG","debugLog","api","DICOMwebClient","Constructor","_classCallCheck","baseURL","username","password","qidoURLPrefix","qidoURL","wadoURLPrefix","wadoURL","stowURLPrefix","stowURL","singlepart","requestHooks","headers","errorInterceptor","verbose","setDebug","protoProps","staticProps","debugLevel","debugLogFunction","_this","reject","request","XMLHttpRequest","open","responseType","setRequestHeader","functions","userHeaders","onloadstart","onloadend","onreadystatechange","readyState","contentType","getResponseHeader","progressCallback","onprogress","isValid","requestHook","areValidRequestHooks","combinedHeaders","pipedRequest","withCredentials","send","_httpRequest","params","urlWithQueryParams","_parseQueryParameters","Accept","_httpGet","mediaTypes","_buildAcceptHeaderFieldValue","byteRange","supportedMediaTypes","Range","_buildRangeHeaderFieldValue","_buildMultipartAcceptHeaderFieldValue","defaultMediaType","acceptableMediaTypes","mediaType","_httpPost","queryParams","_httpGetApplicationJson","studyInstanceUID","seriesInstanceUID","transferSyntax","sopInstanceUID","paramString","frameNumbers","_httpGetMultipartApplicationOctetStream","_getSharedMediaTypes","commonMediaType","_getCommonMediaType","_httpGetMultipartImage","_httpGetMultipartVideo","_httpGetImage","_httpGetVideo","_httpGetText","_httpGetApplicationPdf","_options$withCredenti","_options$progressCall","_httpGetMultipartApplicationDicom","_options$withCredenti2","_options$progressCall2","BulkDataURI","_options$withCredenti3","_options$progressCall3","_multipartEncode","_options$withCredenti4","queryString","encodeURIComponent","sepIndex","mediaTypeType","_assertMediaTypeIsValid","_this2","fieldValueParts","transferSyntaxUID","fieldValue","endsWith","expectedMediaTypes","actualType","_parseMediaType","expectedMediaType","expectedType","types","sharedMediaTypes","HASH_UNDEFINED","INFINITY","funcTag","genTag","symbolTag","reIsDeepProp","reIsPlainProp","reLeadingDot","rePropName","reEscapeChar","reIsHostCtor","freeGlobal","freeSelf","self","root","Function","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","objectToString","reIsNative","RegExp","getNative","nativeCreate","symbolProto","symbolToString","Hash","entry","ListCache","MapCache","assocIndexOf","other","baseGet","object","isSymbol","isKey","stringToPath","toKey","baseIsNative","func","pattern","tag","isFunction","isHostObject","toSource","getMapData","__data__","getValue","memoize","string","baseToString","number","quote","resolver","memoized","apply","Cache","isObjectLike","module","defaultValue","DataView","hashClear","hashDelete","hashGet","hashHas","hashSet","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","setCacheAdd","setCacheHas","SetCache","stackClear","stackDelete","stackGet","stackHas","stackSet","Stack","iteratee","predicate","resIndex","baseTimes","isArguments","isBuffer","isIndex","isTypedArray","inherited","isArr","isArg","isBuff","isType","skipIndexes","baseAssignValue","eq","objValue","copyObject","keysIn","arrayEach","assignValue","baseAssign","baseAssignIn","cloneBuffer","copyArray","copySymbols","copySymbolsIn","getAllKeys","getAllKeysIn","getTag","initCloneArray","initCloneByTag","initCloneObject","isMap","isSet","argsTag","objectTag","cloneableTags","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","isFunc","stacked","subValue","objectCreate","baseCreate","proto","baseForOwn","baseEach","createBaseEach","baseFor","createBaseFor","castPath","arrayPush","keysFunc","symbolsFunc","baseGetTag","baseIsEqualDeep","baseIsEqual","equalArrays","equalByTag","equalObjects","arrayTag","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","matchData","noCustomizer","srcValue","COMPARE_PARTIAL_FLAG","isMasked","isLength","typedArrayTags","baseMatches","baseMatchesProperty","identity","isPrototype","nativeKeys","nativeKeysIn","isProto","isArrayLike","collection","baseIsMatch","getMatchData","matchesStrictComparable","hasIn","isStrictComparable","arrayMap","byteLength","freeExports","nodeType","freeModule","Buffer","allocUnsafe","copy","cloneArrayBuffer","dataView","byteOffset","reFlags","regexp","lastIndex","symbolValueOf","valueOf","typedArray","isNew","getSymbols","getSymbolsIn","eachFunc","fromRight","iterable","arraySome","cacheHas","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","mapToArray","setToArray","convert","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","baseGetAllKeys","isKeyable","getPrototype","overArg","getPrototypeOf","arrayFilter","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","Ctor","ctorString","hasFunc","cloneDataView","cloneRegExp","cloneSymbol","cloneTypedArray","reIsUint","freeProcess","process","nodeUtil","require","pairs","LARGE_ARRAY_SIZE","memoizeCapped","subString","CLONE_DEEP_FLAG","castFunction","baseHasIn","hasPath","baseIsArguments","stubFalse","baseIsMap","baseUnary","nodeIsMap","objectCtorString","baseIsSet","nodeIsSet","baseIsTypedArray","nodeIsTypedArray","arrayLikeKeys","baseKeys","baseKeysIn","baseIteratee","baseMap","baseProperty","basePropertyDeep","checkboardCache","serverCanvas","checkboard","ctx","getContext","fillStyle","fillRect","toDataURL","Checkboard","white","grey","boxShadow","grid","absolute","isValidElement","defaultProps","_createClass","defineProperties","_possibleConstructorReturn","ReferenceError","Alpha","_ref2","_temp","_len","_key","__proto__","handleChange","change","hsl","initialA","container","containerWidth","containerHeight","pageX","touches","pageY","getBoundingClientRect","pageXOffset","pageYOffset","l","_a","onChange","handleMouseDown","handleMouseUp","unbindEventListeners","subClass","superClass","setPrototypeOf","_inherits","rgb","alpha","gradient","margin","slider","marginTop","vertical","ref","onMouseDown","onTouchMove","onTouchStart","PureComponent","Component","VALID_KEY_CODES","idCounter","EditableInput","handleBlur","blurValue","setState","setUpdatedValue","handleKeyDown","getNumberValue","getArrowOffset","updatedValue","handleDrag","dragLabel","movementX","dragMax","getValueObjectWithLabel","inputId","prevProps","prevState","activeElement","_defineProperty","arrowOffset","onChangeValue","wrap","onKeyDown","onBlur","placeholder","spellCheck","hideLabel","htmlFor","Hue","_h","_props$direction","hue","className","nativeObjectToString","symToStringTag","toStringTag","isOwn","unmasked","srcIndex","mergeFunc","isCommon","isTyped","baseMerge","thisArg","nativeMax","otherArgs","nativeNow","lastCalled","stamp","remaining","assigner","sources","guard","Raised","zDepth","_ref$styles","passedStyles","content","bg","propTypes","reWhitespace","reTrimStart","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","nativeMin","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","flush","Saturation","_container$getBoundin","saturation","bright","getContainerRenderWindow","contains","parent","black","circle","hsv","trimLeft","trimRight","tinycolor","opts","ok","named","names","matchers","rgba","hsla","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","convertToPercentage","f","q","hsvToRgb","hue2rgb","hslToRgb","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_roundA","_format","_gradientType","gradientType","_ok","rgbToHsl","rgbToHsv","rgbToHex","allow3Char","hex","pad2","rgbaToArgbHex","convertDecimalToHex","_desaturate","amount","toHsl","clamp01","_saturate","_greyscale","desaturate","_lighten","_brighten","toRgb","_darken","_spin","_complement","polyad","step","_splitcomplement","_analogous","slices","part","ret","_monochromatic","toHsv","modification","isDark","getBrightness","isLight","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","setAlpha","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","_applyModification","lighten","brighten","darken","saturate","greyscale","spin","_applyCombination","analogous","complement","monochromatic","splitcomplement","triad","tetrad","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","readability","isReadable","wcag2","wcag2Parms","out","parms","level","validateWCAG2Parms","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellow","yellowgreen","flipped","flip","isOnePointZero","processPercent","isPercentage","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","simpleCheckForValidColor","checked","passed","letter","toState","oldHue","isValidHex","lh","getContrastingColor","col","isvalidColorString","Picker","ColorPicker","colors","onChangeComplete","handleSwatchHover","onSwatchHover","optionalEvents","nextProps","Span","_React$Component","Focus","handleFocus","onFocus","_ref$onClick","onClick","onHover","_ref$title","_ref$focusStyle","focusStyle","transparent","swatch","outline","onMouseOver","tabIndex","picker","backgroundColor","AlphaPicker","_ref$className","swatches","marginRight","float","marginBottom","Block","triangle","hexCode","card","head","alignItems","justifyContent","body","borderStyle","borderWidth","borderColor","marginLeft","border","deepPurple","lightBlue","lightGreen","amber","deepOrange","blueGrey","CircleSwatch","hover","circleSize","circleSpacing","transition","Swatch","Circle","flexWrap","ChromeFields","toggleViews","view","showHighlight","hideHighlight","paddingTop","fields","flex","field","paddingLeft","toggle","textAlign","icon","iconHighlight","textTransform","lineHeight","svg","UnfoldMoreHorizontalIcon","onMouseEnter","onMouseOut","Chrome","disableAlpha","defaultView","paddingBottom","controls","zIndex","toggles","paddingRight","HEXwrap","HEXinput","HEXlabel","RGBwrap","RGBinput","RGBlabel","Compact","compact","hoverSwatch","Github","borderBottomColor","triangleShadow","HuePicker","HuePointer","material","borderBottom","Hex","third","divider","fieldSymbols","triangleBorder","Extend","leftInside","rightInside","button","backgroundImage","currentColor","new","current","Photoshop","_props","_props$styles","_props$className","previews","PhotoshopPointer","onAccept","onCancel","PhotoshopFields","single","double","SketchPresetColors","borderTop","swatchWrap","handleClick","colorObjOrString","isRequired","Sketch","presetColors","sliders","activeColor","Slider","check","CheckIcon","Swatches","overflowY","Twitter","hash","hexcode","GooglePointerCircle","GooglePointer","_values","_values2","hsvValue","column","input2","label2","flexGrow","rgbValue","hslValue","Google","performance","cancelTimeout","timeoutID","requestTimeout","delay","tick","getScrollbarSize","recalculate","div","cachedRTLResult","getRTLOffsetType","outerDiv","outerStyle","innerDiv","innerStyle","scrollLeft","defaultItemKey$1","createListComponent","_class","getItemOffset","getEstimatedTotalSize","getItemSize","getOffsetForIndexAndAlignment","getStartIndexForOffset","getStopIndexForStartIndex","initInstanceProps","shouldResetStyleCacheOnItemSizeChange","validateProps","_PureComponent","List","_instanceProps","_outerRef","_resetIsScrollingTimeoutId","isScrolling","scrollDirection","scrollOffset","initialScrollOffset","scrollUpdateWasRequested","_callOnItemsRendered","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","onItemsRendered","_callOnScroll","onScroll","_getItemStyle","_this$props","itemSize","layout","itemStyleCache","_getItemStyleCache","_offset","isRtl","offsetHorizontal","__","___","_onScrollHorizontal","_event$currentTarget","scrollWidth","_resetIsScrollingDebounced","_onScrollVertical","_event$currentTarget2","scrollHeight","scrollTop","_outerRefSetter","outerRef","_resetIsScrolling","getDerivedStateFromProps","validateSharedProps$1","_proto","scrollTo","scrollToItem","align","_this$props2","itemCount","scrollbarSize","componentDidMount","_this$props3","_callPropsCallbacks","componentDidUpdate","_this$props4","_this$state","componentWillUnmount","_this$props5","innerRef","innerElementType","innerTagName","itemData","_this$props5$itemKey","itemKey","outerElementType","outerTagName","useIsScrolling","_this$_getRangeToRend","_getRangeToRender","startIndex","stopIndex","items","_index","estimatedTotalSize","WebkitOverflowScrolling","willChange","_this$_getRangeToRend2","_overscanStartIndex","_overscanStopIndex","_visibleStartIndex","_visibleStopIndex","_this$state2","_scrollDirection","_scrollOffset","_scrollUpdateWasRequested","_this$props6","overscanCount","_this$state3","overscanBackward","overscanForward","_ref3","getItemMetadata$1","instanceProps","itemMetadataMap","lastMeasuredIndex","itemMetadata","findNearestItemBinarySearch$1","high","low","middle","currentOffset","findNearestItemExponentialSearch$1","interval","estimatedItemSize","totalSizeOfMeasuredItems","VariableSizeList","maxOffset","minOffset","findNearestItem$1","resetAfterIndex","shouldForceUpdate","forceUpdate","_ref5","autoprefix","_forOwn2","_forOwn3","transforms","msBorderRadius","MozBorderRadius","OBorderRadius","WebkitBorderRadius","msBoxShadow","MozBoxShadow","OBoxShadow","WebkitBoxShadow","userSelect","WebkitTouchCallout","KhtmlUserSelect","MozUserSelect","msUserSelect","WebkitUserSelect","WebkitBoxFlex","MozBoxFlex","WebkitFlex","msFlex","flexBasis","WebkitFlexBasis","WebkitJustifyContent","msTransition","MozTransition","OTransition","WebkitTransition","msTransform","MozTransform","OTransform","WebkitTransform","otherElementStyles","otherStyle","prefixed","expanded","onMouseUp","Hover","handleMouseOver","handleMouseOut","flattenNames","_isString3","_interopRequireDefault","_isPlainObject3","_map3","things","thing","_flattenNames2","_mergeClasses2","_autoprefix2","_hover3","_active2","_loop3","ReactCSS","classes","activations","activeNames","merged","setProp","mergeClasses","_cloneDeep3","toMerge","is","useState","useEffect","useLayoutEffect","useDebugValue","getSnapshot","inst","useSyncExternalStore","useRef","useMemo","useSyncExternalStoreWithSelector","hasValue","createStoreImpl","createState","listeners","partial","nextState","previousState","listener","getInitialState","initialState","subscribe","createStore","didWarnAboutEqualityFn","createImpl","useBoundStore","selector","equalityFn","getServerState","useStore","trackedConnections","getTrackedConnectionState","fromEntries","stores","api2","devtools","devtoolsOptions","anonymousActionType","store","extensionConnector","__REDUX_DEVTOOLS_EXTENSION__","_e","connection","connectionInformation","connect","existingConnection","newConnection","extractConnectionInformation","isRecording","nameOrAction","action","setStateFromDevtools","originalIsRecording","store2","dispatchFromDevtools","dispatch","didWarnAboutReservedActionType","originalDispatch","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","computedStates","stringified","parsed"],"sourceRoot":""}